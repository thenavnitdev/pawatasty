var o0=Object.defineProperty;var l0=(t,s,a)=>s in t?o0(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var He=(t,s,a)=>l0(t,typeof s!="symbol"?s+"":s,a);import{r as n,b as i0,a as sa,R as he,c as c0}from"./react-vendor-Dy3HAe-G.js";import{c as d0}from"./supabase-Cd5F3mML.js";import{C as Ut,A as Ie,S as _t,a as Qe,b as m0,c as ys,X as Cs,d as we,I as nt,P as cs,e as Ve,L as ws,T as u0,F as aa,Q as gt,H as Ze,M as Ce,B as lt,f as ye,g as ct,h as We,U as st,i as Re,W as h0,j as ra,k as Pe,l as tt,m as f0,G as ds,n as na,o as g0,p as vs,q as p0,r as zt,s as E0,t as b0,u as y0,v as Lt,N as Ss,w as C0,R as w0,x as v0,y as B0,z as xa,D as j0,E as Bs,J as Rt,K as ms,O as js,V as oa,Y as la,Z as A0,_ as N0,$ as F0,a0 as D0,a1 as ia,a2 as k0,a3 as S0,a4 as ca,a5 as Ps,a6 as P0,a7 as I0}from"./lucide-CV0GdFD5.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const x of document.querySelectorAll('link[rel="modulepreload"]'))r(x);new MutationObserver(x=>{for(const o of x)if(o.type==="childList")for(const m of o.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function a(x){const o={};return x.integrity&&(o.integrity=x.integrity),x.referrerPolicy&&(o.referrerPolicy=x.referrerPolicy),x.crossOrigin==="use-credentials"?o.credentials="include":x.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(x){if(x.ep)return;x.ep=!0;const o=a(x);fetch(x.href,o)}})();var da={exports:{}},$t={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var M0=n,T0=Symbol.for("react.element"),_0=Symbol.for("react.fragment"),L0=Object.prototype.hasOwnProperty,R0=M0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,O0={key:!0,ref:!0,__self:!0,__source:!0};function ma(t,s,a){var r,x={},o=null,m=null;a!==void 0&&(o=""+a),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(m=s.ref);for(r in s)L0.call(s,r)&&!O0.hasOwnProperty(r)&&(x[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)x[r]===void 0&&(x[r]=s[r]);return{$$typeof:T0,type:t,key:o,ref:m,props:x,_owner:R0.current}}$t.Fragment=_0;$t.jsx=ma;$t.jsxs=ma;da.exports=$t;var e=da.exports,ua,Is=i0;ua=Is.createRoot,Is.hydrateRoot;const U0="modulepreload",z0=function(t){return"/"+t},Ms={},$0=function(s,a,r){let x=Promise.resolve();if(a&&a.length>0){document.getElementsByTagName("link");const m=document.querySelector("meta[property=csp-nonce]"),f=(m==null?void 0:m.nonce)||(m==null?void 0:m.getAttribute("nonce"));x=Promise.allSettled(a.map(g=>{if(g=z0(g),g in Ms)return;Ms[g]=!0;const p=g.endsWith(".css"),c=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${g}"]${c}`))return;const l=document.createElement("link");if(l.rel=p?"stylesheet":U0,p||(l.as="script"),l.crossOrigin="",l.href=g,f&&l.setAttribute("nonce",f),document.head.appendChild(l),p)return new Promise((h,u)=>{l.addEventListener("load",h),l.addEventListener("error",()=>u(new Error(`Unable to preload CSS for ${g}`)))})}))}function o(m){const f=new Event("vite:preloadError",{cancelable:!0});if(f.payload=m,window.dispatchEvent(f),!f.defaultPrevented)throw m}return x.then(m=>{for(const f of m||[])f.status==="rejected"&&o(f.reason);return s().catch(o)})},q0="https://api.pawatasty.com",H0="b0834cfeae781e2c13213b55741d2717",W0="db0572a02b9aa963b0138e7180ba994fa730ddf63cfc5b60798c15a234b6523f";class G0{constructor(s,a,r){He(this,"baseURL");He(this,"authToken",null);He(this,"apiKey");He(this,"apiSecret");this.baseURL=s,this.apiKey=a,this.apiSecret=r}setAuthToken(s){this.authToken=s}async request(s,a,r=!1){var g;const x=`${this.baseURL}${s}`,o={"Content-Type":"application/json"};a!=null&&a.headers&&Object.assign(o,a.headers),r?(o["X-API-Key"]=this.apiKey,o["X-API-Secret"]=this.apiSecret):this.authToken&&(o.Authorization=`Bearer ${this.authToken}`);const m=await fetch(x,{...a,headers:o});if(!m.ok){const p=await m.text();let c=`API Error: ${m.status} ${m.statusText}`;try{const l=JSON.parse(p);c=l.message||l.error||((g=l.data)==null?void 0:g.message)||c}catch{c=p||c}throw new Error(c)}const f=await m.json();if(f&&typeof f=="object"){if("success"in f&&f.success===!1){const p=f.error||f.message||"Request failed";throw new Error(p)}if("data"in f)return f.data}return f}async get(s,a,r){const x=a?"?"+new URLSearchParams(a).toString():"";return this.request(`${s}${x}`,{method:"GET"},r)}async post(s,a,r){return this.request(s,{method:"POST",body:a?JSON.stringify(a):void 0},r)}async put(s,a,r){return this.request(s,{method:"PUT",body:a?JSON.stringify(a):void 0},r)}async delete(s,a){return this.request(s,{method:"DELETE"},a)}}const ve=new G0(q0,H0,W0),ha={register:t=>ve.post("/api/auth/supabase/email/signup",t,!0),login:t=>ve.post("/api/auth/supabase/email/signin",t,!0),verify:()=>ve.get("/api/mobile/auth/verify"),sendOTP:t=>ve.post("/api/auth/phone/send-otp",t,!0),verifyOTP:t=>ve.post("/api/auth/phone/verify-otp",t,!0),firebaseAuth:t=>ve.post("/api/mobile/auth/firebase",t,!0)},fa={getProfile:()=>ve.get("/api/mobile/profile"),updateProfile:t=>ve.put("/api/mobile/profile",t),getPromoCode:()=>ve.get("/api/mobile/user/promo-code")},Y0="https://dopjawhuylqipltnuydp.supabase.co",V0=`${Y0}/functions/v1/image-proxy`,ga="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop",J0="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800&h=600&fit=crop";function X0(t){if(!t)return null;if(/^\d+$/.test(t))return t;const s=[/\/api\/image\/(\d+)/,/\/uploads\/(\d+)/,/\/image\/(\d+)/,/file-(\d+-\w+)\.(?:jpg|jpeg|png)/i,/^([a-zA-Z0-9\-_]+)$/];for(const a of s){const r=t.match(a);if(r)return r[1]}return t&&!t.includes("/")&&!t.includes(".")?t:null}function Z0(t,s={}){if(!t||Array.isArray(t)&&(t=t[0],!t))return null;const a=typeof t=="number"?String(t):t;if(a.startsWith("http")&&a.includes("/functions/v1/image-proxy/"))return a;const r=X0(a);if(!r)return null;let x=`${V0}/${r}`;if(s.width||s.height||s.quality||s.format){const o=new URLSearchParams;s.width&&o.append("w",String(s.width)),s.height&&o.append("h",String(s.height)),s.quality&&o.append("q",String(s.quality)),s.format&&o.append("f",s.format),x+=`?${o.toString()}`}return x}function ke(t,s="merchant",a={}){typeof t=="number"&&(t=String(t)),Array.isArray(t)&&(t=t[0]||null);const r=Z0(t,a);if(r)return r;switch(s){case"deal":return J0;case"merchant":case"logo":case"cover":case"profile":default:return ga}}function Q0(t){return ke(t,"logo",{width:200,height:200,quality:90})}function _e(t){return ke(t,"cover",{width:1200,height:600,quality:85})}function qt(t){return ke(t,"deal",{width:800,height:600,quality:85})}const Bt=new Map;function pa(t){if(!t)return ga;if(Bt.has(t))return Bt.get(t);let s;return t.startsWith("http")?s=t:t.startsWith("user_profile/")?s=`https://dopjawhuylqipltnuydp.supabase.co/storage/v1/object/public/user_images/${t}`:s=ke(t,"profile",{width:300,height:300,quality:90}),Bt.set(t,s),s}function Ea(t){t?Bt.delete(t):Bt.clear()}function ts(t){var a,r;let s=((a=t.coverImageIds)==null?void 0:a[0])||t.coverImageUrl;return t.coverImageIds&&t.coverImageIds.length>0,{...t,imageUrl:Q0(t.logoId||t.imageUrl),coverImageUrl:_e(s),deals:(r=t.deals)==null?void 0:r.map(x=>({...x,imageUrl:qt(x.imageUrl)}))}}const dt={getAllMerchants:async()=>(await ve.get("/api/merchants")).map(r=>({id:r.merchantId,name:r.companyName,description:r.companyDescription,category:r.businessCategory,address:r.address,latitude:r.latitude,longitude:r.longitude,phone:r.phoneNr,website:r.website,openingHours:`${r.openDays||""} ${r.openTime||""}`.trim(),logoId:r.logoId,coverImageIds:r.coverImageIds||[],rating:r.rating,availableSlots:r.availableSlots||0})).map(ts),getMerchantById:async t=>{const s=await ve.get(`/api/merchants/${t}`),a={id:s.merchantId,name:s.companyName,description:s.companyDescription,category:s.businessCategory,address:s.address,latitude:s.latitude,longitude:s.longitude,phone:s.phoneNr,website:s.website,openingHours:`${s.openDays||""} ${s.openTime||""}`.trim(),logoId:s.logoId,coverImageIds:s.coverImageIds||[],rating:s.rating};return ts(a)},getNearbyMerchants:async t=>{const s={lat:t.lat,lng:t.lng,...t.radius&&{radius:t.radius}};return(await ve.get("/api/merchants/nearby",s)).map(ts)},getMerchantCoverImages:(t,s=5)=>(t.coverImageIds||[]).slice(0,s).map(x=>_e(x)).filter(x=>x!==null)},K0="https://dopjawhuylqipltnuydp.supabase.co",er="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co",J=d0(K0,er,{auth:{persistSession:!0,autoRefreshToken:!0,detectSessionInUrl:!0,storage:window.localStorage,storageKey:"supabase.auth.token",flowType:"pkce",debug:!0}}),Ts="https://dopjawhuylqipltnuydp.supabase.co",_s="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co",us={applyPromoCode:async t=>{const{data:{session:s}}=await J.auth.getSession();if(!s)throw new Error("Not authenticated");const a=await fetch(`${Ts}/functions/v1/apply-promo-code`,{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json",apikey:_s},body:JSON.stringify(t)}),r=await a.json();if(!a.ok){if(r.hasOwnProperty("success")&&r.success===!1)return r;throw new Error(r.message||r.error||"Failed to apply promo code")}return r},getUserPromoCode:async()=>{const{data:{session:t}}=await J.auth.getSession();if(!t)throw new Error("Not authenticated");const s=await fetch(`${Ts}/functions/v1/user-promo-code`,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json",apikey:_s}});if(!s.ok){const a=await s.json();throw new Error(a.message||"Failed to fetch promo code")}return s.json()}},Ls="https://dopjawhuylqipltnuydp.supabase.co",Rs="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co",Pt={getBalance:async()=>{const{data:{session:t}}=await J.auth.getSession();if(!t)throw new Error("Not authenticated");const s=await fetch(`${Ls}/functions/v1/points-balance`,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json",apikey:Rs}});if(!s.ok){const a=await s.json();throw new Error(a.message||"Failed to fetch points balance")}return s.json()},getTransactions:async()=>{const{data:{session:t}}=await J.auth.getSession();if(!t)throw new Error("Not authenticated");const s=await fetch(`${Ls}/functions/v1/points-transactions`,{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json",apikey:Rs}});if(!s.ok){const a=await s.json();throw new Error(a.message||"Failed to fetch points transactions")}return s.json()},getReferrals:async()=>{const{data:t,error:s}=await J.from("referrals").select("*").order("created_at",{ascending:!1});if(s)throw s;return t||[]}},bt="https://dopjawhuylqipltnuydp.supabase.co",tr="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co",yt=async t=>{let s=t;if(!s){const{data:{session:a}}=await J.auth.getSession();if(!(a!=null&&a.access_token))throw new Error("Not authenticated");s=a.access_token}return{Authorization:`Bearer ${s}`,"Content-Type":"application/json",apikey:tr}},De={savePaymentMethod:async t=>{const s=await yt(),a=await fetch(`${bt}/functions/v1/payment-methods`,{method:"POST",headers:s,body:JSON.stringify(t)});if(!a.ok){let r="Failed to save payment method";try{const x=await a.json();r=x.error||x.message||r}catch{r=await a.text()||r}throw new Error(r)}return a.json()},getPaymentMethods:async t=>{const s=await yt(t),a=await fetch(`${bt}/functions/v1/payment-methods`,{method:"GET",headers:s});if(!a.ok){const r=await a.text();throw new Error(r||"Failed to get payment methods")}return a.json()},deletePaymentMethod:async t=>{const s=await yt(),a=await fetch(`${bt}/functions/v1/payment-methods/${t}`,{method:"DELETE",headers:s});if(!a.ok){const r=await a.text();throw new Error(r||"Failed to delete payment method")}return a.json()},setDefaultPaymentMethod:async t=>{const s=await yt(),a=await fetch(`${bt}/functions/v1/payment-methods/${t}/default`,{method:"PUT",headers:s});if(!a.ok){const r=await a.text();throw new Error(r||"Failed to set default payment method")}return a.json()},completeSetup:async(t,s)=>{const a=await yt(),r=await fetch(`${bt}/functions/v1/payment-methods/${t}/complete`,{method:"PUT",headers:a,body:JSON.stringify({setupIntentId:s})});if(!r.ok){const x=await r.text();throw new Error(x||"Failed to complete payment method setup")}return r.json()},completePaymentMethodSetup:async(t,s)=>De.completeSetup(t,s)},Ht={getReviews:(t,s)=>ve.get(`/api/mobile/reviews/${t}/${s}`),getReviewStats:(t,s)=>ve.get(`/api/mobile/reviews/${t}/${s}/stats`),createReview:t=>ve.post("/api/mobile/reviews",t),updateReview:(t,s)=>ve.put(`/api/mobile/reviews/${t}`,s),deleteReview:t=>ve.delete(`/api/mobile/reviews/${t}`),markHelpful:t=>ve.post(`/api/mobile/reviews/${t}/helpful`,{})},it={async addLikedMerchant(t){const{data:{user:s}}=await J.auth.getUser();if(!s)throw new Error("User not authenticated");const{error:a}=await J.from("liked_merchants").insert({user_id:s.id,merchant_id:t});if(a)throw a},async removeLikedMerchant(t){const{data:{user:s}}=await J.auth.getUser();if(!s)throw new Error("User not authenticated");const{error:a}=await J.from("liked_merchants").delete().eq("user_id",s.id).eq("merchant_id",t);if(a)throw a},async isLiked(t){const{data:{user:s}}=await J.auth.getUser();if(!s)return!1;const{data:a,error:r}=await J.from("liked_merchants").select("id").eq("user_id",s.id).eq("merchant_id",t).maybeSingle();if(r)throw r;return a!==null},async getLikedMerchants(){const{data:{user:t}}=await J.auth.getUser();if(!t)return[];const{data:s,error:a}=await J.from("liked_merchants").select("merchant_id").eq("user_id",t.id).order("created_at",{ascending:!1});if(a)throw a;return s.map(r=>r.merchant_id)}},sr="https://dopjawhuylqipltnuydp.supabase.co";async function ue(t,s="",a={}){const{method:r="GET",body:x,requireAuth:o=!0,accessToken:m}=a,g={"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"};if(o){let u=m;if(!u){const{data:{session:b},error:E}=await J.auth.getSession();if(!(b!=null&&b.access_token))throw new Error("Not authenticated. Please log in again.");u=b.access_token}g.Authorization=`Bearer ${u}`}const p=s?s.startsWith("/")?s:`/${s}`:"",c=`${sr}/functions/v1/${t}${p}`,l={method:r,headers:g};x&&r!=="GET"&&(l.body=JSON.stringify(x));const h=await fetch(c,l);if(!h.ok){const u=await h.text();let b;try{const E=JSON.parse(u);if(E.hasOwnProperty("success")&&E.success===!1)return E;b=E.error||E.message||"Request failed"}catch{b=u||`HTTP ${h.status}`}throw new Error(b)}return h.json()}const ba={async getActivePromos(){return ue("promo-content")}},Je={async sendInvite(t){return ue("connection-invites","send",{method:"POST",body:{recipientLinkId:t}})},async getPendingInvites(){return ue("connection-invites","pending",{method:"GET"})},async getSentInvites(){return ue("connection-invites","sent",{method:"GET"})},async respondToInvite(t,s){return ue("connection-invites","respond",{method:"POST",body:{inviteId:t,action:s}})},async getConnections(){return ue("connection-invites","connections",{method:"GET"})},async removeConnection(t){return ue("connection-invites","remove",{method:"DELETE",body:{userId:t}})}};function ar(t){if(!t)return"restaurant";const s=t.toLowerCase().trim();return["restaurant","cafe","bar","shop","train_station"].includes(s)?s:"restaurant"}function rr(t){if(!t)return;const s=t.toLowerCase().trim();if(s==="diningonly")return"diningonly";if(s==="chargingonly")return"chargingonly";if(s==="diningandcharging")return"diningandcharging";if(s.includes("dine")&&s.includes("bites")&&s.includes("drinks")&&!s.includes("charging"))return"diningonly";if(s.includes("charging hub")||s.includes("charging")&&!s.includes("bites")&&!s.includes("drinks"))return"chargingonly";if(s.includes("bites")&&s.includes("drinks")&&s.includes("charging"))return"diningandcharging"}function ss(t){var m;const s=rr(t.businessType),a=t.pbAvailable||t.occupiedSlots||t.availableSlots||0,r=t.totalSlots||0,x=t.returnSlots||0;let o=t.coverImageIds||[];return o.length===0&&t.logoId&&(o=[t.logoId]),{id:t.id||t.merchantId,name:t.name||t.companyName,description:t.description||t.companyDescription,category:ar(t.category||t.businessCategory),merchantCategory:s||t.businessType||t.category,businessType:s,subcategoryName:t.subcategoryName,specialty:t.companySpecialty||t.specialty||[],address:t.address,city:t.city,latitude:t.latitude,longitude:t.longitude,phone:t.phone||t.phoneNr,website:t.website,openingHours:t.opening_hours||t.openingHours||`${t.openDays||t.open_days||""} ${t.openTime||t.open_time||""}`.trim(),openDays:t.open_days||t.openDays,openTime:t.open_time||t.openTime,logoId:t.logoId,coverImageIds:o,imageUrl:t.image_url||t.logoId,coverImageUrl:o[0],rating:t.rating||0,reviewCount:t.reviewCount||0,availableSlots:a,partnershipType:t.partnershipType,occupiedSlots:a,totalSlots:r,returnSlots:x,hasStation:t.hasStation||r>0,unitPrice:t.unitPrice,unitMin:t.unitMin,parentMerchantId:t.parentMerchantId,deals:(m=t.deals)==null?void 0:m.map(f=>({id:f.id,merchantId:f.merchantId,title:f.title,description:f.description,discount:f.discount,saveValue:f.discountedPrice||f.saveValue,savings:f.discountedPrice||f.savings,originalPrice:f.originalPrice,discountedPrice:f.discountedPrice,validFrom:f.validFrom,validUntil:f.validUntil,terms:f.terms,imageUrl:f.imageUrl,imageIds:f.imageIds}))}}const mt={getAllMerchants:async()=>{const t="52.3676",s="4.9041",a=new URLSearchParams({latitude:t,longitude:s});return(await ue("merchants",`?${a.toString()}`,{requireAuth:!1})).map(ss)},getMerchantById:async t=>{const s=await ue("merchants",`/${t}`,{requireAuth:!1});return ss(s)},getNearbyMerchants:async t=>{const s=new URLSearchParams({lat:t.lat,lng:t.lng,...t.radius&&{radius:t.radius}});return(await ue("merchants",`?${s.toString()}`,{requireAuth:!1})).map(ss)},getMerchantCoverImages:(t,s=5)=>(t.coverImageIds||[]).slice(0,s).map(r=>_e(r)).filter(r=>r!==null)},Ue={getLikedMerchants:()=>ue("liked-merchants"),likeMerchant:t=>ue("liked-merchants",`/${t}`,{method:"POST"}),unlikeMerchant:t=>ue("liked-merchants",`/${t}`,{method:"DELETE"})},Wt={getProfile:()=>ue("user-profile",""),updateProfile:t=>ue("user-profile","",{method:"PUT",body:t}),updatePassword:t=>ue("user-profile","/password",{method:"PUT",body:t}),deleteAccount:()=>ue("user-profile","",{method:"DELETE"})},ya={getPlans:()=>ue("subscriptions","/plans",{requireAuth:!1}),getSubscriptions:()=>ue("subscriptions","/subscriptions"),getActiveSubscription:()=>ue("subscriptions","/subscriptions/active"),createSubscription:t=>ue("subscriptions","/subscriptions",{method:"POST",body:t}),cancelSubscription:t=>ue("subscriptions",`/subscriptions/${t}`,{method:"DELETE"})},Gt={getMerchantReviews:t=>ue("reviews",`/merchant/${t}`,{requireAuth:!1}),getUserReviews:()=>ue("reviews","/user",{requireAuth:!0}),createReview:t=>ue("reviews","",{method:"POST",body:t,requireAuth:!0}),updateReview:(t,s)=>ue("reviews",`/${t}`,{method:"PUT",body:s,requireAuth:!0}),deleteReview:t=>ue("reviews",`/${t}`,{method:"DELETE",requireAuth:!0})},Ke={bookDeal:async(t,s)=>{const{data:{session:a}}=await J.auth.getSession();if(!a)throw new Error("Not authenticated");const r=`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/deals/${t}/book`,x=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${a.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"},body:JSON.stringify(s)});if(!x.ok){const o=await x.text();alert(`BOOKING ERROR:
Status: ${x.status}
Deal ID: ${t}
Error: ${o}

Check console for details!`);let m;try{m=JSON.parse(o)}catch{m={error:o}}throw new Error(m.error||o||`Failed to book deal: ${x.statusText}`)}return x.json()},getUserBookings:async()=>{const{data:{session:t}}=await J.auth.getSession();if(!t)throw new Error("Not authenticated");const s=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/bookings",{method:"GET",headers:{Authorization:`Bearer ${t.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(!s.ok){const a=await s.json().catch(()=>({}));throw new Error(a.error||`Failed to fetch bookings: ${s.statusText}`)}return s.json()},getBookingById:async t=>{const{data:{session:s}}=await J.auth.getSession();if(!s)throw new Error("Not authenticated");const a=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/bookings/${t}`,{method:"GET",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.error||`Failed to fetch booking: ${a.statusText}`)}return a.json()},cancelBooking:async t=>{const{data:{session:s}}=await J.auth.getSession();if(!s)throw new Error("Not authenticated");const a=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/bookings/${t}`,{method:"DELETE",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(!a.ok){const r=await a.json().catch(()=>({}));throw new Error(r.error||`Failed to cancel booking: ${a.statusText}`)}return a.json()}},hs={async getUserPromoCode(){return ue("user-promo-code")},async applyPromoCode(t){return ue("apply-promo-code","",{method:"POST",body:{promoCode:t}})}},It={async getBalance(){return ue("points-balance")},async getTransactions(t=50,s=0){const a=`?limit=${t}&offset=${s}`;return ue("points-transactions",a)}},Ca={getMenuItems:t=>ue("menu-items",`/${t}`)},nr=Object.freeze(Object.defineProperty({__proto__:null,apiClient:ve,authAPI:ha,bookingsEdgeAPI:Ke,connectionInvitesAPI:Je,likedMerchantsAPI:it,likedMerchantsEdgeAPI:Ue,menuItemsAPI:Ca,merchantsAPI:dt,merchantsEdgeAPI:mt,paymentMethodsAPI:De,pointsAPI:Pt,pointsEdgeAPI:It,profileAPI:fa,profileEdgeAPI:Wt,promoCodesAPI:us,promoCodesEdgeAPI:hs,promoContentAPI:ba,reviewsAPI:Ht,reviewsEdgeAPI:Gt,subscriptionsEdgeAPI:ya},Symbol.toStringTag,{value:"Module"})),xr={USE_EDGE_MERCHANTS:!0,USE_EDGE_STATIONS:!0,USE_EDGE_CATEGORIES:!0,USE_EDGE_DEALS:!0,USE_EDGE_ORDERS:!0,USE_EDGE_LIKED_MERCHANTS:!0,USE_EDGE_PROFILE:!0,USE_EDGE_SUBSCRIPTIONS:!0,USE_EDGE_REVIEWS:!0,USE_EDGE_PAYMENT_METHODS:!0,USE_EDGE_PROMO_CODES:!0,USE_EDGE_POINTS:!0};function Ae(t){return xr[t]===!0}function xt(t,s){if(s&&s.length>0&&!/\d+|straat|weg|laan|plein|singel|gracht|kade/i.test(s))return s;if(!t)return"Unknown";const a=t.split(",").map(o=>o.trim());if(a.length===1){const o=/\d{4}\s*[A-Z]{2}\s+([A-Za-z\s]+)/,m=t.match(o);return m&&m[1]?m[1].trim():"Unknown"}for(let o=0;o<a.length;o++){const m=a[o],f=/\d{4}\s*[A-Z]{2}\s+([A-Za-z\s\-']+)/i,g=m.match(f);if(g&&g[1])return g[1].trim()}if(a.length>=2){const m=a[a.length-2].trim().replace(/^\d{4}\s*[A-Z]{2}\s+/i,"").trim();if(!/^\d+|straat$|weg$|laan$|plein$|singel$|gracht$|kade$/i.test(m)&&m.length>0)return m}const r=["netherlands","nederland","holland","nl","the netherlands"],x=a.filter(o=>{const m=o.toLowerCase().trim();return m.length>0&&!r.includes(m)});return x.length>0?x[x.length-1].replace(/^\d{4}\s*[A-Z]{2}\s+/i,"").trim():"Unknown"}const wa="cities_cache",Os=5*60*1e3;let vt=null;async function As(){if(vt&&Date.now()-vt.timestamp<Os)return vt.cities;try{const s=localStorage.getItem(wa);if(s){const a=JSON.parse(s);if(Date.now()-a.timestamp<Os)return vt=a,a.cities}}catch{}const t=await lr();return or(t),t}function or(t){const s={cities:t,timestamp:Date.now()};vt=s;try{localStorage.setItem(wa,JSON.stringify(s))}catch{}}async function lr(){try{const t=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/cities",{headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co","Content-Type":"application/json"}});return t.ok?(await t.json()).cities||[]:[]}catch{return[]}}const Ns=()=>new Promise((t,s)=>{if(!navigator.geolocation){s(new Error("Geolocation is not supported by this browser"));return}navigator.geolocation.getCurrentPosition(a=>{t({latitude:a.coords.latitude,longitude:a.coords.longitude})},a=>{s(a)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})}),ir=async(t,s)=>{var a;try{const r=await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${t}&lon=${s}&zoom=10&addressdetails=1`,{headers:{"User-Agent":"PowerBankApp/1.0"}});if(!r.ok)throw new Error("Failed to fetch city data");const x=await r.json();if(x.address){const o=x.address.city||x.address.town||x.address.village||x.address.municipality||x.address.county,m=((a=x.address.country_code)==null?void 0:a.toUpperCase())||x.address.country;if(o&&m)return{city:o,country:m}}return null}catch{return null}},cr=async()=>{try{const t=await Ns();return await ir(t.latitude,t.longitude)}catch{return null}},ot=(t,s,a,r)=>{const o=(a-t)*Math.PI/180,m=(r-s)*Math.PI/180,f=Math.sin(o/2)*Math.sin(o/2)+Math.cos(t*Math.PI/180)*Math.cos(a*Math.PI/180)*Math.sin(m/2)*Math.sin(m/2);return 6371*(2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)))},va=n.createContext(void 0);function dr({children:t}){const[s,a]=n.useState(null),[r,x]=n.useState(!0),[o,m]=n.useState(null),f=n.useCallback(async()=>{x(!0),m(null);try{const p=await Ns(),c=await cr(),l={latitude:p.latitude,longitude:p.longitude,city:c==null?void 0:c.city,accuracy:p.accuracy};a(l)}catch(p){m(p instanceof Error?p.message:"Failed to get location"),a(null)}finally{x(!1)}},[]);n.useEffect(()=>{f()},[]);const g=n.useCallback(async()=>{await f()},[f]);return e.jsx(va.Provider,{value:{userLocation:s,isLoading:r,error:o,refreshLocation:g},children:t})}function Yt(){const t=n.useContext(va);if(t===void 0)throw new Error("useUserLocation must be used within a LocationProvider");return t}function mr(t,s){const a={restaurant:`<path d="M18 8h1a4 4 0 0 1 0 8h-1M2 8h16v9a4 4 0 0 1-4 4H6a4 4 0 0 1-4-4V8zM6 1v3M10 1v3M14 1v3" stroke="${s}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>`,cafe:`<path d="M17 8h1a4 4 0 1 1 0 8h-1M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4ZM6 2v2M10 2v2M14 2v2" stroke="${s}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>`,bar:`<path d="M8 2h8M9 2v6.5c0 1 .5 2 1.5 3L15 16v6M9 16v6M15 11l-6 6" stroke="${s}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>`,shop:`<circle cx="9" cy="21" r="1" fill="${s}"/><circle cx="20" cy="21" r="1" fill="${s}"/><path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6" stroke="${s}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>`,train_station:`<path d="M4 15.5C4 17.43 5.57 19 7.5 19L6 20.5v.5h12v-.5L16.5 19c1.93 0 3.5-1.57 3.5-3.5V5c0-3.5-3.58-4-8-4s-8 .5-8 4v10.5zm8 1.5c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm6-7H6V5h12v5z" fill="${s}"/>`,charging_station:`<path d="M7 2h10M7 22h10M12 2v4m0 10v6M9 6h6a2 2 0 0 1 2 2v6a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2zm1.5 4l-1 2h3l-1 2" stroke="${s}" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" fill="none"/>`};return a[t]||a.restaurant}function ur(t,s){const a=s?"#FFA374":"#828EA1",r=mr(t,a),x=`
    <svg xmlns="http://www.w3.org/2000/svg" width="48" height="64" viewBox="0 0 384 512">
      <defs/>
      <path fill="${a}" d="M384 192c0 87.4-117 243-168.3 307.2c-12.3 15.3-35.1 15.3-47.4 0C117 435 0 279.4 0 192C0 86 86 0 192 0s192 86 192 192"/>
      <circle cx="192" cy="192" r="140" fill="white"/>
      <svg x="96" y="96" width="192" height="192" viewBox="0 0 24 24">
        ${r}
      </svg>
    </svg>
  `;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(x)}function et(t,s){if(!t){const b=new Date().getHours();return b>=8&&b<22}const a=new Date,r=a.getHours(),x=a.getMinutes(),o=a.toLocaleDateString("en-US",{weekday:"long"}).toLowerCase();if(s&&!s.toLowerCase().split(",").map(E=>E.trim()).includes(o))return!1;const m=t.match(/(\d{1,2}):(\d{2})-(\d{1,2}):(\d{2})/);if(!m){const b=new Date().getHours();return b>=8&&b<22}const f=parseInt(m[1],10),g=parseInt(m[2],10),p=parseInt(m[3],10),c=parseInt(m[4],10),l=r*60+x,h=f*60+g;let u=p*60+c;return p<f&&(u+=24*60,r<12)?l<=u:l>=h&&l<u}class hr{constructor(){He(this,"cache",new Map);He(this,"maxCacheSize",50);He(this,"maxCacheAge",30*60*1e3)}async preload(s){if(this.cache.has(s))return;const a=this.fetchImage(s);this.cache.set(s,{url:s,timestamp:Date.now(),loading:a});try{const r=await a;this.cache.set(s,{url:s,blob:r,timestamp:Date.now()})}catch{this.cache.delete(s)}}async get(s){const a=this.cache.get(s);if(!a)return this.preload(s).catch(()=>{}),s;if(a.loading&&!a.blob)try{a.blob=await a.loading,delete a.loading}catch{return s}return a.blob&&Date.now()-a.timestamp<this.maxCacheAge?URL.createObjectURL(a.blob):(this.preload(s).catch(()=>{}),s)}async fetchImage(s){const a=await fetch(s,{mode:"cors",cache:"force-cache"});if(!a.ok)throw new Error(`Failed to fetch image: ${a.statusText}`);return a.blob()}async preloadBatch(s){const a=s.map(r=>this.preload(r));await Promise.allSettled(a)}cleanup(){const s=Date.now(),a=Array.from(this.cache.entries());a.forEach(([r,x])=>{s-x.timestamp>this.maxCacheAge&&(x.blob&&URL.revokeObjectURL(URL.createObjectURL(x.blob)),this.cache.delete(r))}),this.cache.size>this.maxCacheSize&&a.sort((o,m)=>o[1].timestamp-m[1].timestamp).slice(0,this.cache.size-this.maxCacheSize).forEach(([o,m])=>{m.blob&&URL.revokeObjectURL(URL.createObjectURL(m.blob)),this.cache.delete(o)})}clear(){this.cache.forEach(s=>{s.blob&&URL.revokeObjectURL(URL.createObjectURL(s.blob))}),this.cache.clear()}getStats(){return{size:this.cache.size,maxSize:this.maxCacheSize,urls:Array.from(this.cache.keys())}}}const Ba=new hr;typeof window<"u"&&setInterval(()=>{Ba.cleanup()},5*60*1e3);class fr{constructor(){He(this,"queue",[]);He(this,"loading",!1);He(this,"maxConcurrent",3);He(this,"currentLoading",0)}add(s){const a=s.map(r=>{const x=typeof r.imageId=="number"?String(r.imageId):Array.isArray(r.imageId)?r.imageId[0]:r.imageId,o=ke(x,r.type);return o?{url:o,priority:r.priority||0}:null}).filter(r=>r!==null);a.sort((r,x)=>x.priority-r.priority),this.queue.push(...a),this.processQueue()}addPriority(s,a="cover"){this.add([{imageId:s,type:a,priority:100}])}async processQueue(){if(!this.loading){for(this.loading=!0;this.queue.length>0&&this.currentLoading<this.maxConcurrent;){const s=this.queue.shift();if(!s)break;this.currentLoading++,Ba.preload(s.url).catch(a=>{}).finally(()=>{this.currentLoading--,this.processQueue()})}this.currentLoading===0&&(this.loading=!1)}}clear(){this.queue=[]}getStatus(){return{queueLength:this.queue.length,currentLoading:this.currentLoading,isLoading:this.loading}}}const gr=new fr;function jt(t,s=3){const a=[];t.slice(0,s).forEach((r,x)=>{r.coverImageIds&&r.coverImageIds.length>0&&a.push({imageId:r.coverImageIds[0],type:"cover",priority:100-x*10}),r.logoId&&a.push({imageId:r.logoId,type:"logo",priority:50-x*5})}),gr.add(a)}function pr({onComplete:t}){const[s,a]=n.useState(!0);return n.useEffect(()=>{const r=setTimeout(()=>{a(!1),setTimeout(t,300)},2500);return()=>clearTimeout(r)},[t]),e.jsxs("div",{className:`fixed inset-0 z-50 bg-[#F5D4C8] transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`,children:[e.jsxs("div",{className:"absolute inset-0 flex items-center justify-center",children:[e.jsx("div",{className:"absolute w-[500px] h-[500px] rounded-full bg-white/20 animate-pulse"}),e.jsx("div",{className:"absolute w-[400px] h-[400px] rounded-full bg-white/30 animate-pulse",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute w-[300px] h-[300px] rounded-full bg-white/40"})]}),e.jsx("div",{className:"relative z-10 h-full flex items-center justify-center",children:e.jsx("div",{className:"w-48 h-48 rounded-full bg-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-5xl font-bold text-[#FF8C61] leading-none",children:"pawa"}),e.jsx("div",{className:"text-5xl font-bold text-[#FF8C61] leading-none",children:"tasty"})]})})}),e.jsx("div",{className:"absolute bottom-[30px] left-0 right-0 z-20 flex justify-center",children:e.jsx("h2",{className:"text-xl font-semibold text-[#FF8C61] tracking-wide",children:"Adventures Made Delicious"})})]})}const ja=[{code:"NL",name:"Netherlands",dialCode:"+31",minDigits:11,maxDigits:11},{code:"US",name:"United States",dialCode:"+1",minDigits:11,maxDigits:11},{code:"CA",name:"Canada",dialCode:"+1",minDigits:11,maxDigits:11},{code:"GB",name:"United Kingdom",dialCode:"+44",minDigits:12,maxDigits:13},{code:"IT",name:"Italy",dialCode:"+39",minDigits:11,maxDigits:13},{code:"BE",name:"Belgium",dialCode:"+32",minDigits:11,maxDigits:11},{code:"FR",name:"France",dialCode:"+33",minDigits:11,maxDigits:11},{code:"DE",name:"Germany",dialCode:"+49",minDigits:11,maxDigits:13},{code:"ES",name:"Spain",dialCode:"+34",minDigits:11,maxDigits:11},{code:"PT",name:"Portugal",dialCode:"+351",minDigits:12,maxDigits:12},{code:"PL",name:"Poland",dialCode:"+48",minDigits:11,maxDigits:11},{code:"AT",name:"Austria",dialCode:"+43",minDigits:11,maxDigits:13},{code:"CH",name:"Switzerland",dialCode:"+41",minDigits:11,maxDigits:11},{code:"SE",name:"Sweden",dialCode:"+46",minDigits:11,maxDigits:12},{code:"NO",name:"Norway",dialCode:"+47",minDigits:10,maxDigits:10},{code:"DK",name:"Denmark",dialCode:"+45",minDigits:10,maxDigits:10},{code:"FI",name:"Finland",dialCode:"+358",minDigits:11,maxDigits:12},{code:"IE",name:"Ireland",dialCode:"+353",minDigits:11,maxDigits:12},{code:"GR",name:"Greece",dialCode:"+30",minDigits:12,maxDigits:12},{code:"CZ",name:"Czech Republic",dialCode:"+420",minDigits:12,maxDigits:12},{code:"HU",name:"Hungary",dialCode:"+36",minDigits:10,maxDigits:11},{code:"AU",name:"Australia",dialCode:"+61",minDigits:11,maxDigits:11},{code:"NZ",name:"New Zealand",dialCode:"+64",minDigits:10,maxDigits:11}];function Fs(t){const s=t.replace(/[\s\-()]/g,"");if(!s.startsWith("+"))return{isValid:!1,error:"Phone number must start with + followed by country code (e.g., +31 for Netherlands)"};if(!/^\+\d+$/.test(s))return{isValid:!1,error:"Phone number must contain only digits after the + sign"};if(s.length<8)return{isValid:!1,error:"Phone number is too short"};if(s.length>16)return{isValid:!1,error:"Number is too long. Please enter only your phone number without the country code"};const a=[...ja].sort((r,x)=>x.dialCode.length-r.dialCode.length);for(const r of a)if(s.startsWith(r.dialCode)){const x=s.substring(1).length;return x<r.minDigits?{isValid:!1,error:`Phone number for ${r.name} is too short (minimum ${r.minDigits} digits)`}:x>r.maxDigits?{isValid:!1,error:"Number is too long. Enter only your phone number without the country code"}:r.pattern&&!r.pattern.test(s)?{isValid:!1,error:`Invalid phone number format for ${r.name}`}:{isValid:!0,formatted:s,country:r.name,dialCode:r.dialCode}}return{isValid:!0,formatted:s,error:void 0}}function Aa(t,s){let a=s.replace(/[\s\-()]/g,"");a=a.replace(/^0+/,"");const r=a.replace(/\D/g,"");let x=t.trim();return x.startsWith("+")?x="+"+x.substring(1).replace(/\D/g,""):x="+"+x.replace(/\D/g,""),`${x}${r}`}function Us(t){const s=t.replace(/[\s\-()]/g,"");if(!s.startsWith("+"))return null;const a=[...ja].sort((x,o)=>o.dialCode.length-x.dialCode.length);for(const x of a)if(s.startsWith(x.dialCode))return{dialCode:x.dialCode,localNumber:s.substring(x.dialCode.length)};const r=s.match(/^(\+\d{1,4})(.+)$/);return r?{dialCode:r[1],localNumber:r[2]}:null}async function Er(){if(!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))return{isInstalled:!1,shouldUseNativeApp:!1};const s=/iPhone|iPad|iPod/i.test(navigator.userAgent),a=/Android/i.test(navigator.userAgent);try{const r=await br(s,a);return{isInstalled:r,shouldUseNativeApp:r&&(s||a)}}catch{return{isInstalled:!1,shouldUseNativeApp:!1}}}async function br(t,s){return new Promise(a=>{const r=setTimeout(()=>{a(!1)},2e3);if(t){const x=document.createElement("iframe");x.style.display="none",x.src="fb://",document.body.appendChild(x),setTimeout(()=>{document.body.removeChild(x),clearTimeout(r),document.hidden||document.webkitHidden?a(!0):a(!1)},1e3)}else if(s){const x=document.createElement("a");x.href="fb://page",x.style.display="none",document.body.appendChild(x);const o=Date.now();x.click(),setTimeout(()=>{const m=Date.now()-o;document.body.removeChild(x),clearTimeout(r),m<1500||document.hidden||document.webkitHidden?a(!0):a(!1)},1e3)}else clearTimeout(r),a(!1)})}function yr(t){try{const s=/iPhone|iPad|iPod/i.test(navigator.userAgent),a=/Android/i.test(navigator.userAgent);if(s)return window.location.href=t,!0;if(a){const r=`intent://authenticate#Intent;package=com.facebook.katana;scheme=https;S.browser_fallback_url=${encodeURIComponent(t)};end`;return window.location.href=r,!0}return!1}catch{return!1}}const zs=[{code:"NL",name:"Netherlands",dialCode:"+31",flag:"ðŸ‡³ðŸ‡±"},{code:"US",name:"United States",dialCode:"+1",flag:"ðŸ‡ºðŸ‡¸"},{code:"IT",name:"Italy",dialCode:"+39",flag:"ðŸ‡®ðŸ‡¹"},{code:"GB",name:"United Kingdom",dialCode:"+44",flag:"ðŸ‡¬ðŸ‡§"},{code:"BE",name:"Belgium",dialCode:"+32",flag:"ðŸ‡§ðŸ‡ª"},{code:"FR",name:"France",dialCode:"+33",flag:"ðŸ‡«ðŸ‡·"},{code:"DE",name:"Germany",dialCode:"+49",flag:"ðŸ‡©ðŸ‡ª"},{code:"ES",name:"Spain",dialCode:"+34",flag:"ðŸ‡ªðŸ‡¸"},{code:"PT",name:"Portugal",dialCode:"+351",flag:"ðŸ‡µðŸ‡¹"},{code:"PL",name:"Poland",dialCode:"+48",flag:"ðŸ‡µðŸ‡±"},{code:"AT",name:"Austria",dialCode:"+43",flag:"ðŸ‡¦ðŸ‡¹"},{code:"CH",name:"Switzerland",dialCode:"+41",flag:"ðŸ‡¨ðŸ‡­"},{code:"SE",name:"Sweden",dialCode:"+46",flag:"ðŸ‡¸ðŸ‡ª"},{code:"NO",name:"Norway",dialCode:"+47",flag:"ðŸ‡³ðŸ‡´"},{code:"DK",name:"Denmark",dialCode:"+45",flag:"ðŸ‡©ðŸ‡°"},{code:"FI",name:"Finland",dialCode:"+358",flag:"ðŸ‡«ðŸ‡®"},{code:"IE",name:"Ireland",dialCode:"+353",flag:"ðŸ‡®ðŸ‡ª"},{code:"GR",name:"Greece",dialCode:"+30",flag:"ðŸ‡¬ðŸ‡·"},{code:"CZ",name:"Czech Republic",dialCode:"+420",flag:"ðŸ‡¨ðŸ‡¿"},{code:"HU",name:"Hungary",dialCode:"+36",flag:"ðŸ‡­ðŸ‡º"},{code:"CA",name:"Canada",dialCode:"+1",flag:"ðŸ‡¨ðŸ‡¦"},{code:"AU",name:"Australia",dialCode:"+61",flag:"ðŸ‡¦ðŸ‡º"},{code:"NZ",name:"New Zealand",dialCode:"+64",flag:"ðŸ‡³ðŸ‡¿"},{code:"LU",name:"Luxembourg",dialCode:"+352",flag:"ðŸ‡±ðŸ‡º"},{code:"IS",name:"Iceland",dialCode:"+354",flag:"ðŸ‡®ðŸ‡¸"},{code:"MT",name:"Malta",dialCode:"+356",flag:"ðŸ‡²ðŸ‡¹"},{code:"CY",name:"Cyprus",dialCode:"+357",flag:"ðŸ‡¨ðŸ‡¾"},{code:"LI",name:"Liechtenstein",dialCode:"+423",flag:"ðŸ‡±ðŸ‡®"},{code:"MC",name:"Monaco",dialCode:"+377",flag:"ðŸ‡²ðŸ‡¨"},{code:"SM",name:"San Marino",dialCode:"+378",flag:"ðŸ‡¸ðŸ‡²"},{code:"VA",name:"Vatican City",dialCode:"+379",flag:"ðŸ‡»ðŸ‡¦"},{code:"AD",name:"Andorra",dialCode:"+376",flag:"ðŸ‡¦ðŸ‡©"}];function Cr({onLogin:t,onOTPRequired:s}){const[a,r]=n.useState(""),[x,o]=n.useState(zs[0]),[m,f]=n.useState(!1),[g,p]=n.useState(""),[c,l]=n.useState(!1),[h,u]=n.useState(null),[b,E]=n.useState(null),[B,j]=n.useState(!0),[v,y]=n.useState(!1),d=zs.filter(w=>w.name.toLowerCase().includes(g.toLowerCase())||w.dialCode.includes(g)||w.code.toLowerCase().includes(g.toLowerCase())),i=async()=>{if(!B){u("Please agree to the Terms & Privacy Policy to continue");return}l(!0),u(null);try{const F=typeof window.ReactNativeWebView<"u"?"pawatasty://auth/callback":window.location.origin,{data:N,error:k}=await J.auth.signInWithOAuth({provider:"google",options:{redirectTo:F,skipBrowserRedirect:!1,queryParams:{access_type:"offline",prompt:"consent"}}});k&&(k.message.includes("not enabled")||k.message.includes("not configured")?u("Google sign-in is not configured yet. Please use phone sign-in or contact support."):u(k.message),l(!1))}catch{u("Failed to sign in with Google. Please try again."),l(!1)}},C=async()=>{if(!B){u("Please agree to the Terms & Privacy Policy to continue");return}l(!0),u(null);try{const F=typeof window.ReactNativeWebView<"u"?"pawatasty://auth/callback":window.location.origin,N=await Er(),{data:k,error:P}=await J.auth.signInWithOAuth({provider:"facebook",options:{redirectTo:F,skipBrowserRedirect:N.shouldUseNativeApp,scopes:"email,public_profile"}});if(P){P.message.includes("not enabled")||P.message.includes("not configured")||P.message.includes("not found")?u("Facebook sign-in is not configured. Please enable it in Supabase Dashboard â†’ Authentication â†’ Providers â†’ Facebook, or use phone sign-in instead."):P.message.includes("redirect")?u("Redirect configuration error. Please contact support."):u(`Facebook sign-in error: ${P.message}`),l(!1);return}k!=null&&k.url?N.shouldUseNativeApp&&N.isInstalled&&yr(k.url)?setTimeout(()=>{document.hidden||document.webkitHidden||(window.location.href=k.url)},1500):window.location.href=k.url:(u("Failed to initiate Facebook login"),l(!1))}catch{u("Failed to sign in with Facebook. Please try again or use phone sign-in."),l(!1)}},A=async w=>{if(w.preventDefault(),!a||a.length<5){u("Please enter a valid phone number");return}l(!0),u(null);try{const F=Aa(x.dialCode,a),N=Fs(F);if(!N.isValid){u(N.error||"Invalid phone number format"),l(!1);return}const k=N.formatted||F,{data:P,error:L}=await J.auth.signInWithOtp({phone:k,options:{channel:"sms"}});L?L.message.includes("rate limit")||L.message.includes("too many")?u("Too many SMS requests. Please wait a few minutes and try again."):L.message.includes("SMS")||L.message.includes("provider")?u("SMS service temporarily unavailable. Please try again in a few moments."):u(L.message||"Failed to send verification code"):s?s(k):E("Verification code sent! Please check your phone.")}catch{u("Failed to send verification code")}finally{l(!1)}};return e.jsxs("div",{className:"fixed inset-0 bg-white flex items-center justify-center overflow-hidden",children:[e.jsxs("div",{className:"w-full max-w-md px-5 pb-[20px] -mt-12",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ‘‹"}),e.jsx("h1",{className:"text-4xl font-bold text-orange-400 mb-2",children:"Hi welcome"}),e.jsx("p",{className:"text-gray-600",children:"Join Pawa with your account"})]}),e.jsxs("div",{className:"space-y-3 mb-6",children:[e.jsxs("button",{type:"button",onClick:i,disabled:c,className:"w-full bg-white border border-gray-200 rounded-2xl p-4 flex items-center justify-center space-x-3 hover:bg-gray-50 transition-colors disabled:opacity-50 shadow-sm",children:[e.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[e.jsx("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),e.jsx("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),e.jsx("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),e.jsx("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Sign-in with Google"})]}),e.jsxs("button",{type:"button",onClick:C,disabled:c,className:"w-full bg-white border border-gray-200 rounded-2xl p-4 flex items-center justify-center space-x-3 hover:bg-gray-50 transition-colors disabled:opacity-50 shadow-sm",children:[e.jsx("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",fill:"#1877F2",children:e.jsx("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),e.jsx("span",{className:"text-gray-700 font-medium",children:"Sign-in with Facebook"})]})]}),e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx("div",{className:"flex-1 border-t border-gray-300"}),e.jsx("span",{className:"px-4 text-gray-600 text-sm font-medium",children:"Or sign in with"}),e.jsx("div",{className:"flex-1 border-t border-gray-300"})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4 mb-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"relative",children:e.jsxs("button",{type:"button",onClick:()=>{f(!0),p("")},className:"bg-white rounded-xl px-3 py-3.5 shadow-sm border border-gray-200 flex items-center gap-2 hover:bg-gray-50 transition-colors min-w-[80px]",children:[e.jsx("span",{className:"text-base font-medium text-gray-700",children:x.code}),e.jsx(Ut,{className:"w-4 h-4 text-gray-600"})]})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl shadow-sm border border-gray-200 relative overflow-hidden",children:[e.jsxs("div",{className:"flex items-center pl-4 pr-0 py-3.5",children:[e.jsx("span",{className:"text-gray-500 font-medium mr-1.5 flex-shrink-0",children:x.dialCode}),e.jsx("input",{type:"tel",placeholder:"612345678",value:a,onChange:w=>{let F=w.target.value.replace(/\D/g,"");F=F.replace(/^0+/,"");const N=x.dialCode.substring(1);if(F.startsWith(N)){const k=F.substring(N.length);k.length>=8&&k.length<=9&&(F=k)}F.length<=9&&r(F)},maxLength:9,className:"flex-1 outline-none text-gray-800 text-base font-medium pr-9"})]}),a&&a.length>=8&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-green-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})})]})]}),h&&e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-600 text-sm flex items-start gap-2",children:[e.jsx(Ie,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:h})]}),b&&e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3 text-green-600 text-sm flex items-center space-x-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),e.jsx("span",{children:b})]}),e.jsx("button",{type:"submit",disabled:c||!a||!B,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-2xl font-semibold hover:from-orange-500 hover:to-orange-600 transition-all disabled:opacity-50",children:c?"Sending code...":"Continue with mobile"})]}),e.jsx("div",{className:"fixed bottom-5 left-0 right-0 px-5",children:e.jsxs("div",{className:"w-full max-w-md mx-auto flex items-center justify-center gap-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["I agree to the"," ",e.jsx("span",{className:"text-orange-400 font-medium cursor-pointer hover:underline",onClick:w=>{w.stopPropagation(),window.open("https://pawatasty.com/terms-conditions/","_blank")},children:"Terms"})," ","&"," ",e.jsx("span",{className:"text-orange-400 font-medium cursor-pointer hover:underline",onClick:w=>{w.stopPropagation(),window.open("https://pawatasty.com/privacy-policy/","_blank")},children:"Privacy Policy"})]}),e.jsx("button",{type:"button",onClick:()=>{B?y(!0):j(!0)},className:`w-12 h-7 rounded-full transition-colors relative flex-shrink-0 ${B?"bg-orange-400":"bg-gray-300"}`,children:e.jsx("div",{className:`w-5 h-5 rounded-full bg-white absolute top-1 transition-transform ${B?"translate-x-6":"translate-x-1"}`})})]})})]}),m&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:()=>f(!1),children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md pb-6",style:{transform:"translateY(0px)",transition:"transform 0.3s ease-out"},onClick:w=>w.stopPropagation(),children:[e.jsx("div",{className:"flex items-center justify-center pt-3 pb-4 cursor-grab active:cursor-grabbing",children:e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),e.jsxs("div",{className:"px-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_t,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search",className:"w-full pl-10 pr-4 py-3 bg-gray-100 rounded-2xl outline-none text-gray-700",value:g,onChange:w=>p(w.target.value)})]}),e.jsx("button",{onClick:()=>f(!1),className:"ml-3 text-gray-600 font-medium",children:"Cancel"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:d.map(w=>e.jsxs("button",{onClick:()=>{o(w),f(!1),p("")},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 rounded-2xl transition-colors text-left",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl leading-none",role:"img","aria-label":w.name,children:w.flag}),e.jsx("span",{className:"text-gray-700 font-medium",children:w.dialCode}),e.jsx("span",{className:"text-gray-600",children:w.name})]}),x.code===w.code&&e.jsx(Qe,{className:"w-5 h-5 text-orange-400"})]},w.code))})]})]})}),v&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:()=>y(!1),children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full animate-slideUp",onClick:w=>w.stopPropagation(),children:[e.jsx("div",{className:"pt-3 pb-2",children:e.jsx("div",{onClick:()=>y(!1),className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto cursor-pointer active:cursor-grabbing"})}),e.jsxs("div",{className:"px-8 py-8 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Terms & Privacy"}),e.jsx("p",{className:"text-center text-gray-700 text-base leading-relaxed mb-8 px-2",children:"Our policy explains how we collect, handle, and process your data. By continuing, you agree to it."}),e.jsx("button",{onClick:()=>y(!1),className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all",children:"I Understand"})]})]})})]})}function wr({isOpen:t,onClose:s}){return t?e.jsxs("div",{className:"fixed inset-0 z-50",children:[e.jsx("div",{className:"absolute inset-0 bg-black/50 backdrop-blur-sm",onClick:s}),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl p-6 pb-8 transform transition-transform duration-300 ease-out ${t?"translate-y-0":"translate-y-full"}`,children:[e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full mx-auto mb-6"}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-5xl",children:"ðŸ˜•"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Oops!"}),e.jsx("p",{className:"text-gray-600 text-base",children:"Your code is invalid or has expired."})]}),e.jsx("button",{onClick:s,className:"w-full bg-orange-400 text-white py-4 rounded-xl font-semibold hover:bg-orange-500 transition-colors text-lg",children:"Try Again"})]})]}):null}function Ds({value:t,onChange:s,disabled:a=!1,autoFocus:r=!1}){const x=n.useRef([]);n.useEffect(()=>{var g;r&&((g=x.current[0])==null||g.focus())},[r]);const o=(g,p)=>{var l;if(!/^\d*$/.test(p))return;p.length>1&&(p=p[0]);const c=[...t];c[g]=p,s(c),p&&g<5&&((l=x.current[g+1])==null||l.focus())},m=(g,p)=>{var c;p.key==="Backspace"&&!t[g]&&g>0&&((c=x.current[g-1])==null||c.focus())},f=g=>{var c;g.preventDefault();const p=g.clipboardData.getData("text/plain").replace(/\D/g,"");if(p.length===6){const l=p.split("");s(l),(c=x.current[5])==null||c.focus()}};return e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[t.slice(0,3).map((g,p)=>e.jsx("input",{ref:c=>x.current[p]=c,type:"text",inputMode:"numeric",maxLength:1,value:g,onChange:c=>o(p,c.target.value),onKeyDown:c=>m(p,c),onPaste:f,disabled:a,className:"w-10 h-12 text-center text-2xl font-semibold bg-transparent border-0 border-b-2 border-gray-300 focus:border-orange-400 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{caretColor:"transparent"}},p)),e.jsx("span",{className:"text-2xl font-bold text-gray-400 px-2",children:"â€“"}),t.slice(3,6).map((g,p)=>e.jsx("input",{ref:c=>x.current[p+3]=c,type:"text",inputMode:"numeric",maxLength:1,value:g,onChange:c=>o(p+3,c.target.value),onKeyDown:c=>m(p+3,c),onPaste:f,disabled:a,className:"w-10 h-12 text-center text-2xl font-semibold bg-transparent border-0 border-b-2 border-gray-300 focus:border-orange-400 focus:outline-none disabled:opacity-50 disabled:cursor-not-allowed transition-colors",style:{caretColor:"transparent"}},p+3))]})}function vr({phoneNumber:t,onVerified:s,onBack:a}){const[r,x]=n.useState(["","","","","",""]),[o,m]=n.useState(!1),[f,g]=n.useState(!1),[p,c]=n.useState(180);n.useEffect(()=>{if(p>0){const B=setTimeout(()=>c(p-1),1e3);return()=>clearTimeout(B)}},[p]);const l=B=>{const j=Math.floor(B/60),v=B%60;return`${j.toString().padStart(2,"0")}:${v.toString().padStart(2,"0")}`},h=B=>{x(B),B.every(j=>j!=="")&&B.length===6&&u(B.join(""))},u=async B=>{m(!0);try{const{data:j,error:v}=await J.auth.verifyOtp({phone:t,token:B,type:"sms"});if(v||!j.session)g(!0),x(["","","","","",""]);else{if(j.session&&j.user){const{data:y}=await J.from("users").select("id, user_id, email, phone_nr, full_name, profile_completed").eq("phone_nr",t).maybeSingle();if(!y){const d=t.replace(/[^0-9]/g,"")+"@phone.pawatasty.com",{data:i,error:C}=await J.from("users").insert({user_id:j.user.id,phone_nr:t,email:d,profile_completed:!1}).select().single()}}s()}}catch{g(!0),x(["","","","","",""])}finally{m(!1)}},b=async()=>{m(!0);try{const{error:B}=await J.auth.signInWithOtp({phone:t,options:{channel:"sms"}});B?g(!0):(c(180),x(["","","","","",""]))}catch{g(!0)}finally{m(!1)}},E=B=>{const j=B.replace(/\D/g,"");if(j.length<=3)return B;const v=j.slice(0,j.length-9),y=j.slice(-9),d=y.slice(0,-2).replace(/\d/g,"*"),i=y.slice(-2);return`+${v} ${d}${i}`};return e.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col",children:[e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-md mx-auto px-5 py-6",children:[e.jsx("button",{onClick:a,className:"mb-6 p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(m0,{className:"w-6 h-6 text-gray-700"})}),e.jsx("div",{className:"mb-8",children:e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"OTP Verification"})}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(Ds,{value:r,onChange:h,disabled:o,autoFocus:!0})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("p",{className:"text-gray-600 mb-1",children:"Enter the verification code sent to:"}),e.jsx("p",{className:"text-orange-400 font-semibold",children:E(t)})]}),e.jsx("div",{className:"text-center mb-8",children:e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l(p)})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-gray-600 mb-2",children:"Don't get the code?"}),e.jsx("button",{onClick:b,disabled:o||p>0,className:"text-orange-400 font-semibold hover:text-orange-500 disabled:text-gray-400 disabled:cursor-not-allowed",children:"Resend"})]})]}),o&&e.jsx("div",{className:"text-center text-gray-600",children:e.jsx("p",{children:"Verifying..."})})]})}),e.jsx(wr,{isOpen:f,onClose:()=>g(!1)})]})}function Na({onDiscoverClick:t,onMapClick:s,onBookingsClick:a,activeView:r="map",unreadInvitesCount:x=0}){return e.jsx("div",{className:"absolute bottom-5 left-0 right-0 px-4 z-30",children:e.jsxs("div",{className:"bg-white rounded-full shadow-2xl px-5 py-2.5 flex justify-between items-center max-w-md mx-auto",children:[e.jsx("button",{onClick:t,className:"p-3 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Discover",children:e.jsx("svg",{width:"29",height:"29",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fill:r==="discover"?"#1E293B":"#64748B",d:"M12 13q-.425 0-.713-.288T11 12q0-.425.288-.713T12 11q.425 0 .713.288T13 12q0 .425-.288.713T12 13Zm0 9q-2.075 0-3.9-.788t-3.175-2.137q-1.35-1.35-2.137-3.175T2 12q0-2.075.788-3.9t2.137-3.175q1.35-1.35 3.175-2.137T12 2q2.075 0 3.9.788t3.175 2.137q1.35 1.35 2.138 3.175T22 12q0 2.075-.788 3.9t-2.137 3.175q-1.35 1.35-3.175 2.138T12 22Zm0-2q3.35 0 5.675-2.325T20 12q0-3.35-2.325-5.675T12 4Q8.65 4 6.325 6.325T4 12q0 3.35 2.325 5.675T12 20Zm0-8Zm-4.575 5.075l6.25-2.925q.15-.075.275-.2t.2-.275l2.925-6.25q.125-.25-.063-.438t-.437-.062l-6.25 2.925q-.15.075-.275.2t-.2.275l-2.925 6.25q-.125.25.063.438t.437.062Z"})})}),e.jsx("button",{onClick:s,className:"p-3 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Map",children:e.jsx("svg",{width:"29",height:"29",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"m3 6l6-3l6 3l6-3v15l-6 3l-6-3l-6 3zm6-3v15m6-12v15",stroke:r==="map"?"#1E293B":"#64748B",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),e.jsxs("button",{onClick:a,className:"p-3 hover:bg-gray-100 rounded-full transition-colors relative","aria-label":"Bookings",children:[e.jsx("svg",{width:"23",height:"25",viewBox:"0 0 23 25",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M1.29886 1.95375C1.15163 1.78184 1.05677 1.57133 1.02552 1.34716C0.994275 1.12299 1.02795 0.894566 1.12256 0.68895C1.21716 0.483334 1.36873 0.30915 1.5593 0.187043C1.74988 0.0649357 1.97146 2.36632e-05 2.1978 0H16.8222C17.5148 -1.03206e-08 18.2006 0.136418 18.8405 0.401465C19.4804 0.666511 20.0618 1.055 20.5515 1.54474C21.0413 2.03448 21.4298 2.61589 21.6948 3.25577C21.9599 3.89565 22.0963 4.58147 22.0963 5.27407C22.0963 5.96667 21.9599 6.65249 21.6948 7.29237C21.4298 7.93225 21.0413 8.51366 20.5515 9.0034C20.0618 9.49314 19.4804 9.88163 18.8405 10.1467C18.2006 10.4117 17.5148 10.5481 16.8222 10.5481H2.1978C1.97146 10.5481 1.74988 10.4832 1.5593 10.3611C1.36873 10.239 1.21716 10.0648 1.12256 9.85919C1.02795 9.65357 0.994275 9.42514 1.02552 9.20097C1.05677 8.9768 1.15163 8.76629 1.29886 8.59439L2.18256 7.56302C2.72886 6.92574 3.02915 6.11404 3.02915 5.27466C3.02915 4.43527 2.72886 3.62357 2.18256 2.9863L1.29886 1.95375ZM4.58871 2.34403C5.10258 3.23503 5.37309 4.24551 5.37309 5.27407C5.37309 6.30263 5.10258 7.31311 4.58871 8.20411H16.8222C17.5993 8.20411 18.3446 7.89541 18.8941 7.34592C19.4435 6.79643 19.7522 6.05116 19.7522 5.27407C19.7522 4.49697 19.4435 3.75171 18.8941 3.20222C18.3446 2.65273 17.5993 2.34403 16.8222 2.34403H4.58871ZM1 16.9942C1 15.5955 1.55566 14.254 2.54474 13.2649C3.53382 12.2758 4.8753 11.7202 6.27407 11.7202H20.8985C21.1248 11.7202 21.3464 11.7851 21.537 11.9072C21.7275 12.0293 21.8791 12.2035 21.9737 12.4091C22.0683 12.6147 22.102 12.8432 22.0708 13.0673C22.0395 13.2915 21.9446 13.502 21.7974 13.6739L20.9125 14.7053C20.3662 15.3426 20.0659 16.1543 20.0659 16.9936C20.0659 17.833 20.3662 18.6447 20.9125 19.282L21.7974 20.3134C21.945 20.4853 22.0402 20.6959 22.0716 20.9202C22.1031 21.1446 22.0695 21.3733 21.9748 21.5791C21.8802 21.7849 21.7285 21.9593 21.5377 22.0814C21.3469 22.2036 21.125 22.2685 20.8985 22.2683H6.27407C4.8753 22.2683 3.53382 21.7126 2.54474 20.7236C1.55566 19.7345 1 18.393 1 16.9942ZM6.27407 14.0642C5.49697 14.0642 4.75171 14.3729 4.20222 14.9224C3.65273 15.4719 3.34403 16.2171 3.34403 16.9942C3.34403 17.7713 3.65273 18.5166 4.20222 19.0661C4.75171 19.6156 5.49697 19.9243 6.27407 19.9243H18.5076C17.9937 19.0333 17.7232 18.0228 17.7232 16.9942C17.7232 15.9657 17.9937 14.9552 18.5076 14.0642H6.27407Z",fill:r==="bookings"?"#1E293B":"#64748B"})}),x>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-semibold",children:x})]})]})})}const Fa=n.createContext(void 0),qe=()=>{const t=n.useContext(Fa);if(!t)throw new Error("useToast must be used within ToastProvider");return t},Br=({children:t})=>{const[s,a]=n.useState([]),r=n.useCallback(f=>{a(g=>g.filter(p=>p.id!==f))},[]),x=n.useCallback(f=>{const g=Math.random().toString(36).substring(7),p={id:g,type:"success",message:f};a(c=>[...c,p]),setTimeout(()=>{r(g)},3e3)},[r]),o=n.useCallback(f=>{const g=Math.random().toString(36).substring(7),p={id:g,type:"error",message:f};a(c=>[...c,p]),setTimeout(()=>{r(g)},3e3)},[r]),m=n.useCallback((f,g)=>{g==="success"?x(f):o(f)},[x,o]);return e.jsxs(Fa.Provider,{value:{showSuccess:x,showError:o,showToast:m},children:[t,e.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[100] flex flex-col gap-2 pointer-events-none w-full max-w-[90%] sm:max-w-md px-4",children:s.map(f=>e.jsxs("div",{className:`pointer-events-auto flex items-start gap-3 p-4 rounded-2xl shadow-2xl backdrop-blur-sm animate-toast-slide-down w-full ${f.type==="success"?"bg-green-50/95 border-2 border-green-200":"bg-red-50/95 border-2 border-red-200"}`,children:[f.type==="success"?e.jsx(ys,{className:"w-6 h-6 text-green-600 flex-shrink-0 mt-0.5"}):e.jsx(Cs,{className:"w-6 h-6 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:`flex-1 font-medium ${f.type==="success"?"text-green-900":"text-red-900"}`,children:f.message}),e.jsx("button",{onClick:()=>r(f.id),className:`p-1 rounded-full transition-colors ${f.type==="success"?"hover:bg-green-100":"hover:bg-red-100"}`,children:e.jsx(we,{className:`w-4 h-4 ${f.type==="success"?"text-green-600":"text-red-600"}`})})]},f.id))})]})};async function jr(t,s){try{const{data:a,error:r}=await J.from("station_items").select("station_id, pb_available").like("station_id",`%${t}`);if(r||!a||a.length===0)return{isValid:!1,error:"STATION_NOT_FOUND"};const x=a[0],o=x.pb_available||0;if(o===0)return{isValid:!1,error:"NO_POWERBANKS",stationId:x.station_id,availablePowerbanks:0};const{data:m}=await J.from("rentals").select("id").eq("user_id",s).eq("status","active").maybeSingle();if(m)return{isValid:!1,error:"ACTIVE_RENTAL",stationId:x.station_id,availablePowerbanks:o};const{data:f}=await J.from("user_memberships").select("id, membership_tier, subscription_status, free_rental_used_today").eq("user_id",s).maybeSingle();return f&&f.subscription_status==="active"&&(f.membership_tier==="silver"||f.membership_tier==="gold")?f.free_rental_used_today?{isValid:!0,error:"DAILY_LIMIT_EXCEEDED",stationId:x.station_id,availablePowerbanks:o,hasActiveSubscription:!0,dailyLimitUsed:!0,canProceedWithCharge:!0}:{isValid:!0,stationId:x.station_id,availablePowerbanks:o,hasActiveSubscription:!0,dailyLimitUsed:!1}:{isValid:!0,stationId:x.station_id,availablePowerbanks:o,hasActiveSubscription:!1}}catch{return{isValid:!1,error:"STATION_NOT_FOUND"}}}var Da={exports:{}},Ar="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Nr=Ar,Fr=Nr;function ka(){}function Sa(){}Sa.resetWarningCache=ka;var Dr=function(){function t(r,x,o,m,f,g){if(g!==Fr){var p=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw p.name="Invariant Violation",p}}t.isRequired=t;function s(){return t}var a={array:t,bigint:t,bool:t,func:t,number:t,object:t,string:t,symbol:t,any:t,arrayOf:s,element:t,elementType:t,instanceOf:s,node:t,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:Sa,resetWarningCache:ka};return a.PropTypes=a,a};Da.exports=Dr();var kr=Da.exports;const be=sa(kr);function $s(t,s){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);s&&(r=r.filter(function(x){return Object.getOwnPropertyDescriptor(t,x).enumerable})),a.push.apply(a,r)}return a}function qs(t){for(var s=1;s<arguments.length;s++){var a=arguments[s]!=null?arguments[s]:{};s%2?$s(Object(a),!0).forEach(function(r){Pa(t,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):$s(Object(a)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(a,r))})}return t}function Mt(t){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Mt=function(s){return typeof s}:Mt=function(s){return s&&typeof Symbol=="function"&&s.constructor===Symbol&&s!==Symbol.prototype?"symbol":typeof s},Mt(t)}function Pa(t,s,a){return s in t?Object.defineProperty(t,s,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[s]=a,t}function Sr(t,s){if(t==null)return{};var a={},r=Object.keys(t),x,o;for(o=0;o<r.length;o++)x=r[o],!(s.indexOf(x)>=0)&&(a[x]=t[x]);return a}function Pr(t,s){if(t==null)return{};var a=Sr(t,s),r,x;if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(x=0;x<o.length;x++)r=o[x],!(s.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(a[r]=t[r])}return a}function Ia(t,s){return Ir(t)||Mr(t,s)||Tr(t,s)||_r()}function Ir(t){if(Array.isArray(t))return t}function Mr(t,s){var a=t&&(typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"]);if(a!=null){var r=[],x=!0,o=!1,m,f;try{for(a=a.call(t);!(x=(m=a.next()).done)&&(r.push(m.value),!(s&&r.length===s));x=!0);}catch(g){o=!0,f=g}finally{try{!x&&a.return!=null&&a.return()}finally{if(o)throw f}}return r}}function Tr(t,s){if(t){if(typeof t=="string")return Hs(t,s);var a=Object.prototype.toString.call(t).slice(8,-1);if(a==="Object"&&t.constructor&&(a=t.constructor.name),a==="Map"||a==="Set")return Array.from(t);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return Hs(t,s)}}function Hs(t,s){(s==null||s>t.length)&&(s=t.length);for(var a=0,r=new Array(s);a<s;a++)r[a]=t[a];return r}function _r(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var Te=function(s,a,r){var x=!!r,o=he.useRef(r);he.useEffect(function(){o.current=r},[r]),he.useEffect(function(){if(!x||!s)return function(){};var m=function(){o.current&&o.current.apply(o,arguments)};return s.on(a,m),function(){s.off(a,m)}},[x,a,s,o])},fs=function(s){var a=he.useRef(s);return he.useEffect(function(){a.current=s},[s]),a.current},ft=function(s){return s!==null&&Mt(s)==="object"},Lr=function(s){return ft(s)&&typeof s.then=="function"},Rr=function(s){return ft(s)&&typeof s.elements=="function"&&typeof s.createToken=="function"&&typeof s.createPaymentMethod=="function"&&typeof s.confirmCardPayment=="function"},Ws="[object Object]",Or=function t(s,a){if(!ft(s)||!ft(a))return s===a;var r=Array.isArray(s),x=Array.isArray(a);if(r!==x)return!1;var o=Object.prototype.toString.call(s)===Ws,m=Object.prototype.toString.call(a)===Ws;if(o!==m)return!1;if(!o&&!r)return s===a;var f=Object.keys(s),g=Object.keys(a);if(f.length!==g.length)return!1;for(var p={},c=0;c<f.length;c+=1)p[f[c]]=!0;for(var l=0;l<g.length;l+=1)p[g[l]]=!0;var h=Object.keys(p);if(h.length!==f.length)return!1;var u=s,b=a,E=function(j){return t(u[j],b[j])};return h.every(E)},Ma=function(s,a,r){return ft(s)?Object.keys(s).reduce(function(x,o){var m=!ft(a)||!Or(s[o],a[o]);return r.includes(o)||!m?x:qs(qs({},x||{}),{},Pa({},o,s[o]))},null):null},Ta="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",Gs=function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ta;if(s===null||Rr(s))return s;throw new Error(a)},Ur=function(s){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ta;if(Lr(s))return{tag:"async",stripePromise:Promise.resolve(s).then(function(x){return Gs(x,a)})};var r=Gs(s,a);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},zr=function(s){!s||!s._registerWrapper||!s.registerAppInfo||(s._registerWrapper({name:"react-stripe-js",version:"5.4.1"}),s.registerAppInfo({name:"react-stripe-js",version:"5.4.1",url:"https://stripe.com/docs/stripe-js/react"}))},Vt=he.createContext(null);Vt.displayName="ElementsContext";var _a=function(s,a){if(!s)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(a," in an <Elements> provider."));return s},Ye=function(s){var a=s.stripe,r=s.options,x=s.children,o=he.useMemo(function(){return Ur(a)},[a]),m=he.useState(function(){return{stripe:o.tag==="sync"?o.stripe:null,elements:o.tag==="sync"?o.stripe.elements(r):null}}),f=Ia(m,2),g=f[0],p=f[1];he.useEffect(function(){var h=!0,u=function(E){p(function(B){return B.stripe?B:{stripe:E,elements:E.elements(r)}})};return o.tag==="async"&&!g.stripe?o.stripePromise.then(function(b){b&&h&&u(b)}):o.tag==="sync"&&!g.stripe&&u(o.stripe),function(){h=!1}},[o,g,r]);var c=fs(a);he.useEffect(function(){},[c,a]);var l=fs(r);return he.useEffect(function(){if(g.elements){var h=Ma(r,l,["clientSecret","fonts"]);h&&g.elements.update(h)}},[r,l,g.elements]),he.useEffect(function(){zr(g.stripe)},[g.stripe]),he.createElement(Vt.Provider,{value:g},x)};Ye.propTypes={stripe:be.any,options:be.object};var $r=function(s){var a=he.useContext(Vt);return _a(a,s)},Jt=function(){var s=$r("calls useElements()"),a=s.elements;return a};be.func.isRequired;var La=he.createContext(null);La.displayName="CheckoutContext";be.any,be.shape({clientSecret:be.oneOfType([be.string,be.instanceOf(Promise)]).isRequired,elementsOptions:be.object}).isRequired;var gs=function(s){var a=he.useContext(La),r=he.useContext(Vt);if(a){if(r)throw new Error("You cannot wrap the part of your app that ".concat(s," in both <CheckoutProvider> and <Elements> providers."));return a}else return _a(r,s)},qr=["mode"],Hr=function(s){return s.charAt(0).toUpperCase()+s.slice(1)},ze=function(s,a){var r="".concat(Hr(s),"Element"),x=function(g){var p=g.id,c=g.className,l=g.options,h=l===void 0?{}:l,u=g.onBlur,b=g.onFocus,E=g.onReady,B=g.onChange,j=g.onEscape,v=g.onClick,y=g.onLoadError,d=g.onLoaderStart,i=g.onNetworksChange,C=g.onConfirm,A=g.onCancel,w=g.onShippingAddressChange,F=g.onShippingRateChange,N=g.onSavedPaymentMethodRemove,k=g.onSavedPaymentMethodUpdate,P=gs("mounts <".concat(r,">")),L="elements"in P?P.elements:null,$="checkoutState"in P?P.checkoutState:null,U=($==null?void 0:$.type)==="success"||($==null?void 0:$.type)==="loading"?$.sdk:null,S=he.useState(null),I=Ia(S,2),M=I[0],H=I[1],T=he.useRef(null),D=he.useRef(null);Te(M,"blur",u),Te(M,"focus",b),Te(M,"escape",j),Te(M,"click",v),Te(M,"loaderror",y),Te(M,"loaderstart",d),Te(M,"networkschange",i),Te(M,"confirm",C),Te(M,"cancel",A),Te(M,"shippingaddresschange",w),Te(M,"shippingratechange",F),Te(M,"savedpaymentmethodremove",N),Te(M,"savedpaymentmethodupdate",k),Te(M,"change",B);var R;E&&(s==="expressCheckout"?R=E:R=function(){E(M)}),Te(M,"ready",R),he.useLayoutEffect(function(){if(T.current===null&&D.current!==null&&(L||U)){var O=null;if(U)switch(s){case"paymentForm":O=U.createPaymentFormElement();break;case"payment":O=U.createPaymentElement(h);break;case"address":if("mode"in h){var V=h.mode,q=Pr(h,qr);if(V==="shipping")O=U.createShippingAddressElement(q);else if(V==="billing")O=U.createBillingAddressElement(q);else throw new Error("Invalid options.mode. mode must be 'billing' or 'shipping'.")}else throw new Error("You must supply options.mode. mode must be 'billing' or 'shipping'.");break;case"expressCheckout":O=U.createExpressCheckoutElement(h);break;case"currencySelector":O=U.createCurrencySelectorElement();break;case"taxId":O=U.createTaxIdElement(h);break;default:throw new Error("Invalid Element type ".concat(r,". You must use either the <PaymentElement />, <AddressElement options={{mode: 'shipping'}} />, <AddressElement options={{mode: 'billing'}} />, or <ExpressCheckoutElement />."))}else L&&(O=L.create(s,h));T.current=O,H(O),O&&O.mount(D.current)}},[L,U,h]);var Z=fs(h);return he.useEffect(function(){if(T.current){var O=Ma(h,Z,["paymentRequest"]);O&&"update"in T.current&&T.current.update(O)}},[h,Z]),he.useLayoutEffect(function(){return function(){if(T.current&&typeof T.current.destroy=="function")try{T.current.destroy(),T.current=null}catch{}}},[]),he.createElement("div",{id:p,className:c,ref:D})},o=function(g){gs("mounts <".concat(r,">"));var p=g.id,c=g.className;return he.createElement("div",{id:p,className:c})},m=a?o:x;return m.propTypes={id:be.string,className:be.string,onChange:be.func,onBlur:be.func,onFocus:be.func,onReady:be.func,onEscape:be.func,onClick:be.func,onLoadError:be.func,onLoaderStart:be.func,onNetworksChange:be.func,onConfirm:be.func,onCancel:be.func,onShippingAddressChange:be.func,onShippingRateChange:be.func,onSavedPaymentMethodRemove:be.func,onSavedPaymentMethodUpdate:be.func,options:be.object},m.displayName=r,m.__elementType=s,m},$e=typeof window>"u",Wr=he.createContext(null);Wr.displayName="EmbeddedCheckoutProviderContext";var pt=function(){var s=gs("calls useStripe()"),a=s.stripe;return a};ze("auBankAccount",$e);var Ot=ze("card",$e);ze("cardNumber",$e);ze("cardExpiry",$e);ze("cardCvc",$e);ze("iban",$e);ze("payment",$e);ze("expressCheckout",$e);var Ra=ze("paymentRequestButton",$e);ze("linkAuthentication",$e);ze("address",$e);ze("shippingAddress",$e);ze("paymentMethodMessaging",$e);ze("taxId",$e);const Gr=[{code:"NL",name:"Netherlands",dialCode:"+31"},{code:"US",name:"United States",dialCode:"+1"},{code:"IT",name:"Italy",dialCode:"+39"},{code:"GB",name:"United Kingdom",dialCode:"+44"},{code:"BE",name:"Belgium",dialCode:"+32"},{code:"FR",name:"France",dialCode:"+33"},{code:"DE",name:"Germany",dialCode:"+49"},{code:"ES",name:"Spain",dialCode:"+34"},{code:"PT",name:"Portugal",dialCode:"+351"},{code:"PL",name:"Poland",dialCode:"+48"},{code:"AT",name:"Austria",dialCode:"+43"},{code:"CH",name:"Switzerland",dialCode:"+41"},{code:"SE",name:"Sweden",dialCode:"+46"},{code:"NO",name:"Norway",dialCode:"+47"},{code:"DK",name:"Denmark",dialCode:"+45"},{code:"FI",name:"Finland",dialCode:"+358"},{code:"IE",name:"Ireland",dialCode:"+353"},{code:"GR",name:"Greece",dialCode:"+30"},{code:"CZ",name:"Czech Republic",dialCode:"+420"},{code:"HU",name:"Hungary",dialCode:"+36"},{code:"CA",name:"Canada",dialCode:"+1"},{code:"AU",name:"Australia",dialCode:"+61"},{code:"NZ",name:"New Zealand",dialCode:"+64"},{code:"LU",name:"Luxembourg",dialCode:"+352"},{code:"IS",name:"Iceland",dialCode:"+354"},{code:"MT",name:"Malta",dialCode:"+356"},{code:"CY",name:"Cyprus",dialCode:"+357"},{code:"LI",name:"Liechtenstein",dialCode:"+423"},{code:"MC",name:"Monaco",dialCode:"+377"},{code:"SM",name:"San Marino",dialCode:"+378"},{code:"VA",name:"Vatican City",dialCode:"+379"},{code:"AD",name:"Andorra",dialCode:"+376"}];function At(t){if(!t)return null;const s=t.replace(/[\s()-]/g,"");if(!s.startsWith("+"))return null;const a=[...Gr].sort((r,x)=>x.dialCode.length-r.dialCode.length);for(const r of a)if(s.startsWith(r.dialCode))return r;return null}var Oa="clover",Yr=function(s){return s===3?"v3":s},Ua="https://js.stripe.com",Vr="".concat(Ua,"/").concat(Oa,"/stripe.js"),Jr=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,Xr=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var Zr=function(s){return Jr.test(s)||Xr.test(s)},Qr=function(){for(var s=document.querySelectorAll('script[src^="'.concat(Ua,'"]')),a=0;a<s.length;a++){var r=s[a];if(Zr(r.src))return r}return null},Ys=function(s){var a="",r=document.createElement("script");r.src="".concat(Vr).concat(a);var x=document.head||document.body;if(!x)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return x.appendChild(r),r},Kr=function(s,a){!s||!s._registerWrapper||s._registerWrapper({name:"stripe-js",version:"8.5.3",startTime:a})},Ct=null,Dt=null,kt=null,en=function(s){return function(a){s(new Error("Failed to load Stripe.js",{cause:a}))}},tn=function(s,a){return function(){window.Stripe?s(window.Stripe):a(new Error("Stripe.js not available"))}},sn=function(s){return Ct!==null?Ct:(Ct=new Promise(function(a,r){if(typeof window>"u"||typeof document>"u"){a(null);return}if(window.Stripe){a(window.Stripe);return}try{var x=Qr();if(!(x&&s)){if(!x)x=Ys(s);else if(x&&kt!==null&&Dt!==null){var o;x.removeEventListener("load",kt),x.removeEventListener("error",Dt),(o=x.parentNode)===null||o===void 0||o.removeChild(x),x=Ys(s)}}kt=tn(a,r),Dt=en(r),x.addEventListener("load",kt),x.addEventListener("error",Dt)}catch(m){r(m);return}}),Ct.catch(function(a){return Ct=null,Promise.reject(a)}))},an=function(s,a,r){if(s===null)return null;var x=a[0],o=x.match(/^pk_test/),m=Yr(s.version),f=Oa,g=s.apply(void 0,a);return Kr(g,r),g},wt,za=!1,$a=function(){return wt||(wt=sn(null).catch(function(s){return wt=null,Promise.reject(s)}),wt)};Promise.resolve().then(function(){return $a()}).catch(function(t){});var rn=function(){for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];za=!0;var x=Date.now();return $a().then(function(o){return an(o,a,x)})};let as=null;const qa=()=>{if(!as){const t="pk_test_51M2D1ECcTUIOQ9MlHx82jO3oGqleOMKvBub1sYxHYTODiKzxwwAWb3hUiqgvHXCf92WXbklGIYgjLtpvh5DiQ9ll00eCtUxgsy";if(!t.startsWith("pk_test_")&&!t.startsWith("pk_live_"))return Promise.resolve(null);as=rn(t).then(s=>s).catch(s=>null)}return as};function Ha({onSuccess:t,onError:s,loading:a,setLoading:r,initialCardholderName:x=""}){const o=pt(),m=Jt(),[f,g]=n.useState(x),[p,c]=n.useState(!1),[l,h]=n.useState(null),[u,b]=n.useState(null),[E,B]=n.useState(!1),[j,v]=n.useState(!1),y=n.useRef(!0),d=n.useRef(!1);n.useEffect(()=>(y.current=!0,()=>{y.current=!1}),[]),n.useEffect(()=>{x&&!f&&g(x)},[x]);const i=F=>F.trim()?F.trim().length<2?"Name must be at least 2 characters":/^[a-zA-Z\s'-]+$/.test(F.trim())?null:"Name can only contain letters, spaces, hyphens, and apostrophes":"Cardholder name is required";n.useEffect(()=>{const F=setTimeout(()=>{(!o||!m)&&h("Payment form failed to load. Please refresh the page.")},1e4);return()=>clearTimeout(F)},[o,m,E]);const C=async F=>{if(F.preventDefault(),d.current)return;if(!o||!m){const k="Stripe has not loaded yet. Please try again.";y.current&&h(k),s(k);return}const N=i(f);if(N){y.current&&(b(N),h(N)),s(N);return}if(!p){const k="Please complete your card details";y.current&&h(k),s(k);return}d.current=!0,y.current&&(r(!0),h(null),b(null));try{const k=m.getElement(Ot);if(!k)throw new Error("Card element not found. Please refresh the page.");const{error:P,paymentMethod:L}=await o.createPaymentMethod({type:"card",card:k,billing_details:{name:f.trim()}});if(P)throw new Error(P.message||"Failed to process card");if(!L)throw new Error("Failed to create payment method");if(y.current)try{await t(L.id)}catch($){throw $}}catch(k){const P=(k==null?void 0:k.message)||"Failed to add card. Please try again.";y.current&&h(P);try{s(P)}catch{}}finally{d.current=!1,y.current&&r(!1)}},A={style:{base:{fontSize:"16px",color:"#1f2937",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',lineHeight:"24px","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}},hidePostalCode:!1},w=f.trim().length>=2&&!i(f)&&p&&o&&m;return e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cardholder Name",x&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(from your profile)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:f,onChange:F=>{g(F.target.value),v(!0);const N=i(F.target.value);b(N),N||h(null)},onBlur:()=>v(!0),placeholder:"John Doe",className:`w-full px-4 py-3 pr-10 border rounded-xl focus:ring-2 focus:border-transparent transition-all ${j&&u?"border-red-300 focus:ring-red-500":j&&f.trim()&&!u?"border-green-300 focus:ring-green-500":"border-gray-300 focus:ring-slate-500"}`,disabled:a,required:!0}),j&&f.trim()&&!u&&e.jsx(ys,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-500"}),j&&u&&e.jsx(Ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-red-500"})]}),j&&u&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:u}),x&&!j&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You can edit this if needed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Details"}),o?e.jsx("div",{className:`w-full px-4 py-3 bg-white border rounded-xl focus-within:ring-2 focus-within:border-transparent min-h-[44px] transition-all ${p?"border-green-300 focus-within:ring-green-500":"border-gray-300 focus-within:ring-slate-500"}`,children:e.jsx(Ot,{options:A,onReady:()=>{B(!0)},onChange:F=>{c(F.complete),F.error?h(F.error.message):u||h(null)},onBlur:()=>{},onFocus:()=>{}})}):e.jsx("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-xl",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Loading payment form..."})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"For testing, use card number: 4242 4242 4242 4242"})]}),l&&!u&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:l})]}),e.jsx("button",{type:"submit",disabled:a||!w,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-2xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:a?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Adding Card..."]}):"Add Card"})]})}function Wa({onSuccess:t,onError:s,loading:a,setLoading:r}){const x=pt(),o=Jt(),[m,f]=n.useState(null),[g,p]=n.useState(!1),[c,l]=n.useState(null),[h,u]=n.useState(null),[b,E]=n.useState(!0),[B,j]=n.useState([]);return n.useEffect(()=>{const v=window.location.protocol==="https:",y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";if(E(v||y),!x||!o)return;if(!v&&!y){u("Digital wallets require a secure HTTPS connection. Apple Pay will not be available.");return}y&&u("Apple Pay requires HTTPS and domain verification. Only Google Pay may be available in development.");const d=x.paymentRequest({country:"NL",currency:"eur",total:{label:"Add Payment Method",amount:0},requestPayerName:!0,requestPayerEmail:!1});return d.canMakePayment().then(i=>{if(i){const C=[];i.applePay&&C.push("Apple Pay"),i.googlePay&&C.push("Google Pay"),j(C),f(d),p(!0),y&&!i.applePay&&i.googlePay?u("Google Pay is available. Apple Pay requires HTTPS domain verification and will only work in production."):y&&i.applePay&&u(null)}else u("No digital wallets (Apple Pay / Google Pay) are available on this device or browser.")}).catch(i=>{u("Unable to check digital wallet availability. Please use card payment.")}),d.on("paymentmethod",async i=>{var C;r(!0),l(null);try{if((C=i.paymentMethod)!=null&&C.id)t(i.paymentMethod.id),i.complete("success");else throw new Error("No payment method created")}catch(A){const w=(A==null?void 0:A.message)||"Failed to add payment method";l(w),s(w),i.complete("fail")}finally{r(!1)}}),()=>{d.abort()}},[x,o,t,s,r]),!g||!m?h?e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-xl flex items-start gap-2",children:[e.jsx(nt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Digital Wallet Information"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:h})]})]}):null:e.jsxs("div",{className:"space-y-3",children:[c&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:c})]}),h&&!c&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-xl flex items-start gap-2",children:[e.jsx(nt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-blue-700",children:h}),B.length>0&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Available: ",B.join(", ")]})]})]}),e.jsx("div",{className:"payment-request-button",children:e.jsx(Ra,{options:{paymentRequest:m,style:{paymentRequestButton:{type:"default",theme:"dark",height:"48px"}}}})})]})}function Ga({clientSecret:t,setupIntentId:s,paymentMethodId:a,customerName:r,customerEmail:x,onSuccess:o,onError:m}){const f=pt(),[g,p]=n.useState(!1),[c,l]=n.useState(null),[h,u]=n.useState(!1),[b,E]=n.useState({confirmation_title:"Confirm with Ideal.",confirmation_subtitle:"You'll be redirected to your bank to complete.",redirecting_text:"Redirecting to your bank..."}),B=n.useRef(!1);return n.useEffect(()=>{(async()=>{try{const y=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/payment-method-messages?type=ideal&language=en");if(y.ok){const d=await y.json();d.success&&d.messages&&E(d.messages)}}catch{}})()},[]),n.useEffect(()=>{if(!f||h||B.current)return;(async()=>{try{if(!(r!=null&&r.trim())){const d="Customer name is required for iDEAL payment setup";l(d),m(d);return}if(!(x!=null&&x.trim())){const d="Customer email is required for iDEAL payment setup";l(d),m(d);return}B.current=!0,u(!0),p(!0);const v={return_url:`${window.location.origin}/?payment_setup_complete=${a}&setup_intent=${s}`,payment_method_data:{type:"ideal",billing_details:{name:r.trim(),email:x.trim()}}},y=await f.confirmSetup({clientSecret:t,confirmParams:v});if(y.error)throw new Error(y.error.message||"Failed to confirm iDEAL setup")}catch(v){const y=(v==null?void 0:v.message)||"Failed to set up iDEAL. Please try again.";l(y),m(y),p(!1),u(!1),B.current=!1}})()},[f,t,a,s,r,x,m,h]),e.jsxs("div",{className:"space-y-4",children:[!c&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-orange-400 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-center text-gray-600 text-sm",children:b.redirecting_text})]})}),c&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-1",children:"Setup Failed"}),e.jsx("p",{className:"text-sm text-red-600",children:c})]})]})]})}function Ya({clientSecret:t,setupIntentId:s,paymentMethodId:a,customerName:r,customerEmail:x,onSuccess:o,onError:m}){const f=pt(),[g,p]=n.useState(!1),[c,l]=n.useState(null),[h,u]=n.useState(!1),[b,E]=n.useState({confirmation_title:"Confirm with Bancontact.",confirmation_subtitle:"You'll be redirected to your bank to complete.",redirecting_text:"Redirecting to your bank..."}),B=n.useRef(!1);return n.useEffect(()=>{(async()=>{try{const y=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/payment-method-messages?type=bancontact&language=en");if(y.ok){const d=await y.json();d.success&&d.messages&&E(d.messages)}}catch{}})()},[]),n.useEffect(()=>{if(!f||h||B.current)return;(async()=>{try{if(!(r!=null&&r.trim())){const d="Customer name is required for Bancontact payment setup";l(d),m(d);return}if(!(x!=null&&x.trim())){const d="Customer email is required for Bancontact payment setup";l(d),m(d);return}B.current=!0,u(!0),p(!0);const v={return_url:`${window.location.origin}/?payment_setup_complete=${a}&setup_intent=${s}`,payment_method_data:{type:"bancontact",billing_details:{name:r.trim(),email:x.trim()}}},y=await f.confirmSetup({clientSecret:t,confirmParams:v});if(y.error)throw new Error(y.error.message||"Failed to confirm Bancontact setup")}catch(v){const y=(v==null?void 0:v.message)||"Failed to set up Bancontact. Please try again.";l(y),m(y),p(!1),u(!1),B.current=!1}})()},[f,t,a,s,r,x,m,h]),e.jsxs("div",{className:"space-y-4",children:[!c&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 space-y-4",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-orange-400 border-t-transparent rounded-full animate-spin"}),e.jsx("p",{className:"text-center text-gray-600 text-sm",children:b.redirecting_text})]})}),c&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-red-900 mb-1",children:"Setup Failed"}),e.jsx("p",{className:"text-sm text-red-600",children:c})]})]})]})}function Xt({onClose:t,onPaymentMethodSelected:s,title:a="Choose Payment Method",description:r="Select or add a payment method",excludeTypes:x=[],userProfile:o}){const[m,f]=n.useState("select"),[g,p]=n.useState([]),[c,l]=n.useState(null),[h,u]=n.useState(!0),[b,E]=n.useState(!1),[B,j]=n.useState(null),{showSuccess:v,showError:y}=qe(),[d,i]=n.useState("card"),C=n.useMemo(()=>qa(),[]),[A,w]=n.useState(""),[F,N]=n.useState(""),[k,P]=n.useState(!0),[L,$]=n.useState(null),[U,S]=n.useState(""),[I,M]=n.useState(""),[H,T]=n.useState(!1),[D,R]=n.useState(""),[Z,O]=n.useState(null),[V,q]=n.useState(null);n.useEffect(()=>{const Y=navigator.userAgent||navigator.vendor||window.opera,ee=/iPad|iPhone|iPod/.test(Y)&&!window.MSStream,xe=/Macintosh|MacIntel|MacPPC|Mac68K/.test(Y),me=/Safari/.test(Y)&&!/Chrome/.test(Y);T(ee||xe&&me),(async()=>{try{u(!0);let pe=(await De.getPaymentMethods()).paymentMethods||[];x.length>0&&(pe=pe.filter(Xe=>!x.includes(Xe.type))),p(pe);const Me=pe.find(Xe=>Xe.isPrimary);if(Me?l(Me.id):pe.length>0&&l(pe[0].id),pe.length===0&&f("add"),o&&(o.full_name&&(S(o.full_name),N(o.full_name)),o.email&&(M(o.email),R(o.email)),o.phone_nr)){const Xe=At(o.phone_nr);Xe&&$(Xe.code)}}catch{f("add")}finally{u(!1)}})()},[]);const z=async()=>{if(!c){j("Please select a payment method");return}E(!0);try{await s(c),t()}catch(Y){j(Y.message||"Failed to process payment")}finally{E(!1)}},_=async Y=>{try{E(!0),await De.savePaymentMethod({type:"card",stripePaymentMethodId:Y,isPrimary:k});const me=((await De.getPaymentMethods()).paymentMethods||[]).find(ce=>ce.stripePaymentMethodId===Y);me&&await s(me.id),v("Payment method added successfully"),t()}catch(ee){const xe=(ee==null?void 0:ee.message)||"Failed to save payment method. Please try again.";j(xe),y(xe)}finally{E(!1)}},W=Y=>{j(Y),y(Y)},ne=async Y=>{Y.preventDefault(),j(null),E(!0);try{if(d==="bancontact"){if(!(U!=null&&U.trim()))throw new Error("Your profile name is required for Bancontact. Please complete your profile first.");if(!(I!=null&&I.trim()))throw new Error("Your profile email is required for Bancontact. Please complete your profile first.");const ce=await De.savePaymentMethod({type:"bancontact",cardholderName:U.trim(),email:I.trim(),isPrimary:k});if(ce.requiresAction&&ce.clientSecret&&ce.setupIntentId&&ce.paymentMethodId){q({clientSecret:ce.clientSecret,setupIntentId:ce.setupIntentId,paymentMethodId:ce.paymentMethodId}),E(!1);return}}else if(d==="ideal"){if(!(U!=null&&U.trim()))throw new Error("Your profile name is required for iDEAL. Please complete your profile first.");if(!(I!=null&&I.trim()))throw new Error("Your profile email is required for iDEAL. Please complete your profile first.");const ce=await De.savePaymentMethod({type:"ideal",cardholderName:U.trim(),email:I.trim(),isPrimary:k});if(ce.requiresAction&&ce.clientSecret&&ce.setupIntentId&&ce.paymentMethodId){O({clientSecret:ce.clientSecret,setupIntentId:ce.setupIntentId,paymentMethodId:ce.paymentMethodId}),E(!1);return}}const xe=(await De.getPaymentMethods()).paymentMethods||[],me=xe[xe.length-1];me&&await s(me.id),t()}catch(ee){const xe=(ee==null?void 0:ee.message)||"Failed to add payment method. Please try again.";j(xe),y(xe)}finally{E(!1)}},X=async Y=>{try{E(!0);const ee=H?"applepay":"googlepay";await De.savePaymentMethod({type:ee,stripePaymentMethodId:Y,isPrimary:!0});const ce=((await De.getPaymentMethods()).paymentMethods||[]).find(Le=>Le.stripePaymentMethodId===Y);ce&&await s(ce.id),v("Payment method added successfully"),t()}catch(ee){const xe=(ee==null?void 0:ee.message)||"Failed to save payment method. Please try again.";j(xe),y(xe)}finally{E(!1)}},re=Y=>{j(Y),y(Y)},te=Y=>{switch(Y){case"card":return e.jsx(Ve,{className:"w-5 h-5"});case"ideal":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 576 512",children:e.jsx("path",{fill:"currentColor",d:"M125.61 165.48a49.07 49.07 0 1 0 49.06 49.06a49.08 49.08 0 0 0-49.06-49.06M86.15 425.84h78.94V285.32H86.15Zm151.46-211.6c0-20-10-22.53-18.74-22.53h-14.05v45.79h14.05c9.75 0 18.74-2.81 18.74-23.26m201.69 46v-91.31h22.75v68.57h33.69C486.5 113.08 388.61 86.19 299.67 86.19h-94.83V169h14c25.6 0 41.5 17.35 41.5 45.26c0 28.81-15.52 46-41.5 46h-14v165.62h94.83c144.61 0 194.94-67.16 196.72-165.64Zm-109.75 0H273.3V169h54.43v22.73H296v10.58h30V225h-30v12.5h33.51Zm74.66 0l-5.16-17.67h-29.74l-5.18 17.67h-23.66L368 168.92h32.35l27.53 91.34ZM299.65 32H32v448h267.65c161.85 0 251-79.73 251-224.52C550.62 172 518 32 299.65 32m0 426.92H53.07V53.07h246.58c142.1 0 229.9 64.61 229.9 202.41c0 134.09-81 203.44-229.9 203.44m83.86-264.85L376 219.88h16.4l-7.52-25.81Z"})});case"bancontact":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M28.516 13.027h-9.433l-5.723 6.692H2.079l3.041-3.583H1.495c-.823 0-1.495.687-1.495 1.531v3.24c0 .843.672 1.531 1.495 1.531H18.74c.823 0 1.948-.511 2.5-1.14l2.609-2.964l4.624-5.26zm-1.5 1.702l-1 1.14zm3.489-5.166H13.306c-.823 0-1.947.511-2.5 1.135l-7.317 8.281h9.396l5.823-6.692h11.229l-3.016 3.583h3.584c.823 0 1.495-.692 1.495-1.536v-3.235c0-.844-.672-1.536-1.495-1.536m-2.494 4.03l-.5.568l-.131.156z"})});case"sepa_debit":return e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M12.553 8.72v6.56h1.766v-1.694h1.052l.293-.01q.868-.013.984-.033q.985-.13 1.3-.994q.16-.436.16-1.434q0-.83-.145-1.243q-.277-.786-1.09-1.04q-.354-.111-1.031-.111zm6.79 0l-1.971 6.56h1.826l.317-1.134h2.36l.337 1.133H24l-1.995-6.558zm-9.339.031a3.36 3.36 0 0 0-1.888.574a3.27 3.27 0 0 0-1.199 1.455h-.742l-.464.996h.969a3 3 0 0 0 .004.526h-.467l-.465.995H6.94a3.33 3.33 0 0 0 3.064 1.973a3.37 3.37 0 0 0 1.876-.564l.013-.009v-1.241l-.05.056a2.293 2.293 0 0 1-3.618-.215h2.396l.465-.995H7.838a2.4 2.4 0 0 1-.012-.526h3.505l.008-.017l.438-.939l.019-.04H8.154a2.31 2.31 0 0 1 1.963-1.108c.694 0 1.344.31 1.783.85l.028.035l.409-.875l-.015-.014a3.36 3.36 0 0 0-2.318-.917m-7.2.004q-.658 0-1.196.048q-.646.051-1.062.348a1.1 1.1 0 0 0-.41.565q-.128.372-.128.99q0 .81.236 1.21q.269.47 1.074.621q.308.052 1.094.109q.981.066 1.098.103q.316.095.316.528a1.1 1.1 0 0 1-.037.315a.48.48 0 0 1-.298.287q-.127.048-.589.048h-.604a1 1 0 0 1-.41-.09q-.246-.121-.246-.549v-.136H0q0 .8.118 1.143q.213.618.879.82q.543.165 1.922.164q.826 0 1.228-.075q.96-.18 1.233-.853q.151-.368.151-1.16q0-.344-.033-.617a1.2 1.2 0 0 0-.355-.74q-.379-.363-1.22-.448q-.265-.028-1.33-.1l-.331-.023a.8.8 0 0 1-.35-.094q-.185-.113-.185-.471q0-.396.208-.514t.852-.118q.661 0 .808.205q.095.138.095.542h1.642q.016-.217.016-.326q0-1.325-1.072-1.613q-.44-.119-1.473-.119zm17.894 1.27l.827 2.843h-1.63zm-6.38.13h1.116q.27 0 .342.01q.36.063.456.345q.067.201.067.617a3 3 0 0 1-.033.512q-.053.258-.21.344q-.114.063-.637.082h-1.1Z"})});default:return e.jsx(Ve,{className:"w-5 h-5"})}},oe=Y=>Y.type==="card"?`${Y.cardBrand||"Card"} â€¢â€¢â€¢â€¢ ${Y.lastFour}`:Y.type==="ideal"?"iDEAL":Y.type==="sepa_debit"?"SEPA Direct Debit":Y.type==="bancontact"?"Bancontact":Y.type==="applepay"?"Apple Pay":Y.type==="googlepay"?"Google Pay":Y.type;return h?e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-center justify-center",children:e.jsx("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4",children:e.jsxs("div",{className:"flex items-center justify-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-orange-400 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-gray-700",children:"Loading..."})]})})}):V?e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-end",onClick:()=>q(null),children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:Y=>Y.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Complete via Bancontact"})})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:C,children:e.jsx(Ya,{clientSecret:V.clientSecret,setupIntentId:V.setupIntentId,paymentMethodId:V.paymentMethodId,customerName:U,customerEmail:I,onSuccess:async()=>{try{q(null);const ee=(await De.getPaymentMethods()).paymentMethods||[],xe=ee[ee.length-1];xe&&await s(xe.id),v("Payment method added successfully"),t()}catch{y("Failed to complete Bancontact setup")}},onError:Y=>{try{j(Y),q(null),y(Y)}catch{}}})})})]})}):Z?e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-end",onClick:()=>O(null),children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:Y=>Y.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Complete via iDEAL"})})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:C,children:e.jsx(Ga,{clientSecret:Z.clientSecret,setupIntentId:Z.setupIntentId,paymentMethodId:Z.paymentMethodId,customerName:U,customerEmail:I,onSuccess:async()=>{try{O(null);const ee=(await De.getPaymentMethods()).paymentMethods||[],xe=ee[ee.length-1];xe&&await s(xe.id),v("Payment method added successfully"),t()}catch{y("Failed to complete iDEAL setup")}},onError:Y=>{try{j(Y),O(null),y(Y)}catch{}}})})})]})}):e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-end",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:Y=>Y.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:[e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:a})}),e.jsx("p",{className:"text-sm text-gray-600",children:r})]}),e.jsxs("div",{className:"px-5 py-5",children:[m==="select"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-3 mb-6",children:g.map(Y=>e.jsxs("button",{onClick:()=>l(Y.id),className:`w-full p-4 rounded-2xl border-2 transition-all flex items-center justify-between ${c===Y.id?"border-orange-400 bg-orange-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-xl ${c===Y.id?"bg-orange-100":"bg-gray-100"}`,children:te(Y.type)}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:oe(Y)}),Y.cardholderName&&e.jsx("div",{className:"text-sm text-gray-600",children:Y.cardholderName})]})]}),c===Y.id&&e.jsx("div",{className:"w-6 h-6 bg-orange-400 rounded-full flex items-center justify-center",children:e.jsx(Qe,{className:"w-4 h-4 text-white"})})]},Y.id))}),e.jsxs("button",{onClick:()=>f("add"),className:"w-full p-4 rounded-2xl border-2 border-dashed border-gray-300 hover:border-gray-400 transition-all flex items-center justify-center gap-2 mb-6 text-gray-700 hover:text-gray-900",children:[e.jsx(cs,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Add New Payment Method"})]}),B&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:B})]}),e.jsx("button",{onClick:z,disabled:b||!c,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-2xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Continue"})]}),m==="add"&&e.jsxs("form",{onSubmit:ne,children:[g.length>0&&e.jsx("button",{type:"button",onClick:()=>f("select"),className:"mb-4 text-orange-500 hover:text-orange-600 font-medium flex items-center gap-1",children:"â† Back to saved methods"}),!x.includes("applepay")&&!x.includes("googlepay")&&e.jsxs("div",{className:"mb-6",children:[e.jsx(Ye,{stripe:C,children:e.jsx(Wa,{onSuccess:X,onError:re,loading:b,setLoading:E})}),e.jsxs("div",{className:"flex items-center gap-4 mt-6 mb-6",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500",children:"or add"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>i("card"),className:`py-3 rounded-xl font-medium transition-all ${d==="card"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Card"})]})}),e.jsx("button",{type:"button",onClick:()=>i("ideal"),className:`py-3 rounded-xl font-medium transition-all ${d==="ideal"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-5 h-5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 576 512",children:e.jsx("path",{fill:"currentColor",d:"M125.61 165.48a49.07 49.07 0 1 0 49.06 49.06a49.08 49.08 0 0 0-49.06-49.06M86.15 425.84h78.94V285.32H86.15Zm151.46-211.6c0-20-10-22.53-18.74-22.53h-14.05v45.79h14.05c9.75 0 18.74-2.81 18.74-23.26m201.69 46v-91.31h22.75v68.57h33.69C486.5 113.08 388.61 86.19 299.67 86.19h-94.83V169h14c25.6 0 41.5 17.35 41.5 45.26c0 28.81-15.52 46-41.5 46h-14v165.62h94.83c144.61 0 194.94-67.16 196.72-165.64Zm-109.75 0H273.3V169h54.43v22.73H296v10.58h30V225h-30v12.5h33.51Zm74.66 0l-5.16-17.67h-29.74l-5.18 17.67h-23.66L368 168.92h32.35l27.53 91.34ZM299.65 32H32v448h267.65c161.85 0 251-79.73 251-224.52C550.62 172 518 32 299.65 32m0 426.92H53.07V53.07h246.58c142.1 0 229.9 64.61 229.9 202.41c0 134.09-81 203.44-229.9 203.44m83.86-264.85L376 219.88h16.4l-7.52-25.81Z"})})}),e.jsx("span",{className:"text-xs",children:"iDEAL"})]})}),e.jsx("button",{type:"button",onClick:()=>i("bancontact"),className:`py-3 rounded-xl font-medium transition-all ${d==="bancontact"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-5 h-5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M28.516 13.027h-9.433l-5.723 6.692H2.079l3.041-3.583H1.495c-.823 0-1.495.687-1.495 1.531v3.24c0 .843.672 1.531 1.495 1.531H18.74c.823 0 1.948-.511 2.5-1.14l2.609-2.964l4.624-5.26zm-1.5 1.702l-1 1.14zm3.489-5.166H13.306c-.823 0-1.947.511-2.5 1.135l-7.317 8.281h9.396l5.823-6.692h11.229l-3.016 3.583h3.584c.823 0 1.495-.692 1.495-1.536v-3.235c0-.844-.672-1.536-1.495-1.536m-2.494 4.03l-.5.568l-.131.156z"})})}),e.jsx("span",{className:"text-xs",children:"Bancontact"})]})})]}),d==="card"&&e.jsx("div",{className:"mb-6",children:e.jsx(Ye,{stripe:C,options:{appearance:{theme:"stripe"},loader:"auto"},children:e.jsx(Ha,{onSuccess:_,onError:W,loading:b,setLoading:E,initialCardholderName:U})})}),d==="ideal"&&e.jsx("div",{className:"space-y-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cardholder Name"}),e.jsx("input",{type:"text",value:U,onChange:Y=>S(Y.target.value),placeholder:"Enter cardholder name...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-slate-500"})]})}),d==="bancontact"&&e.jsx("div",{className:"space-y-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cardholder Name"}),e.jsx("input",{type:"text",value:U,onChange:Y=>S(Y.target.value),placeholder:"Enter cardholder name...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-slate-500"})]})}),d!=="card"&&e.jsxs(e.Fragment,{children:[B&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:B})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("input",{type:"checkbox",id:"saveCard",checked:k,onChange:Y=>P(Y.target.checked),className:"w-4 h-4 text-slate-700 border-gray-300 rounded focus:ring-slate-500"}),e.jsx("label",{htmlFor:"saveCard",className:"text-sm text-gray-700",children:"Set as primary payment method"})]}),e.jsx("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-2xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:b?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):"Add & Continue"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4 text-xs text-gray-500",children:[e.jsx(ws,{className:"w-3 h-3"}),e.jsx("span",{children:"Your payment information is secure and encrypted"})]})]})]})]})]})})}const nn=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"No Powerbanks Available"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(we,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ie,{className:"w-8 h-8 text-orange-500"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"All powerbanks at this station are currently in use."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Please try another nearby station or check back later."})]}),e.jsx("button",{onClick:t,className:"w-full bg-[#FF6B35] text-white py-3 rounded-xl font-semibold hover:bg-[#E55A2B] active:scale-95 transition-all",children:"Find Another Station"})]})}),xn=({onClose:t})=>e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-[100] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 max-w-sm w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Active Rental"}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600",children:e.jsx(we,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(Ie,{className:"w-8 h-8 text-blue-500"})}),e.jsx("p",{className:"text-gray-600 mb-2",children:"You already have an active powerbank rental."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Please return your current powerbank before renting another one."})]}),e.jsx("button",{onClick:t,className:"w-full bg-[#FF6B35] text-white py-3 rounded-xl font-semibold hover:bg-[#E55A2B] active:scale-95 transition-all",children:"Got It"})]})}),on=({className:t=""})=>e.jsxs("svg",{viewBox:"0 0 100 100",className:t,fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("rect",{x:"30",y:"20",width:"40",height:"60",rx:"8",fill:"#FF6B35"}),e.jsx("rect",{x:"35",y:"25",width:"30",height:"45",rx:"4",fill:"#FFA574"}),e.jsx("path",{d:"M50 35 L45 50 L55 50 L50 65",stroke:"white",strokeWidth:"3",strokeLinecap:"round",strokeLinejoin:"round"}),e.jsx("rect",{x:"45",y:"10",width:"10",height:"12",rx:"2",fill:"#FF6B35"})]}),ln=({onSwitchToManual:t})=>{const s=n.useRef(null),a=n.useRef(null),[r,x]=n.useState(!1),[o,m]=n.useState(!1);n.useEffect(()=>((async()=>{try{const p={video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080}}},c=await navigator.mediaDevices.getUserMedia(p);a.current=c,s.current&&(s.current.srcObject=c);const h=c.getVideoTracks()[0].getCapabilities();h&&h.torch&&m(!0)}catch{alert("Could not access the camera. Please check your permissions.")}})(),()=>{a.current&&a.current.getTracks().forEach(p=>{p.stop()})}),[]);const f=async()=>{if(!a.current)return;const g=a.current.getVideoTracks()[0];if(g)try{const p=g.getCapabilities();if(p&&p.torch){const c=!r;await g.applyConstraints({advanced:[{torch:c}]}),x(c)}else alert("Flashlight is not supported on this device")}catch{alert("Failed to toggle flashlight. Your device may not support this feature.")}};return e.jsxs("div",{className:"relative w-full h-full bg-black",children:[e.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,className:"absolute top-0 left-0 w-full h-full object-cover"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-between h-full px-8 pt-8 text-white",children:[e.jsxs("div",{className:"w-full flex-grow flex flex-col items-center justify-center -mt-16",children:[e.jsxs("div",{className:"w-64 h-64 bg-transparent relative rounded-3xl",style:{boxShadow:"0 0 0 4000px rgba(0,0,0,0.6)"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-white rounded-tl-3xl"}),e.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-white rounded-tr-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-white rounded-bl-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-white rounded-br-3xl"})]}),e.jsx("p",{className:"text-xl font-semibold mt-8 text-center",style:{textShadow:"0 2px 8px rgba(0,0,0,0.7)"},children:"Point the camera at the QR code"})]}),e.jsxs("div",{className:"absolute bottom-24 flex items-center space-x-8",children:[e.jsx("button",{onClick:t,className:"flex flex-col items-center space-y-2",children:e.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center shadow-lg transition-shadow hover:shadow-xl active:scale-95",children:e.jsx(u0,{className:"w-10 h-10 text-[#203F55]"})})}),e.jsx("button",{onClick:f,disabled:!o,className:"flex flex-col items-center space-y-2 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Toggle flashlight",children:e.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition-all hover:shadow-xl active:scale-95 ${r?"bg-yellow-300":"bg-white"}`,children:e.jsx(aa,{className:"w-10 h-10 text-[#203F55]"})})})]})]})]})},cn=({onSwitchToScan:t,onValidationComplete:s,onShowUnavailable:a,onShowLimitExceeded:r,onShowActiveRental:x})=>{const[o,m]=n.useState(new Array(6).fill("")),f=n.useRef([]),g=n.useRef(null),[p,c]=n.useState(!1),[l,h]=n.useState(!1),[u,b]=n.useState(!1),{showToast:E}=qe();n.useEffect(()=>{var i;return(i=f.current[0])==null||i.focus(),(async()=>{try{const C=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}});g.current=C;const w=C.getVideoTracks()[0].getCapabilities();w&&w.torch&&h(!0)}catch{}})(),()=>{g.current&&g.current.getTracks().forEach(C=>C.stop())}},[]);const B=async d=>{var i;if(!u){b(!0);try{const{data:{user:C}}=await J.auth.getUser();if(!C){E("Please log in to continue","error"),b(!1);return}const A=await jr(d,C.id);if(A.isValid)if(A.error==="DAILY_LIMIT_EXCEEDED")r(A.stationId);else{const w=!A.hasActiveSubscription||A.dailyLimitUsed;s(A.stationId,w)}else switch(A.error){case"STATION_NOT_FOUND":E("Invalid station code. Please try again.","error"),m(new Array(6).fill("")),(i=f.current[0])==null||i.focus();break;case"NO_POWERBANKS":a();break;case"ACTIVE_RENTAL":x();break}}catch{E("An error occurred. Please try again.","error")}finally{b(!1)}}},j=(d,i)=>{var A;const{value:C}=d.target;if(/^[0-9]$/.test(C)||C===""){const w=[...o];if(w[i]=C,m(w),C!==""&&i<5)(A=f.current[i+1])==null||A.focus();else if(C!==""&&i===5){const F=w.join("");B(F)}}},v=(d,i)=>{var C;d.key==="Backspace"&&o[i]===""&&i>0&&((C=f.current[i-1])==null||C.focus())},y=async()=>{if(!g.current)return;const d=g.current.getVideoTracks()[0];if(d)try{const i=d.getCapabilities();if(i&&i.torch){const C=!p;await d.applyConstraints({advanced:[{torch:C}]}),c(C)}else alert("Flashlight is not supported on this device")}catch{alert("Failed to toggle flashlight. Your device may not support this feature.")}};return e.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-between px-8 pt-20 text-gray-800",children:[e.jsxs("div",{className:"flex-grow flex flex-col items-center justify-center -mt-16 text-center",children:[e.jsx("div",{className:"w-32 h-32 rounded-full bg-gray-100 flex items-center justify-center shadow-lg overflow-hidden mb-6",children:e.jsx("div",{className:"scale-[0.7] -translate-y-2",children:e.jsx(on,{className:"w-full h-full"})})}),e.jsxs("p",{className:"text-lg max-w-xs",children:["Enter the 6 numbers below the ",e.jsx("span",{className:"text-orange-500 font-semibold",children:"QR code"})]}),e.jsx("div",{className:"flex justify-center items-center space-x-2 my-8",children:o.map((d,i)=>e.jsxs(he.Fragment,{children:[e.jsx("input",{ref:C=>{f.current[i]=C},type:"tel",inputMode:"numeric",maxLength:1,value:d,onChange:C=>j(C,i),onKeyDown:C=>v(C,i),disabled:u,className:`w-10 h-12 bg-transparent text-center text-3xl font-semibold border-b-2 outline-none transition-all ${u?"border-orange-400 animate-pulse opacity-70":"border-gray-300 focus:border-orange-500"}`}),i===2&&e.jsx("div",{className:"w-3 h-1 bg-gray-300 rounded-full"})]},i))}),u&&e.jsx("p",{className:"text-sm text-orange-500 font-medium animate-pulse",children:"Searching for station..."})]}),e.jsxs("div",{className:"absolute bottom-24 flex items-center space-x-8",children:[e.jsx("button",{onClick:t,className:"flex flex-col items-center space-y-2",children:e.jsx("div",{className:"w-20 h-20 bg-orange-500 rounded-full flex items-center justify-center shadow-lg transition-all hover:shadow-xl active:scale-95",children:e.jsx(gt,{className:"w-10 h-10 text-white"})})}),e.jsx("button",{onClick:y,disabled:!l,className:"flex flex-col items-center space-y-2 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"Toggle flashlight",children:e.jsx("div",{className:`w-20 h-20 rounded-full flex items-center justify-center shadow-lg transition-all hover:shadow-xl active:scale-95 ${p?"bg-yellow-300":"bg-gray-800"}`,children:e.jsx(aa,{className:`w-10 h-10 ${p?"text-gray-800":"text-white"}`})})})]})]})},Va=({onClose:t})=>{const[s,a]=n.useState("scan"),[r,x]=n.useState(!1),[o,m]=n.useState(!1),[f,g]=n.useState(!1),[p,c]=n.useState(""),{showToast:l}=qe(),h=s==="scan"?"":"Manually",u=s==="scan"?"text-white":"text-gray-800",b=()=>{t()},E=(i,C)=>{c(i),x(!0)},B=()=>{m(!0)},j=i=>{c(i),x(!0)},v=()=>{g(!0)},y=async i=>{l("Processing rental...","info"),x(!1),t()},d=()=>{x(!1)};return e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col font-sans bg-white animate-fade-in",children:[e.jsxs("header",{className:`absolute top-0 left-0 right-0 flex items-center p-4 z-50 pointer-events-auto ${u}`,style:{pointerEvents:"auto"},children:[e.jsx("button",{onClick:b,"aria-label":"Go back",className:"active:scale-95 transition-transform p-2 -m-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"w-6 h-6",children:e.jsx("path",{d:"m15 18-6-6 6-6"})})}),e.jsx("h2",{className:"flex-1 text-center text-xl font-bold -ml-6",children:h})]}),e.jsx("main",{className:"flex-1 flex flex-col",children:s==="scan"?e.jsx(ln,{onSwitchToManual:()=>a("manual"),onValidationComplete:E,onShowUnavailable:B,onShowLimitExceeded:j,onShowActiveRental:v}):e.jsx(cn,{onSwitchToScan:()=>a("scan"),onValidationComplete:E,onShowUnavailable:B,onShowLimitExceeded:j,onShowActiveRental:v})}),o&&e.jsx(nn,{onClose:()=>m(!1)}),f&&e.jsx(xn,{onClose:()=>g(!1)}),r&&e.jsx(Xt,{onClose:d,onPaymentMethodSelected:y,title:"Select Payment Method",description:`Complete your rental at station ${p}`}),e.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        .animate-fade-in {
          animation: fade-in 0.3s ease-out forwards;
        }
      `})]})};function Ja({onConfirm:t,onCancel:s}){return e.jsxs("div",{className:"fixed inset-0 bg-black/50 z-[100] flex items-center justify-center p-4 animate-fade-in",children:[e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl max-w-md w-full p-6 animate-slide-up",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-orange-100 flex items-center justify-center",children:e.jsx(Ie,{className:"w-6 h-6 text-orange-500"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Additional Rental"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Paid rental notice"})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors active:scale-95","aria-label":"Close",children:e.jsx(we,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-5 mb-6",children:[e.jsx("p",{className:"text-gray-800 font-medium mb-3",children:"You've already used your free daily power bank rental."}),e.jsx("p",{className:"text-gray-700 text-sm mb-4",children:"Additional rentals will be charged:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500 mt-1.5 flex-shrink-0"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"â‚¬1.00 upfront"})," covers the first 30 minutes"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500 mt-1.5 flex-shrink-0"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"â‚¬1.00 per 30 minutes"})," thereafter"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-orange-500 mt-1.5 flex-shrink-0"}),e.jsxs("p",{className:"text-gray-700",children:[e.jsx("span",{className:"font-semibold text-gray-900",children:"â‚¬5.00 daily cap"})," maximum charge"]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-semibold py-4 rounded-2xl shadow-lg hover:shadow-xl transition-all active:scale-[0.98]",children:"Continue with Payment"}),e.jsx("button",{onClick:s,className:"w-full bg-gray-100 text-gray-700 font-semibold py-4 rounded-2xl hover:bg-gray-200 transition-colors active:scale-[0.98]",children:"Cancel Rental"})]})]}),e.jsx("style",{children:`
        @keyframes fade-in {
          from { opacity: 0; }
          to { opacity: 1; }
        }
        @keyframes slide-up {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        .animate-fade-in {
          animation: fade-in 0.2s ease-out forwards;
        }
        .animate-slide-up {
          animation: slide-up 0.3s ease-out forwards;
        }
      `})]})}function Vs({location:t,isLiked:s,onClose:a,onToggleLike:r,onBookDining:x,isLoadingLike:o,userProfile:m}){var c,l,h;const f=ke(((c=t.coverImageIds)==null?void 0:c[0])||t.logoId||t.image,"merchant",{width:800,height:600}),g=et(t.open_time,t.open_days),p=t.deals&&t.deals.length>0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 z-30",onClick:a}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-4 pb-4 z-40 animate-slideUp",children:e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl overflow-hidden max-w-md mx-auto",children:[e.jsxs("div",{className:"relative h-52 bg-gradient-to-br from-orange-400 to-pink-400",children:[e.jsx("img",{src:f,alt:t.name,className:"w-full h-full object-cover",onError:u=>{const b=u.currentTarget;b.src.includes("unsplash.com")||(b.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop")}}),e.jsx("button",{onClick:r,disabled:o,className:"absolute top-3 right-3 p-2.5 rounded-full transition-all duration-200 bg-white/90 hover:bg-white disabled:opacity-50 shadow-md",children:e.jsx(Ze,{className:`w-5 h-5 transition-all duration-200 ${s?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1 bg-orange-100 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"text-sm font-bold text-orange-600",children:t.rating}),e.jsx("span",{className:"text-orange-400",style:{fontSize:"10px"},children:"â­"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:t.address}),e.jsxs("span",{className:"flex items-center gap-2 ml-auto whitespace-nowrap",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${g?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:g?"Open":"Closed"}),e.jsx("span",{className:"text-sm text-gray-600",children:((h=(l=t.open_time)==null?void 0:l.match(/\d{1,2}:\d{2}\s*[-â€“]\s*\d{1,2}:\d{2}/))==null?void 0:h[0].replace(/\s*[-â€“]\s*/," â€“ "))||"09:00 â€“ 17:00"})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-4 font-medium",children:t.subcategoryName||"Dine | Bites & Drinks"}),p&&e.jsxs("div",{className:"bg-orange-50 rounded-2xl p-4 mb-4",children:[e.jsx("p",{className:"text-sm font-bold text-orange-600 mb-1",children:"Special Offer"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.deals[0].description})]}),e.jsx("button",{onClick:x,className:"w-full bg-[#FFA374] text-white py-3.5 rounded-2xl font-bold hover:bg-[#ff9461] transition-all shadow-md active:scale-[0.98]",children:"Book Now"})]})]})})]})}function Js({location:t,isLiked:s,onClose:a,onToggleLike:r,isLoadingLike:x,userProfile:o}){var P,L;const[m,f]=n.useState(!1),[g,p]=n.useState(!1),[c,l]=n.useState(!1),[h,u]=n.useState(!1),[b,E]=n.useState("flex"),[B,j]=n.useState(!1),v=et(t.open_time,t.open_days),y=t.occupiedSlots||0;t.totalSlots;const d=t.returnSlots||0;n.useEffect(()=>{i()},[]);const i=async()=>{var $;try{const{data:{user:U}}=await J.auth.getUser();if(!U)return;const{data:S}=await J.from("users").select("subscription").eq("id",U.id).single(),{data:I}=await J.from("user_memberships").select("membership_tier, free_rental_used_today, last_free_rental_reset").eq("user_id",U.id).single(),M=(I==null?void 0:I.membership_tier)||(S==null?void 0:S.subscription)||"flex";E(M);const H=new Date().toISOString().split("T")[0],D=(($=I==null?void 0:I.last_free_rental_reset)==null?void 0:$.split("T")[0])!==H;j(D?!1:(I==null?void 0:I.free_rental_used_today)||!1)}catch{E("flex"),j(!1)}},C=async()=>{if(h)return;(b==="silver"||b==="gold")&&B?p(!0):f(!0)},A=()=>{p(!1),l(!0)},w=()=>{p(!1)},F=$=>{l(!1),f(!0)},N=()=>{l(!1)},k=()=>{f(!1),a()};return c?e.jsx(Xt,{onClose:N,onPaymentMethodSelected:F,title:"Select Payment Method",description:"Choose or add a payment method for this rental",userProfile:o}):m?e.jsx(Va,{onClose:k}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 z-30",onClick:a}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-4 pb-4 z-40 animate-slideUp",children:e.jsxs("div",{className:"max-w-md mx-auto relative",children:[e.jsx("button",{onClick:C,disabled:h,className:"absolute -top-[30px] right-[26.5px] w-16 h-16 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 shadow-lg flex items-center justify-center z-30 hover:shadow-xl transition-shadow active:scale-95 disabled:opacity-50",children:e.jsx(gt,{className:"w-7 h-7 text-white"})}),g&&e.jsx(Ja,{onConfirm:A,onCancel:w}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl overflow-hidden relative",style:{background:"radial-gradient(circle at top 3.6px right 59.1px, transparent 38.1px, white 38.6px)",backgroundRepeat:"no-repeat"},children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 py-3 flex justify-center cursor-pointer active:cursor-grabbing z-10",onClick:a,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),e.jsx("div",{className:"absolute top-3 left-4 z-20",children:e.jsx("button",{onClick:r,disabled:x,className:`p-2.5 rounded-full transition-all duration-200 ${s?"bg-red-50 hover:bg-red-100":"bg-gray-100 hover:bg-gray-200"} disabled:opacity-50`,children:e.jsx(Ze,{className:`w-5 h-5 transition-all duration-200 ${s?"fill-red-500 text-red-500":"text-gray-600"}`})})}),e.jsxs("div",{className:"pt-12 px-5 pb-5",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:t.name}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:t.address}),e.jsxs("span",{className:"flex items-center gap-2 ml-auto whitespace-nowrap",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${v?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:v?"Open":"Closed"}),e.jsx("span",{className:"text-sm text-gray-600",children:((L=(P=t.open_time)==null?void 0:P.match(/\d{1,2}:\d{2}\s*[-â€“]\s*\d{1,2}:\d{2}/))==null?void 0:L[0].replace(/\s*[-â€“]\s*/," â€“ "))||"09:00 â€“ 17:00"})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-4 font-medium",children:t.subcategoryName||"Charging Hub"}),e.jsxs("div",{className:"flex items-center gap-2.5 mb-5",children:[e.jsxs("div",{className:"flex-1 bg-cyan-50 border border-cyan-100 rounded-2xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5 font-semibold text-cyan-800",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsxs("span",{className:"text-sm",children:["â‚¬ ",t.unitPrice||"Free"," / ",t.unitMin||"60"," Min"]})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-slate-700",children:[e.jsx(lt,{className:"w-5 h-5 text-orange-400"}),e.jsxs("span",{className:"text-sm",children:[y," PB Available"]})]}),e.jsxs("div",{className:"flex items-center gap-2.5 text-slate-700",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:"w-5 h-5 text-slate-400",children:e.jsx("path",{d:"M19.5 4.5h-15A1.5 1.5 0 003 6v12a1.5 1.5 0 001.5 1.5h15a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5zM9 16.5H6V7.5h3v9zm3.75 0h-3v-9h3v9zm3.75 0h-3v-9h3v9z"})}),e.jsxs("span",{className:"text-sm",children:[d," Return slots"]})]})]}),e.jsx("div",{className:"w-24 h-32 flex-shrink-0 bg-gray-100 rounded-xl overflow-hidden p-3",children:e.jsx("img",{src:"https://dopjawhuylqipltnuydp.supabase.co/storage/v1/object/public/merchant-images/Category_Icons/Charging%20station.png",alt:"Charging Station",className:"w-full h-full object-contain"})})]}),e.jsxs("button",{onClick:()=>{const $=encodeURIComponent(t.address);window.open(`https://www.google.com/maps/search/?api=1&query=${$}`,"_blank")},className:"w-full bg-gradient-to-br from-orange-400 to-orange-500 text-white py-4 rounded-2xl font-bold hover:shadow-xl transition-shadow shadow-lg flex items-center justify-center gap-2.5 text-lg",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"w-6 h-6",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",children:[e.jsx("path",{d:"m12.593 23.258l-.011.002l-.071.035l-.02.004l-.014-.004l-.071-.035q-.016-.005-.024.005l-.004.01l-.017.428l.005.02l.01.013l.104.074l.015.004l.012-.004l.104-.074l.012-.016l.004-.017l-.017-.427q-.004-.016-.017-.018m.265-.113l-.013.002l-.185.093l-.01.01l-.003.011l.018.43l.005.012l.008.007l.201.093q.019.005.029-.008l.004-.014l-.034-.614q-.005-.018-.02-.022m-.715.002a.02.02 0 0 0-.027.006l-.006.014l-.034.614q.001.018.017.024l.015-.002l.201-.093l.01-.008l.004-.011l.017-.43l-.003-.012l-.01-.01z"}),e.jsx("path",{fill:"currentColor",d:"M18 16a3 3 0 1 1 0 6a3 3 0 0 1 0-6M15.5 4a4.5 4.5 0 1 1 0 9h-7a2.5 2.5 0 0 0 0 5H13a1 1 0 1 1 0 2H8.5a4.5 4.5 0 1 1 0-9h7a2.5 2.5 0 0 0 0-5H11a1 1 0 1 1 0-2zM18 18a1 1 0 1 0 0 2a1 1 0 0 0 0-2M6 2a3 3 0 1 1 0 6a3 3 0 0 1 0-6m0 2a1 1 0 1 0 0 2a1 1 0 0 0 0-2"})]})}),e.jsx("span",{children:"Go There"})]})]})]})]})})]})}function Xs({location:t,isLiked:s,onClose:a,onToggleLike:r,onBookDining:x,isLoadingLike:o,userProfile:m}){var U,S,I;const[f,g]=n.useState(!1),[p,c]=n.useState(!1),[l,h]=n.useState(!1),[u,b]=n.useState(!1),[E,B]=n.useState("flex"),[j,v]=n.useState(!1),y=ke(((U=t.coverImageIds)==null?void 0:U[0])||t.logoId||t.image,"merchant",{width:800,height:600}),d=et(t.open_time,t.open_days),i=t.deals&&t.deals.length>0,C=t.occupiedSlots||0;t.totalSlots;const A=t.returnSlots||0;n.useEffect(()=>{w()},[]);const w=async()=>{var M;try{const{data:{user:H}}=await J.auth.getUser();if(!H)return;const{data:T}=await J.from("users").select("subscription").eq("id",H.id).single(),{data:D}=await J.from("user_memberships").select("membership_tier, free_rental_used_today, last_free_rental_reset").eq("user_id",H.id).single(),R=(D==null?void 0:D.membership_tier)||(T==null?void 0:T.subscription)||"flex";B(R);const Z=new Date().toISOString().split("T")[0],V=((M=D==null?void 0:D.last_free_rental_reset)==null?void 0:M.split("T")[0])!==Z;v(V?!1:(D==null?void 0:D.free_rental_used_today)||!1)}catch{B("flex"),v(!1)}},F=async()=>{if(u)return;(E==="silver"||E==="gold")&&j?c(!0):g(!0)},N=()=>{c(!1),h(!0)},k=()=>{c(!1)},P=M=>{h(!1),g(!0)},L=()=>{h(!1)},$=()=>{g(!1),a()};return l?e.jsx(Xt,{onClose:L,onPaymentMethodSelected:P,title:"Select Payment Method",description:"Choose or add a payment method for this rental",userProfile:m}):f?e.jsx(Va,{onClose:$}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"absolute inset-0 bg-black/20 z-30",onClick:a}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 px-4 pb-4 z-40 animate-slideUp",children:e.jsxs("div",{className:"max-w-md mx-auto relative",children:[e.jsx("button",{onClick:F,disabled:u,className:"absolute -top-[23px] right-6 w-14 h-14 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 shadow-lg flex items-center justify-center z-30 hover:shadow-xl transition-shadow active:scale-95 disabled:opacity-50",children:e.jsx(gt,{className:"w-7 h-7 text-white"})}),p&&e.jsx(Ja,{onConfirm:N,onCancel:k}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 left-0 right-0 py-3 flex justify-center cursor-pointer active:cursor-grabbing z-10",onClick:a,children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full"})}),e.jsxs("div",{className:"relative h-52 overflow-hidden",style:{borderTopLeftRadius:"24px",borderTopRightRadius:"24px"},children:[e.jsx("img",{src:y,alt:t.name,className:"w-full h-full object-cover",style:{maskImage:"radial-gradient(circle 28px at calc(100% - 52px) 5px, transparent 28px, black 28.5px)",WebkitMaskImage:"radial-gradient(circle 28px at calc(100% - 52px) 5px, transparent 28px, black 28.5px)"},onError:M=>{const H=M.currentTarget;H.src.includes("unsplash.com")||(H.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop")}}),e.jsx("button",{onClick:r,disabled:o,className:`absolute top-12 left-4 p-2.5 rounded-full transition-all duration-200 ${s?"bg-red-50 hover:bg-red-100":"bg-gray-100 hover:bg-gray-200"} disabled:opacity-50 z-20`,children:e.jsx(Ze,{className:`w-5 h-5 transition-all duration-200 ${s?"fill-red-500 text-red-500":"text-gray-600"}`})})]}),e.jsxs("div",{className:"px-5 pt-4 pb-5",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),t.rating>0&&e.jsxs("div",{className:"flex items-center gap-1 bg-orange-100 px-3 py-1.5 rounded-lg",children:[e.jsx("span",{className:"text-sm font-bold text-orange-600",children:t.rating}),e.jsx("span",{className:"text-orange-400",style:{fontSize:"10px"},children:"â­"})]})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Ce,{className:"w-4 h-4 text-gray-500 flex-shrink-0"}),e.jsx("span",{className:"text-sm text-gray-600 truncate",children:t.address}),e.jsxs("span",{className:"flex items-center gap-2 ml-auto whitespace-nowrap",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold ${d?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:d?"Open":"Closed"}),e.jsx("span",{className:"text-sm text-gray-600",children:((I=(S=t.open_time)==null?void 0:S.match(/\d{1,2}:\d{2}\s*[-â€“]\s*\d{1,2}:\d{2}/))==null?void 0:I[0].replace(/\s*[-â€“]\s*/," â€“ "))||"09:00 â€“ 17:00"})]})]}),e.jsx("div",{className:"text-sm text-gray-600 mb-4 font-medium",children:t.subcategoryName||"Bites | Drinks & Charging"}),e.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[e.jsxs("div",{className:"flex-1 bg-[#E4F5FE] rounded-2xl p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(Ve,{className:"w-5 h-5 text-cyan-700"}),e.jsxs("span",{className:"text-sm text-gray-800 font-medium",children:["â‚¬ ",t.unitPrice||"Free"," / ",t.unitMin||"60"," Min"]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx(lt,{className:"w-5 h-5 text-orange-500"}),e.jsxs("span",{className:"text-sm text-gray-800 font-medium",children:[C," PB Available"]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",className:"w-5 h-5 text-slate-500",children:e.jsx("path",{d:"M19.5 4.5h-15A1.5 1.5 0 003 6v12a1.5 1.5 0 001.5 1.5h15a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5zM9 16.5H6V7.5h3v9zm3.75 0h-3v-9h3v9zm3.75 0h-3v-9h3v9z"})}),e.jsxs("span",{className:"text-sm text-gray-800 font-medium",children:[A," Return slots"]})]})]}),e.jsx("div",{className:"w-24 h-32 flex-shrink-0 bg-gray-100 rounded-xl overflow-hidden p-3",children:e.jsx("img",{src:i&&t.deals&&t.deals.length>0&&t.deals[0].image?t.deals[0].image:"https://dopjawhuylqipltnuydp.supabase.co/storage/v1/object/public/merchant-images/Category_Icons/Charging%20station.png",alt:i&&t.deals&&t.deals.length>0?t.deals[0].title:"Charging Station",className:"w-full h-full object-contain"})})]}),i&&t.deals&&t.deals.length>0&&e.jsxs("div",{className:"bg-orange-50 rounded-2xl p-4 mb-4",children:[e.jsx("p",{className:"text-sm font-bold text-orange-600 mb-1",children:"Special Offer"}),e.jsx("p",{className:"text-sm text-gray-700",children:t.deals[0].description})]}),e.jsx("button",{onClick:x,className:"w-full bg-[#FFA374] text-white py-3.5 rounded-2xl font-bold hover:bg-[#ff9461] transition-all shadow-md active:scale-[0.98]",children:"Book Now"})]})]})]})})]})}function dn({restaurants:t,onRestaurantSelect:s,onNavigateToBookings:a,onOpenMenu:r,onOpenDiscover:x,onOpenPromotions:o,unreadInvitesCount:m=0,userProfile:f}){const{userLocation:g,isLoading:p,refreshLocation:c}=Yt(),[l,h]=n.useState(null),[u,b]=n.useState(!1),[E,B]=n.useState(""),[j,v]=n.useState(t),y=n.useRef(null),d=n.useRef(null),i=n.useRef([]),C=n.useRef(null),A=n.useRef(null),w=n.useRef(null);n.useRef(null);const F=n.useRef(null),N=n.useRef(null),[k,P]=n.useState(null),[L,$]=n.useState(new Set),[U,S]=n.useState(!1),[I,M]=n.useState("checking");n.useRef(!1);const[H,T]=n.useState(!1),D=g?{lat:g.latitude,lng:g.longitude}:null;n.useEffect(()=>{const z=_=>{u&&N.current&&!N.current.contains(_.target)&&(b(!1),B(""))};return document.addEventListener("mousedown",z),()=>{document.removeEventListener("mousedown",z)}},[u]),n.useEffect(()=>{const z=t.filter(ne=>{const X=ne.latitude,re=ne.longitude;return X!=null&&re!==null&&re!==void 0&&!isNaN(X)&&!isNaN(re)&&X!==0&&re!==0});if(z.length>0,!E.trim()){v(z);return}const _=E.toLowerCase().trim(),W=z.filter(ne=>{var oe,Y,ee;const X=((oe=ne.name)==null?void 0:oe.toLowerCase())||"",re=((Y=ne.category)==null?void 0:Y.toLowerCase())||"",te=((ee=ne.address)==null?void 0:ee.toLowerCase())||"";return X.includes(_)||re.includes(_)||te.includes(_)});v(W)},[E,t]),n.useEffect(()=>{if(j.length>0){const z=j.slice(0,15).map(_=>({coverImageIds:_.coverImageIds||void 0,logoId:_.logoId||void 0}));jt(z,15)}},[j]),n.useEffect(()=>{g?(M("granted"),g.accuracy&&P(g.accuracy)):p||M("denied")},[g,p]),n.useEffect(()=>{if(!y.current||!window.google||d.current)return;const z=!!D,_=D,W=k,X=z?_:{lat:52.3676,lng:4.9041},re=z?13:11,te=new window.google.maps.Map(y.current,{center:X,zoom:re,disableDefaultUI:!0,zoomControl:!1,mapTypeControl:!1,streetViewControl:!1,fullscreenControl:!1,rotateControl:!1,gestureHandling:"greedy",clickableIcons:!1,styles:[{featureType:"poi",elementType:"labels",stylers:[{visibility:"off"}]}]});if(d.current=te,T(!0),z&&_){C.current=new window.google.maps.Marker({position:_,map:te,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#4285F4",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2.5},title:"Your Location",zIndex:1e4,optimized:!1}),w.current=new window.google.maps.Circle({map:te,center:_,radius:W||50,strokeColor:"#4285F4",strokeOpacity:.3,strokeWeight:1,fillColor:"#4285F4",fillOpacity:.1,zIndex:9e3}),A.current=new window.google.maps.Marker({position:_,map:te,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:15,fillColor:"#4285F4",fillOpacity:.2,strokeColor:"#4285F4",strokeOpacity:.5,strokeWeight:1},zIndex:9500,optimized:!1}),F.current&&clearInterval(F.current);let oe=15,Y=!0;F.current=setInterval(()=>{if(A.current){Y?(oe+=.5,oe>=25&&(Y=!1)):(oe-=.5,oe<=15&&(Y=!0));const ee=.3-(oe-15)/20*.25;A.current.setIcon({path:window.google.maps.SymbolPath.CIRCLE,scale:oe,fillColor:"#4285F4",fillOpacity:Math.max(ee,.05),strokeColor:"#4285F4",strokeOpacity:Math.max(ee*2,.1),strokeWeight:1})}},50)}},[]),n.useEffect(()=>{if(!d.current||!D||!window.google||C.current)return;C.current=new window.google.maps.Marker({position:D,map:d.current,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:8,fillColor:"#4285F4",fillOpacity:1,strokeColor:"#ffffff",strokeWeight:2.5},title:"Your Location",zIndex:1e4,optimized:!1}),w.current=new window.google.maps.Circle({map:d.current,center:D,radius:k||50,strokeColor:"#4285F4",strokeOpacity:.3,strokeWeight:1,fillColor:"#4285F4",fillOpacity:.1,zIndex:9e3}),A.current=new window.google.maps.Marker({position:D,map:d.current,icon:{path:window.google.maps.SymbolPath.CIRCLE,scale:15,fillColor:"#4285F4",fillOpacity:.2,strokeColor:"#4285F4",strokeOpacity:.5,strokeWeight:1},zIndex:9500,optimized:!1}),F.current&&clearInterval(F.current);let z=15,_=!0;F.current=setInterval(()=>{if(A.current){_?(z+=.5,z>=25&&(_=!1)):(z-=.5,z<=15&&(_=!0));const W=.3-(z-15)/20*.25;A.current.setIcon({path:window.google.maps.SymbolPath.CIRCLE,scale:z,fillColor:"#4285F4",fillOpacity:Math.max(W,.05),strokeColor:"#4285F4",strokeOpacity:Math.max(W*2,.1),strokeWeight:1})}},50),d.current.setCenter(D),d.current.setZoom(13)},[D,k,H]),n.useEffect(()=>{if(!d.current)return;const z=d.current;i.current.forEach(_=>_.setMap(null)),i.current=[],j.forEach(_=>{if(!_.latitude||!_.longitude)return;const W=et(_.open_time,_.open_days);let ne=_.category||"restaurant";(_.businessType==="chargingonly"||_.merchantCategory==="chargingonly")&&(ne="charging_station");const re=ur(ne,W),te=new window.google.maps.Marker({position:{lat:_.latitude,lng:_.longitude},map:z,icon:{url:re,scaledSize:new window.google.maps.Size(36,48),anchor:new window.google.maps.Point(18,48)},title:_.name,zIndex:2e3});te.addListener("click",()=>{h(_),z.panTo({lat:_.latitude,lng:_.longitude})}),i.current.push(te)})},[j,H]),n.useEffect(()=>{(async()=>{if(Ae("USE_EDGE_LIKED_MERCHANTS"))try{const _=await Ue.getLikedMerchants(),W=new Set(_.map(ne=>ne.merchantId||ne.id));$(W)}catch{}})()},[]),n.useEffect(()=>()=>{F.current&&clearInterval(F.current)},[]),n.useEffect(()=>{if(!C.current||!D||!d.current)return;const z=new window.google.maps.LatLng(D.lat,D.lng),_=C.current.getPosition();(!_||Math.abs(_.lat()-z.lat())>1e-5||Math.abs(_.lng()-z.lng())>1e-5)&&(_?(R(C.current,z),A.current&&R(A.current,z)):(C.current.setPosition(z),A.current&&A.current.setPosition(z)),w.current&&(w.current.setCenter(z),k&&w.current.setRadius(k)))},[D,k]);const R=(z,_)=>{const W=z.getPosition();if(!W){z.setPosition(_);return}const ne=W.lat(),X=W.lng(),re=_.lat(),te=_.lng(),oe=800,Y=Date.now(),ee=()=>{const xe=Date.now()-Y,me=Math.min(xe/oe,1),ce=me<.5?2*me*me:1-Math.pow(-2*me+2,2)/2,Le=ne+(re-ne)*ce,pe=X+(te-X)*ce;z.setPosition(new window.google.maps.LatLng(Le,pe)),me<1&&requestAnimationFrame(ee)};ee()},Z=async()=>{if(!l||U)return;const z=l.parentMerchantId||l.id;l.id;const _=L.has(z),W=new Set(L);_?W.delete(z):W.add(z),$(W),S(!0);try{_?await Ue.unlikeMerchant(z):await Ue.likeMerchant(z)}catch{$(L),alert(`Failed to ${_?"unlike":"like"} merchant`)}finally{S(!1)}},O=()=>{l&&s(l)},V=async()=>{if(d.current)try{await c(),D&&(d.current.setCenter(D),d.current.setZoom(16))}catch{D&&(d.current.setCenter(D),d.current.setZoom(15))}},q=z=>{d.current&&z.latitude&&z.longitude&&(d.current.panTo({lat:z.latitude,lng:z.longitude}),d.current.setZoom(15),h(z),B(""))};return e.jsx(e.Fragment,{children:e.jsx("div",{className:"fixed inset-0 bg-gray-50 flex flex-col overflow-hidden",children:e.jsxs("div",{className:"relative flex-1 w-full h-full min-h-0",children:[e.jsx("div",{ref:y,className:"absolute inset-0 w-full h-full"}),e.jsx("div",{className:"absolute top-0 left-0 right-0 z-10",children:e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3",children:[e.jsx("button",{onClick:r,className:"p-2 bg-white/90 backdrop-blur-sm hover:bg-white rounded-full transition-colors flex-shrink-0 shadow-sm",children:e.jsx("img",{src:"/menu-alt-1.svg",alt:"Menu",className:"w-6 h-6"})}),e.jsxs("div",{className:"relative flex-1 min-w-0 max-w-md",ref:N,children:[u?e.jsxs("div",{className:"flex items-center bg-white/90 backdrop-blur-sm rounded-full shadow-sm transition-all duration-300 px-4 py-2 w-full",children:[e.jsx("button",{className:"p-2 hover:bg-gray-100/50 rounded-full transition-colors flex-shrink-0 -ml-2",children:e.jsx(_t,{className:"w-5 h-5 text-gray-400"})}),e.jsx("input",{type:"text",value:E,onChange:z=>B(z.target.value),placeholder:"Search restaurants...",className:"flex-1 outline-none bg-transparent text-gray-700 placeholder-gray-400 ml-2 text-sm min-w-0",autoFocus:!0}),e.jsx("button",{onClick:()=>{B(""),b(!1)},className:"p-1 hover:bg-gray-100 rounded-full transition-colors flex-shrink-0",children:e.jsx(we,{className:"w-4 h-4 text-gray-400"})})]}):e.jsx("button",{onClick:()=>b(!0),className:"p-2 bg-white/90 backdrop-blur-sm hover:bg-white rounded-full transition-colors shadow-sm",children:e.jsx(_t,{className:"w-5 h-5 text-gray-400"})}),E&&j.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white/95 backdrop-blur-sm rounded-2xl shadow-lg max-h-80 overflow-y-auto",children:e.jsxs("div",{className:"p-2",children:[e.jsxs("div",{className:"px-3 py-2 text-xs text-gray-500 font-medium",children:[j.length," ",j.length===1?"result":"results"," found"]}),j.slice(0,10).map(z=>{var _;return e.jsxs("button",{onClick:()=>q(z),className:"w-full text-left px-3 py-3 hover:bg-gray-100/80 rounded-xl transition-colors flex items-start gap-3 group",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg overflow-hidden bg-gray-200 flex-shrink-0",children:e.jsx("img",{src:ke(((_=z.coverImageIds)==null?void 0:_[0])||z.logoId||z.image_url,"merchant",{width:100,height:100}),alt:z.name,className:"w-full h-full object-cover",onError:W=>{const ne=W.currentTarget;ne.src.includes("unsplash.com")||(ne.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=100&h=100&fit=crop")}})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 text-sm group-hover:text-[#00BFA6] transition-colors truncate",children:z.name}),e.jsx("div",{className:"text-xs text-gray-500 mt-0.5 truncate",children:z.category}),z.address&&e.jsxs("div",{className:"text-xs text-gray-400 mt-0.5 truncate flex items-center gap-1",children:[e.jsx(Ce,{className:"w-3 h-3 flex-shrink-0"}),z.address]})]})]},z.id)}),j.length>10&&e.jsxs("div",{className:"px-3 py-2 text-xs text-gray-400 text-center",children:["+",j.length-10," more results"]})]})})]}),e.jsx("button",{onClick:o,className:"p-2 hover:bg-white/20 rounded-full transition-colors flex-shrink-0 bg-[#B2E9E9]",children:e.jsx("img",{src:"/discount.svg",alt:"Discount",className:"w-6 h-6"})})]})}),l&&(()=>{var oe;const z=l.deals&&l.deals.length>0,_=l.hasStation||l.occupiedSlots!==void 0&&l.occupiedSlots>=0,W=(oe=l.partnershipType)==null?void 0:oe.toLowerCase(),ne=l.businessType,X={id:l.id,name:l.name,address:l.address,specialty:l.specialty,coverImageIds:l.coverImageIds,logoId:l.logoId,image:l.image_url,rating:l.rating,reviewCount:l.reviewCount,open_days:l.open_days,open_time:l.open_time,deals:l.deals,occupiedSlots:l.occupiedSlots,totalSlots:l.totalSlots,availableSlots:l.availableSlots,returnSlots:l.returnSlots,hasStation:l.hasStation,subcategoryName:l.subcategoryName,businessType:l.businessType,unitPrice:l.unitPrice,unitMin:l.unitMin},re=()=>{h(null)},te=l.parentMerchantId||l.id;return ne==="chargingonly"||W==="map_chargingonly"?e.jsx(Js,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,isLoadingLike:U,userProfile:f}):ne==="diningandcharging"||W==="map_both"?e.jsx(Xs,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,onBookDining:O,isLoadingLike:U,userProfile:f}):ne==="diningonly"||W==="map_diningonly"?e.jsx(Vs,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,onBookDining:O,isLoadingLike:U,userProfile:f}):_&&!z?e.jsx(Js,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,isLoadingLike:U,userProfile:f}):_&&z?e.jsx(Xs,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,onBookDining:O,isLoadingLike:U,userProfile:f}):e.jsx(Vs,{location:X,isLiked:L.has(te),onClose:re,onToggleLike:Z,onBookDining:O,isLoadingLike:U,userProfile:f})})(),e.jsx(Na,{onDiscoverClick:x,onMapClick:()=>{},onBookingsClick:a,activeView:"map",unreadInvitesCount:m}),e.jsx("div",{className:"absolute bottom-36 right-6 z-30",children:e.jsx("button",{onClick:V,className:"bg-white p-2 rounded-full shadow-2xl hover:shadow-xl transition-all hover:scale-110",children:e.jsx("img",{src:"/location-target-1-remix.svg",alt:"Center Location",className:"w-7 h-7"})})})]})})})}function mn({restaurant:t,userId:s,onBack:a,onBookingComplete:r}){const[x,o]=n.useState(""),[m,f]=n.useState(""),[g,p]=n.useState(2),[c,l]=n.useState("single"),[h,u]=n.useState(!1),[b,E]=n.useState([t]),[B,j]=n.useState(t),[v,y]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const C=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/rest/v1/merchants?select=*&name=eq.${encodeURIComponent(t.name)}`,{headers:{apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co",Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(C.ok){const A=await C.json();A.length>1&&E(A)}}catch{}})()},[t]);const d=async i=>{i.preventDefault(),u(!0);try{alert("Table booking feature will be available once the restaurant has deals. Please use the Discover section to book available deals!"),a()}catch{alert("Failed to create booking. Please try again.")}finally{u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50 via-white to-pink-50 overflow-hidden",children:e.jsxs("div",{className:"h-full overflow-y-auto px-5 py-4 pb-20",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("button",{onClick:a,className:"p-2 hover:bg-white rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Book a Table"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-white rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-700"})})]}),e.jsxs("div",{className:"bg-white rounded-3xl shadow-lg p-6 mb-6",children:[e.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-orange-400 to-pink-400 rounded-2xl mb-4 overflow-hidden flex items-center justify-center",children:[e.jsx("div",{className:"absolute inset-0 bg-black/20"}),e.jsxs("div",{className:"relative z-10 text-center px-6",children:[e.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mb-3 mx-auto shadow-lg",children:e.jsx(Ce,{className:"w-8 h-8 text-orange-500"})}),e.jsx("p",{className:"text-white font-semibold text-lg leading-relaxed",children:B.address||"Address not available"})]})]}),e.jsx("h3",{className:"text-2xl font-bold text-gray-800 mb-2",children:t.name}),b.length>1?e.jsxs("div",{className:"relative",children:[e.jsxs("button",{type:"button",onClick:()=>y(!v),className:"w-full flex items-start gap-2 text-left p-3 bg-gray-50 rounded-xl hover:bg-gray-100 transition-colors",children:[e.jsx(Ce,{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-gray-800 text-sm font-medium",children:B.address}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[b.length," locations available"]})]}),e.jsx(Ut,{className:`w-5 h-5 text-gray-400 flex-shrink-0 mt-0.5 transition-transform ${v?"rotate-180":""}`})]}),v&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-lg border border-gray-200 z-10 max-h-60 overflow-y-auto",children:b.map(i=>e.jsx("button",{type:"button",onClick:()=>{j(i),y(!1)},className:`w-full text-left p-4 hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0 ${B.id===i.id?"bg-orange-50":""}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ce,{className:`w-4 h-4 flex-shrink-0 mt-0.5 ${B.id===i.id?"text-orange-500":"text-gray-400"}`}),e.jsx("p",{className:`text-sm ${B.id===i.id?"text-orange-600 font-medium":"text-gray-700"}`,children:i.address})]})},i.id))})]}):e.jsxs("div",{className:"flex items-start gap-2 p-3 bg-gray-50 rounded-xl",children:[e.jsx(Ce,{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-gray-700 text-sm",children:t.address})]})]}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-5",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 text-gray-700 font-semibold",children:[e.jsx(ct,{className:"w-5 h-5 text-orange-500"}),"Select Date"]}),e.jsx("input",{type:"date",value:x,onChange:i=>o(i.target.value),required:!0,className:"w-full p-3 border border-gray-200 rounded-2xl outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-5",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 text-gray-700 font-semibold",children:[e.jsx(We,{className:"w-5 h-5 text-orange-500"}),"Select Time"]}),e.jsx("input",{type:"time",value:m,onChange:i=>f(i.target.value),required:!0,className:"w-full p-3 border border-gray-200 rounded-2xl outline-none focus:ring-2 focus:ring-orange-500"})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-5",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 text-gray-700 font-semibold",children:[e.jsx(st,{className:"w-5 h-5 text-orange-500"}),"Party Size"]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{type:"button",onClick:()=>p(Math.max(1,g-1)),className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-full font-bold hover:bg-orange-200 transition-colors",children:"-"}),e.jsx("span",{className:"text-2xl font-bold text-gray-800 min-w-[3rem] text-center",children:g}),e.jsx("button",{type:"button",onClick:()=>p(Math.min(20,g+1)),className:"w-12 h-12 bg-orange-100 text-orange-600 rounded-full font-bold hover:bg-orange-200 transition-colors",children:"+"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-sm p-5",children:[e.jsx("label",{className:"text-gray-700 font-semibold mb-3 block",children:"Booking Type"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:()=>l("single"),className:`flex-1 py-3 rounded-[1rem] font-semibold transition-all ${c==="single"?"bg-orange-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Single"}),e.jsx("button",{type:"button",onClick:()=>l("group"),className:`flex-1 py-3 rounded-[1rem] font-semibold transition-all ${c==="group"?"bg-orange-500 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Group"})]})]}),e.jsxs("div",{className:"bg-orange-50 rounded-2xl p-4 border-2 border-orange-200",children:[e.jsx("p",{className:"text-sm font-bold text-orange-800 mb-1",children:"ðŸŽ‰ Special Offer Applied!"}),e.jsx("p",{className:"text-xs text-gray-700",children:"You'll get 2 for 1 on all main courses with this booking"})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gradient-to-r from-orange-500 to-orange-600 text-white py-4 rounded-[1rem] font-bold hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg disabled:opacity-50",children:h?"Booking...":"Confirm Booking"})]})]})})}function Xa({booking:t,restaurant:s,onGoToBookings:a,onExploreMore:r}){const x=o=>new Date(o).toLocaleDateString("en-US",{weekday:"long",day:"numeric",month:"short",year:"2-digit"});return e.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50 via-white to-pink-50 flex items-center justify-center overflow-hidden",children:e.jsxs("div",{className:"w-full max-w-md px-4 flex flex-col h-full",children:[e.jsxs("div",{className:"text-center flex-1 flex flex-col justify-center",children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"text-8xl",children:"ðŸŽ"}),e.jsx("div",{className:"absolute -top-2 -right-2 text-4xl animate-bounce",children:"ðŸŽ‰"}),e.jsx("div",{className:"absolute -bottom-2 -left-2 text-3xl animate-pulse",children:"âœ¨"})]})}),e.jsx("h1",{className:"text-3xl font-bold text-slate-800 mb-4",children:"CONGRATULATIONS!"}),e.jsx("p",{className:"text-gray-600 mb-2",children:"Your booking is confirmed at:"}),e.jsx("h2",{className:"text-3xl font-bold text-orange-400 mb-6",children:s.name}),e.jsx("p",{className:"text-gray-600 mb-8",children:s.address}),e.jsxs("div",{className:"flex justify-center gap-8",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-white rounded-2xl p-3 mb-2 shadow-sm",children:e.jsx(ct,{className:"w-6 h-6 text-orange-400"})}),e.jsx("p",{className:"font-semibold text-slate-800",children:x(t.booking_date).split(" ")[0]}),e.jsx("p",{className:"text-sm text-gray-600",children:x(t.booking_date).split(" ").slice(1).join(" ")})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"bg-white rounded-2xl p-3 mb-2 shadow-sm",children:e.jsx(We,{className:"w-6 h-6 text-orange-400"})}),e.jsx("p",{className:"font-semibold text-slate-800",children:"Time"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.booking_time})]})]})]}),e.jsxs("div",{className:"pb-[30px]",children:[e.jsx("button",{onClick:a,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-[1rem] font-semibold hover:from-orange-500 hover:to-orange-600 transition-all shadow-md mb-4",children:"Go to bookings"}),e.jsx("button",{onClick:r,className:"w-full bg-white text-gray-700 py-4 rounded-[1rem] font-semibold hover:bg-gray-50 transition-all shadow-lg",children:"Explore more!"})]})]})})}const un=[{emoji:"ðŸ˜¡",label:"Terrible",value:1,color:"#EF4444"},{emoji:"ðŸ˜ž",label:"Bad",value:2,color:"#F97316"},{emoji:"ðŸ˜",label:"Okay",value:3,color:"#FBBF24"},{emoji:"ðŸ˜Š",label:"Good",value:4,color:"#10B981"},{emoji:"ðŸ˜",label:"Loved it",value:5,color:"#8B5CF6"}];function hn({merchantId:t,merchantName:s,merchantImage:a,onComplete:r}){const[x,o]=n.useState(0),[m,f]=n.useState(""),[g,p]=n.useState(!1),[c,l]=n.useState(""),[h,u]=n.useState(!1),[b,E]=n.useState(null),[B,j]=n.useState(null),v=n.useRef(null);n.useEffect(()=>{setTimeout(()=>u(!0),10)},[]);const y=()=>{u(!1),setTimeout(r,300)},d=N=>{N.target===N.currentTarget&&y()},i=N=>{E(N.touches[0].clientY)},C=N=>{if(b===null)return;const P=N.touches[0].clientY-b;P>0&&j(P)},A=()=>{B&&B>150&&y(),E(null),j(null)},w=async()=>{if(x===0){l("Please select a rating");return}p(!0),l("");try{Ae("USE_EDGE_REVIEWS")?await Gt.createReview({merchantId:t,rating:x,comment:m.trim()||void 0}):await Ht.createReview({target_type:"merchant",target_id:t,rating:x,comment:m.trim()||void 0}),r()}catch(N){l(N.message||"Failed to submit review")}finally{p(!1)}},F=B!==null?B:0;return e.jsx("div",{className:`fixed inset-0 z-50 flex items-end justify-center transition-colors duration-300 ${h?"bg-black/50":"bg-transparent pointer-events-none"}`,onClick:d,children:e.jsxs("div",{ref:v,className:`w-full max-w-2xl bg-white flex flex-col transition-transform duration-300 ease-out ${h?"translate-y-0":"translate-y-full"}`,style:{transform:`translateY(${F}px)`,height:"90vh",borderTopLeftRadius:"1.5rem",borderTopRightRadius:"1.5rem"},onTouchStart:i,onTouchMove:C,onTouchEnd:A,onClick:N=>N.stopPropagation(),children:[e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto mt-3 mb-2 flex-shrink-0"}),e.jsx("button",{onClick:y,className:"absolute top-4 right-4 z-10 w-8 h-8 flex items-center justify-center rounded-full bg-white/80 backdrop-blur-sm shadow-lg hover:bg-white transition-colors",children:e.jsx(we,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"relative w-full h-64 overflow-hidden flex-shrink-0",children:[a?e.jsx("img",{src:a,alt:s,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-orange-100 to-orange-200"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-white"})]}),e.jsxs("div",{className:"flex-1 bg-white -mt-6 relative z-10 px-6 pt-6 flex flex-col overflow-hidden rounded-t-[1.5rem]",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto pb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-900 text-center mb-1",children:"How did you experience"}),e.jsx("p",{className:"text-lg font-semibold text-orange-500 text-center mb-6",children:s}),e.jsx("div",{className:"flex justify-center gap-[0.45rem] mb-6",children:un.map(N=>e.jsxs("button",{onClick:()=>o(N.value),className:"flex flex-col items-center gap-1 transition-all hover:scale-105 active:scale-95",children:[e.jsx("div",{className:`text-[2.8rem] leading-none transition-all ${x===N.value?"scale-110":"scale-100 opacity-80"}`,children:N.emoji}),x===N.value&&e.jsx("span",{className:"text-xs font-medium text-slate-700 whitespace-nowrap",children:N.label})]},N.value))}),e.jsxs("div",{className:"mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-slate-700 mb-3",children:"Comments"}),e.jsx("textarea",{value:m,onChange:N=>f(N.target.value),placeholder:"Comments",rows:6,className:"w-full px-4 py-3 border-2 border-orange-400 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 resize-none text-sm placeholder:text-gray-400"}),e.jsx("p",{className:"text-xs text-orange-500 mt-1.5",children:"* Optional"})]}),c&&e.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-xl text-sm mb-4",children:c})]}),e.jsx("div",{className:"pb-6 pt-2",children:e.jsx("button",{onClick:w,disabled:g||x===0,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-3.5 rounded-xl font-bold text-base hover:shadow-lg active:scale-[0.98] transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-md",children:g?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):"Submit Review"})})]})]})})}function fn({onContinue:t,onBookingChanged:s,savings:a=0,totalSavings:r=0,merchantId:x,merchantName:o,merchantImage:m}){const[f,g]=n.useState(!1),[p,c]=n.useState(!1),[l,h]=n.useState(!1),[u,b]=n.useState(!0);n.useEffect(()=>{setTimeout(()=>g(!0),100)},[]),n.useEffect(()=>{(async()=>{if(!x){b(!1);return}try{const{data:{user:j}}=await J.auth.getUser();if(!j){b(!1);return}const{data:v}=await J.from("reviews").select("id").eq("user_id",j.id).eq("target_type","merchant").eq("target_id",x).maybeSingle();h(!!v)}catch{}finally{b(!1)}})()},[x]);const E=async()=>{x&&o&&!l&&!u?c(!0):(s&&await s(),t())};return p&&x&&o?e.jsx(hn,{merchantId:x,merchantName:o,merchantImage:m,onComplete:async()=>{s&&await s(),t()}}):e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-orange-50 via-white to-green-50 z-50 flex flex-col items-center justify-between p-6",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("svg",{className:"absolute top-10 left-10 w-32 h-32 text-orange-200 opacity-30",viewBox:"0 0 100 100",children:e.jsx("path",{d:"M10,50 Q30,30 50,50 T90,50",stroke:"currentColor",strokeWidth:"2",fill:"none"})}),e.jsx("svg",{className:"absolute top-20 right-8 w-24 h-24 text-green-200 opacity-30",viewBox:"0 0 100 100",children:e.jsx("path",{d:"M20,50 Q40,20 60,50 T100,50",stroke:"currentColor",strokeWidth:"2",fill:"none"})}),e.jsx("svg",{className:"absolute bottom-32 left-8 w-28 h-28 text-orange-200 opacity-30",viewBox:"0 0 100 100",children:e.jsx("path",{d:"M10,60 Q35,35 60,60 T110,60",stroke:"currentColor",strokeWidth:"2",fill:"none"})}),e.jsx("svg",{className:"absolute bottom-48 right-12 w-20 h-20 text-green-200 opacity-30",viewBox:"0 0 100 100",children:e.jsx("path",{d:"M15,45 Q40,25 65,45 T115,45",stroke:"currentColor",strokeWidth:"2",fill:"none"})})]}),e.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center w-full max-w-md",children:[e.jsxs("div",{className:`relative mb-8 transition-all duration-700 ${f?"scale-100 opacity-100":"scale-50 opacity-0"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-green-400 rounded-full opacity-20 animate-ping",style:{animationDuration:"2s"}}),e.jsx("div",{className:"absolute inset-0 bg-green-300 rounded-full opacity-30 blur-2xl"}),e.jsx("div",{className:"relative w-32 h-32 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center shadow-2xl",children:e.jsx(Qe,{className:"w-20 h-20 text-white",strokeWidth:3})})]}),e.jsx("h1",{className:`text-4xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-orange-400 to-orange-600 mb-6 text-center transition-all duration-700 delay-200 ${f?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,children:"DEAL REDEEMED"}),e.jsxs("p",{className:`text-xl text-gray-700 text-center font-medium leading-relaxed transition-all duration-700 delay-400 ${f?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,children:["Thanks for your visit",e.jsx("br",{}),"welcome back again!"]}),e.jsxs("div",{className:`mt-8 w-full max-w-md bg-white rounded-2xl p-6 shadow-lg transition-all duration-700 delay-500 ${f?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,children:[e.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[e.jsx(h0,{className:"w-6 h-6 text-slate-700"}),e.jsx("h3",{className:"text-lg font-semibold text-slate-800",children:"Money saved"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-4xl font-bold text-green-600 mb-2",children:["â‚¬",r.toFixed(2)]}),a>0&&e.jsxs("div",{className:"text-sm text-gray-600",children:["+â‚¬",a.toFixed(2)," from this booking"]})]})]})]}),e.jsx("button",{onClick:E,className:`w-full max-w-md bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold text-lg py-4 rounded-2xl shadow-lg hover:shadow-xl active:scale-95 transition-all duration-300 ${f?"translate-y-0 opacity-100":"translate-y-4 opacity-0"}`,style:{transitionDelay:"600ms"},children:"Continue"})]})}function Za({onClose:t}){const[s,a]=n.useState(0),[r,x]=n.useState(0),[o,m]=n.useState(!1),f=n.useRef(null),g=h=>{a(h.touches[0].clientY),m(!0)},p=h=>{if(!o)return;const u=h.touches[0].clientY-s;u>0&&x(u)},c=()=>{r>100&&t(),x(0),m(!1)},l=h=>{h.target===h.currentTarget&&t()};return e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50 flex items-end justify-center",onClick:l,children:e.jsx("div",{ref:f,className:"bg-white rounded-t-3xl w-full max-w-md shadow-2xl animate-slide-up",style:{transform:`translateY(${r}px)`,transition:o?"none":"transform 0.3s ease-out"},onTouchStart:g,onTouchMove:p,onTouchEnd:c,children:e.jsxs("div",{className:"px-6 pt-6 pb-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-orange-300 flex items-center justify-center mb-6",children:e.jsx("span",{className:"text-4xl",children:"ðŸ¦‰"})}),e.jsx("h2",{className:"text-xl font-bold text-orange-500 mb-6 text-center",children:"Please note!"}),e.jsxs("div",{className:"space-y-4 mb-6",children:[e.jsx("p",{className:"text-gray-700 text-center text-sm leading-relaxed",children:"All deals are redeemable on-site only; no reservations required."}),e.jsx("p",{className:"text-gray-700 text-center text-sm leading-relaxed",children:"Simply book and visit."})]}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-3.5 rounded-[1rem] transition-all shadow-lg",children:"Got it"})]})})})}function gn({booking:t,onBack:s,onNavigateToMap:a,onBookingChanged:r}){const[x,o]=n.useState(0),[m,f]=n.useState(!1),[g,p]=n.useState(!1),[c,l]=n.useState(0),[h,u]=n.useState(!1),[b,E]=n.useState(0),[B,j]=n.useState("details"),[v,y]=n.useState(0),[d,i]=n.useState(0),[C,A]=n.useState(!1),w=n.useRef(null),F=t.image?[t.image]:[],N=t.status==="complete"||t.status==="completed"||t.status==="cancelled",k=async()=>{try{f(!0);const{data:{session:T}}=await J.auth.getSession();if(!T)throw new Error("Not authenticated");const D=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/bookings/${t.id}/complete`,{method:"POST",headers:{Authorization:`Bearer ${T.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(!D.ok){const V=await D.text();let q="Failed to complete booking";try{q=JSON.parse(V).error||q}catch{q=V||q}throw new Error(q)}const R=await D.json(),Z=R.savings||0,O=R.totalSavings||Z;y(Z),i(O),setTimeout(()=>{j("completed"),f(!1)},500)}catch(T){const D=T instanceof Error?T.message:"Unknown error occurred";alert(`Failed to redeem booking: ${D}

Please try again or contact support.`),f(!1),l(0),u(!1)}},P=async()=>{try{p(!0);const{data:{session:T}}=await J.auth.getSession();if(!T)throw new Error("Not authenticated");const D=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/deals-booking/bookings/${t.id}`,{method:"DELETE",headers:{Authorization:`Bearer ${T.access_token}`,"Content-Type":"application/json",apikey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRvcGphd2h1eWxxaXBsdG51eWRwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA2NDA0NTksImV4cCI6MjA3NjIxNjQ1OX0.l_xbP6PPkTsq82CnFQ6caHFWyKf1fwkvYqBmzpp03Co"}});if(!D.ok){const R=await D.text();throw new Error("Failed to cancel booking")}r&&await r(),setTimeout(()=>{s()},300)}catch{p(!1)}},L=T=>{if(N||m)return;const D=T.touches[0];E(D.clientX),u(!0)},$=T=>{if(!h||!w.current||N||m)return;const D=T.touches[0],Z=w.current.getBoundingClientRect().width-80,O=D.clientX-b,V=Math.max(0,Math.min(O,Z));l(V)},U=()=>{if(!w.current||N||m){u(!1),E(0);return}const T=w.current.getBoundingClientRect(),D=T.width*.75;c>D?(l(T.width-80),k()):l(0),u(!1),E(0)},S=T=>{N||m||(T.preventDefault(),E(T.clientX),u(!0))},I=T=>{if(!h||!w.current||N||m)return;const R=w.current.getBoundingClientRect().width-80,Z=T.clientX-b,O=Math.max(0,Math.min(Z,R));l(O)},M=()=>{if(!w.current||N||m){u(!1),E(0);return}const T=w.current.getBoundingClientRect(),D=T.width*.75;c>D?(l(T.width-80),k()):l(0),u(!1),E(0)};n.useEffect(()=>{if(h)return window.addEventListener("mousemove",I),window.addEventListener("mouseup",M),()=>{window.removeEventListener("mousemove",I),window.removeEventListener("mouseup",M)}},[h,c]);const H=w.current?c/(w.current.getBoundingClientRect().width-80):0;return B==="completed"?e.jsx(fn,{onContinue:s,onBookingChanged:r,savings:v,totalSavings:d,merchantId:t.merchantId,merchantName:t.name,merchantImage:t.image}):e.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto flex flex-col",children:[e.jsxs("div",{className:"relative h-80 bg-gradient-to-br from-gray-100 to-gray-200 flex-shrink-0",children:[t.image?e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx("span",{className:"text-gray-400",children:"No image available"})}),e.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 flex items-center justify-between",children:[e.jsx("button",{onClick:s,className:"w-10 h-10 rounded-full bg-white/90 backdrop-blur-sm flex items-center justify-center hover:bg-white transition-colors shadow-lg",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("button",{onClick:a||s,className:"w-10 h-10 rounded-full bg-white/90 backdrop-blur-sm flex items-center justify-center hover:bg-white transition-colors shadow-lg",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})})]}),F.length>1&&e.jsx("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center gap-1.5",children:F.map((T,D)=>e.jsx("button",{onClick:()=>o(D),className:`w-2 h-2 rounded-full transition-all ${D===x?"bg-white w-6":"bg-white/60"}`},D))})]}),e.jsxs("div",{className:"bg-white rounded-t-[2rem] -mt-6 relative z-10 px-6 pt-6 flex-1 flex flex-col",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 flex-1 pr-4",children:t.name}),e.jsx("button",{onClick:()=>A(!0),className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors flex-shrink-0",children:e.jsx(nt,{className:"w-5 h-5 text-gray-700"})})]}),e.jsxs("div",{className:"flex items-start gap-3 mb-4 bg-gray-50 p-4 rounded-2xl",children:[e.jsx("img",{src:"/9295138671579770860 copy.svg",alt:"Deal info",className:"w-8 h-8 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-base mb-1",children:t.dealTitle||t.deal||"2 for 1 main course"}),t.dealDescription&&e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed",children:t.dealDescription})]})]}),e.jsxs("button",{onClick:()=>{const T=encodeURIComponent(t.address);window.open(`https://www.google.com/maps/search/?api=1&query=${T}`,"_blank")},className:"flex items-center justify-between w-full pl-[15px] pr-0 py-2 transition-colors mb-1",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ce,{className:"w-5 h-5 text-gray-700 flex-shrink-0"}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.address}),t.city&&e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:t.city})]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-[#1e3a5f] text-white px-4 py-2 rounded-full text-sm font-medium flex-shrink-0",children:[e.jsx("span",{children:"Route"}),e.jsx("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 2L4.5 20.29L5.21 21L12 18L18.79 21L19.5 20.29L12 2Z",fill:"currentColor"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-white rounded-2xl",children:[e.jsx(ct,{className:"w-5 h-5 text-gray-700 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Sunday"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.date})]})]}),e.jsxs("div",{className:"flex items-start gap-3 px-4 py-3 bg-white rounded-2xl",children:[e.jsx(We,{className:"w-5 h-5 text-gray-700 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-500 mb-0.5",children:"Time"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:t.time})]})]})]})]}),e.jsxs("div",{className:"flex-shrink-0 pb-[15px] mt-8",children:[e.jsxs("div",{ref:w,className:"w-full rounded-[1.5rem] p-1 relative overflow-hidden mb-4 select-none",style:{background:N?"#9ca3af":m?"linear-gradient(90deg, #86efac 0%, #4ade80 100%)":h?`linear-gradient(90deg, #86efac 0%, #86efac ${H*100}%, #f3f4f6 ${H*100}%, #f3f4f6 100%)`:"#f3f4f6",transition:h?"none":"background 0.3s ease-out",cursor:N?"not-allowed":h?"grabbing":"grab",touchAction:"none"},onTouchStart:L,onTouchMove:$,onTouchEnd:U,onMouseDown:S,children:[e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",style:{opacity:h?Math.max(.3,1-H*1.2):1,transition:h?"opacity 0.1s ease-out":"opacity 0.3s ease-out"},children:e.jsx("span",{className:"text-base font-bold",style:{color:N||m||h&&H>.35?"#ffffff":"#111827",transition:"color 0.2s ease-out"},children:N?t.status==="complete"||t.status==="completed"?"âœ“ Already Redeemed":"âœ— Cancelled":m?"âœ“ Completed!":"Swipe to redeem"})}),e.jsx("div",{className:"relative z-10 w-14 h-14 rounded-2xl flex items-center justify-center pointer-events-none",style:{transform:`translateX(${c}px) scale(${h?1.05:1})`,transition:h?"transform 0.05s ease-out, background-color 0.1s ease-out, box-shadow 0.1s ease-out":"all 0.3s cubic-bezier(0.4, 0, 0.2, 1)",backgroundColor:N?"#6b7280":m?"#22c55e":h&&H>0?`rgb(${Math.floor(255-H*221)}, ${Math.floor(163-H*66)}, ${Math.floor(116-H*22)})`:"rgb(255, 163, 116)",boxShadow:N?"none":m?"0 4px 24px rgba(34, 197, 94, 0.6)":h?`0 4px 20px rgba(${Math.floor(255-H*221)}, ${Math.floor(163-H*66)}, ${Math.floor(116-H*22)}, ${.5+H*.3})`:"0 2px 8px rgba(255, 163, 116, 0.3)"},children:N?t.status==="complete"||t.status==="completed"?e.jsx("svg",{className:"w-7 h-7 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}):e.jsx(we,{className:"w-7 h-7 text-white"}):m?e.jsx("svg",{className:"w-7 h-7 text-white animate-pulse",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}):e.jsx(ra,{className:"w-7 h-7 text-white"})})]}),e.jsxs("button",{onClick:P,disabled:g||m,className:"w-full text-center text-gray-700 font-medium text-base hover:text-gray-900 transition-colors flex items-center justify-center gap-2 py-3 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(we,{className:"w-5 h-5"}),e.jsx("span",{children:g?"Cancelling...":"Cancel this booking"})]})]})]})]})}),C&&e.jsx(Za,{onClose:()=>A(!1)})]})}function pn({bookings:t,onBack:s,onBookingClick:a,onOpenHistory:r}){var w;const[x,o]=he.useState(0),[m,f]=he.useState(null),p=(()=>{const F=new Date,N=F.getDay(),k=new Date(F);k.setDate(F.getDate()-N+x*7);const P=[];for(let L=0;L<7;L++){const $=new Date(k);$.setDate(k.getDate()+L),P.push($)}return P})(),c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],l=()=>x===0?"This week":x===1?"Next week":x===-1?"Last week":x>0?`+${x} weeks`:`${x} weeks`,h=p[0].toLocaleString("default",{month:"long",year:"numeric"}),u=F=>{const N=["bg-orange-100","bg-green-100","bg-blue-100","bg-yellow-100","bg-gray-100","bg-purple-100","bg-pink-100"];return N[F%N.length]},E=(()=>{const F=new Date;F.setHours(0,0,0,0);const k=t.filter(P=>{const L=new Date(P.booking_date);return L.setHours(0,0,0,0),L>=F}).reduce((P,L)=>{const $=new Date(L.booking_date).toDateString();return P[$]||(P[$]=[]),P[$].push(L),P},{});return Object.entries(k).sort(([P],[L])=>new Date(P).getTime()-new Date(L).getTime()).map(([P,L])=>({date:new Date(P),bookings:L.sort(($,U)=>$.booking_time.localeCompare(U.booking_time))}))})(),B=F=>{const N=F.toDateString();return t.some(k=>new Date(k.booking_date).toDateString()===N)},v=m?[{date:m,bookings:(F=>{const N=F.toDateString();return t.filter(k=>new Date(k.booking_date).toDateString()===N).sort((k,P)=>k.booking_time.localeCompare(P.booking_time))})(m)}].filter(F=>F.bookings.length>0):E,y=new Date;y.setHours(0,0,0,0);const d=t.filter(F=>{const N=new Date(F.booking_date);return N.setHours(0,0,0,0),N>=y}),i=d.length,C=d.filter(F=>F.booking_type==="single").length,A=d.filter(F=>F.booking_type==="group").length;return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm",children:e.jsxs("div",{className:"px-4 pt-6 pb-4 flex items-center justify-between",children:[e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("button",{onClick:r,className:"font-medium",style:{color:"#203F55"},children:"History"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"bg-white",style:{borderBottomLeftRadius:"2.5rem",borderBottomRightRadius:"2.5rem"},children:[e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[i," Bookings"]})}),i>0?e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("div",{className:"flex gap-3",children:[E.length>0&&E[0].bookings.length>0&&e.jsxs("div",{className:"bg-orange-100 rounded-2xl p-4 flex-shrink-0 w-[250px] cursor-pointer hover:shadow-md transition-shadow",onClick:()=>a(E[0].bookings[0].id),children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[e.jsx(st,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm line-clamp-1",children:E[0].bookings[0].deal_description||"Booking"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(ct,{className:"w-4 h-4"}),e.jsx("span",{children:"Date"}),e.jsx(We,{className:"w-4 h-4 ml-2"}),e.jsx("span",{children:"Time"})]}),e.jsxs("div",{className:"text-sm mb-3",children:[new Date(E[0].bookings[0].booking_date).toLocaleDateString("en-GB")," ",E[0].bookings[0].booking_time]}),e.jsx("p",{className:"font-bold text-base line-clamp-1",children:((w=E[0].bookings[0].restaurant)==null?void 0:w.name)||"Restaurant"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"bg-yellow-100 rounded-xl p-2.5 text-center w-[90px]",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:i}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Bookings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"bg-pink-100 rounded-xl p-2 text-center flex-1",children:[e.jsx("div",{className:"text-lg font-bold",children:C}),e.jsx("div",{className:"text-[9px] text-gray-600",children:"Single"})]}),e.jsxs("div",{className:"bg-pink-200 rounded-xl p-2 text-center flex-1",children:[e.jsx("div",{className:"text-lg font-bold",children:A}),e.jsx("div",{className:"text-[9px] text-gray-600",children:"Group"})]})]})]})]})}):null,e.jsxs("div",{className:"px-4 flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:l()}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:h})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[x>0&&e.jsxs("button",{onClick:()=>o(x-1),className:"flex items-center gap-1 text-sm font-medium",style:{color:"#203F55"},children:[e.jsx(ye,{size:16}),"Prev"]}),e.jsxs("button",{onClick:()=>o(x+1),className:"flex items-center gap-1 text-sm font-medium",style:{color:"#203F55"},children:["Next",e.jsx(Pe,{size:16})]})]})]}),e.jsx("div",{className:"px-4 grid grid-cols-7 gap-1",children:c.map((F,N)=>{const k=B(p[N]),P=(m==null?void 0:m.toDateString())===p[N].toDateString();return e.jsxs("button",{onClick:()=>{k&&f(P?null:p[N])},className:`${u(N)} rounded-lg px-2 py-2 text-center relative transition-all ${k?"cursor-pointer hover:shadow-md":"cursor-default"} ${P?"ring-2 ring-blue-500":""}`,children:[e.jsx("div",{className:"text-[11px] font-medium text-[#334155]",children:F}),e.jsx("div",{className:"text-sm font-bold text-[#334155]",children:p[N].getDate()}),k&&e.jsx("div",{className:"absolute bottom-1 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"w-1.5 h-1.5 bg-blue-600 rounded-full"})})]},N)})})]}),e.jsxs("div",{className:"px-4 mt-6 pb-28",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-bold text-gray-800",children:"Upcoming plan"}),m&&e.jsx("button",{onClick:()=>f(null),className:"text-xs font-medium text-blue-600 hover:text-blue-700",children:"Clear filter"})]}),v.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No bookings in your calendar."})}):e.jsx("div",{className:"space-y-6",children:v.map((F,N)=>e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-3",children:F.date.toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric",year:"numeric"})}),e.jsx("div",{className:"space-y-2",children:F.bookings.map(k=>{var P,L;return e.jsxs("div",{onClick:()=>a(k.id),className:`p-3 rounded-xl ${k.status==="confirmed"?"bg-pink-100":"bg-green-100"} cursor-pointer hover:shadow-md transition-shadow`,children:[e.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:[k.booking_type==="single"?"Single":"Group"," booking"]}),e.jsx("div",{className:"font-semibold text-sm leading-tight",children:((P=k.restaurant)==null?void 0:P.name)||"Restaurant"}),((L=k.restaurant)==null?void 0:L.address)&&e.jsx("div",{className:"text-xs text-gray-500 mt-0.5 line-clamp-1",children:k.restaurant.address}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:k.booking_time})]},k.id)})})]},N))})]})]})]})}function En({bookings:t,onBack:s,onOpenChat:a,onOpenHistory:r,onBookingClick:x}){var B;const[o,m]=he.useState(0),f=()=>o===0?"This week":o===1?"Next week":o===-1?"Last week":o>0?`+${o} weeks`:`${o} weeks`,p=(()=>{const j=new Date,v=j.getDay(),y=new Date(j);return y.setDate(j.getDate()-v+o*7),y})().toLocaleString("default",{month:"long",year:"numeric"}),c=["https://images.pexels.com/photos/1279330/pexels-photo-1279330.jpeg?auto=compress&cs=tinysrgb&w=800","https://images.pexels.com/photos/1251198/pexels-photo-1251198.jpeg?auto=compress&cs=tinysrgb&w=800","https://images.pexels.com/photos/70497/pexels-photo-70497.jpeg?auto=compress&cs=tinysrgb&w=800"],l=new Date;l.setHours(0,0,0,0);const h=t.filter(j=>{const v=new Date(j.booking_date);return v.setHours(0,0,0,0),v>=l}).sort((j,v)=>{const y=new Date(j.booking_date).getTime()-new Date(v.booking_date).getTime();return y!==0?y:j.booking_time.localeCompare(v.booking_time)}),u=h.length,b=h.filter(j=>j.booking_type==="single").length,E=h.filter(j=>j.booking_type==="group").length;return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm",children:e.jsxs("div",{className:"px-4 pt-6 pb-4 flex items-center justify-between",children:[e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("button",{onClick:r,className:"font-medium",style:{color:"#203F55"},children:"History"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto",children:[e.jsxs("div",{className:"bg-white pb-6",style:{borderBottomLeftRadius:"2.5rem",borderBottomRightRadius:"2.5rem"},children:[e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[u," Bookings"]})}),u>0?e.jsx("div",{className:"px-4 mb-4",children:e.jsxs("div",{className:"flex gap-3",children:[h.length>0&&h[0]&&e.jsxs("div",{className:"bg-orange-100 rounded-2xl p-4 flex-shrink-0 w-[250px] cursor-pointer hover:shadow-md transition-shadow",onClick:()=>x==null?void 0:x(h[0].id),children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-3",children:[e.jsx(st,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm line-clamp-1",children:h[0].deal_description||"Booking"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-2",children:[e.jsx(ct,{className:"w-4 h-4"}),e.jsx("span",{children:"Date"}),e.jsx(We,{className:"w-4 h-4 ml-2"}),e.jsx("span",{children:"Time"})]}),e.jsxs("div",{className:"text-sm mb-3",children:[new Date(h[0].booking_date).toLocaleDateString("en-GB")," ",h[0].booking_time.split(" - ")[0]]}),e.jsx("p",{className:"font-bold text-base line-clamp-1",children:((B=h[0].restaurant)==null?void 0:B.name)||"Restaurant"})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"bg-yellow-100 rounded-xl p-2.5 text-center w-[90px]",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-500",children:u}),e.jsx("div",{className:"text-[10px] text-gray-600",children:"Bookings"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"bg-pink-100 rounded-xl p-2 text-center flex-1",children:[e.jsx("div",{className:"text-lg font-bold",children:b}),e.jsx("div",{className:"text-[9px] text-gray-600",children:"Single"})]}),e.jsxs("div",{className:"bg-pink-200 rounded-xl p-2 text-center flex-1",children:[e.jsx("div",{className:"text-lg font-bold",children:E}),e.jsx("div",{className:"text-[9px] text-gray-600",children:"Group"})]})]})]})]})}):null,e.jsxs("div",{className:"px-4 flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-800",children:f()}),e.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:p})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[o>0&&e.jsxs("button",{onClick:()=>m(o-1),className:"flex items-center gap-1 text-sm font-medium",style:{color:"#203F55"},children:[e.jsx(ye,{size:16}),"Prev"]}),e.jsxs("button",{onClick:()=>m(o+1),className:"flex items-center gap-1 text-sm font-medium",style:{color:"#203F55"},children:["Next",e.jsx(Pe,{size:16})]})]})]})]}),e.jsxs("div",{className:"px-4 mt-6 pb-28",children:[e.jsx("h3",{className:"font-bold text-gray-800 mb-4",children:"Upcoming plan"}),h.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No bookings in your calendar."})}):e.jsx("div",{className:"space-y-4",children:h.map((j,v)=>{var y,d;return e.jsx("div",{className:"bg-white rounded-2xl shadow-sm overflow-hidden cursor-pointer active:scale-[0.98] transition-transform",onClick:()=>x==null?void 0:x(j.id),children:e.jsxs("div",{className:"flex gap-4 p-4",children:[e.jsx("img",{src:j.dealImage?qt(j.dealImage):c[v%c.length],alt:"Food",className:"w-32 h-32 rounded-2xl object-cover",loading:v<2?"eager":"lazy",decoding:"async",onError:i=>{const C=i.currentTarget;!C.src.includes("pexels.com")&&!C.src.includes("unsplash.com")&&(C.src="https://images.pexels.com/photos/1640772/pexels-photo-1640772.jpeg?auto=compress&cs=tinysrgb&w=400")}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-800 mb-1 leading-tight",children:((y=j.restaurant)==null?void 0:y.name)||"Restaurant"}),((d=j.restaurant)==null?void 0:d.address)&&e.jsx("p",{className:"text-xs text-gray-500 mb-2 line-clamp-1",children:j.restaurant.address}),j.deal_description&&e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[e.jsx("span",{className:"font-semibold",children:"Deal:"})," ",j.deal_description]}),e.jsxs("div",{className:"flex gap-4 mb-3",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(ct,{className:"w-5 h-5 text-gray-600 mb-1"}),e.jsx("span",{className:"text-xs text-gray-600",children:new Date(j.booking_date).toLocaleDateString("en-GB",{day:"2-digit",month:"2-digit",year:"numeric"}).replace(/\//g,"-")})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(We,{className:"w-5 h-5 text-gray-600 mb-1"}),e.jsx("span",{className:"text-xs text-gray-600",children:j.booking_time.split(" - ")[0]})]}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(st,{className:"w-5 h-5 text-gray-600 mb-1"}),e.jsx("span",{className:"text-xs text-gray-600",children:j.status})]})]}),e.jsx("button",{className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-2 rounded-[1rem] font-semibold text-sm hover:from-orange-500 hover:to-orange-600 transition-all",children:"Redeem"})]})]})},j.id)})})]})]})]})}function bn({onBack:t,onOpenHistory:s,onInviteCountChange:a}){const[r,x]=n.useState([]),[o,m]=n.useState(!0),[f,g]=n.useState(null),{showToast:p}=qe();n.useEffect(()=>{c()},[]),n.useEffect(()=>{let h;return(async()=>{const{data:{user:b}}=await J.auth.getUser();b&&(h=J.channel("bookings_invites_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"connection_invites",filter:`recipient_user_id=eq.${b.id}`},E=>{const B=E.new;x(j=>{const v=[B,...j];return a==null||a(v.length),v}),p(`New connection request from ${B.sender_name}`,"success")}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"connection_invites",filter:`recipient_user_id=eq.${b.id}`},E=>{const B=E.new;B.status!=="pending"&&x(j=>{const v=j.filter(y=>y.id!==B.id);return a==null||a(v.length),v})}).subscribe())})(),()=>{h&&J.removeChannel(h)}},[a,p]);const c=async()=>{m(!0);try{const h=await Je.getPendingInvites();h.success?(x(h.invites),a==null||a(h.invites.length)):p(h.error||"Failed to load invites","error")}catch{p("Failed to load invites","error")}finally{m(!1)}},l=async(h,u)=>{g(h);try{const b=await Je.respondToInvite(h,u);if(b.success){p(u==="accept"?"Connection established!":"Invite ignored","success");const E=r.filter(B=>B.id!==h);x(E),a==null||a(E.length)}else p(b.error||`Failed to ${u} invite`,"error")}catch{p(`Failed to ${u} invite`,"error")}finally{g(null)}};return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm",children:e.jsxs("div",{className:"px-4 pt-6 pb-4 flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("button",{onClick:s,className:"font-medium",style:{color:"#203F55"},children:"History"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:e.jsx("div",{className:"px-4 mt-6 pb-6",children:o?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):r.length===0?e.jsx("div",{className:"flex items-center justify-center py-16 px-6",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"40",height:"40",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-400 mx-auto mb-3",children:[e.jsx("path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"}),e.jsx("circle",{cx:"9",cy:"7",r:"4"}),e.jsx("path",{d:"M22 21v-2a4 4 0 0 0-3-3.87"}),e.jsx("path",{d:"M16 3.13a4 4 0 0 1 0 7.75"})]}),e.jsx("p",{className:"text-gray-600 text-base font-medium mb-1",children:"No New Invites"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Connection invites will appear here when friends send them."})]})}):e.jsx("div",{className:"space-y-3",children:r.map(h=>e.jsxs("div",{className:"bg-white rounded-2xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-orange-400 to-pink-500 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg font-bold",children:h.sender_name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm text-gray-900 mb-1",children:[e.jsx("span",{className:"font-bold",children:h.sender_name})," sent you a connection request"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"font-semibold",children:"Link ID:"})," ",h.sender_link_id]}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:new Date(h.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>l(h.id,"accept"),disabled:f===h.id,className:"flex-1 bg-[#FF8C5A] text-white py-2.5 rounded-xl font-semibold hover:bg-[#FF7A42] transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f===h.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"w-4 h-4"}),"Accept"]})}),e.jsx("button",{onClick:()=>l(h.id,"ignore"),disabled:f===h.id,className:"flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-xl font-semibold hover:bg-gray-200 transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f===h.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Cs,{className:"w-4 h-4"}),"Ignore"]})})]})]},h.id))})})})]})}function yn({onBack:t,onOpenHistory:s,onMerchantClick:a,likedMerchants:r,setLikedMerchants:x,isLoading:o}){const{userLocation:m}=Yt(),f=c=>{if(!m||!c.latitude||!c.longitude)return null;const l=ot(m.latitude,m.longitude,c.latitude,c.longitude);return`${Math.round(l)}km`},g=(c,l)=>{if(!c||!l)return"";let h=l;const u=h.match(/(\d{1,2}:\d{2})\s*[-â€“]\s*(\d{1,2}:\d{2})/);u&&(h=`${u[1]} â€“ ${u[2]}`);const b=c.toLowerCase().split(",").map(y=>y.trim()).filter(y=>y.length>2);if(b.length===0)return h||"";const E={sun:"Sun",sunday:"Sun",mon:"Mon",monday:"Mon",tue:"Tue",tuesday:"Tue",wed:"Wed",wednesday:"Wed",thu:"Thu",thursday:"Thu",fri:"Fri",friday:"Fri",sat:"Sat",saturday:"Sat"},B=b.map(y=>E[y]).filter(Boolean);if(B.length===0)return h||"";if(B.length===1)return`${B[0]}, ${h}`;const j=B[0],v=B[B.length-1];return`${j} â€“ ${v}, ${h}`},p=async(c,l)=>{l.stopPropagation();try{await Ue.unlikeMerchant(c),x(h=>h.filter(u=>u.id!==c))}catch{}};return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm",children:e.jsxs("div",{className:"px-4 pt-6 pb-4 flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:s,className:"font-medium",style:{color:"#203F55"},children:"History"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):r.length===0?e.jsx("div",{className:"flex items-center justify-center h-64 px-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ze,{className:"w-10 h-10 text-gray-400 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 text-base font-medium mb-1",children:"No liked places yet"}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Start exploring and save your favorites"})]})}):e.jsx("div",{className:"px-4 py-3 space-y-3",children:r.map(c=>{var u;const l=((u=c.coverImageIds)==null?void 0:u[0])||c.logoId,h=_e(l);return e.jsxs("div",{onClick:()=>a==null?void 0:a(c),className:"bg-white rounded-3xl shadow-sm hover:shadow-md transition-shadow cursor-pointer p-3 flex gap-3",children:[e.jsxs("div",{className:"relative w-28 h-28 flex-shrink-0",children:[e.jsx("div",{className:"w-full h-full rounded-2xl bg-gradient-to-br from-gray-100 to-gray-200 overflow-hidden",children:e.jsx("img",{src:h,alt:c.companyName,className:"w-full h-full object-cover",onError:b=>{b.currentTarget.style.display="none"}})}),e.jsx("button",{onClick:b=>p(c.id,b),className:"absolute top-2 left-2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md hover:shadow-lg transition-all z-10",children:e.jsx(Ze,{className:"w-4 h-4 fill-red-500 text-red-500"})})]}),e.jsxs("div",{className:"flex-1 min-w-0 py-1",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-1.5 line-clamp-1",children:c.companyName}),e.jsxs("div",{className:"flex items-center gap-1.5 text-xs mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(tt,{className:"w-3.5 h-3.5 fill-orange-500 text-orange-500"}),e.jsx("span",{className:"font-semibold text-slate-900",children:c.rating.toFixed(1)})]}),f(c)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("span",{className:"font-semibold text-slate-900",children:f(c)})]}),e.jsx("span",{className:"text-gray-400",children:"|"}),e.jsx("span",{className:"text-gray-700 capitalize truncate",children:c.businessCategory})]}),e.jsxs("div",{className:"flex items-start gap-1 text-xs text-gray-600 mb-1.5",children:[e.jsx(Ce,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5 text-gray-500"}),e.jsx("span",{className:"line-clamp-1",children:c.address})]}),c.openDays&&c.openTime&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[e.jsx(We,{className:"w-3.5 h-3.5 flex-shrink-0"}),e.jsx("span",{children:g(c.openDays,c.openTime)})]})]})]},c.id)})})})]})}function Cn({onBack:t,onMerchantClick:s}){const{userLocation:a}=Yt(),[r,x]=n.useState([]),[o,m]=n.useState(!0);n.useEffect(()=>{g()},[]);const f=c=>{if(!a||!c.latitude||!c.longitude)return null;const l=ot(a.latitude,a.longitude,c.latitude,c.longitude);return`${Math.round(l)}km`},g=async()=>{try{if(m(!0),Ae("USE_EDGE_LIKED_MERCHANTS")){const c=await Ue.getLikedMerchants();x(c)}}catch{}finally{m(!1)}},p=async(c,l)=>{l.stopPropagation();try{await Ue.unlikeMerchant(c),x(h=>h.filter(u=>u.id!==c))}catch{}};return e.jsxs("div",{className:"h-full bg-gray-50 flex flex-col",children:[e.jsx("div",{className:"sticky top-0 z-10 bg-white shadow-sm",children:e.jsxs("div",{className:"px-4 pt-6 pb-4 flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("h1",{className:"text-xl font-bold text-slate-900 flex-1 text-center",children:"Liked"}),e.jsx("button",{className:"font-medium text-sm",style:{color:"#203F55"},children:"History"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto bg-white",children:o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):r.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ze,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"No liked places yet"}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Start exploring and save your favorites"})]})}):e.jsx("div",{className:"divide-y divide-gray-100",children:r.map(c=>e.jsx("div",{onClick:()=>s==null?void 0:s(c),className:"hover:bg-gray-50 transition-colors cursor-pointer",children:e.jsxs("div",{className:"p-4 flex gap-3",children:[e.jsx("div",{className:"relative w-24 h-24 bg-gray-200 rounded-2xl flex-shrink-0",children:e.jsx("button",{onClick:l=>p(c.id,l),className:"absolute top-2 left-2 w-8 h-8 bg-white rounded-full flex items-center justify-center shadow-md hover:shadow-lg transition-shadow",children:e.jsx(Ze,{className:"w-4 h-4 fill-red-500 text-red-500"})})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-1.5",children:c.companyName}),e.jsxs("div",{className:"flex items-center gap-1.5 mb-1.5",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(tt,{className:"w-3.5 h-3.5 fill-orange-500 text-orange-500"}),e.jsx("span",{className:"text-xs font-medium text-slate-900",children:c.rating.toFixed(1)})]}),f(c)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-gray-400",children:"|"}),e.jsx("span",{className:"text-xs font-medium text-slate-900",children:f(c)})]}),e.jsx("span",{className:"text-xs text-gray-400",children:"|"}),e.jsx("span",{className:"text-xs text-gray-600 capitalize truncate",children:c.businessCategory})]}),e.jsxs("div",{className:"flex items-start gap-1.5 mb-1.5",children:[e.jsx(Ce,{className:"w-3.5 h-3.5 flex-shrink-0 mt-0.5 text-gray-500"}),e.jsx("span",{className:"text-xs text-gray-600 line-clamp-1",children:c.address})]}),c.openDays&&c.openTime&&e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("span",{className:"lowercase",children:c.openDays})," â€¢ ",c.openTime]})]})]})},c.id))})})]})}function wn({bookings:t,onBack:s,onBookingClick:a,onOpenChat:r,onOpenHistory:x,onRestaurantSelect:o,initialView:m="week",onNavigateToDiscover:f,onNavigateToMap:g,onInviteCountChange:p}){const[c,l]=n.useState(m),[h,u]=n.useState(0),[b,E]=n.useState([]),[B,j]=n.useState(!1),[v,y]=n.useState(!1);n.useEffect(()=>{c==="liked"&&!B&&d()},[c,B]);const d=async()=>{try{if(y(!0),Ae("USE_EDGE_LIKED_MERCHANTS")){const i=await Ue.getLikedMerchants();E(i),j(!0)}}catch{}finally{y(!1)}};return e.jsxs("div",{className:"fixed inset-0 bg-gray-50",children:[e.jsxs("div",{className:"h-full",children:[c==="week"&&e.jsx(pn,{bookings:t,onBack:s,onBookingClick:a,onOpenHistory:x}),c==="list"&&e.jsx(En,{bookings:t,onBack:s,onOpenChat:r,onOpenHistory:x,onBookingClick:a}),c==="invites"&&e.jsx(bn,{onBack:s,onOpenHistory:x,onInviteCountChange:p}),c==="liked"&&e.jsx(yn,{onBack:s,onOpenHistory:x,likedMerchants:b,setLikedMerchants:E,isLoading:v,onMerchantClick:async i=>{var C,A;if(o)try{const w=Ae("USE_EDGE_MERCHANTS")?await mt.getMerchantById(i.id):await dt.getMerchantById(i.id),F=xt(w.address||"",w.city),N=w.specialty&&w.specialty.length>0?w.specialty:[],k=(C=w.coverImageIds)!=null&&C[0]?_e(w.coverImageIds[0]):w.logoId?_e(w.logoId):"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop",P=et(w.openTime,w.openDays),L={id:w.id,name:w.name,specialty:N,city:F,status:P?"Open":"Closed",image:k,address:w.address,rating:w.rating||0,reviewCount:w.reviewCount||0,deals:w.deals||[],latitude:w.latitude,longitude:w.longitude,coverImageIds:w.coverImageIds,logoId:w.logoId,open_days:w.openDays,open_time:w.openTime,businessType:w.businessType,subcategoryName:w.subcategoryName,availableSlots:w.availableSlots,occupiedSlots:w.occupiedSlots,totalSlots:w.totalSlots,returnSlots:w.returnSlots,unitPrice:w.unitPrice,unitMin:w.unitMin,parentMerchantId:w.parentMerchantId};o(L)}catch{const F=xt(i.address||"",i.city),N=i.businessCategory?[i.businessCategory]:["Restaurant"],k=(A=i.coverImageIds)!=null&&A[0]?_e(i.coverImageIds[0]):i.logoId?_e(i.logoId):"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop",P=et(i.openTime,i.openDays),L={id:i.id,name:i.companyName,specialty:N,city:F,status:P?"Open":"Closed",image:k,address:i.address,rating:i.rating||0,reviewCount:0,deals:[],latitude:i.latitude,longitude:i.longitude,coverImageIds:i.coverImageIds,logoId:i.logoId,open_days:i.openDays,open_time:i.openTime,subcategoryName:i.subcategoryName};o(L)}}}),c==="liked-history"&&e.jsx(Cn,{onBack:s,onMerchantClick:async i=>{var C,A;if(o)try{const w=Ae("USE_EDGE_MERCHANTS")?await mt.getMerchantById(i.id):await dt.getMerchantById(i.id),F=xt(w.address||"",w.city),N=w.specialty&&w.specialty.length>0?w.specialty:[],k=(C=w.coverImageIds)!=null&&C[0]?_e(w.coverImageIds[0]):w.logoId?_e(w.logoId):"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop",P=et(w.openTime,w.openDays),L={id:w.id,name:w.name,specialty:N,city:F,status:P?"Open":"Closed",image:k,address:w.address,rating:w.rating||0,reviewCount:w.reviewCount||0,deals:w.deals||[],latitude:w.latitude,longitude:w.longitude,coverImageIds:w.coverImageIds,logoId:w.logoId,open_days:w.openDays,open_time:w.openTime,businessType:w.businessType,subcategoryName:w.subcategoryName,availableSlots:w.availableSlots,occupiedSlots:w.occupiedSlots,totalSlots:w.totalSlots,returnSlots:w.returnSlots,unitPrice:w.unitPrice,unitMin:w.unitMin,parentMerchantId:w.parentMerchantId};o(L)}catch{const F=xt(i.address||"",i.city),N=i.businessCategory?[i.businessCategory]:["Restaurant"],k=(A=i.coverImageIds)!=null&&A[0]?_e(i.coverImageIds[0]):i.logoId?_e(i.logoId):"https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=800&h=600&fit=crop",P=et(i.openTime,i.openDays),L={id:i.id,name:i.companyName,specialty:N,city:F,status:P?"Open":"Closed",image:k,address:i.address,rating:i.rating||0,reviewCount:0,deals:[],latitude:i.latitude,longitude:i.longitude,coverImageIds:i.coverImageIds,logoId:i.logoId,open_days:i.openDays,open_time:i.openTime,subcategoryName:i.subcategoryName};o(L)}}})]}),e.jsx("div",{className:"fixed bottom-5 left-6 right-6 z-20",children:e.jsxs("div",{className:"bg-white rounded-full shadow-2xl px-6 py-3 flex justify-around items-center max-w-md mx-auto",children:[e.jsx("button",{onClick:()=>l("list"),className:`p-3 hover:bg-gray-100 rounded-full transition-colors ${c==="list"?"text-slate-800":"text-gray-400"}`,children:e.jsx(ct,{className:"w-6 h-6"})}),e.jsx("button",{onClick:()=>l("week"),className:`p-3 hover:bg-gray-100 rounded-full transition-colors ${c==="week"?"text-slate-800":"text-gray-400"}`,children:e.jsx(f0,{className:"w-6 h-6"})}),e.jsxs("button",{onClick:()=>l("invites"),className:`p-3 hover:bg-gray-100 rounded-full transition-colors relative ${c==="invites"?"text-slate-800":"text-gray-400"}`,children:[e.jsx(st,{className:"w-6 h-6"}),h>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-semibold",children:h})]}),e.jsx("button",{onClick:()=>l("liked"),className:`p-3 hover:bg-gray-100 rounded-full transition-colors ${c==="liked"?"text-slate-800":"text-gray-400"}`,children:e.jsx(Ze,{className:"w-6 h-6"})})]})})]})}function Qa({onClose:t,onCloseToMap:s}){return e.jsxs("div",{className:"fixed inset-0 bg-white z-50 flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"bg-white border-b border-gray-200 px-4 py-4 flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(ye,{className:"w-6 h-6 text-gray-700"})}),e.jsx("h2",{className:"text-lg font-bold text-gray-800",children:"Support"}),e.jsx("button",{onClick:s||t,className:"p-2 hover:bg-gray-100 rounded-full",children:e.jsx(we,{className:"w-6 h-6 text-gray-700"})})]}),e.jsx("div",{className:"flex-1 overflow-hidden relative",children:e.jsx("iframe",{src:"https://chat.pawatasty.com?aid=b776b517-1e6b-4034-9559-ff823819883a&lang=en",className:"w-full border-0 absolute top-[-120px] left-0 right-0",style:{height:"calc(100% + 120px)"},title:"Support Chat",allow:"microphone; camera"})})]})}const ks=n.memo(({imagePath:t,userName:s,className:a="",size:r="medium"})=>{const[x,o]=n.useState(null),[m,f]=n.useState(!1);n.useEffect(()=>{if(!t){o(null);return}const c=pa(t);o(c),f(!1)},[t]);const g=()=>{switch(r){case"small":return"text-sm";case"large":return"text-3xl";default:return"text-2xl"}},p=(s==null?void 0:s.charAt(0).toUpperCase())||"G";return!x||m?e.jsx("span",{className:`text-white font-bold ${g()} ${a}`,children:p}):e.jsx("img",{src:x,alt:s,className:`w-full h-full object-cover ${a}`,loading:"lazy",onError:()=>f(!0),crossOrigin:"anonymous"})});ks.displayName="CachedProfileImage";const ps="menu_promo_content",vn=30*60*1e3,Zs=()=>{try{const t=sessionStorage.getItem(ps);if(t){const{promos:s,timestamp:a}=JSON.parse(t);if(Date.now()-a<vn)return s;sessionStorage.removeItem(ps)}}catch{}return null},Bn=t=>{try{sessionStorage.setItem(ps,JSON.stringify({promos:t,timestamp:Date.now()}))}catch{}};function jn({isOpen:t,onClose:s,onOpenPromotions:a,onOpenMembership:r,onOpenHistory:x,onOpenHelpCenter:o,onOpenSettings:m,onOpenProfile:f,onOpenLinkId:g,onOpenConnectionInvites:p,onOpenFriendsList:c,connectionInvitesCount:l,connectionsCount:h,userProfile:u}){const[b,E]=n.useState(()=>Zs()||[]),[B,j]=n.useState(0),[v,y]=n.useState(!1);n.useEffect(()=>{(async()=>{const C=Zs();if(!(C&&C.length>0))try{const A=await ba.getActivePromos();A.success&&A.promos&&(E(A.promos),j(0),Bn(A.promos))}catch{}})()},[]);const d=b[B];return t?e.jsx("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto px-4 sm:px-6 py-4 sm:py-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 sm:mb-6",children:[e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})}),e.jsx("button",{onClick:g,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",className:"text-gray-800",children:e.jsx("path",{fill:"currentColor",d:"M4 4h6v6H4zm16 0v6h-6V4zm-6 11h2v-2h-2v-2h2v2h2v-2h2v2h-2v2h2v3h-2v2h-2v-2h-3v2h-2v-4h3zm2 0v3h2v-3zM4 20v-6h6v6zM6 6v2h2V6zm10 0v2h2V6zM6 16v2h2v-2zm-2-5h2v2H4zm5 0h4v4h-2v-2H9zm2-5h2v4h-2zM2 2v4H0V2a2 2 0 0 1 2-2h4v2zm20-2a2 2 0 0 1 2 2v4h-2V2h-4V0zM2 18v4h4v2H2a2 2 0 0 1-2-2v-4zm20 4v-4h2v4a2 2 0 0 1-2 2h-4v-2z"})})})]}),e.jsxs("div",{className:"flex items-center gap-3 sm:gap-4 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:`w-14 h-14 sm:w-16 sm:h-16 rounded-full flex items-center justify-center overflow-hidden ${u!=null&&u.profile_picture?"":"bg-gradient-to-br from-orange-400 to-pink-500"}`,children:e.jsx(ks,{imagePath:u==null?void 0:u.profile_picture,userName:(u==null?void 0:u.full_name)||"Guest",size:"medium"})}),e.jsx("div",{className:"absolute bottom-0 right-0 w-5 h-5 sm:w-6 sm:h-6 bg-orange-500 rounded-full flex items-center justify-center border-2 border-white",children:e.jsx("span",{className:"text-white text-[10px] sm:text-xs font-bold",children:(u==null?void 0:u.current_level)||1})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h2",{className:"text-lg sm:text-xl font-bold text-gray-800",children:["Hi ",(u==null?void 0:u.full_name)||"Guest"]}),(h>0||l>0)&&e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[h>0&&e.jsxs("span",{className:"text-xs text-gray-600",children:[h," Connection",h!==1?"s":""]}),h>0&&l>0&&e.jsx("span",{className:"text-xs text-gray-400",children:"â€¢"}),l>0&&e.jsxs("span",{className:"text-xs text-gray-600",children:[l," Pending Invite",l!==1?"s":""]})]})]})]}),e.jsxs("div",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:(u==null?void 0:u.current_level)||1}),e.jsx("div",{className:"flex-1 h-3 bg-[#EFEFEF] rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-[#FFA374] rounded-full transition-all duration-300",style:{width:`${Math.min((((u==null?void 0:u.current_level)||1)-1)/4*100,100)}%`}})}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-gray-800",children:"5"})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1 pl-6",children:(u==null?void 0:u.current_level)===5?"You have reached the maximum level!":`Charge and dine more to reach level ${((u==null?void 0:u.current_level)||1)+1}!`})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2.5 sm:gap-3 mb-4 sm:mb-6",children:[e.jsxs("div",{className:"bg-[#FBE6F5] rounded-2xl p-4 sm:p-5 flex flex-col items-center justify-center min-h-[80px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ds,{className:"w-6 h-6 text-[#203F55]"}),e.jsx("span",{className:"text-xl sm:text-2xl font-bold text-[#203F55]",children:(u==null?void 0:u.available_points)??(u==null?void 0:u.total_points)??(u==null?void 0:u.points_count)??0})]}),e.jsx("p",{className:"text-xs sm:text-sm text-[#203F55]",children:"Credit points"})]}),e.jsxs("div",{className:"bg-[#E4F5FE] rounded-2xl p-4 sm:p-5 flex flex-col items-center justify-center min-h-[80px]",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("img",{src:"/wallet-bold.svg",alt:"Wallet",className:"w-6 h-6",style:{filter:"brightness(0) saturate(100%) invert(18%) sepia(14%) saturate(1366%) hue-rotate(158deg) brightness(95%) contrast(89%)"}}),e.jsxs("span",{className:"text-xl sm:text-2xl font-bold text-[#203F55]",children:["â‚¬",u!=null&&u.total_savings?parseFloat(String(u.total_savings)).toFixed(2):u!=null&&u.total_savings_amount?parseFloat(u.total_savings_amount).toFixed(2):"0.00"]})]}),e.jsx("p",{className:"text-xs sm:text-sm text-[#203F55]",children:"Money saved"})]})]}),b.length>0&&d&&e.jsx("div",{className:"bg-gradient-to-br from-slate-700 to-slate-800 rounded-2xl p-3 sm:p-4 mb-4 sm:mb-6 relative overflow-hidden",children:e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2 gap-2",children:[e.jsx("h3",{className:"text-white font-bold text-base sm:text-lg flex-1 line-clamp-1",children:d.promo_title}),e.jsx("button",{onClick:()=>{B<b.length-1?j(B+1):j(0)},className:"p-1.5 bg-white/10 hover:bg-white/20 rounded-full transition-colors flex-shrink-0",children:e.jsx(Pe,{className:"w-4 h-4 text-white"})})]}),d.content_type==="text"&&d.text_content&&e.jsx("p",{className:"text-gray-300 text-sm sm:text-base mb-2 line-clamp-2",children:d.text_content}),d.content_type==="image"&&d.image_url&&e.jsx("img",{src:d.image_url,alt:d.promo_title,className:"w-full h-24 object-cover rounded-lg mb-2"}),b.length>1&&e.jsx("div",{className:"flex gap-1.5 justify-center mt-1",children:b.map((i,C)=>e.jsx("button",{onClick:()=>j(C),className:`w-1.5 h-1.5 rounded-full transition-colors ${C===B?"bg-white":"bg-white/30"}`},C))})]})}),e.jsxs("nav",{className:"space-y-1 pb-4",children:[e.jsxs("button",{onClick:a,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ds,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Promotions"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),l>0&&e.jsxs("button",{onClick:p,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(na,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Connection Invites"}),e.jsx("span",{className:"bg-[#FF8C5A] text-white text-xs font-bold px-2 py-0.5 rounded-full min-w-[20px] text-center",children:l})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),e.jsxs("button",{onClick:r,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Memberships"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),e.jsxs("button",{onClick:x,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(We,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"History"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),e.jsxs("button",{className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g0,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Quick tutorial"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),e.jsxs("button",{onClick:o,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vs,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Help center"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]}),e.jsxs("button",{onClick:m,className:"w-full flex items-center justify-between p-3 sm:p-4 hover:bg-gray-50 rounded-[1rem] transition-colors group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p0,{className:"w-5 h-5 text-gray-600 group-hover:text-gray-800"}),e.jsx("span",{className:"font-semibold text-gray-800",children:"Settings"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400 group-hover:text-gray-600"})]})]})]})})}):null}function An({onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full shadow-2xl animate-slide-up",children:[e.jsx("div",{className:"pt-3 pb-2",children:e.jsx("div",{onClick:t,className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto cursor-pointer active:cursor-grabbing"})}),e.jsxs("div",{className:"px-6 pb-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-orange-100 flex items-center justify-center mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-orange-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Please enter a promo code."}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-3.5 rounded-[1rem] transition-all shadow-lg mt-6",children:"OK, Got it"})]})]})})}function Nn({onClose:t}){const[s,a]=n.useState(!1),[r,x]=n.useState(0),[o,m]=n.useState(0),[f,g]=n.useState(!1),p=n.useRef(null);n.useEffect(()=>{setTimeout(()=>a(!0),10)},[]);const c=()=>{a(!1),setTimeout(t,300)},l=b=>{x(b.touches[0].clientY),g(!0)},h=b=>{if(!f)return;const E=b.touches[0].clientY-r;E>0&&m(E)},u=()=>{g(!1),o>100?c():m(0)};return e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-end justify-center",onClick:c,children:[e.jsx("div",{className:`absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300 ${s?"opacity-100":"opacity-0"}`}),e.jsxs("div",{ref:p,className:`relative bg-white rounded-t-[2rem] w-full max-w-md shadow-2xl transition-transform duration-300 ease-out ${s?"translate-y-0":"translate-y-full"}`,style:{transform:f?`translateY(${o}px)`:void 0,transition:f?"none":void 0},onClick:b=>b.stopPropagation(),onTouchStart:l,onTouchMove:h,onTouchEnd:u,children:[e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto mt-4 mb-2"}),e.jsx("div",{className:"px-8 pb-8 pt-4",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-orange-300 to-orange-400 rounded-full flex items-center justify-center mb-6 shadow-lg",children:e.jsx("span",{className:"text-5xl",children:"ðŸ˜¢"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400 mb-4 text-center",children:"Oops, Activation failed!"}),e.jsx("p",{className:"text-gray-700 text-center mb-8 leading-relaxed",children:"This promo code is valid only for new users within 24 hours of joining."}),e.jsx("button",{onClick:c,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-[1rem] font-bold text-lg hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg active:scale-95",children:"Got It"})]})})]})]})}function Fn({onClose:t,pointsEarned:s=25}){const[a,r]=n.useState(!1),[x,o]=n.useState(0),[m,f]=n.useState(0),[g,p]=n.useState(!1),c=n.useRef(null);n.useEffect(()=>{setTimeout(()=>r(!0),10)},[]);const l=()=>{r(!1),setTimeout(t,300)},h=E=>{o(E.touches[0].clientY),p(!0)},u=E=>{if(!g)return;const B=E.touches[0].clientY-x;B>0&&f(B)},b=()=>{p(!1),m>100?l():f(0)};return e.jsxs("div",{className:"fixed inset-0 z-[60] flex items-end justify-center",onClick:l,children:[e.jsx("div",{className:`absolute inset-0 bg-black/40 backdrop-blur-sm transition-opacity duration-300 ${a?"opacity-100":"opacity-0"}`}),e.jsxs("div",{ref:c,className:`relative bg-white rounded-t-[2rem] w-full max-w-md shadow-2xl transition-transform duration-300 ease-out ${a?"translate-y-0":"translate-y-full"}`,style:{transform:g?`translateY(${m}px)`:void 0,transition:g?"none":void 0},onClick:E=>E.stopPropagation(),onTouchStart:h,onTouchMove:u,onTouchEnd:b,children:[e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto mt-4 mb-2"}),e.jsx("div",{className:"px-8 pb-8 pt-4",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-gradient-to-br from-green-400 to-teal-500 rounded-full flex items-center justify-center mb-6 shadow-lg",children:e.jsx("span",{className:"text-5xl",children:"ðŸŽ‰"})}),e.jsx("h2",{className:"text-2xl font-bold text-green-500 mb-4 text-center",children:"Successful activation!"}),e.jsx("p",{className:"text-gray-700 text-center mb-2 leading-relaxed",children:"Welcome and enjoy your offer!"}),e.jsxs("p",{className:"text-orange-500 font-bold text-lg mb-8",children:["You earned ",s," points!"]}),e.jsx("button",{onClick:l,className:"w-full bg-gradient-to-r from-green-500 to-teal-600 text-white py-4 rounded-[1rem] font-bold text-lg hover:from-green-600 hover:to-teal-700 transition-all shadow-lg active:scale-95",children:"Continue"})]})})]})]})}const Oe={REFERRAL_CODE:"user_referral_code",POINTS_BALANCE:"user_points_balance",TRANSACTIONS:"user_transactions",USER_LEVEL:"user_level_info"},Zt={REFERRAL_CODE:30*24*60*60*1e3,POINTS_BALANCE:5*60*1e3,TRANSACTIONS:5*60*1e3,USER_LEVEL:10*60*1e3},je={referralCode:null,pointsBalance:null,transactions:null,userLevel:null},Qt=(t,s)=>{try{const a=localStorage.getItem(t);if(a){const{data:r,timestamp:x}=JSON.parse(a);if(Date.now()-x<s)return r;localStorage.removeItem(t)}}catch{}return null},Kt=(t,s)=>{try{localStorage.setItem(t,JSON.stringify({data:s,timestamp:Date.now()}))}catch{}},ht=t=>{localStorage.removeItem(t)},rs=()=>{if(je.referralCode)return je.referralCode;const t=Qt(Oe.REFERRAL_CODE,Zt.REFERRAL_CODE);return t&&(je.referralCode=t),t},Dn=t=>{je.referralCode=t,Kt(Oe.REFERRAL_CODE,t)},ns=()=>{if(je.pointsBalance!==null)return je.pointsBalance;const t=Qt(Oe.POINTS_BALANCE,Zt.POINTS_BALANCE);return t!==null&&(je.pointsBalance=t),t},Qs=t=>{je.pointsBalance=t,Kt(Oe.POINTS_BALANCE,t)},xs=()=>{if(je.transactions)return je.transactions;const t=Qt(Oe.TRANSACTIONS,Zt.TRANSACTIONS);return t&&(je.transactions=t),t},Ks=t=>{je.transactions=t,Kt(Oe.TRANSACTIONS,t)},os=()=>{if(je.userLevel)return je.userLevel;const t=Qt(Oe.USER_LEVEL,Zt.USER_LEVEL);return t&&(je.userLevel=t),t},kn=(t,s)=>{const a={level:t,name:s};je.userLevel=a,Kt(Oe.USER_LEVEL,a)};function Sn({onBack:t}){const[s,a]=n.useState("invite"),[r,x]=n.useState(""),o=rs(),m=ns(),f=os(),g=xs(),[p,c]=n.useState(o||""),[l,h]=n.useState(m??0),[u,b]=n.useState((f==null?void 0:f.level)??1),[E,B]=n.useState((f==null?void 0:f.name)??"Newbie"),[j,v]=n.useState(!o||m===null),[y,d]=n.useState(null),[i,C]=n.useState(!1),[A,w]=n.useState(!1),[F,N]=n.useState(!1),[k,P]=n.useState(!1),[L,$]=n.useState(25),[U,S]=n.useState(g||[]),[I,M]=n.useState(!g),[H,T]=n.useState(null),D=n.useRef(null),R=n.useRef(null),Z=n.useRef(!1);n.useEffect(()=>(_(),O(),()=>{D.current&&D.current.unsubscribe()}),[]),n.useEffect(()=>{R.current&&!j&&u>0&&!Z.current&&(Z.current=!0,requestAnimationFrame(()=>{R.current&&R.current.scrollIntoView({behavior:"auto",block:"nearest",inline:"center"})}))},[u,j]);const O=async()=>{try{const{data:{user:X}}=await J.auth.getUser();if(!X)return;D.current=J.channel("points-changes").on("postgres_changes",{event:"*",schema:"public",table:"points_transactions",filter:`user_id=eq.${X.id}`},()=>{ht(Oe.POINTS_BALANCE),ht(Oe.TRANSACTIONS),je.pointsBalance=null,je.transactions=null,V()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`user_id=eq.${X.id}`},()=>{ht(Oe.POINTS_BALANCE),ht(Oe.USER_LEVEL),je.pointsBalance=null,je.userLevel=null,V()}).subscribe()}catch{}},V=async()=>{try{const re=(Ae("USE_EDGE_POINTS")?await It.getBalance().catch(()=>({userId:"",totalPoints:0,availablePoints:0,pendingPoints:0})):await Pt.getBalance().catch(()=>({userId:"",totalPoints:0,availablePoints:0,pendingPoints:0}))).availablePoints||0;h(re),Qs(re),await z(),q()}catch{}},q=async()=>{var X;try{const re=xs();if(re&&re.length>0){S(re),M(!1);return}if(M(!0),Ae("USE_EDGE_POINTS")){const oe=((X=(await It.getTransactions(20).catch(()=>({transactions:[],total:0}))).transactions)==null?void 0:X.map(Y=>({id:Y.id,amount:Y.points||Y.amount,type:Y.type,source:Y.source,description:Y.description,createdAt:Y.createdAt})))||[];S(oe),Ks(oe)}else{const te=await Pt.getTransactions().catch(()=>[]);S(te||[]),Ks(te||[])}}catch{S([])}finally{M(!1)}},z=async()=>{try{const X=os();if(X){b(X.level),B(X.name);return}const{data:{user:re}}=await J.auth.getUser();if(!re)return;const{data:te,error:oe}=await J.from("users").select("current_level, level_name").eq("user_id",re.id).maybeSingle();if(oe)return;if(te){const Y=te.current_level||1,ee=te.level_name||"Newbie";b(Y),B(ee),kn(Y,ee)}}catch{}},_=async()=>{try{const X=rs(),re=ns(),te=os(),oe=xs();if(X&&re!==null&&te&&oe){c(X),h(re),b(te.level),B(te.name),S(oe),v(!1),M(!1);return}v(!0),d(null),X&&c(X),re!==null&&h(re),te&&(b(te.level),B(te.name)),oe&&(S(oe),M(!1));const ee=!X,xe=re===null;if(ee||xe){const me=[];ee&&me.push(Ae("USE_EDGE_PROMO_CODES")?hs.getUserPromoCode().catch(()=>({promoCode:"",referralCount:0,totalPointsEarned:0})):us.getUserPromoCode().catch(()=>({promoCode:"",referralCount:0,totalPointsEarned:0}))),xe&&me.push(Ae("USE_EDGE_POINTS")?It.getBalance().catch(()=>({userId:"",totalPoints:0,availablePoints:0,pendingPoints:0})):Pt.getBalance().catch(()=>({userId:"",totalPoints:0,availablePoints:0,pendingPoints:0})));const ce=await Promise.all(me);let Le=0;if(ee){const Me=ce[Le++].promoCode||"N/A";c(Me),Me&&Me!=="N/A"&&Dn(Me)}if(xe){const Me=ce[Le++].availablePoints||0;h(Me),Qs(Me)}}te||await z(),oe||await q()}catch{d("Unable to load rewards data");const re=rs(),te=ns();c(re||"N/A"),h(te??0),S([])}finally{v(!1)}},W=async()=>{if(!r.trim()){w(!0);return}try{C(!0);const X=Ae("USE_EDGE_PROMO_CODES")?await hs.applyPromoCode(r.trim()):await us.applyPromoCode({promoCode:r.trim()});if(X.success)$(X.pointsEarned||25),P(!0),x(""),ht(Oe.POINTS_BALANCE),ht(Oe.TRANSACTIONS),je.pointsBalance=null,je.transactions=null,await _();else{const re=X.code;re==="OUTSIDE_24_HOUR_WINDOW"||re==="ALREADY_USED"||re==="SELF_REFERRAL"?N(!0):alert(X.message||"Invalid promo code")}}catch{alert("Failed to activate promo code. Please try again.")}finally{C(!1)}},ne=async()=>{const X=`Join me on Pawa! Use my code: ${p}`;if(navigator.share)try{await navigator.share({title:"Join Pawa",text:X})}catch{}else navigator.clipboard.writeText(X),alert("Promo code copied to clipboard!")};return e.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"px-4 sm:px-6 pt-4 pb-3 flex items-center justify-between border-b-2 border-gray-100",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-[1rem] transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("button",{onClick:()=>a("invite"),className:`pb-3 font-semibold transition-colors relative ${s==="invite"?"text-gray-800":"text-gray-400"}`,children:["Invite",s==="invite"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-orange-400"})]}),e.jsxs("button",{onClick:()=>a("rewards"),className:`pb-3 font-semibold transition-colors relative ${s==="rewards"?"text-gray-800":"text-gray-400"}`,children:["Rewards",s==="rewards"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-0.5 bg-orange-400"})]})]})]}),s==="invite"&&e.jsxs("div",{className:"px-4 sm:px-6 pt-8",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("div",{className:"w-16 h-16 rounded-full bg-teal-100 flex items-center justify-center",children:e.jsx(ds,{className:"w-8 h-8 text-teal-600"})})}),j&&e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(Re,{className:"w-8 h-8 text-orange-400 animate-spin"})}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-4 mb-6",children:e.jsx("p",{className:"text-red-700 text-center",children:y})}),e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-orange-400 text-center mb-8",children:"ENTER PROMO CODE"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-800 font-semibold text-center mb-3",children:"Enter Your Promo Code Here:"}),e.jsx("input",{type:"text",value:r,onChange:X=>x(X.target.value.toUpperCase()),placeholder:"**********",className:"w-full bg-orange-50 rounded-2xl px-6 py-4 text-center text-gray-800 placeholder-gray-400 outline-none focus:ring-2 focus:ring-orange-300"})]}),e.jsx("button",{onClick:W,disabled:i||j,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-[1rem] font-bold text-lg hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg mb-6 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:i?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5 animate-spin"}),"Activating..."]}):"Activate"}),e.jsx("div",{className:"text-center mb-6",children:e.jsx("span",{className:"text-gray-600 font-semibold",children:"OR"})}),e.jsx("h2",{className:"text-xl font-bold text-orange-400 text-center mb-4",children:"Invite Friends"}),e.jsx("p",{className:"text-center text-gray-700 mb-2",children:"Explore a new way of dining, charging, and"}),e.jsxs("p",{className:"text-center text-gray-700 mb-6",children:["discovering the city. ",e.jsx("span",{className:"text-blue-500 font-semibold",children:"Unlock rewards!"})]}),e.jsx("div",{className:"bg-gray-50 rounded-2xl p-4 mb-4",children:e.jsxs("p",{className:"text-center text-gray-700 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Share unique code:"})," ",j?e.jsx(Re,{className:"w-4 h-4 inline-block animate-spin text-orange-400"}):e.jsx("span",{className:"text-orange-400 font-bold",children:p})]})}),e.jsxs("button",{onClick:ne,className:"w-full bg-gradient-to-r from-slate-700 to-slate-800 text-white py-4 rounded-[1rem] font-bold text-lg hover:from-slate-800 hover:to-slate-900 transition-all shadow-lg flex items-center justify-center gap-2",children:[e.jsx(zt,{className:"w-5 h-5"}),"Share link"]})]}),s==="rewards"&&e.jsxs("div",{className:"px-4 sm:px-6 pt-8",children:[j&&e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(Re,{className:"w-8 h-8 text-orange-400 animate-spin"})}),y&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-2xl p-4 mb-6",children:e.jsx("p",{className:"text-red-700 text-center",children:y})}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-100 to-pink-100 rounded-3xl p-5 mb-6",children:[e.jsx("div",{className:"text-center mb-4",children:j?e.jsx(Re,{className:"w-8 h-8 mx-auto text-orange-400 animate-spin mb-2"}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-5xl font-bold text-orange-500 mb-2",children:[l," ",e.jsx("span",{className:"text-lg text-gray-500 font-normal",children:"pts"})]}),e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:["Level ",u," - ",e.jsx("span",{className:"font-semibold",children:E})]}),(()=>{const X=[{level:1,min:0,max:49,name:"Newbie"},{level:2,min:50,max:149,name:"Explorer"},{level:3,min:150,max:299,name:"Enthusiast"},{level:4,min:300,max:599,name:"Ambassador"},{level:5,min:600,max:1/0,name:"Legend"}],re=X.find(me=>me.level===u)||X[0],te=X.find(me=>me.level===u+1);if(!te)return e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsx("span",{className:"text-xs text-gray-600",children:"Max Level Reached!"}),e.jsxs("span",{className:"text-xs font-semibold text-orange-600",children:[l," pts"]})]}),e.jsx("div",{className:"w-full h-2 bg-white/50 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-600 rounded-full",style:{width:"100%"}})})]});const oe=l-re.min,Y=te.min-re.min,ee=Math.min(100,Math.max(0,oe/Y*100)),xe=te.min-l;return e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("span",{className:"text-xs text-gray-600",children:[re.min," pts"]}),xe>0&&e.jsxs("span",{className:"text-xs text-gray-600",children:[xe," pts to next level"]}),e.jsxs("span",{className:"text-xs text-gray-600",children:[te.min," pts"]})]}),e.jsx("div",{className:"w-full h-2 bg-white/50 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-orange-400 to-orange-600 rounded-full transition-all duration-500",style:{width:`${ee}%`}})})]})})()]})}),e.jsx("div",{className:"bg-white rounded-2xl p-3 text-center",children:e.jsx("p",{className:"text-sm text-gray-700",children:"Use your points to unlock exclusive deals and discounts!"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"All levels & Rewards"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-8 h-1 bg-orange-400 rounded-full"}),e.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"})]})]}),e.jsxs("div",{className:"flex gap-3 mb-6 overflow-x-auto pb-2 pt-3 scrollbar-hide -mx-4 px-4 scroll-smooth",children:[e.jsxs("div",{ref:u===1?R:null,className:`rounded-2xl p-3 flex-shrink-0 w-[170px] relative ${u===1?"bg-teal-100 border-2 border-teal-500 shadow-lg":"bg-teal-50 border-2 border-transparent"}`,children:[u===1&&e.jsx("div",{className:"absolute -top-2 left-2 bg-teal-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"CURRENT"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg",children:"ðŸŒ±"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Level 1"}),e.jsx("div",{className:"text-sm font-bold text-teal-600 mb-0.5",children:"Newbie"}),e.jsx("div",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:"0 - 49 Points"})]})]})]}),e.jsxs("div",{ref:u===2?R:null,className:`rounded-2xl p-3 flex-shrink-0 w-[170px] relative ${u===2?"bg-orange-100 border-2 border-orange-500 shadow-lg":"bg-orange-50 border-2 border-transparent"}`,children:[u===2&&e.jsx("div",{className:"absolute -top-2 left-2 bg-orange-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"CURRENT"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-400 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg",children:"ðŸ†"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Level 2"}),e.jsx("div",{className:"text-sm font-bold text-orange-600 mb-0.5",children:"Explorer"}),e.jsx("div",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:"50 - 149 Points"})]})]})]}),e.jsxs("div",{ref:u===3?R:null,className:`rounded-2xl p-3 flex-shrink-0 w-[170px] relative ${u===3?"bg-green-100 border-2 border-green-500 shadow-lg":"bg-green-50 border-2 border-transparent"}`,children:[u===3&&e.jsx("div",{className:"absolute -top-2 left-2 bg-green-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"CURRENT"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg",children:"âš¡"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Level 3"}),e.jsx("div",{className:"text-sm font-bold text-green-600 mb-0.5",children:"Enthusiast"}),e.jsx("div",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:"150 - 299 Points"})]})]})]}),e.jsxs("div",{ref:u===4?R:null,className:`rounded-2xl p-3 flex-shrink-0 w-[170px] relative ${u===4?"bg-blue-100 border-2 border-blue-500 shadow-lg":"bg-blue-50 border-2 border-transparent"}`,children:[u===4&&e.jsx("div",{className:"absolute -top-2 left-2 bg-blue-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"CURRENT"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg",children:"ðŸŽ–ï¸"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Level 4"}),e.jsx("div",{className:"text-sm font-bold text-blue-600 mb-0.5",children:"Ambassador"}),e.jsx("div",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:"300 - 599 Points"})]})]})]}),e.jsxs("div",{ref:u===5?R:null,className:`rounded-2xl p-3 flex-shrink-0 w-[170px] relative ${u===5?"bg-amber-100 border-2 border-amber-500 shadow-lg":"bg-amber-50 border-2 border-transparent"}`,children:[u===5&&e.jsx("div",{className:"absolute -top-2 left-2 bg-amber-600 text-white text-[10px] font-bold px-2 py-0.5 rounded-full",children:"CURRENT"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-amber-500 rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg",children:"ðŸ‘‘"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-0.5",children:"Level 5"}),e.jsx("div",{className:"text-sm font-bold text-amber-600 mb-0.5",children:"Legend"}),e.jsx("div",{className:"text-[10px] text-gray-500 whitespace-nowrap",children:"600+ Points"})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-2",children:"Earning Points"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"You earn points (pt) by completing various actions, redeem them for online shopping discounts."}),e.jsxs("div",{className:"bg-blue-50 rounded-2xl p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(lt,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Charge up"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Earn points each time you rent and return a power bank within 24 hours!"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(E0,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Booking"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Enjoy delicious dining and earn points by sharing dining pics & reviews!"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-white rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx(st,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Referrals"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Invite friends to PawaTasty and earn points when they join using your referral."})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Points History"}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-1 h-1 bg-gray-300 rounded-full"}),e.jsx("div",{className:"w-8 h-1 bg-orange-400 rounded-full"})]})]}),I&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(Re,{className:"w-6 h-6 text-orange-400 animate-spin"})}),!I&&U.length===0&&e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-6 text-center",children:[e.jsx("p",{className:"text-gray-500 text-sm",children:"No points history yet"}),e.jsx("p",{className:"text-gray-400 text-xs mt-1",children:"Complete bookings to earn points!"})]}),!I&&U.length>0&&e.jsx("div",{className:"overflow-x-auto -mx-4 px-4",children:e.jsx("div",{className:"flex gap-3 pb-2",children:U.slice(0,10).map(X=>{const re=()=>X.source==="referral"?"Referral Activated":X.source==="booking"?"Booking Completed":X.source==="rental"||X.source==="subscription"?"Rental Completed":X.source==="welcome"||X.source==="promo"?"New Joiner":"Points earned",te=()=>{const Y=new Date,ee=new Date(X.createdAt),xe=Y.getTime()-ee.getTime(),me=Math.floor(xe/(1e3*60)),ce=Math.floor(xe/(1e3*60*60)),Le=Math.floor(xe/(1e3*60*60*24));return me<60?`${me}m ago`:ce<24?`${ce}h ago`:`${Le}d ago`},oe=H===X.id;return e.jsxs("div",{className:"bg-white rounded-2xl p-4 border border-gray-200 shadow-sm cursor-pointer active:scale-95 transition-all flex-shrink-0 w-[160px]",onClick:()=>T(oe?null:X.id),children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-1 text-xs truncate",children:re()}),e.jsxs("div",{className:`text-sm font-medium mb-2 ${X.type==="earned"?"text-green-700":"text-red-600"}`,children:[X.type==="earned"?"+":"-",X.amount," points"]}),oe&&e.jsx("p",{className:"text-[10px] text-gray-600 mb-2 line-clamp-3",children:X.description}),e.jsx("div",{className:"text-[10px] text-gray-400",children:te()})]},X.id)})})})]})]})]})}),A&&e.jsx(An,{onClose:()=>w(!1)}),F&&e.jsx(Nn,{onClose:()=>N(!1)}),k&&e.jsx(Fn,{onClose:()=>P(!1),pointsEarned:L})]})}function Pn({onClose:t}){const[s,a]=n.useState(null),[r,x]=n.useState(null),o=l=>{a(l.touches[0].clientY)},m=l=>{s!==null&&x(l.touches[0].clientY)},f=()=>{s!==null&&r!==null&&r-s>50&&t(),a(null),x(null)},g=l=>{a(l.clientY)},p=l=>{s!==null&&x(l.clientY)},c=()=>{s!==null&&r!==null&&r-s>50&&t(),a(null),x(null)};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm z-50 flex items-end justify-center",children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full p-8 shadow-2xl relative animate-slideUp",children:[e.jsx("div",{className:"absolute top-3 left-1/2 -translate-x-1/2 cursor-pointer py-2 px-8",onClick:t,onTouchStart:o,onTouchMove:m,onTouchEnd:f,onMouseDown:g,onMouseMove:p,onMouseUp:c,children:e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),e.jsxs("div",{className:"flex flex-col items-center text-center mt-2",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-300 to-orange-400 flex items-center justify-center mb-6 shadow-lg",children:e.jsx(b0,{className:"w-10 h-10 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-orange-500 mb-6",children:"Members note!"}),e.jsxs("div",{className:"space-y-3 text-center w-full mb-8",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Subscription:"})," Starts immediately upon upgrade."]}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Cancellation:"})," Downgrade to the Flex plan."]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Changes take effect at the end of the current plan."})]}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-semibold py-4 rounded-[1rem] hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg shadow-orange-200",children:"Got it"})]})]})})}function In({onBack:t,userProfile:s}){const[a,r]=n.useState("gold"),[x,o]=n.useState(!1),[m,f]=n.useState(!1),[g,p]=n.useState(!1),[c,l]=n.useState(!0),[h,u]=n.useState(!1),[b,E]=n.useState([]),[B,j]=n.useState([]),[v,y]=n.useState(""),[d,i]=n.useState(""),[C,A]=n.useState(null),w=n.useRef(null),F=n.useRef({});n.useEffect(()=>{(async()=>{try{l(!0),A(null);const{data:{user:D}}=await J.auth.getUser(),[R,Z]=await Promise.all([ya.getPlans(),D?J.from("users").select("current_level, subscription").eq("user_id",D.id).maybeSingle():Promise.resolve({data:null,error:null})]);if(!R||R.length===0)throw new Error("No membership plans available");E(R);const O=Z==null?void 0:Z.data;O?(y((O.current_level||1).toString()),i(O.subscription||"flex")):(y("1"),i("flex")),l(!1)}catch(D){A(D.message||"Unable to load membership plans. Please try again."),l(!1)}})()},[]),n.useEffect(()=>{const T=new URLSearchParams(window.location.search),D=T.get("payment_intent"),R=T.get("payment_intent_client_secret");D&&R&&(N(D),window.history.replaceState({},document.title,window.location.pathname))},[]);const N=async T=>{try{l(!0);const{data:D}=await J.auth.getUser();if(!D.user)throw new Error("Not authenticated");const R=(await J.auth.getSession()).data.session;if(!R)throw new Error("No active session");const Z=await fetch(`https://dopjawhuylqipltnuydp.supabase.co/functions/v1/subscription-payment/verify?payment_intent=${T}`,{headers:{Authorization:`Bearer ${R.access_token}`}});if(!Z.ok)throw new Error("Failed to verify payment");const O=await Z.json();if(O.status==="succeeded"&&O.paymentMethodId){if(!(await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/subscription-payment/confirm",{method:"POST",headers:{Authorization:`Bearer ${R.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({paymentIntentId:T,paymentMethodId:O.paymentMethodId})})).ok)throw new Error("Failed to confirm payment");k()}else throw new Error(`Payment not completed. Status: ${O.status}`)}catch{A("Payment verification failed. Please contact support if you were charged.")}finally{l(!1)}},k=async()=>{f(!0);try{const{data:{user:T}}=await J.auth.getUser();if(T){const{data:D}=await J.from("users").select("current_level, subscription").eq("user_id",T.id).maybeSingle();D&&(y((D.current_level||1).toString()),i(D.subscription||"flex"))}}catch{}setTimeout(()=>{f(!1),t()},3e3)},P=async()=>{if(A(null),!b.find(D=>(D.tier||D.name.toLowerCase()).includes(a))){A("Selected plan not found");return}if(a==="flex"){u(!0);try{const{data:{session:D}}=await J.auth.getSession();if(!D)throw new Error("Not authenticated");const R=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/subscriptions",{method:"POST",headers:{Authorization:`Bearer ${D.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({tier:"flex",paymentMethodId:null})});if(!R.ok){const Z=await R.json();throw new Error(Z.error||"Failed to downgrade to Flex plan")}await R.json(),k()}catch(D){A(D.message||"Failed to downgrade to Flex plan. Please try again."),u(!1)}return}u(!0);try{const D=await De.getPaymentMethods();j(D.paymentMethods||[]),u(!1),p(!0)}catch{A("Unable to load payment methods. Please try again."),u(!1)}},L=async(T,D)=>{try{u(!0),A(null);const{data:{session:R}}=await J.auth.getSession();if(!R)throw new Error("Not authenticated");const Z=D.tier||(D.name.toLowerCase().includes("flex")?"flex":D.name.toLowerCase().includes("gold")?"gold":D.name.toLowerCase().includes("silver")?"silver":"flex"),O=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/subscriptions",{method:"POST",headers:{Authorization:`Bearer ${R.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({tier:Z,paymentMethodId:T})});if(!O.ok){const V=await O.json();throw new Error(V.error||"Failed to upgrade subscription")}await O.json(),k()}catch(R){A(R.message||"Failed to upgrade subscription. Please try again.")}finally{u(!1)}},$=async T=>{p(!1);const D=b.find(R=>(R.tier||R.name.toLowerCase()).includes(a));D&&await L(T,D)},S=b.map(T=>{const D=T.tier||(T.name.toLowerCase().includes("flex")?"flex":T.name.toLowerCase().includes("gold")?"gold":"silver"),R=parseFloat(T.price),Z=T.type==="year",O=Z?Math.round(R/12*100)/100:R,V=Array.isArray(T.features)?T.features.map(z=>({text:z})):[],q={flex:"blue",silver:"teal",gold:"orange"};return{id:D,name:T.name,displayName:T.name,subtitle:D==="flex"?`â‚¬ ${R}/Flex`:Z?"Yearly plan":"Monthly plan",price:O,period:D==="flex"?"/Flex":"/Month",annualPrice:Z?R:void 0,features:V,billingNote:D==="flex"?"(Billed by minutes)":Z?`(Billed annually: â‚¬${R}/year)`:`Billed: â‚¬${R}/monthly (â‚¬${Math.round(R*12*100)/100} a year)`,badge:D==="gold"?"Best Value":void 0,color:q[D]}}),I=S.find(T=>T.id===a),M=T=>{r(T);const D=w.current,R=F.current[T];if(D&&R){const Z=D.clientWidth,O=R.offsetLeft,V=R.offsetWidth,q=O-Z/2+V/2;D.scrollTo({left:q,behavior:"smooth"})}},H=(T,D)=>{const R={blue:{bg:D?"bg-blue-100 border-blue-300":"bg-blue-50 border-blue-100",text:"text-blue-800",check:"bg-green-500"},orange:{bg:D?"bg-orange-200 border-orange-300":"bg-orange-100 border-orange-200",text:"text-orange-600",check:"bg-orange-500",badge:"bg-orange-500"},teal:{bg:D?"bg-teal-100 border-teal-300":"bg-teal-50 border-teal-100",text:"text-teal-800",check:"bg-teal-500"}};return R[T]||R.blue};return m?e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-start justify-center pt-20",children:e.jsxs("div",{className:"bg-white rounded-3xl p-8 max-w-md w-full mx-4 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:a==="flex"?"Plan Changed!":"Membership Upgraded!"}),e.jsx("p",{className:"text-gray-600",children:a==="flex"?`You have successfully switched to the ${I==null?void 0:I.displayName}.`:`Your ${I==null?void 0:I.displayName} is now active.`})]})}):c?e.jsx("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-5 pt-4 pb-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Membership Plans"}),e.jsx("div",{className:"w-10"})]}),e.jsx("div",{className:"flex items-center justify-center gap-2 mt-4 text-gray-600 mx-auto",children:e.jsx("span",{className:"text-sm",children:"Loading plans..."})})]}),e.jsxs("div",{className:"px-5 py-5",children:[e.jsx("div",{className:"flex gap-3 mb-6 overflow-x-auto pb-2",children:[1,2,3].map(T=>e.jsxs("div",{className:"flex-shrink-0 rounded-2xl border-2 border-gray-200 p-4 animate-pulse",style:{minWidth:"160px"},children:[e.jsx("div",{className:"h-4 bg-gray-200 rounded w-20 mb-2"}),e.jsx("div",{className:"h-3 bg-gray-200 rounded w-16"})]},T))}),e.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-sm animate-pulse",children:[e.jsx("div",{className:"h-8 bg-gray-200 rounded w-32 mb-8"}),e.jsx("div",{className:"h-12 bg-gray-200 rounded w-40 mb-8"}),e.jsx("div",{className:"space-y-4 mb-8",children:[1,2,3,4].map(T=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-200"}),e.jsx("div",{className:"h-4 bg-gray-200 rounded flex-1"})]},T))}),e.jsx("div",{className:"h-12 bg-gray-200 rounded-xl w-full"})]})]})]})})}):C||b.length===0?e.jsx("div",{className:"fixed inset-0 bg-gray-50 z-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center px-6",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Unable to Load Plans"}),e.jsx("p",{className:"text-gray-600 mb-6",children:C||"No membership plans available"}),e.jsxs("div",{className:"flex flex-col gap-3",children:[(C==null?void 0:C.toLowerCase().includes("payment"))&&e.jsx("button",{onClick:()=>{A(null),p(!0)},className:"bg-orange-400 text-white px-6 py-3 rounded-xl font-medium hover:bg-orange-500 transition-colors",children:"Add Payment Method"}),e.jsx("button",{onClick:t,className:`${C!=null&&C.toLowerCase().includes("payment")?"bg-gray-200 text-gray-700 hover:bg-gray-300":"bg-orange-400 text-white hover:bg-orange-500"} px-6 py-3 rounded-xl font-medium transition-colors`,children:"Go Back"})]})]})}):e.jsxs("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-5 pt-4 pb-3 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"Membership Plans"}),e.jsx("div",{className:"w-10"})]}),e.jsxs("button",{onClick:()=>o(!0),className:"flex items-center justify-center gap-2 mt-4 text-gray-600 hover:text-gray-800 transition-colors mx-auto",children:[e.jsx("span",{className:"text-sm",children:"Select a plan to start"}),e.jsx(nt,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"px-5 py-5",children:[e.jsx("div",{ref:w,className:"flex gap-3 mb-6 overflow-x-auto pb-2 scroll-smooth",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:S.map(T=>{const D=a===T.id,R=H(T.color,D);return e.jsxs("button",{ref:Z=>F.current[T.id]=Z,onClick:()=>M(T.id),className:`flex-shrink-0 rounded-2xl border-2 p-4 transition-all relative ${R.bg}`,style:{minWidth:"160px"},children:[T.id==="gold"&&e.jsx("div",{className:"absolute -top-2 left-1/2 -translate-x-1/2 bg-orange-500 text-white text-xs font-semibold px-3 py-1 rounded-full whitespace-nowrap",children:"Best Valued"}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:`font-bold text-base ${R.text}`,children:T.name}),e.jsx("div",{className:`text-xs ${R.text} opacity-80`,children:T.subtitle})]})]},T.id)})}),I&&e.jsxs("div",{className:"bg-white rounded-3xl p-8 shadow-sm flex flex-col min-h-[calc(100vh-240px)]",children:[e.jsxs("div",{className:"flex items-start justify-between mb-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:I.displayName}),I.badge&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-semibold px-3 py-1 rounded-full",children:I.badge})]}),e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex items-baseline gap-1",children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-800",children:["â‚¬",I.price]}),e.jsx("span",{className:"text-gray-600 text-lg",children:I.period})]})}),e.jsx("div",{className:"space-y-4 mb-8",children:I.features.map((T,D)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-gray-800 flex items-center justify-center",children:e.jsx(Qe,{className:"w-3 h-3 text-white"})}),e.jsx("span",{className:"text-gray-700 flex-1",children:T.text}),T.badge&&e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-semibold px-2 py-1 rounded",children:T.badge})]},D))}),e.jsxs("div",{className:"mt-auto",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-8",children:I.billingNote}),C&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl text-sm text-red-600",children:C}),e.jsx("button",{onClick:P,disabled:h||d.toLowerCase()===a,className:`w-full font-semibold py-4 rounded-[1rem] transition-all ${d.toLowerCase()===a?"bg-gray-300 text-gray-500 cursor-not-allowed":h?"bg-orange-300 text-white cursor-wait":"bg-gradient-to-r from-orange-400 to-orange-500 text-white hover:from-orange-500 hover:to-orange-600"}`,children:h?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processing..."]}):d.toLowerCase()===a?"Current Plan":(()=>{const T=["flex","silver","gold"],D=T.indexOf(d.toLowerCase());return T.indexOf(a)>D?"Upgrade Now":"Downgrade"})()})]})]})]})]})}),x&&e.jsx(Pn,{onClose:()=>o(!1)}),g&&e.jsx(Xt,{onClose:()=>p(!1),onPaymentMethodSelected:$,title:"Choose Payment Method",description:"Select a payment method for your subscription",userProfile:s})]})}function Mn({isOpen:t,onClose:s,message:a}){return t?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-end justify-center backdrop-blur-sm",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:s,children:e.jsx("div",{className:"bg-white rounded-t-[2rem] w-full max-w-md mx-auto text-center shadow-2xl animate-slide-up",onClick:r=>r.stopPropagation(),children:e.jsxs("div",{className:"pt-8 pb-10 px-8",children:[e.jsx("div",{className:"w-20 h-20 mx-auto mb-6 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center",children:e.jsx("div",{className:"text-4xl",children:"ðŸ˜•"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-3",children:"Oops error!"}),e.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed",children:a||"Something went wrong; failed to book the deal. Please try again."}),e.jsx("button",{onClick:s,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-2xl font-semibold hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg",children:"Got it"})]})})}):null}function Tn({isOpen:t,onClose:s,onUpgrade:a}){return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:s,children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full animate-slide-up",onClick:r=>r.stopPropagation(),children:[e.jsx("div",{className:"pt-3 pb-2",children:e.jsx("div",{onClick:s,className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto cursor-pointer active:cursor-grabbing"})}),e.jsxs("div",{className:"px-8 py-8 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-orange-400 to-orange-500 rounded-full flex items-center justify-center mb-6",children:e.jsx("svg",{className:"w-10 h-10 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4 text-center",children:"Become a Member"}),e.jsxs("p",{className:"text-center text-gray-700 text-base leading-relaxed mb-6 px-2",children:["Deal bookings are only available for ",e.jsx("strong",{children:"Silver"})," and ",e.jsx("strong",{children:"Gold"})," subscription members."]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-2xl p-5 mb-8 w-full",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-3 text-center",children:"Silver & Gold Benefits:"}),e.jsxs("div",{className:"space-y-2.5",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-gray-700 text-sm leading-relaxed",children:"All deals city-wide included"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-gray-700 text-sm leading-relaxed",children:"Free power bank rental per day"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-gray-700 text-sm leading-relaxed",children:"Priority access to exclusive spots"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-500 flex-shrink-0 mt-0.5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("span",{className:"text-gray-700 text-sm leading-relaxed",children:"Save on dining experiences"})]})]})]}),e.jsx("button",{onClick:a,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all mb-3",children:"Upgrade Now"}),e.jsx("button",{onClick:s,className:"text-gray-600 font-medium py-2",children:"Maybe Later"})]})]})}):null}function _n({deal:t,restaurant:s,onClose:a,onBookingComplete:r}){const[x,o]=n.useState("Today"),[m,f]=n.useState(""),[g,p]=n.useState(!1),[c,l]=n.useState(!1),[h,u]=n.useState(""),[b,E]=n.useState([]),[B,j]=n.useState(!0),[v,y]=n.useState(0),[d,i]=n.useState(0),[C,A]=n.useState(!1),[w,F]=n.useState(null),[N,k]=n.useState(!1),[P,L]=n.useState(!0),$=n.useRef(null),U=t.bookable_qty??0,S=O=>{y(O.touches[0].clientY),A(!0)},I=O=>{if(!C)return;const V=O.touches[0].clientY-v;V>0&&i(V)},M=()=>{d>100&&a(),i(0),A(!1)},H=O=>{O.target===O.currentTarget&&a()},T=n.useMemo(()=>{if(!s.openingHours)return{Monday:{open:"12:00",close:"22:00"},Tuesday:{open:"12:00",close:"22:00"},Wednesday:{open:"12:00",close:"22:00"},Thursday:{open:"12:00",close:"22:00"},Friday:{open:"12:00",close:"22:00"},Saturday:{open:"12:00",close:"22:00"},Sunday:{open:"12:00",close:"22:00"}};const O={};return s.openingHours.split(",").map(q=>q.trim()).forEach(q=>{const[z,_]=q.split(":").map(X=>X.trim());if(!_)return;const[W,ne]=_.split("-").map(X=>X.trim());if(z.includes("-")){const[X,re]=z.split("-").map(ee=>ee.trim()),te=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],oe=te.findIndex(ee=>X.startsWith(ee.substring(0,3))),Y=te.findIndex(ee=>re.startsWith(ee.substring(0,3)));for(let ee=oe;ee<=Y;ee++)O[te[ee]]={open:W,close:ne}}else{const re=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"].find(te=>z.startsWith(te.substring(0,3)));re&&(O[re]={open:W,close:ne})}}),O},[s.openingHours]);n.useEffect(()=>{const O=async()=>{try{L(!0);const{data:{user:q}}=await J.auth.getUser();if(!q){L(!1);return}const{data:z,error:_}=await J.from("users").select("subscription").eq("user_id",q.id).maybeSingle();if(!_){if(z){const W=z.subscription||"flex";F(W),W==="flex"&&k(!0)}}L(!1)}catch{L(!1)}},V=async()=>{try{const z=(await Ke.getUserBookings()).bookings.filter(_=>_.dealId===t.id&&_.status!=="cancelled").map(_=>({date:new Date(_.bookingDate||_.booking_date||"").toDateString(),time:_.specialRequests||_.booking_time||""}));E(z)}catch{}finally{j(!1)}};O(),V()},[t.id]);const D=n.useMemo(()=>{const O=new Date,V=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],q=[];for(let z=0;z<7;z++){const _=new Date(O);_.setDate(_.getDate()+z);const W=V[_.getDay()];if(T[W]){const ne=z===0?"Today":z===1?"Tomorrow":W;q.push({label:ne,date:_,dayName:W})}}return q.slice(0,4)},[T]),R=n.useMemo(()=>{const O=D.find(te=>te.label===x);if(!O)return[];const V=T[O.dayName];if(!V)return[];const q=new Date,z=O.label==="Today",_=q.getHours(),W=q.getMinutes(),ne=[],X=parseInt(V.open.split(":")[0]),re=parseInt(V.close.split(":")[0]);return X<=13&&re>=17&&ne.push("13:00 - 17:00"),X<=18&&re>=21&&ne.push("18:00 - 21:00"),(X<=22||re>=1)&&ne.push("22:00 - 01:00"),ne.filter(te=>{if(!z)return!0;const oe=parseInt(te.split(":")[0]),Y=parseInt(te.split(":")[1].split(" ")[0]);return oe>_||oe===_&&Y>W}).filter(te=>{const oe=O.date.toDateString();return!b.some(Y=>Y.date===oe&&Y.time===te)})},[x,D,T,b]);n.useEffect(()=>{m&&!R.includes(m)&&f("")},[m,R]);const Z=async()=>{var _,W,ne,X,re,te,oe,Y;if(w==="flex"){k(!0);return}if(!m){u("Please select a time slot"),l(!0);return}const O=D.find(ee=>ee.label===x);if(!O){u("Invalid day selected"),l(!0);return}const V=new Date;if(O.label==="Today"){const ee=parseInt(m.split(":")[0]),xe=V.getHours();if(ee<=xe){u("This time slot has already passed. Please select a future time."),l(!0);return}}const z=O.date.toDateString();if(b.some(ee=>ee.date===z&&ee.time===m)){u("You already have a booking for this time slot. Please choose a different time."),l(!0);return}p(!0);try{const ee=O.date,xe=await Ke.bookDeal(t.id,{bookingDate:ee.toISOString(),guests:1,specialRequests:m,restaurantId:s.id});a(),r(xe,s)}catch(ee){let xe="Failed to book deal. Please try again.";(_=ee.message)!=null&&_.includes("Unauthorized")||(W=ee.message)!=null&&W.includes("401")?xe="Session expired. Please log in again.":(ne=ee.message)!=null&&ne.includes("already booked")?xe="This time slot is no longer available. Please select a different time.":(X=ee.message)!=null&&X.includes("network")||(re=ee.message)!=null&&re.includes("NetworkError")?xe="Network error. Please check your connection and try again.":(te=ee.message)!=null&&te.includes("authentication")?xe="Authentication failed. Please log in again.":(Y=(oe=ee.response)==null?void 0:oe.data)!=null&&Y.message?xe=ee.response.data.message:ee.message&&(xe=`Booking failed: ${ee.message}`),u(xe),l(!0)}finally{p(!1)}};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:H,children:[e.jsxs("div",{ref:$,className:"bg-white w-full max-w-md rounded-t-3xl max-h-[92vh] overflow-y-auto animate-slide-up",style:{transform:`translateY(${d}px)`,transition:C?"none":"transform 0.3s ease-out"},onTouchStart:S,onTouchMove:I,onTouchEnd:M,children:[e.jsx("div",{className:"sticky top-0 bg-white z-10 pt-6 pb-2"}),e.jsx("div",{className:"relative h-48 bg-gray-200 mb-4",children:e.jsx("img",{src:ke(t.image||t.imageUrl||s.image,"deal",{width:448,height:192,quality:85}),alt:t.title,className:"w-full h-full object-cover object-center"})}),e.jsxs("div",{className:"px-5 pb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-slate-800 mb-2",children:t.title.replace("2 for 1 Berg Menu","2 for 1 main course")}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.description}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[U>0&&e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-700",children:[e.jsx(y0,{className:"w-4 h-4"}),e.jsxs("span",{children:[U," Remains"]})]}),t.savings&&t.savings>0&&e.jsx("div",{className:"flex items-center gap-2 text-xs font-medium text-[#334155]",children:e.jsxs("span",{className:"text-sm",children:["â‚¬",t.savings," Benefit"]})}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-700",children:[e.jsx("svg",{className:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M20.924 5.617a1 1 0 0 0-.217-.324l-3-3a1 1 0 1 0-1.414 1.414L17.586 5H8a5 5 0 0 0-5 5v2a1 1 0 1 0 2 0v-2a3 3 0 0 1 3-3h9.586l-1.293 1.293a1 1 0 0 0 1.414 1.414l3-3A1 1 0 0 0 21 6m-.076-.383a1 1 0 0 1 .076.38zm-17.848 12a1 1 0 0 0 .217 1.09l3 3a1 1 0 0 0 1.414-1.414L6.414 19H16a5 5 0 0 0 5-5v-2a1 1 0 1 0-2 0v2a3 3 0 0 1-3 3H6.414l1.293-1.293a1 1 0 1 0-1.414-1.414l-3 3m-.217.324a1 1 0 0 1 .215-.322z"})}),e.jsxs("span",{children:[t.duration," Days"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs font-medium text-slate-700",children:[e.jsx(Ce,{className:"w-4 h-4"}),e.jsx("span",{children:"On-site"})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2.5",children:"Select day"}),B?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading available days..."}):D.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No available days. Merchant may be closed."}):e.jsx("div",{className:"grid grid-cols-4 gap-2",children:D.map(O=>e.jsx("button",{onClick:()=>{o(O.label)},className:`py-2.5 px-2 rounded-2xl text-sm font-medium transition-colors whitespace-nowrap ${x===O.label?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O.label},O.label))})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("h3",{className:"font-semibold text-gray-800 mb-2.5",children:["Select time",x==="Today"&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(Past times hidden)"})]}),B?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading available times..."}):R.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500",children:x==="Today"?"No more time slots available today. Try tomorrow!":"No available times for this day."}):e.jsx("div",{className:"grid grid-cols-3 gap-2",children:R.map(O=>{const V=b.some(q=>{var z;return q.date===((z=D.find(_=>_.label===x))==null?void 0:z.date.toDateString())&&q.time===O});return e.jsx("button",{onClick:()=>{f(O)},disabled:V,className:`py-2 px-2 rounded-2xl text-xs font-medium transition-colors ${V?"bg-gray-200 text-gray-400 cursor-not-allowed line-through":m===O?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:O},O)})})]}),e.jsx("button",{onClick:()=>{Z()},disabled:!m||g||P||w==="flex",className:`w-full font-semibold py-4 rounded-[1rem] transition-all ${m&&!g&&!P&&w!=="flex"?"bg-gradient-to-r from-orange-400 to-orange-500 text-white hover:from-orange-500 hover:to-orange-600 shadow-lg":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:P?"Loading...":g?"Booking...":w==="flex"?"Become a Member":"Book this deal"})]})]}),e.jsx(Mn,{isOpen:c,onClose:()=>l(!1),message:h}),e.jsx(Tn,{isOpen:N,onClose:()=>{k(!1),a()},onUpgrade:()=>{k(!1),a(),window.dispatchEvent(new CustomEvent("navigate-to-membership"))}})]})}const Ln=5*1024*1024,Rn=["image/jpeg","image/jpg","image/png","image/webp"];function Ka(t){return Rn.includes(t.type)?t.size>Ln?"Image size must be less than 5MB":null:"Please upload a valid image file (JPEG, PNG, or WebP)"}async function On(t,s){const a=Ka(t);if(a)throw new Error(a);const r=t.name.split(".").pop(),x=`${Date.now()}.${r}`,o=`user_profile/${s}/${x}`,{data:m,error:f}=await J.storage.from("user_images").upload(o,t,{cacheControl:"3600",upsert:!1});if(f)throw new Error(f.message||"Failed to upload profile picture");const{data:{publicUrl:g}}=J.storage.from("user_images").getPublicUrl(o);return Ea(o),{path:o,publicUrl:g}}async function Un(t){const{error:s}=await J.storage.from("user_images").remove([t]);if(s)throw new Error(s.message||"Failed to delete profile picture")}async function zn(t,s){const a=Ka(t);if(a)throw new Error(a);const r=t.name.split(".").pop(),o=`MC_Review_images/${`review_${s}_${Date.now()}.${r}`}`,{data:m,error:f}=await J.storage.from("merchant-images").upload(o,t,{cacheControl:"3600",upsert:!1});if(f)throw new Error(f.message||"Failed to upload review image");const{data:{publicUrl:g}}=J.storage.from("merchant-images").getPublicUrl(o);return{path:o,publicUrl:g}}async function $n(t,s){const a=t.map(r=>zn(r,s));return Promise.all(a)}function qn({targetType:t,targetId:s,targetName:a,onClose:r,onSuccess:x}){const[o,m]=n.useState(0),[f,g]=n.useState(0),[p,c]=n.useState(""),[l,h]=n.useState(0),[u,b]=n.useState(0),[E,B]=n.useState(0),[j,v]=n.useState(0),[y,d]=n.useState(!1),[i,C]=n.useState(""),[A,w]=n.useState([]),[F,N]=n.useState(!1),k=n.useRef(null),P=async()=>{if(o===0){C("Please select a rating");return}if(!p.trim()){C("Please write a review");return}d(!0),C("");try{if(Ae("USE_EDGE_REVIEWS"))await Gt.createReview({merchantId:s,rating:o,comment:p.trim()});else{const S={target_type:t,target_id:s,rating:o,comment:p.trim(),food_rating:l||void 0,service_rating:u||void 0,ambiance_rating:E||void 0,value_rating:j||void 0,images:A.length>0?A:void 0};await Ht.createReview(S)}x(),r()}catch(S){C(S.message||"Failed to submit review")}finally{d(!1)}},L=async S=>{const I=Array.from(S.target.files||[]);if(I.length!==0){if(A.length+I.length>5){C("You can only upload up to 5 images");return}N(!0),C("");try{const{data:{user:M}}=await J.auth.getUser();if(!M)throw new Error("Not authenticated");const T=(await $n(I,M.id)).map(D=>D.path);w(D=>[...D,...T])}catch(M){C(M.message||"Failed to upload images")}finally{N(!1),k.current&&(k.current.value="")}}},$=S=>{w(I=>I.filter((M,H)=>H!==S))},U=({value:S,onChange:I,size:M="large"})=>{const[H,T]=n.useState(0),D=M==="large"?"w-12 h-12":"w-8 h-8";return e.jsx("div",{className:"flex gap-2",children:[1,2,3,4,5].map(R=>e.jsx("button",{type:"button",onClick:()=>I(R),onMouseEnter:()=>T(R),onMouseLeave:()=>T(0),className:"transition-transform hover:scale-110",children:e.jsx(tt,{className:`${D} transition-colors ${R<=(H||S)?"fill-orange-400 text-orange-400":"fill-gray-200 text-gray-200"}`})},R))})};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-end justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-lg max-h-[90vh] overflow-hidden flex flex-col animate-slide-up",children:[e.jsx("div",{className:"sticky top-0 bg-white z-10 pt-3 pb-2",children:e.jsx("div",{onClick:r,className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto mb-4 cursor-pointer active:cursor-grabbing"})}),e.jsx("div",{className:"flex items-center justify-between px-6 pb-4 border-b border-gray-100",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Write a Review"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Overall Rating"}),e.jsx(U,{value:o,onChange:m,size:"large"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:[o===0&&"Tap to rate",o===1&&"Poor",o===2&&"Fair",o===3&&"Good",o===4&&"Very Good",o===5&&"Excellent"]})]}),t==="merchant"&&e.jsxs("div",{className:"space-y-4 bg-gray-50 rounded-2xl p-4",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Rate Your Experience"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Food Quality"}),e.jsx(U,{value:l,onChange:h,size:"small"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Service"}),e.jsx(U,{value:u,onChange:b,size:"small"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Ambiance"}),e.jsx(U,{value:E,onChange:B,size:"small"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Value for Money"}),e.jsx(U,{value:j,onChange:v,size:"small"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Review"}),e.jsx("textarea",{value:p,onChange:S=>c(S.target.value),placeholder:"Share your experience...",rows:5,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:outline-none focus:ring-2 focus:ring-orange-500 resize-none"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[p.length," characters"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-3",children:"Add Photos (Optional)"}),A.length>0&&e.jsx("div",{className:"grid grid-cols-3 gap-2 mb-3",children:A.map((S,I)=>{const M=J.storage.from("merchant-images").getPublicUrl(S).data.publicUrl;return e.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden bg-gray-100",children:[e.jsx("img",{src:M,alt:`Review ${I+1}`,className:"w-full h-full object-cover"}),e.jsx("button",{type:"button",onClick:()=>$(I),className:"absolute top-1 right-1 w-6 h-6 bg-red-500 hover:bg-red-600 rounded-full flex items-center justify-center shadow-lg transition-colors",children:e.jsx(we,{className:"w-4 h-4 text-white"})})]},I)})}),A.length<5&&e.jsx("button",{type:"button",onClick:()=>{var S;return(S=k.current)==null?void 0:S.click()},disabled:F,className:"w-full border-2 border-dashed border-gray-300 rounded-xl p-6 hover:border-orange-400 hover:bg-orange-50 transition-colors flex flex-col items-center justify-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",children:F?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-8 h-8 text-gray-400 animate-spin"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Lt,{className:"w-8 h-8 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Add photos"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Up to 5 images"})]})}),e.jsx("input",{ref:k,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",multiple:!0,onChange:L,className:"hidden"})]}),i&&e.jsx("div",{className:"bg-red-50 text-red-600 px-4 py-3 rounded-lg text-sm",children:i})]})}),e.jsx("div",{className:"p-6 border-t border-gray-100",children:e.jsx("button",{onClick:P,disabled:y||o===0,className:"w-full bg-orange-500 text-white py-4 rounded-xl font-semibold hover:bg-orange-600 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:y?e.jsxs(e.Fragment,{children:[e.jsx(Re,{className:"w-5 h-5 animate-spin"}),"Submitting..."]}):"Submit Review"})})]})})}function Hn({station:t,onBack:s}){const[a,r]=n.useState(!1),[x,o]=n.useState(!1),[m,f]=n.useState(t);n.useEffect(()=>{p(),g()},[t.id]);const g=async()=>{try{const v=Ae("USE_EDGE_MERCHANTS")?await mt.getMerchantById(t.id):await dt.getMerchantById(t.id),y=v.subcategoryName||v.category_name;f({...t,subcategoryName:y,city:v.city,specialty:v.specialty,address:v.address,openDays:v.open_days,openTime:v.open_time})}catch{}},p=async()=>{try{if(Ae("USE_EDGE_LIKED_MERCHANTS")){const y=(await Ue.getLikedMerchants()).some(d=>d.id===t.id||d.merchantId===t.id);r(y)}else{const v=await it.isLiked(t.id);r(v)}}catch{r(!1)}},c=async()=>{if(x)return;const v=a;r(!v),o(!0);try{Ae("USE_EDGE_LIKED_MERCHANTS")?v?await Ue.unlikeMerchant(t.id):await Ue.likeMerchant(t.id):v?await it.removeLikedMerchant(t.id):await it.addLikedMerchant(t.id)}catch(y){r(v);const d=y instanceof Error?y.message:String(y);alert(`Failed to ${v?"unlike":"like"} station: ${d}`)}finally{o(!1)}},l=async()=>{const v={title:t.name,text:`Check out ${t.name} charging station`,url:window.location.href};try{navigator.share?await navigator.share(v):(await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!"))}catch(y){y instanceof Error&&y.name}},h=()=>{if(!t.openTime)return"Open â€¢ 11:00 - 21:00";const v=t.openTime.match(/(\d{1,2}:\d{2})\s*[-â€“]\s*(\d{1,2}:\d{2})/);return v?`Open â€¢ ${v[1]} - ${v[2]}`:`Open â€¢ ${t.openTime}`},u=()=>{let v;t.latitude&&t.longitude?v=`https://www.google.com/maps/search/?api=1&query=${t.latitude},${t.longitude}`:v=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t.address||t.name)}`,window.open(v,"_blank")},b=t.occupiedSlots||0,E=t.returnSlots||0,B=t.unitPrice||"Free",j=t.unitMin||"60";return t.totalSlots,e.jsx("div",{className:"fixed inset-0 bg-white z-50 flex items-end",children:e.jsxs("div",{className:"w-full max-w-md mx-auto bg-white rounded-t-3xl shadow-2xl relative",style:{maxHeight:"85vh"},children:[e.jsx("button",{className:"absolute -top-[23px] right-6 w-14 h-14 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 shadow-lg flex items-center justify-center z-30 hover:shadow-xl transition-shadow active:scale-95",children:e.jsx(gt,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{className:"relative h-52 overflow-hidden",style:{borderTopLeftRadius:"24px",borderTopRightRadius:"24px"},children:[e.jsx("img",{src:t.image,alt:t.name,className:"w-full h-full object-cover rounded-t-3xl",style:{maskImage:"radial-gradient(circle 30px at top 5px right 52px, transparent 30px, black 30.5px)",WebkitMaskImage:"radial-gradient(circle 30px at top 5px right 52px, transparent 30px, black 30.5px)"},onError:v=>{const y=v.currentTarget;y.src="https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800&h=600&fit=crop"}}),e.jsx("button",{onClick:s,className:"absolute top-6 left-6 w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg hover:bg-gray-50 transition-colors z-10",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsxs("div",{className:"absolute top-6 right-6 flex gap-2 z-10",children:[e.jsx("button",{onClick:c,disabled:x,className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${a?"bg-red-50 hover:bg-red-100":"bg-white hover:bg-gray-50"} disabled:opacity-50`,children:e.jsx(Ze,{className:`w-5 h-5 transition-all duration-200 ${a?"fill-red-500 text-red-500":"text-gray-800"}`})}),e.jsx("button",{onClick:l,className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg hover:bg-gray-50 transition-colors",children:e.jsx(zt,{className:"w-5 h-5 text-gray-800"})})]})]}),e.jsxs("div",{className:"p-6 pb-8 overflow-y-auto",style:{maxHeight:"calc(85vh - 13rem)"},children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-3",children:m.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[m.subcategoryName&&e.jsx("span",{className:"font-bold text-slate-800 truncate",style:{minWidth:0},children:m.subcategoryName}),e.jsxs("span",{className:"text-gray-600 flex-shrink-0",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"City: "}),m.city]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 mb-1",children:[e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:m.address})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(We,{className:"w-4 h-4 text-orange-500 flex-shrink-0"}),e.jsx("span",{className:"text-orange-500 font-medium",children:h()})]})]}),e.jsxs("div",{className:"mb-5",children:[m.specialty&&m.specialty.length>0&&e.jsx("h2",{className:"text-lg font-bold text-slate-900 mb-3",children:m.specialty.join(", ")}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(lt,{className:"w-5 h-5 text-orange-500"})}),e.jsxs("span",{className:"text-sm text-slate-700 font-medium",children:["â‚¬ ",B," / ",j," Min"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(lt,{className:"w-5 h-5 text-orange-500"})}),e.jsxs("span",{className:"text-sm text-slate-700 font-medium",children:[b," PB Available"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(lt,{className:"w-5 h-5 text-gray-500"})}),e.jsxs("span",{className:"text-sm text-slate-700 font-medium",children:[E," Return slots"]})]})]}),e.jsx("div",{className:"bg-gradient-to-br from-gray-800 to-gray-900 rounded-2xl p-6 flex items-center justify-center overflow-hidden",children:e.jsx("img",{src:"https://dopjawhuylqipltnuydp.supabase.co/storage/v1/object/public/merchant-images/Category_Icons/Charging%20station.png",alt:"Charging Station Interface",className:"w-full h-auto max-w-[240px] object-contain"})})]}),e.jsxs("button",{onClick:u,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-md flex items-center justify-center gap-2",children:[e.jsx(Ce,{className:"w-5 h-5"}),"Go There"]})]})]})})}function e0({restaurant:t,onBack:s,onBookingComplete:a}){if(t.businessType==="chargingonly")return e.jsx(Hn,{station:{id:t.id,name:t.name,address:t.address,city:t.city,image:t.image,subcategoryName:t.subcategoryName,specialty:t.specialty,latitude:t.latitude,longitude:t.longitude,openDays:t.open_days,openTime:t.open_time,availableSlots:t.availableSlots,occupiedSlots:t.occupiedSlots,totalSlots:t.totalSlots,returnSlots:t.returnSlots,unitPrice:t.unitPrice,unitMin:t.unitMin},onBack:s});const[r,x]=n.useState("about"),[o,m]=n.useState(!1),[f,g]=n.useState(null),[p,c]=n.useState(null),[l,h]=n.useState(0),[u,b]=n.useState([]),[E,B]=n.useState(!1),[j,v]=n.useState(!1),[y,d]=n.useState(!1),[i,C]=n.useState(!1),[A,w]=n.useState(!0),[F,N]=n.useState(0),[k,P]=n.useState(0),L=n.useRef(null),$=n.useRef({}),U=n.useRef(null),S=n.useRef(null),[I,M]=n.useState([]),[H,T]=n.useState(!1),D=()=>{if(t.coverImageIds&&t.coverImageIds.length>0){const G=t.coverImageIds.slice(0,5).map(ae=>ke(ae,"cover",{width:1200,height:600,quality:85})).filter(ae=>ae!==null);if(G.length>0)return jt([{coverImageIds:t.coverImageIds,logoId:t.logoId}],1),G}if(t.logoId){const G=ke(t.logoId,"logo",{width:1200,height:800});if(G)return[G]}return t.image?[t.image]:[]},[R,Z]=n.useState(D()),[O,V]=n.useState(!1),[q,z]=n.useState(t);n.useEffect(()=>{(async()=>{V(!0);try{const ae=Ae("USE_EDGE_MERCHANTS")?await mt.getMerchantById(t.id):await dt.getMerchantById(t.id),fe=ae.subcategoryName||ae.category_name;z({...t,subcategoryName:fe,city:ae.city,specialty:ae.specialty,rating:ae.rating??0,reviewCount:ae.reviewCount??0,status:ae.status,address:ae.address,open_days:ae.open_days,open_time:ae.open_time});const ie=Ae("USE_EDGE_MERCHANTS")?mt.getMerchantCoverImages(ae,5):dt.getMerchantCoverImages(ae,5),Be=R.length>0&&!R.includes(t.image);if(ie.length>0){const le=ae.coverImageIds||[],de=t.coverImageIds||[];(JSON.stringify(le)!==JSON.stringify(de)||!Be)&&(Z(ie),jt([ae],1))}else if(!Be){if(ae.logoId){const le=ke(ae.logoId,"merchant",{width:1200,height:800});Z([le])}else if(ae.image_url){const le=ke(ae.image_url,"merchant",{width:1200,height:800});Z([le])}}}catch{R.length===0&&t.image&&Z([t.image])}finally{V(!1)}})()},[t.id]);const _=R,W=t.deals&&t.deals.length>0?t.deals.map(G=>{const ae=G.imageUrl||G.image||G.imageIds&&G.imageIds[0];return{id:String(G.id),title:G.title,description:G.description||"",discount:G.discount?`${G.discount}% OFF`:"Deal",averagePrice:G.price||G.averagePrice||0,image:qt(ae),badge:G.discount?`${G.discount}% OFF`:G.badge,savings:G.saveValue||G.savings||0,duration:90,isOnsite:!0}}):[],X=(()=>{if(!t.open_days||!t.open_time)return[{day:"Monday",hours:"11:00 - 21:00"},{day:"Tuesday",hours:"11:00 - 21:00"},{day:"Wednesday",hours:"11:00 - 21:00"},{day:"Thursday",hours:"11:00 - 21:00"},{day:"Friday",hours:"11:00 - 21:00"},{day:"Saturday",hours:"12:00 - 22:00"},{day:"Sunday",hours:"12:00 - 20:00"}];let G=t.open_time;const ae=G.match(/(\d{1,2}:\d{2})\s*[-â€“]\s*(\d{1,2}:\d{2})/);ae&&(G=`${ae[1]} - ${ae[2]}`);const fe=t.open_days.toLowerCase().split(",").map(le=>le.trim()),ie={sun:"Sunday",sunday:"Sunday",mon:"Monday",monday:"Monday",tue:"Tuesday",tuesday:"Tuesday",wed:"Wednesday",wednesday:"Wednesday",thu:"Thursday",thursday:"Thursday",fri:"Friday",friday:"Friday",sat:"Saturday",saturday:"Saturday"},Be=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],se=fe.map(le=>ie[le.toLowerCase()]).filter(Boolean);return Be.map(le=>({day:le,hours:se.includes(le)?G:"Closed"}))})(),te=(()=>{if(!t.open_days||!t.open_time)return!1;const G=new Date,ae=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"][G.getDay()];if(!t.open_days.toLowerCase().split(",").map(Se=>Se.trim()).includes(ae))return!1;const ie=t.open_time.match(/(\d{1,2}):(\d{2})\s*[-â€“]\s*(\d{1,2}):(\d{2})/);if(!ie)return!1;const Be=parseInt(ie[1]),se=parseInt(ie[2]),le=parseInt(ie[3]),de=parseInt(ie[4]),Q=G.getHours()*60+G.getMinutes(),K=Be*60+se,Fe=le*60+de;return Q>=K&&Q<Fe})(),oe=G=>{c(G)},Y=G=>{g(G)};n.useEffect(()=>{W.length>0&&!p?c(W[0]):W.length===0&&c(null)},[W,p]),n.useEffect(()=>{},[p]),n.useEffect(()=>{},[f]),n.useEffect(()=>{if(!p)return;const G=L.current,ae=$.current[p.id];if(G&&ae){const fe=G.clientWidth,ie=ae.offsetLeft,Be=ae.offsetWidth,se=ie-fe/2+Be/2;G.scrollTo({left:se,behavior:"smooth"})}},[p]),n.useEffect(()=>{if(A)return U.current=setInterval(()=>{h(G=>(G+1)%_.length)},3e3),()=>{U.current&&clearInterval(U.current)}},[_.length,A]);const ee=G=>{N(G.targetTouches[0].clientX),w(!1),S.current&&clearTimeout(S.current)},xe=G=>{P(G.targetTouches[0].clientX)},me=()=>{if(!F||!k)return;const G=F-k,ae=G>50,fe=G<-50;ae&&h(ie=>(ie+1)%_.length),fe&&h(ie=>(ie-1+_.length)%_.length),N(0),P(0),S.current=setTimeout(()=>{w(!0)},5e3)},ce=n.useCallback(async()=>{B(!0);try{const G=t.parentMerchantId||t.id,ae=Ae("USE_EDGE_REVIEWS")?await Gt.getMerchantReviews(G):await Ht.getReviews("merchant",G);Array.isArray(ae)?b(ae):b([])}catch{b([])}finally{B(!1)}},[t.id,t.parentMerchantId,t.name,t.reviewCount]),Le=async()=>{T(!0);try{const G=await Ca.getMenuItems(t.id);M(G)}catch{M([])}finally{T(!1)}};n.useEffect(()=>{r==="menu"&&Le()},[r,t.id]),n.useEffect(()=>{r==="reviews"&&ce()},[r,t.id,ce]),n.useEffect(()=>{pe()},[t.id]);const pe=async()=>{try{const G=t.parentMerchantId||t.id;if(Ae("USE_EDGE_LIKED_MERCHANTS")){const ae=await Ue.getLikedMerchants();ae.length>0;const fe=ae.some(ie=>{const Be=ie.id===G||ie.merchantId===G;return Be});m(fe)}else{const ae=await it.isLiked(G);m(ae)}}catch{m(!1)}},Me=async()=>{if(y)return;const G=o,ae=!G,fe=t.parentMerchantId||t.id;m(ae),d(!0);try{if(Ae("USE_EDGE_LIKED_MERCHANTS"))if(G){const ie=await Ue.unlikeMerchant(fe)}else{const ie=await Ue.likeMerchant(fe)}else G?await it.removeLikedMerchant(fe):await it.addLikedMerchant(fe)}catch(ie){m(G);const Be=ie instanceof Error?ie.message:String(ie);alert(`Failed to ${G?"unlike":"like"} merchant: ${Be}`)}finally{d(!1)}},Xe=async()=>{const G=q.specialty&&q.specialty.length>0?` - ${q.specialty.join(", ")}`:"",ae={title:t.name,text:`Check out ${t.name}${G}`,url:window.location.href};try{navigator.share?await navigator.share(ae):(await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!"))}catch(fe){if(fe instanceof Error&&fe.name!=="AbortError")try{await navigator.clipboard.writeText(window.location.href),alert("Link copied to clipboard!")}catch{}}},es=G=>new Date(G).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"});return e.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"w-full max-w-md mx-auto pb-4",children:[e.jsxs("div",{className:"relative h-80 bg-gray-200",onTouchStart:ee,onTouchMove:xe,onTouchEnd:me,children:[e.jsx("img",{src:_[l],alt:t.name,className:"w-full h-full object-cover object-center transition-opacity duration-300",loading:l===0?"eager":"lazy",fetchPriority:l===0?"high":"auto",decoding:"async",onError:G=>{},onLoad:()=>{}}),e.jsxs("div",{className:"absolute top-4 left-4 right-4 flex items-center justify-between",children:[e.jsx("button",{onClick:s,className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg hover:bg-gray-50 transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:Me,disabled:y,className:`w-10 h-10 rounded-full flex items-center justify-center shadow-lg transition-all duration-200 ${o?"bg-red-50 hover:bg-red-100":"bg-white hover:bg-gray-50"} disabled:opacity-50`,children:e.jsx(Ze,{className:`w-5 h-5 transition-all duration-200 ${o?"fill-red-500 text-red-500":"text-gray-800"}`})}),e.jsx("button",{onClick:Xe,className:"w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-lg hover:bg-gray-50 transition-colors",children:e.jsx(zt,{className:"w-5 h-5 text-gray-800"})})]})]}),e.jsx("div",{className:"absolute bottom-4 left-0 right-0 flex justify-center gap-1.5",children:_.map((G,ae)=>e.jsx("button",{onClick:()=>h(ae),className:`h-2 rounded-full transition-all ${ae===l?"bg-slate-800 w-8":"bg-white/60 w-2"}`},ae))})]}),e.jsxs("div",{className:"px-5 pt-5",children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900 mb-3",children:q.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm mb-1",children:[q.subcategoryName&&e.jsx("span",{className:"font-bold text-slate-800 truncate",style:{minWidth:0},children:q.subcategoryName}),e.jsxs("span",{className:"text-gray-600 flex-shrink-0",children:[e.jsx("span",{className:"font-semibold text-slate-800",children:"City: "}),q.city]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-semibold whitespace-nowrap flex-shrink-0 ${te?"bg-green-100 text-green-700":"bg-red-100 text-red-700"}`,children:te?"Open":"Closed"})]}),q.occupiedSlots>0&&e.jsxs("div",{className:"text-orange-600 flex items-center gap-0.5 text-sm mb-5",children:[e.jsx("span",{className:"leading-none",children:"âš¡"}),e.jsxs("span",{className:"font-medium leading-none",children:[q.occupiedSlots," PB Available"]})]}),!q.occupiedSlots&&e.jsx("div",{className:"mb-5"}),W.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("h2",{className:"text-base font-bold text-slate-900 mb-3",children:"Select a deal:"}),e.jsx("div",{ref:L,className:"flex gap-3 overflow-x-auto pb-2 -mx-5 px-5 scrollbar-hide scroll-smooth",style:{WebkitOverflowScrolling:"touch"},children:W.map((G,ae)=>{const fe=["#E4F5FE","#FFE8DC","#D9F8EF"],ie=fe[ae%fe.length];return e.jsxs("button",{type:"button",ref:Be=>$.current[G.id]=Be,onClick:()=>oe(G),className:"flex-shrink-0 w-36 rounded-lg overflow-hidden relative cursor-pointer active:scale-95 transition-transform select-none",style:{backgroundColor:ie,touchAction:"manipulation"},children:[e.jsxs("div",{className:"relative pointer-events-none",children:[e.jsx("img",{src:G.image,alt:G.title,className:"w-full h-24 object-cover",loading:ae<3?"eager":"lazy",decoding:"async",draggable:"false",onError:Be=>{const se=Be.currentTarget;!se.src.includes("pexels.com")&&!se.src.includes("unsplash.com")&&(se.src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&h=300&fit=crop")}}),(p==null?void 0:p.id)===G.id&&e.jsxs("div",{className:"absolute top-1.5 left-1.5 bg-orange-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-full flex items-center gap-1",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-white rounded-full"}),"Selected"]})]}),e.jsxs("div",{className:"p-2.5 text-left pointer-events-none",children:[e.jsx("p",{className:"text-xs font-semibold mb-1 line-clamp-2",style:{color:"#203F55"},children:G.title}),G.averagePrice>0&&e.jsxs("p",{className:"text-[10px]",style:{color:"#203F55"},children:["Average price: â‚¬",G.averagePrice]})]})]},G.id)})})]}),W.length>0&&p&&e.jsxs("div",{className:"bg-cyan-50 rounded-2xl p-4 mb-5 relative",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 flex-1 pr-2",children:p.title}),e.jsx("button",{onClick:()=>C(!0),className:"w-7 h-7 bg-cyan-100 rounded-full flex items-center justify-center flex-shrink-0 hover:bg-cyan-200 transition-colors",children:e.jsx(nt,{className:"w-3.5 h-3.5 text-cyan-700"})})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3 text-xs",children:[p.savings&&e.jsx("div",{className:"flex items-center gap-1.5 text-slate-700 text-xs",children:e.jsxs("span",{className:"font-medium",children:[e.jsx("span",{className:"text-sm",children:"â‚¬"}),p.savings," Saving"]})}),p.duration&&e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-700",children:[e.jsx("svg",{className:"w-3.5 h-3.5",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"currentColor",d:"M20.924 5.617a1 1 0 0 0-.217-.324l-3-3a1 1 0 1 0-1.414 1.414L17.586 5H8a5 5 0 0 0-5 5v2a1 1 0 1 0 2 0v-2a3 3 0 0 1 3-3h9.586l-1.293 1.293a1 1 0 0 0 1.414 1.414l3-3A1 1 0 0 0 21 6m-.076-.383a1 1 0 0 1 .076.38zm-17.848 12a1 1 0 0 0 .217 1.09l3 3a1 1 0 0 0 1.414-1.414L6.414 19H16a5 5 0 0 0 5-5v-2a1 1 0 1 0-2 0v2a3 3 0 0 1-3 3H6.414l1.293-1.293a1 1 0 1 0-1.414-1.414l-3 3m-.217.324a1 1 0 0 1 .215-.322z"})}),e.jsxs("span",{className:"font-medium",children:[p.duration," days"]})]}),p.isOnsite&&e.jsxs("div",{className:"flex items-center gap-1.5 text-slate-700",children:[e.jsx(Ce,{className:"w-3.5 h-3.5"}),e.jsx("span",{className:"font-medium",children:"On-site"})]})]}),e.jsx("p",{className:"text-sm text-slate-700 mb-4 leading-relaxed",children:p.description}),e.jsx("button",{type:"button",onClick:G=>{G.preventDefault(),G.stopPropagation(),Y(p)},className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-3.5 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-md cursor-pointer active:scale-98",children:"Get this deal"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-5",children:e.jsxs("div",{className:"flex",children:[e.jsxs("button",{onClick:()=>x("about"),className:`flex-1 pb-3 font-bold text-sm transition-colors relative ${r==="about"?"text-slate-900":"text-gray-400"}`,children:["About",r==="about"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-orange-500 rounded-t"})]}),e.jsxs("button",{onClick:()=>x("menu"),className:`flex-1 pb-3 font-bold text-sm transition-colors relative ${r==="menu"?"text-slate-900":"text-gray-400"}`,children:["Menu",r==="menu"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-orange-500 rounded-t"})]}),e.jsxs("button",{onClick:()=>x("reviews"),className:`flex-1 pb-3 font-bold text-sm transition-colors relative ${r==="reviews"?"text-slate-900":"text-gray-400"}`,children:["Reviews",r==="reviews"&&e.jsx("div",{className:"absolute bottom-0 left-0 right-0 h-1 bg-orange-500 rounded-t"})]})]})}),r==="about"&&e.jsxs("div",{children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-2",children:"Specialty:"}),e.jsx("p",{className:"text-sm text-slate-700 leading-relaxed",children:q.specialty&&q.specialty.length>0?q.specialty.join(", "):"No specialty information available"})]}),q.reviewCount>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-2",children:"Ratings & reviews"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(tt,{className:"w-4 h-4 fill-orange-500 text-orange-500"}),e.jsxs("span",{className:"text-sm text-slate-700",children:[q.rating.toFixed(1)," average | ",q.reviewCount," ",q.reviewCount===1?"review":"reviews"]})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-3",children:"Location:"}),e.jsx("button",{onClick:()=>{let G;t.latitude&&t.longitude?G=`https://www.google.com/maps/search/?api=1&query=${t.latitude},${t.longitude}`:G=`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(t.address||t.name)}`,window.open(G,"_blank")},className:"w-full",children:e.jsxs("div",{className:"relative h-48 bg-gray-200 rounded-2xl overflow-hidden group hover:bg-gray-300 transition-all",children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full",viewBox:"0 0 400 300",fill:"none",xmlns:"http://www.w3.org/2000/svg",preserveAspectRatio:"xMidYMid slice",children:[e.jsx("rect",{width:"400",height:"300",fill:"#e5e5e5"}),e.jsx("path",{d:"M20 80 Q80 60 120 100 L180 140 L220 100 Q260 80 320 120",stroke:"#d4d4d4",strokeWidth:"8",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M10 160 Q50 140 100 180 L140 200 Q180 220 240 180 L300 160 L380 200",stroke:"#d4d4d4",strokeWidth:"8",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M30 250 L100 220 Q140 200 180 240 L260 270",stroke:"#d4d4d4",strokeWidth:"8",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M50 40 Q80 30 100 60 L120 90",stroke:"#d4d4d4",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M280 60 Q300 80 320 60 L340 40",stroke:"#d4d4d4",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),e.jsx("path",{d:"M360 180 Q370 200 390 180",stroke:"#d4d4d4",strokeWidth:"5",fill:"none",strokeLinecap:"round"}),e.jsx("text",{x:"30",y:"95",fill:"#9ca3af",fontSize:"8",fontFamily:"Arial",transform:"rotate(-15 30 95)",children:"Park Ave"}),e.jsx("text",{x:"260",y:"110",fill:"#9ca3af",fontSize:"8",fontFamily:"Arial",transform:"rotate(20 260 110)",children:"Main St"}),e.jsx("text",{x:"150",y:"195",fill:"#9ca3af",fontSize:"8",fontFamily:"Arial",transform:"rotate(-10 150 195)",children:"Oak Road"}),e.jsx("text",{x:"80",y:"240",fill:"#9ca3af",fontSize:"8",fontFamily:"Arial",children:"Central Ave"}),e.jsx("text",{x:"300",y:"70",fill:"#9ca3af",fontSize:"7",fontFamily:"Arial",children:"Hill Dr"})]}),e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:[e.jsx("div",{className:"w-16 h-16 mb-2 flex items-center justify-center",children:e.jsx("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z",fill:"#EA4335"})})}),e.jsx("p",{className:"font-semibold text-[#0f172a]",children:"Click to view on map"}),e.jsx("p",{className:"text-sm text-[#0F152A] opacity-75",children:t.address||t.name})]})]})})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-3",children:"Open hours"}),e.jsx("div",{className:"space-y-2.5",children:X.map((G,ae)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-slate-900 font-medium",children:G.day}),e.jsx("span",{className:"text-sm text-slate-600",children:G.hours})]},ae))})]})]}),r==="menu"&&e.jsx("div",{className:"py-3",children:H?e.jsx("div",{className:"py-12 text-center text-gray-500",children:e.jsx("p",{children:"Loading menu..."})}):I.length>0?e.jsx("div",{className:"space-y-4",children:["appetizer","main","dessert","drink","other"].map(G=>{const ae=I.filter(ie=>ie.category===G);if(ae.length===0)return null;const fe={appetizer:"Appetizers",main:"Main Dishes",dessert:"Desserts",drink:"Drinks",other:"Other"};return e.jsxs("div",{children:[e.jsx("h3",{className:"text-base font-bold text-slate-900 mb-2 px-6 capitalize",children:fe[G]}),e.jsx("div",{className:"space-y-1",children:ae.map(ie=>e.jsx("div",{className:"px-6 py-2 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-slate-900",children:ie.name}),ie.description&&e.jsx("p",{className:"text-sm text-gray-600 mt-0.5",children:ie.description}),!ie.isAvailable&&e.jsx("span",{className:"inline-block mt-0.5 text-xs text-red-600 font-medium",children:"Currently unavailable"})]}),e.jsx("div",{className:"ml-3 text-right flex-shrink-0",children:e.jsxs("span",{className:"font-bold text-slate-900",children:["â‚¬",ie.price.toFixed(2)]})})]})},ie.id))})]},G)})}):e.jsx("div",{className:"py-12 text-center text-gray-500",children:e.jsx("p",{children:"No menu items available"})})}),r==="reviews"&&e.jsxs("div",{className:"space-y-4",children:[u.length>0&&e.jsxs("div",{className:"flex items-center justify-between pb-3",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-900",children:"Ratings & Reviews"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[q.reviewCount," ratings"]})]}),E?e.jsx("div",{className:"py-12 text-center text-gray-500",children:e.jsx("p",{children:"Loading reviews..."})}):u.length===0?e.jsx("div",{className:"flex flex-col items-center py-8",children:e.jsx("p",{className:"text-gray-400",children:"No reviews yet"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex gap-6 pb-4",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("span",{className:"text-5xl font-bold text-gray-900 mb-1",children:q.rating.toFixed(1)}),e.jsx("div",{className:"flex items-center gap-0.5",children:[1,2,3,4,5].map(G=>e.jsx(tt,{className:`w-4 h-4 ${G<=Math.round(q.rating)?"fill-orange-500 text-orange-500":"fill-gray-300 text-gray-300"}`},G))})]}),e.jsx("div",{className:"flex-1",children:[5,4,3,2,1].map(G=>{const ae=u.filter(ie=>Math.round(ie.rating)===G).length,fe=u.length>0?ae/u.length*100:0;return e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("span",{className:"text-sm text-gray-700 w-2",children:G}),e.jsx("div",{className:"flex-1 h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-orange-500 transition-all",style:{width:`${fe}%`}})})]},G)})})]}),e.jsx("div",{className:"space-y-4 pt-2",children:u.map(G=>{const ae=G.userName||G.user_name||"Anonymous",fe=ae.charAt(0).toUpperCase(),ie=G.createdAt||G.created_at;return e.jsx("div",{className:"border-b border-gray-200 pb-3",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-lg font-semibold text-gray-700",children:fe})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:ae}),e.jsx("span",{className:"text-sm text-gray-400",children:ie?es(ie):"Date unavailable"})]}),G.comment&&e.jsx("p",{className:"text-gray-600 text-sm leading-relaxed mb-1.5",children:G.comment}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(Be=>e.jsx(tt,{className:`w-4 h-4 ${Be<=G.rating?"fill-orange-500 text-orange-500":"fill-gray-300 text-gray-300"}`},Be))})]})]})},G.id)})})]})]})]})]})}),f&&e.jsx(_n,{deal:f,restaurant:t,onClose:()=>g(null),onBookingComplete:a}),j&&e.jsx(qn,{targetType:"merchant",targetId:t.id,targetName:t.name,onClose:()=>v(!1),onSuccess:ce}),i&&e.jsx(Za,{onClose:()=>C(!1)})]})}function Wn({selectedCity:t,onSelectCity:s,onClose:a}){const[r,x]=n.useState([]),[o,m]=n.useState(!1),[f,g]=n.useState(null);n.useEffect(()=>{c(),p()},[]);const p=async()=>{try{const d=await Ns();g(d)}catch{}},c=async()=>{try{m(!0);const d=await As();x(d),m(!1)}catch{m(!1)}},l=d=>d==="Netherlands"?"NL":d,u=[...r.map(d=>{const i=l(d.country);if(f&&d.latitude&&d.longitude){const C=ot(f.latitude,f.longitude,d.latitude,d.longitude);return{...d,country:i,distance:C}}return{...d,country:i,distance:void 0}})].sort((d,i)=>d.distance!==void 0&&i.distance!==void 0?d.distance-i.distance:d.distance!==void 0?-1:i.distance!==void 0?1:d.country!==i.country?d.country.localeCompare(i.country):d.name.localeCompare(i.name)),b=u.reduce((d,i)=>{const C=i.country;return d[C]||(d[C]=[]),d[C].push(i),d},{}),E=f&&u.length>0&&u[0].distance!==void 0?u[0].country:null,B=Object.keys(b).sort((d,i)=>{if(E){if(d===E)return-1;if(i===E)return 1}return d.localeCompare(i)}),j={NL:"THE NETHERLANDS",DE:"GERMANY",FR:"FRANCE",ES:"SPAIN",AT:"AUSTRIA"},v={NL:"ðŸ‡³ðŸ‡±",DE:"ðŸ‡©ðŸ‡ª",FR:"ðŸ‡«ðŸ‡·",ES:"ðŸ‡ªðŸ‡¸",AT:"ðŸ‡¦ðŸ‡¹"},y=d=>{s(d),a()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-end justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-2xl max-h-[85vh] flex flex-col animate-slide-up",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-900",children:"Cities"}),e.jsx("button",{onClick:a,className:"w-10 h-10 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-slate-600"})})]}),f&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[e.jsx(Ss,{className:"w-4 h-4"}),e.jsx("span",{children:"Sorted by proximity to your location"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-slate-900"})}):e.jsx("div",{className:"pb-8",children:B.map(d=>e.jsxs("div",{children:[e.jsx("div",{className:"sticky top-0 bg-white px-6 py-4 border-b border-gray-100",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:v[d]||"ðŸ³ï¸"}),e.jsx("span",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide",children:j[d]||d})]})}),e.jsx("div",{className:"divide-y divide-gray-100",children:b[d].map(i=>{const C=i.name.toLowerCase()===t.toLowerCase();return e.jsxs("button",{onClick:()=>y(i.name),className:"w-full px-6 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors text-left",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1",children:[C&&e.jsx("div",{className:"w-10 h-10 rounded-full bg-green-500 flex items-center justify-center flex-shrink-0",children:e.jsx(Qe,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:`text-lg font-medium ${C?"text-slate-900":"text-slate-700"}`,children:i.name}),i.distance!==void 0&&e.jsxs("div",{className:"flex items-center gap-1 text-sm text-slate-500",children:[e.jsx(Ss,{className:"w-3 h-3"}),e.jsxs("span",{children:[i.distance<1?"<1":Math.round(i.distance)," km away"]})]})]})]}),e.jsxs("span",{className:"text-base text-slate-500 font-normal",children:[i.dealCount," ",i.dealCount===1?"Deal":"Deals"]})]},`${d}-${i.name}`)})})]},d))})})]})})}function Gn({selectedFilters:t,onToggleFilter:s,onClose:a,onApply:r}){const x=[{id:"open",label:"Open"},{id:"charging_hub",label:"PB Available"},{id:"returned_slots",label:"Returned Slots"}];return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-end",children:e.jsxs("div",{className:"bg-white w-full rounded-t-3xl max-h-[80vh] flex flex-col animate-slideUp",children:[e.jsxs("div",{className:"flex items-center justify-between px-6 py-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-xl font-semibold text-slate-900",children:"Filters"}),e.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-5 h-5 text-slate-600"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:e.jsx("div",{className:"space-y-3",children:x.map(o=>e.jsx("button",{onClick:()=>s(o.id),className:`w-full px-4 py-3 rounded-xl text-left font-medium transition-all ${t.includes(o.id)?"bg-teal-50 text-teal-700 border-2 border-teal-500":"bg-gray-50 text-slate-700 border-2 border-transparent hover:bg-gray-100"}`,children:o.label},o.id))})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex gap-3",children:[e.jsx("button",{onClick:()=>{x.forEach(o=>{t.includes(o.id)&&s(o.id)})},className:"flex-1 px-4 py-3 rounded-xl font-semibold text-slate-700 bg-gray-100 hover:bg-gray-200 transition-colors",children:"Clear All"}),e.jsx("button",{onClick:()=>{r(),a()},className:"flex-1 px-4 py-3 rounded-xl font-semibold text-white bg-teal-600 hover:bg-teal-700 transition-colors",children:"Apply Filters"})]})]})})}const Yn=[{normalized:"Den Haag",country:"NL",variations:["s-gravenhage","'s-gravenhage","S-GRAVENHAGE","'S-GRAVENHAGE","den haag","Den haag","Den Haag","the hague","The Hague"]}],ls=(t,s)=>{if(!t)return"";const a=t.trim(),r=a.toLowerCase();for(const x of Yn)if(!(s&&x.country!==s)){for(const o of x.variations)if(o.toLowerCase()===r)return x.normalized}return a.charAt(0).toUpperCase()+a.slice(1)};function Vn({restaurants:t,onRestaurantSelect:s,onBack:a,onNavigateToBookings:r,unreadInvitesCount:x=0}){var U;const{userLocation:o,isLoading:m}=Yt(),[f,g]=n.useState("Amsterdam"),[p,c]=n.useState("recommended"),[l,h]=n.useState([]),[u,b]=n.useState(!1),[E,B]=n.useState(null),[j,v]=n.useState(null),[y,d]=n.useState(null),[i,C]=n.useState(!1),[A,w]=n.useState(null),F=S=>{if(!A||!S.latitude||!S.longitude)return null;const I=ot(A.latitude,A.longitude,S.latitude,S.longitude);return I<10?`${I.toFixed(1)}km`:`${Math.round(I)}km`};n.useEffect(()=>{o!=null&&o.city&&o.latitude&&o.longitude&&(g(o.city),w({latitude:o.latitude,longitude:o.longitude}))},[o]),n.useEffect(()=>{(async()=>{if(f)try{const M=(await As()).find(H=>H.name.toLowerCase()===f.toLowerCase());M!=null&&M.latitude&&(M!=null&&M.longitude)?w({latitude:M.latitude,longitude:M.longitude}):!A&&o&&w({latitude:o.latitude,longitude:o.longitude})}catch{}})()},[f]),n.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[f,A]);const N=n.useMemo(()=>t.filter(S=>!(S.businessType==="chargingonly"||S.merchantCategory==="chargingonly"||l.length>0&&(l.includes("open")&&S.status!=="Open"||l.includes("charging_hub")&&(!S.occupiedSlots||S.occupiedSlots===0)||l.includes("returned_slots")&&(!S.returnSlots||S.returnSlots===0)))).sort((S,I)=>{var V,q,z,_;const M=S.country||"NL",H=I.country||"NL",T=ls(S.city||"",M),D=ls(I.city||"",H),R=ls(f,M),Z=T.toLowerCase()===R.toLowerCase(),O=D.toLowerCase()===R.toLowerCase();if(Z&&!O)return-1;if(!Z&&O)return 1;if(p==="recommended"){if(A){const W=S.latitude&&S.longitude?ot(A.latitude,A.longitude,S.latitude,S.longitude):1/0,ne=I.latitude&&I.longitude?ot(A.latitude,A.longitude,I.latitude,I.longitude):1/0;if(W!==ne)return W-ne}return(I.rating||0)-(S.rating||0)}else{if(p==="popular")return(I.reviewCount||0)!==(S.reviewCount||0)?(I.reviewCount||0)-(S.reviewCount||0):(I.rating||0)-(S.rating||0);if(p==="deals"){const W=((V=S.deals)==null?void 0:V.length)||0,ne=((q=I.deals)==null?void 0:q.length)||0;if(W!==ne)return ne-W;const X=Math.max(...((z=S.deals)==null?void 0:z.map(te=>te.saveValue||te.savings||0))||[0]);return Math.max(...((_=I.deals)==null?void 0:_.map(te=>te.saveValue||te.savings||0))||[0])-X}else if(p==="new")return(parseInt(I.id)||0)-(parseInt(S.id)||0)}return 0}),[t,f,A,p,l]);N.length>0&&A&&N.slice(0,5).forEach((S,I)=>{const M=S.latitude&&S.longitude?ot(A.latitude,A.longitude,S.latitude,S.longitude):null;M&&(M<10?`${M.toFixed(1)}`:`${Math.round(M)}`)});const k=N.slice(0,3),P=N;n.useEffect(()=>{if(N.length>0){const S=N.slice(0,5).map(I=>({coverImageIds:I.coverImageIds||void 0,logoId:I.logoId||void 0}));jt(S,5)}},[N]);const L=S=>{B(S)},$=(S,I)=>{const M={id:S.id||S.bookingId||"",user_id:S.userId||S.user_id||"",restaurant_id:S.merchantId||S.merchant_id||"",booking_date:S.bookingDate||S.booking_date||"",booking_time:S.booking_time||S.bookingTime||"",party_size:S.guests||S.party_size||1,booking_type:"single",status:S.status||"confirmed",created_at:S.createdAt||S.created_at||new Date().toISOString()},T=S.restaurant||S.merchant||I,D={id:T.id||I.id||"",name:T.name||I.name||"",address:T.address||I.address||"",category:"Restaurant",image_url:T.image_url||I.image||I.image_url};!M.id||!M.booking_date||!M.booking_time||!D.name||!D.address||(v(M),d(D),B(null))};return j&&y?e.jsx(Xa,{booking:j,restaurant:y,onGoToBookings:()=>{v(null),d(null),r()},onExploreMore:()=>{v(null),d(null)}}):E?e.jsx(e0,{restaurant:{...E,image:ke(((U=E.coverImageIds)==null?void 0:U[0])||E.logoId||E.image_url,"merchant",{width:1200,height:800}),specialty:E.specialty&&E.specialty.length>0?E.specialty:[],subcategoryName:E.subcategoryName,city:xt(E.address||"",E.city),status:"Open",address:E.address,rating:E.rating||0,reviewCount:E.reviewCount||0,latitude:E.latitude,longitude:E.longitude,coverImageIds:E.coverImageIds??void 0,logoId:E.logoId??void 0,open_days:E.open_days,open_time:E.open_time,businessType:E.businessType,availableSlots:E.availableSlots,occupiedSlots:E.occupiedSlots,totalSlots:E.totalSlots,returnSlots:E.returnSlots,unitPrice:E.unitPrice,unitMin:E.unitMin,parentMerchantId:E.parentMerchantId},onBack:()=>B(null),onBookingComplete:$}):e.jsxs("div",{className:"fixed inset-0 bg-white flex flex-col overflow-hidden",children:[e.jsxs("div",{className:"bg-white px-6 pt-5 pb-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>C(!0),className:"flex items-center gap-2 hover:bg-gray-50 transition-colors rounded-lg px-2 py-1 -ml-2",children:[e.jsx(Ce,{className:"w-5 h-5 text-slate-700"}),e.jsx("span",{className:"font-semibold text-slate-900 text-lg",children:m?"Detecting...":f}),e.jsx(Ut,{className:"w-5 h-5 text-slate-700"})]}),e.jsxs("button",{onClick:()=>b(!0),className:"relative flex items-center justify-center w-10 h-10 rounded-full bg-gray-100 hover:bg-gray-200 transition-colors",children:[e.jsx(C0,{className:"w-5 h-5 text-slate-700"}),l.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 rounded-full bg-teal-600 text-white text-xs flex items-center justify-center font-semibold",children:l.length})]})]}),e.jsxs("div",{className:"flex gap-2 overflow-x-auto scrollbar-hide",children:[e.jsx("button",{onClick:()=>c("recommended"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${p==="recommended"?"bg-teal-600 text-white":"bg-gray-100 text-slate-700 hover:bg-gray-200"}`,children:"Recommended"}),e.jsx("button",{onClick:()=>c("popular"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${p==="popular"?"bg-teal-600 text-white":"bg-gray-100 text-slate-700 hover:bg-gray-200"}`,children:"Most Popular"}),e.jsx("button",{onClick:()=>c("deals"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${p==="deals"?"bg-teal-600 text-white":"bg-gray-100 text-slate-700 hover:bg-gray-200"}`,children:"Best Deals"}),e.jsx("button",{onClick:()=>c("new"),className:`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all flex-shrink-0 ${p==="new"?"bg-teal-600 text-white":"bg-gray-100 text-slate-700 hover:bg-gray-200"}`,children:"New Spots"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden pb-32",children:P.map((S,I)=>{var M,H,T,D;return e.jsxs("div",{children:[I===0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{onClick:()=>L(S),className:"px-6 py-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:ke(((M=S.coverImageIds)==null?void 0:M[0])||S.logoId||S.image_url,"merchant",{width:400,height:400}),alt:S.name,className:"w-24 h-24 rounded-lg object-cover",loading:I<3?"eager":"lazy",decoding:"async",onError:R=>{const Z=R.currentTarget;Z.src.includes("unsplash.com")||(Z.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=400&fit=crop")}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:S.name}),e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[S.reviewCount>0&&e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"w-4 h-4 fill-orange-400 text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:(H=S.rating)==null?void 0:H.toFixed(1)}),e.jsx("span",{className:"text-sm text-slate-500 mx-1",children:"|"})]}),F(S)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:F(S)}),e.jsx("span",{className:"text-sm text-slate-500 mx-1",children:"|"})]}),e.jsx("span",{className:"text-sm text-slate-600 truncate",children:S.subcategoryName||S.category||"Restaurant"})]}),S.occupiedSlots>0&&e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-xs text-orange-600",children:"âš¡"}),e.jsxs("span",{className:"text-xs text-slate-600",children:[S.occupiedSlots," PB Available"]})]}),S.deals&&S.deals.length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap",children:S.deals.slice(0,3).map((R,Z)=>e.jsx("span",{className:"px-3 py-1 bg-teal-50 text-teal-700 text-xs font-medium rounded-full whitespace-nowrap flex-shrink-0",children:R.saveValue||R.savings?`Save â‚¬${R.saveValue||R.savings}`:R.title},Z))})]})]})}),e.jsxs("div",{className:"px-6 py-6",children:[e.jsx("h2",{className:"font-bold text-slate-900 text-lg mb-4",children:"Top Recommended"}),e.jsx("div",{className:"flex gap-3 overflow-x-auto pb-2 scrollbar-hide -mx-6 px-6",children:k.map(R=>{var Z,O;return e.jsx("div",{onClick:()=>L(R),className:"flex-shrink-0 w-40 cursor-pointer",children:e.jsxs("div",{className:"relative rounded-xl overflow-hidden mb-2",children:[e.jsx("img",{src:ke(((Z=R.coverImageIds)==null?void 0:Z[0])||R.logoId||R.image_url,"merchant",{width:400,height:400}),alt:R.name,className:"w-full h-40 object-cover",onError:V=>{const q=V.currentTarget;q.src.includes("unsplash.com")||(q.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=400&fit=crop")}}),e.jsxs("div",{className:"absolute bottom-2 left-2 right-2 bg-white/95 backdrop-blur-sm rounded-lg p-2.5",children:[e.jsx("h3",{className:"font-semibold text-xs text-slate-900 mb-1.5 truncate",children:R.name}),e.jsx("div",{className:"flex items-center gap-1 text-xs text-slate-600 mb-1.5",children:e.jsxs("span",{children:["ðŸ½ï¸ ",R.subcategoryName||R.category||"Drink, Meat, Curry"]})}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[R.reviewCount>0&&e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"w-3 h-3 fill-orange-400 text-orange-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:(O=R.rating)==null?void 0:O.toFixed(1)})]}),F(R)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-xs text-slate-500",children:"|"}),e.jsx("span",{className:"text-xs font-medium text-slate-700",children:F(R)})]}),R.occupiedSlots>0&&e.jsxs("span",{className:"text-xs text-green-600 ml-auto font-medium",children:["âš¡ ",R.occupiedSlots," PB"]})]})]})]})},R.id)})})]})]}),I>0&&e.jsx("div",{onClick:()=>L(S),className:"px-6 py-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("img",{src:ke(((T=S.coverImageIds)==null?void 0:T[0])||S.logoId||S.image_url,"merchant",{width:400,height:400}),alt:S.name,className:"w-24 h-24 rounded-lg object-cover",onError:R=>{const Z=R.currentTarget;Z.src.includes("unsplash.com")||(Z.src="https://images.unsplash.com/photo-1517248135467-4c7edcad34c4?w=400&h=400&fit=crop")}}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-900 mb-1",children:S.name}),e.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[S.reviewCount>0&&e.jsxs(e.Fragment,{children:[e.jsx(tt,{className:"w-4 h-4 fill-orange-400 text-orange-400"}),e.jsx("span",{className:"text-sm font-medium text-slate-700",children:(D=S.rating)==null?void 0:D.toFixed(1)}),e.jsx("span",{className:"text-sm text-slate-500 mx-1",children:"|"})]}),F(S)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm font-medium text-slate-700",children:F(S)}),e.jsx("span",{className:"text-sm text-slate-500 mx-1",children:"|"})]}),e.jsx("span",{className:"text-sm text-slate-600 truncate",children:S.subcategoryName||S.category||"Restaurant"})]}),S.occupiedSlots>0&&e.jsxs("div",{className:"flex items-center gap-1 mb-2",children:[e.jsx("span",{className:"text-xs text-orange-600",children:"âš¡"}),e.jsxs("span",{className:"text-xs text-slate-600",children:[S.occupiedSlots," PB Available"]})]}),S.deals&&S.deals.length>0&&e.jsx("div",{className:"flex gap-2 flex-wrap",children:S.deals.slice(0,3).map((R,Z)=>e.jsx("span",{className:"px-3 py-1 bg-teal-50 text-teal-700 text-xs font-medium rounded-full whitespace-nowrap flex-shrink-0",children:R.saveValue||R.savings?`Save â‚¬${R.saveValue||R.savings}`:R.title},Z))})]})]})})]},S.id)})},`${f}-${p}`),e.jsx(Na,{onDiscoverClick:()=>{},onMapClick:a,onBookingsClick:r,activeView:"discover",unreadInvitesCount:x}),i&&e.jsx(Wn,{selectedCity:f,onSelectCity:S=>{g(S),C(!1)},onClose:()=>C(!1)}),u&&e.jsx(Gn,{selectedFilters:l,onToggleFilter:S=>{h(I=>I.includes(S)?I.filter(M=>M!==S):[...I,S])},onClose:()=>b(!1),onApply:()=>{}})]})}function Jn({booking:t,onBack:s,onOpenHelpCenter:a,onNavigateToMerchant:r,onNavigateToMap:x,onOpenReportPowerBank:o}){var c;const m=t.type==="rental",f=t.type==="dining",g=l=>{switch(l){case"active":return"text-orange-500";case"complete":return"text-green-600";case"cancelled":return"text-gray-500";case"lost":return"text-red-500";default:return"text-gray-600"}},p=l=>l.charAt(0).toUpperCase()+l.slice(1);return e.jsx("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gray-50 z-10 px-4 sm:px-6 pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"History Details"}),e.jsx("div",{className:"w-10"})]})}),e.jsxs("div",{className:"px-4 sm:px-6 pb-6",children:[e.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-sm mb-6",children:[m?e.jsxs("div",{className:"relative h-48 overflow-hidden",style:{background:"linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%, #f0f4f8 100%)",backgroundSize:"200% 200%"},children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full opacity-20",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid-detail-modal",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"#94a3b8",strokeWidth:"0.5"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid-detail-modal)"}),e.jsx("path",{d:"M0,80 Q150,60 300,90 T600,80",fill:"none",stroke:"#94a3b8",strokeWidth:"1.5",opacity:"0.4"}),e.jsx("path",{d:"M120,0 Q150,150 210,180",fill:"none",stroke:"#94a3b8",strokeWidth:"2",opacity:"0.3"}),e.jsx("circle",{cx:"140",cy:"90",r:"3",fill:"#94a3b8",opacity:"0.4"}),e.jsx("circle",{cx:"260",cy:"120",r:"2.5",fill:"#94a3b8",opacity:"0.4"}),e.jsx("circle",{cx:"340",cy:"100",r:"2",fill:"#94a3b8",opacity:"0.4"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsxs("svg",{width:"40",height:"50",viewBox:"0 0 24 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"drop-shadow-lg",children:[e.jsx("path",{d:"M12 0C7.58 0 4 3.58 4 8C4 14 12 24 12 24C12 24 20 14 20 8C20 3.58 16.42 0 12 0ZM12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11Z",fill:"#F97316"}),e.jsx("circle",{cx:"12",cy:"8",r:"2.5",fill:"white"})]})})]}):e.jsx("div",{className:"relative h-48 bg-gray-200",children:t.image&&e.jsx("img",{src:ke(t.image,"deal",{width:800,height:600,quality:85}),alt:t.name,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"p-5",children:[m&&e.jsx(e.Fragment,{children:t.powerBankId&&e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("h2",{className:"text-2xl font-bold text-slate-800",children:["Power Bank ID: ",t.powerBankId]}),e.jsxs("button",{onClick:()=>{x&&x()},className:"flex items-center gap-1 px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full transition-colors flex-shrink-0",children:[e.jsx(We,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Repeat"})]})]})}),f&&e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.name.replace(/\d+/g,"").trim()+"'s Rest"}),e.jsxs("button",{onClick:()=>{t.merchantId&&r&&r(t.merchantId)},className:"flex items-center gap-1 px-3 py-1.5 bg-orange-50 hover:bg-orange-100 rounded-full transition-colors flex-shrink-0",children:[e.jsx(We,{className:"w-3 h-3 text-orange-600"}),e.jsx("span",{className:"text-xs font-medium text-orange-700",children:"Repeat"})]})]}),m&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Picked Up:"}),e.jsx("p",{className:"font-semibold text-gray-800",children:t.date})]}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:((c=t.pickupLocation)==null?void 0:c.split(",")[0])||t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.time})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex flex-col items-center pt-1",children:[e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0 text-gray-800"}),e.jsx("div",{className:"w-0.5 h-6 bg-gray-300 my-1"}),e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0 text-gray-400"})]}),e.jsx("div",{className:"flex-1 text-sm text-gray-600",children:e.jsx("p",{children:t.address})})]})]}),f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 mb-4 bg-gray-50 p-4 rounded-2xl",children:[e.jsx("img",{src:"/9295138671579770860 copy.svg",alt:"Deal info",className:"w-8 h-8 flex-shrink-0"}),e.jsx("div",{className:"flex-1",children:e.jsx("h3",{className:"font-bold text-gray-900 text-base mb-1",children:t.deal||"2 for 1 main course"})})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"mb-1",children:e.jsx("h3",{className:"font-semibold text-gray-800",children:"Booked:"})}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t.name}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-800",children:t.date}),e.jsx("p",{className:"text-sm text-gray-600",children:t.time})]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0 text-gray-800"}),e.jsx("div",{className:"flex-1 text-sm text-gray-600",children:e.jsx("p",{children:t.address})})]})]})]}),m&&t.status==="active"&&e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:"Returned:"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Unknown"}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-400",children:"---"})]})]}),m&&t.status==="complete"&&t.returnLocation&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Returned:"}),e.jsx("p",{className:"font-semibold text-gray-800",children:t.returnDate||"05-sep-2022"})]}),e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t.returnLocation.split(",")[0]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.returnTime||"11:37"})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ce,{className:"w-4 h-4 flex-shrink-0 text-green-600"}),e.jsx("div",{className:"flex-1 text-sm text-gray-600",children:e.jsx("p",{children:t.returnLocation})})]})]}),e.jsxs("div",{className:"border-t border-gray-100 pt-4 mt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Status:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`font-semibold ${g(t.status)}`,children:p(t.status)}),t.status==="complete"&&t.returnTime&&e.jsx("span",{className:"text-sm text-gray-600",children:t.returnTime})]})]}),m&&t.rentalFee!==void 0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[e.jsx("span",{children:"Rental fee:"}),e.jsxs("span",{children:["â‚¬ ",t.rentalFee.toFixed(2)]})]}),t.lateFee!==void 0&&t.lateFee>0&&e.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-2",children:[e.jsx("span",{children:"Late fee:"}),e.jsxs("span",{children:["â‚¬ ",t.lateFee.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("span",{className:"font-semibold text-gray-800",children:"Total:"}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:["â‚¬ ",t.amount.toFixed(2)]}),t.status==="complete"&&t.returnDate&&e.jsx("p",{className:"text-sm text-gray-600",children:t.returnDate})]})]}),t.receiptNumber&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("button",{className:"flex items-center gap-2 text-orange-500 hover:text-orange-600 transition-colors",children:[e.jsx(w0,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Receipt"})]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["# ",t.receiptNumber]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-3xl overflow-hidden shadow-sm",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 px-5 pt-5 pb-4",children:"Report"}),e.jsxs("button",{onClick:o,className:"w-full px-5 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsxs("svg",{width:"23",height:"27",viewBox:"0 0 23 27",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5",children:[e.jsxs("g",{clipPath:"url(#clip0_1_84350)",children:[e.jsx("path",{d:"M9.85205 18.75C9.85205 18.4393 9.60021 18.1875 9.28955 18.1875C8.97889 18.1875 8.72705 18.4393 8.72705 18.75L9.28955 18.75L9.85205 18.75ZM9.28955 18.75L8.72705 18.75L8.72705 26.25L9.28955 26.25L9.85205 26.25L9.85205 18.75L9.28955 18.75Z",fill:"#25314C"}),e.jsx("path",{d:"M11.7271 18.75C11.7271 18.4393 11.4752 18.1875 11.1646 18.1875C10.8539 18.1875 10.6021 18.4393 10.6021 18.75L11.1646 18.75L11.7271 18.75ZM11.1646 18.75L10.6021 18.75L10.6021 26.25L11.1646 26.25L11.7271 26.25L11.7271 18.75L11.1646 18.75Z",fill:"#25314C"}),e.jsx("path",{d:"M13.6021 18.75C13.6021 18.4393 13.3502 18.1875 13.0396 18.1875C12.7289 18.1875 12.4771 18.4393 12.4771 18.75L13.0396 18.75L13.6021 18.75ZM13.0396 18.75L12.4771 18.75L12.4771 26.25L13.0396 26.25L13.6021 26.25L13.6021 18.75L13.0396 18.75Z",fill:"#25314C"})]}),e.jsx("rect",{x:"4.41455",y:"0.75",width:"13.5",height:"24.75",rx:"3",stroke:"#25314C",strokeWidth:"1.5"}),e.jsx("path",{d:"M1 4.62915L22 23.6292",stroke:"#25314C",strokeWidth:"2",strokeLinecap:"round"}),e.jsx("defs",{children:e.jsx("clipPath",{id:"clip0_1_84350",children:e.jsx("rect",{x:"3.66455",width:"15",height:"26.25",rx:"3.75",fill:"white"})})})]})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Lost and found PB"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Report here a found power bank"})]})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("button",{onClick:a,className:"w-full px-5 py-4 flex items-center justify-between hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(Ie,{className:"w-5 h-5 text-gray-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Report issue"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Let us know if you encountered any issues"})]})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]})]})]})]})})})}function t0({onClose:t,bookingId:s,orderId:a,defaultCategory:r}){const[x,o]=n.useState(["","","","","",""]),[m,f]=n.useState(r||""),[g,p]=n.useState(""),[c,l]=n.useState(!1),[h,u]=n.useState(0),{showSuccess:b}=qe(),E=y=>{u(y.touches[0].clientY)},B=y=>{y.changedTouches[0].clientY-h>100&&t()},j=["Lost / Found","PB Damage","Other"],v=async()=>{l(!0);try{const{data:{session:y}}=await J.auth.getSession();if(!y){alert("Please log in to submit a report");return}const i=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/fault-reports",{method:"POST",headers:{Authorization:`Bearer ${y.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({reportType:"power_bank",qrCode:x.join(""),category:m,description:g,bookingId:s,orderId:a})});if(!i.ok){const A=await i.json().catch(()=>({error:"Unknown error"}));throw new Error(A.error||"Failed to submit report")}const C=await i.json();b("Successfully submitted!"),t()}catch(y){const d=y instanceof Error?y.message:"Unknown error occurred";alert(`Failed to submit report: ${d}`)}finally{l(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:y=>y.stopPropagation(),onTouchStart:E,onTouchEnd:B,children:e.jsxs("div",{className:"px-6 py-6 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#1e293b"},children:"Report a power bank"}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("p",{className:"text-slate-800 text-center mb-3",children:["Enter the 6 numbers below the",e.jsx("br",{}),e.jsx("span",{className:"text-orange-400 font-semibold",children:"QR code"})]}),e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx(Ds,{value:x,onChange:o,disabled:c})}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-semibold mb-2 block",children:["Select category",e.jsx("span",{className:"text-orange-500",children:"*"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:j.map(y=>e.jsx("button",{onClick:()=>f(y),className:`px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap flex-shrink-0 ${m===y?"bg-orange-400 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:y},y))})]}),e.jsx("div",{className:"mb-4",children:e.jsx("textarea",{value:g,onChange:y=>p(y.target.value),placeholder:"Describe the Issue*",className:"w-full h-32 p-4 border-2 border-orange-400 rounded-2xl outline-none focus:border-orange-500 resize-none text-slate-800 placeholder-gray-400"})})]}),e.jsx("button",{onClick:v,disabled:!x.every(y=>y)||!m||!g||c,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:c?"Submitting...":"Submit"})]})})})}function Xn({onBack:t,onOpenHelpCenter:s,onNavigateToMerchant:a,onNavigateToMap:r}){const[x,o]=n.useState(null),[m,f]=n.useState([]),[g,p]=n.useState(!0),[c,l]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const j=(await Ke.getUserBookings()).bookings.filter(v=>v.status==="completed"||v.status==="cancelled"||v.status==="expired").map(v=>{var C,A,w,F,N,k;const y=v.status==="completed"&&v.completedAt?new Date(v.completedAt):null,d=y?y.toLocaleTimeString("en-GB",{hour:"2-digit",minute:"2-digit",hour12:!1}):"",i=y?`${y.getDate().toString().padStart(2,"0")}-${y.toLocaleString("en-GB",{month:"short"})}-${y.getFullYear()}`:void 0;return{id:v.id,type:"dining",name:((C=v.merchant)==null?void 0:C.name)||((A=v.restaurant)==null?void 0:A.name)||"Restaurant",address:((w=v.merchant)==null?void 0:w.address)||((F=v.restaurant)==null?void 0:F.address)||"",date:new Date(v.bookingDate||v.booking_date||"").toLocaleDateString("en-GB",{day:"numeric",month:"short"}),time:(v.booking_time||"").split(" - ")[0]||"",status:v.status==="completed"?"complete":v.status==="cancelled"?"cancelled":v.status==="expired"?"complete":"cancelled",amount:0,deal:((N=v.deal)==null?void 0:N.title)||"2 for 1 main course",image:v.dealImage||((k=v.deal)==null?void 0:k.image)||"",receiptNumber:v.id,returnDate:i,returnTime:d,merchantId:v.merchantId}});f(j)}catch{}finally{p(!1)}})()},[]);const h=[];if(x)return e.jsxs(e.Fragment,{children:[e.jsx(Jn,{booking:x,onBack:()=>o(null),onOpenHelpCenter:s,onNavigateToMerchant:a,onNavigateToMap:r,onOpenReportPowerBank:()=>l(!0)}),c&&e.jsx(t0,{onClose:()=>l(!1),defaultCategory:"Lost / Found"})]});const u=E=>{switch(E){case"active":return"bg-orange-500";case"complete":return"text-green-600";case"cancelled":return"text-red-500";case"lost":return"text-red-500";default:return"text-gray-600"}},b=E=>{switch(E){case"active":return"Active";case"complete":return"Complete";case"cancelled":return"Cancelled";case"lost":return"Lost";default:return E}};return e.jsx("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gray-50 z-10 px-4 sm:px-6 pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-lg font-semibold text-gray-800",children:"History"}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})})]})}),e.jsxs("div",{className:"px-4 sm:px-6 pb-6",children:[h.length>0&&e.jsx("div",{className:"mb-6",children:h.map(E=>{const B=E.pickupCoordinates;return B&&`${B.lat}${B.lng}`,e.jsxs("div",{onClick:()=>o(E),className:"bg-white rounded-3xl overflow-hidden shadow-sm cursor-pointer hover:shadow-md transition-shadow mb-4",children:[E.type==="rental"?e.jsxs("div",{className:"relative h-32 overflow-hidden",style:{background:"linear-gradient(135deg, #f0f4f8 0%, #e2e8f0 25%, #cbd5e1 50%, #e2e8f0 75%, #f0f4f8 100%)",backgroundSize:"200% 200%"},children:[e.jsxs("svg",{className:"absolute inset-0 w-full h-full opacity-20",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("defs",{children:e.jsx("pattern",{id:"grid",width:"40",height:"40",patternUnits:"userSpaceOnUse",children:e.jsx("path",{d:"M 40 0 L 0 0 0 40",fill:"none",stroke:"#94a3b8",strokeWidth:"0.5"})})}),e.jsx("rect",{width:"100%",height:"100%",fill:"url(#grid)"}),e.jsx("path",{d:"M0,50 Q100,30 200,60 T400,50",fill:"none",stroke:"#94a3b8",strokeWidth:"1.5",opacity:"0.4"}),e.jsx("path",{d:"M50,0 Q80,100 120,130",fill:"none",stroke:"#94a3b8",strokeWidth:"2",opacity:"0.3"}),e.jsx("circle",{cx:"60",cy:"40",r:"3",fill:"#94a3b8",opacity:"0.4"}),e.jsx("circle",{cx:"140",cy:"70",r:"2.5",fill:"#94a3b8",opacity:"0.4"}),e.jsx("circle",{cx:"200",cy:"55",r:"2",fill:"#94a3b8",opacity:"0.4"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none -mt-2",children:e.jsxs("svg",{width:"32",height:"40",viewBox:"0 0 24 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"drop-shadow-lg",children:[e.jsx("path",{d:"M12 0C7.58 0 4 3.58 4 8C4 14 12 24 12 24C12 24 20 14 20 8C20 3.58 16.42 0 12 0ZM12 11C10.34 11 9 9.66 9 8C9 6.34 10.34 5 12 5C13.66 5 15 6.34 15 8C15 9.66 13.66 11 12 11Z",fill:"#F97316"}),e.jsx("circle",{cx:"12",cy:"8",r:"2.5",fill:"white"})]})}),e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx("span",{className:"bg-orange-500 text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Active"})})]}):e.jsx("div",{className:"relative h-32 bg-orange-100",children:e.jsx("div",{className:"absolute top-3 right-3 z-10",children:e.jsx("span",{className:"bg-orange-500 text-white text-xs font-semibold px-3 py-1 rounded-full",children:"Active"})})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-1",children:"Picked Up:"}),e.jsx("p",{className:"text-sm text-gray-600",children:E.name})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-800",children:E.date}),e.jsx("p",{className:"text-sm text-gray-600",children:E.time})]})]}),e.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 mb-4",children:[e.jsx(Ce,{className:"w-4 h-4 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:E.address})]}),e.jsx("button",{className:"w-full bg-slate-700 text-white font-semibold py-3 rounded-[1rem] hover:bg-slate-800 transition-colors",children:"How to Return"})]})]},E.id)})}),g?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"Loading history..."})}):m.length===0?e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{children:"No past bookings"})}):e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Past"}),e.jsx("div",{className:"space-y-3",children:m.map(E=>e.jsxs("div",{onClick:()=>o(E),className:"bg-white rounded-2xl p-4 shadow-sm cursor-pointer hover:shadow-md transition-shadow flex gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-xl overflow-hidden flex-shrink-0 bg-gray-100",children:E.type==="dining"&&E.image?e.jsx("img",{src:ke(E.image,"deal",{width:128,height:128,quality:85}),alt:E.name,className:"w-full h-full object-cover"}):e.jsx("img",{src:"/6.png",alt:E.name,className:"w-full h-full object-contain"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-1 truncate",children:E.name}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-gray-500 mb-1",children:[e.jsx("span",{children:E.date}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:E.time})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-xs font-medium capitalize ${u(E.status)}`,children:b(E.status)}),e.jsx("span",{className:"text-xs text-gray-500",children:"â€¢"}),e.jsxs("span",{className:"text-xs font-semibold text-gray-800",children:["â‚¬ ",E.amount.toFixed(2)]})]})]}),e.jsxs("button",{onClick:B=>{B.stopPropagation(),E.type==="dining"&&E.merchantId&&a?a(E.merchantId):E.type==="rental"&&r&&r()},className:"flex items-center gap-1 px-3 py-1.5 bg-gray-50 hover:bg-gray-100 rounded-full transition-colors self-start",children:[e.jsx(We,{className:"w-3 h-3 text-gray-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:"Repeat"})]})]},E.id))})]})]})]})})})}function Zn({onClose:t}){const[s,a]=n.useState(0),r=o=>{a(o.touches[0].clientY)},x=o=>{o.changedTouches[0].clientY-s>100&&t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:o=>o.stopPropagation(),onTouchStart:r,onTouchEnd:x,children:[e.jsx("div",{className:"pt-3 pb-2",children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto cursor-pointer active:cursor-grabbing"})}),e.jsxs("div",{className:"px-6 pb-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mb-6 shadow-lg",children:e.jsx("div",{className:"text-4xl",children:"ðŸ¤"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-500 mb-6",children:"Price Info"}),e.jsxs("div",{className:"w-full space-y-4 text-left mb-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-orange-500 font-semibold mb-2",children:"Flex:"}),e.jsx("p",{className:"text-slate-800 text-sm leading-relaxed",children:"Rental duration is rounded to half hour block (30 or 60 minutes) with maximum â‚¬5.00 per day."})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-orange-500 font-semibold mb-2",children:"Membership:"}),e.jsx("p",{className:"text-slate-800 text-sm leading-relaxed",children:"Users have the freedom to rent power banks at any time with a membership plan"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-orange-500 font-semibold mb-2",children:"Failure to return:"}),e.jsx("p",{className:"text-slate-800 text-sm leading-relaxed",children:"If the power bank isn't returned within 5 days, a rental fee for 5 days plus a â‚¬25.00 late fee will be charged. This applies to all customers."})]})]}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md",children:"Got It"})]})]})})}function Qn({onClose:t}){const[s,a]=n.useState(0),r=o=>{a(o.touches[0].clientY)},x=o=>{o.changedTouches[0].clientY-s>100&&t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:o=>o.stopPropagation(),onTouchStart:r,onTouchEnd:x,children:e.jsxs("div",{className:"px-6 pt-6 pb-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mb-6 shadow-lg",children:e.jsx("div",{className:"text-4xl",children:"ðŸ˜Š"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400 mb-8",children:"Find and use deals?"}),e.jsxs("div",{className:"w-full space-y-4 mb-8",children:[e.jsxs("div",{className:"bg-pink-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx(Ce,{className:"w-7 h-7 text-orange-500",fill:"currentColor"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Step1"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Simply pick a restaurant where you'd like to dine."})]})]}),e.jsxs("div",{className:"bg-cyan-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx("div",{className:"text-3xl",children:"ðŸŽ‰"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Step 2"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Book a deal, choose a day & time to visit and enjoy!"})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center shadow-sm",children:e.jsx(ra,{className:"w-7 h-7 text-white",strokeWidth:2.5})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Redeem deal"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Present your booking at the restaurant and swipe to redeem upon finishing."})]})]})]}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md",children:"Got It"})]})})})}function Kn({onClose:t}){const[s,a]=n.useState(0),r=o=>{a(o.touches[0].clientY)},x=o=>{o.changedTouches[0].clientY-s>100&&t()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:o=>o.stopPropagation(),onTouchStart:r,onTouchEnd:x,children:e.jsxs("div",{className:"px-6 pt-6 pb-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mb-6 shadow-lg",children:e.jsx("div",{className:"text-4xl",children:"ðŸ˜œ"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400 mb-8",children:"Unlock and return PB?"}),e.jsxs("div",{className:"w-full space-y-4 mb-8",children:[e.jsxs("div",{className:"bg-pink-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx(Ce,{className:"w-7 h-7 text-orange-500",fill:"currentColor"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Step1"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Locate the nearest station hub in the app."})]})]}),e.jsxs("div",{className:"bg-green-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx(gt,{className:"w-7 h-7 text-slate-700",strokeWidth:2})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Step 2"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Use QR scanner to unlock the power bank. (Take & Charge)"})]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-3xl p-5 flex gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-14 h-14 rounded-full bg-white flex items-center justify-center shadow-sm",children:e.jsx(lt,{className:"w-7 h-7 text-slate-700",strokeWidth:2})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-orange-400 font-bold text-lg mb-1",children:"Return / End rental"}),e.jsx("p",{className:"text-slate-700 text-sm leading-relaxed",children:"Insert the power bank into an empty slot; rental stops upon return."})]})]})]}),e.jsx("button",{onClick:t,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md",children:"Got It"})]})})})}function ex({onClose:t,bookingId:s,orderId:a}){const[r,x]=n.useState(["","","","","",""]),[o,m]=n.useState(""),[f,g]=n.useState(""),[p,c]=n.useState(!1),[l,h]=n.useState(0),{showSuccess:u}=qe(),b=v=>{h(v.touches[0].clientY)},E=v=>{v.changedTouches[0].clientY-l>100&&t()},B=["Not Ejecting","Not Online","Other"],j=async()=>{c(!0);try{const{data:{session:v}}=await J.auth.getSession();if(!v){alert("Please log in to submit a report");return}const d=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/fault-reports",{method:"POST",headers:{Authorization:`Bearer ${v.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({reportType:"power_station",qrCode:r.join(""),category:o,description:f,bookingId:s,orderId:a})});if(!d.ok){const C=await d.json().catch(()=>({error:"Unknown error"}));throw new Error(C.error||"Failed to submit report")}const i=await d.json();u("Successfully submitted!"),t()}catch(v){const y=v instanceof Error?v.message:"Unknown error occurred";alert(`Failed to submit report: ${y}`)}finally{c(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:v=>v.stopPropagation(),onTouchStart:b,onTouchEnd:E,children:e.jsxs("div",{className:"px-6 py-6 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",style:{color:"#1e293b"},children:"Report Station Fault"}),e.jsx("p",{className:"text-slate-700 text-center mb-2 text-sm",children:"Enter the 6 numbers below the"}),e.jsx("p",{className:"text-orange-400 text-center mb-4 text-sm font-semibold",children:"QR code"}),e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx(Ds,{value:r,onChange:x,disabled:p})}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:["Select category",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:B.map(v=>e.jsx("button",{onClick:()=>m(v),className:`px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap flex-shrink-0 ${o===v?"bg-orange-400 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:v},v))})]}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:["Describe the Issue",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:f,onChange:v=>g(v.target.value),placeholder:"",className:"w-full h-32 p-4 border-2 border-orange-400 rounded-2xl focus:outline-none focus:border-orange-500 resize-none text-sm text-slate-700"})]}),e.jsx("button",{onClick:j,disabled:!r.every(v=>v)||!o||!f||p,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-bold py-4 rounded-[1rem] transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Submitting...":"Submit"})]})})})}function tx({onClose:t}){const[s,a]=n.useState(""),[r,x]=n.useState(!1),[o,m]=n.useState(0),[f,g]=n.useState(""),{showSuccess:p}=qe(),c=u=>{m(u.touches[0].clientY)},l=u=>{u.changedTouches[0].clientY-o>100&&t()},h=async()=>{x(!0);try{const{data:{session:u}}=await J.auth.getSession();if(!u){alert("Please log in to submit a report");return}const E=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/fault-reports",{method:"POST",headers:{Authorization:`Bearer ${u.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({reportType:"mobile_app",category:f||"App Issue",description:s})});if(!E.ok){const j=await E.json().catch(()=>({error:"Unknown error"}));throw new Error(j.error||"Failed to submit report")}const B=await E.json();p("Successfully submitted!"),t()}catch(u){const b=u instanceof Error?u.message:"Unknown error occurred";alert(`Failed to submit report: ${b}`)}finally{x(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:u=>u.stopPropagation(),onTouchStart:c,onTouchEnd:l,children:e.jsxs("div",{className:"px-6 py-6 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",style:{color:"#1e293b"},children:"Report App Issue"}),e.jsx("p",{className:"text-slate-700 text-center mb-4 text-sm",children:"Tell us what's not working in the app."}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsx("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:"Categories:"}),e.jsx("div",{className:"flex gap-2 mb-4 overflow-x-auto pb-2 scrollbar-hide",children:["Performance","Not Updating","Crash Issues","Other"].map(u=>e.jsx("button",{type:"button",onClick:()=>g(u),className:`px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap flex-shrink-0 ${f===u?"bg-orange-400 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:u},u))})]}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:["Describe it here",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:s,onChange:u=>a(u.target.value),placeholder:"type your comment here:",className:"w-full h-32 p-4 border-2 border-orange-400 rounded-2xl focus:outline-none focus:border-orange-500 resize-none text-sm text-slate-600 placeholder:text-slate-400"})]}),e.jsx("button",{onClick:h,disabled:!s.trim()||r,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Submitting...":"Submit"})]})})})}function sx({onClose:t}){const[s,a]=n.useState(""),[r,x]=n.useState(""),[o,m]=n.useState(!1),[f,g]=n.useState(0),{showSuccess:p}=qe(),c=b=>{g(b.touches[0].clientY)},l=b=>{b.changedTouches[0].clientY-f>100&&t()},h=["New feature","Suggestions","Other"],u=async()=>{m(!0);try{const{data:{session:b}}=await J.auth.getSession();if(!b){alert("Please log in to submit a suggestion");return}const B=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/suggestions",{method:"POST",headers:{Authorization:`Bearer ${b.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({category:s,title:s,description:r})});if(!B.ok){const v=await B.json().catch(()=>({error:"Unknown error"}));throw new Error(v.error||"Failed to submit suggestion")}const j=await B.json();p("Successfully submitted!"),t()}catch(b){const E=b instanceof Error?b.message:"Unknown error occurred";alert(`Failed to submit suggestion: ${E}`)}finally{m(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:b=>b.stopPropagation(),onTouchStart:c,onTouchEnd:l,children:e.jsxs("div",{className:"px-6 py-6 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-3",style:{color:"#1e293b"},children:"Share it with us"}),e.jsxs("p",{className:"text-slate-700 text-center mb-4 text-sm",children:["We welcome suggestions and new",e.jsx("br",{}),"feature ideas."]}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:["Select category",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("div",{className:"flex gap-2 overflow-x-auto pb-2 scrollbar-hide",children:h.map(b=>e.jsx("button",{onClick:()=>a(b),className:`px-4 py-2 rounded-full text-sm font-medium transition-all whitespace-nowrap flex-shrink-0 ${s===b?"bg-orange-400 text-white shadow-md":"bg-slate-100 text-slate-700 hover:bg-slate-200"}`,children:b},b))})]}),e.jsxs("div",{className:"w-full mb-4",children:[e.jsxs("label",{className:"text-slate-800 font-medium text-sm mb-2 block",children:["Describe it here",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("textarea",{value:r,onChange:b=>x(b.target.value),placeholder:"",className:"w-full h-32 p-4 border-2 border-orange-400 rounded-2xl focus:outline-none focus:border-orange-500 resize-none text-sm text-slate-700"})]}),e.jsx("button",{onClick:u,disabled:!s||!r.trim()||o,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 hover:from-orange-500 hover:to-orange-600 text-white font-bold py-4 rounded-[1rem] transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:o?"Submitting...":"Submit"})]})})})}function ax({onClose:t,bookingId:s,orderId:a}){const[r,x]=n.useState(!1),[o,m]=n.useState(!1),[f,g]=n.useState(!1),[p,c]=n.useState(!1),l=()=>{m(!0)},h=()=>{g(!0)},u=()=>{c(!0)},[b,E]=n.useState(0),B=v=>{E(v.touches[0].clientY)},j=v=>{v.changedTouches[0].clientY-b>100&&t()};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl max-w-md w-full max-h-[90vh] overflow-y-auto shadow-2xl animate-slide-up",onClick:v=>v.stopPropagation(),onTouchStart:B,onTouchEnd:j,children:[e.jsx("div",{className:"pt-3 pb-2",children:e.jsx("div",{className:"w-12 h-1.5 bg-gray-300 rounded-full mx-auto cursor-pointer active:cursor-grabbing"})}),e.jsxs("div",{className:"px-6 pb-6 flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"#1e293b"},children:"Report or Suggest"}),e.jsx("p",{className:"text-slate-800 text-center mb-8",children:"Report a malfunction or share suggestions?"}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("button",{onClick:l,className:"bg-blue-50 hover:bg-blue-100 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ”Œ"}),e.jsx("span",{className:"text-slate-800 font-semibold text-sm",children:"Power Station"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"bg-pink-50 hover:bg-pink-100 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ”‹"}),e.jsx("span",{className:"text-slate-800 font-semibold text-sm",children:"Power Bank"})]}),e.jsxs("button",{onClick:h,className:"bg-green-50 hover:bg-green-100 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx(v0,{className:"w-12 h-12 text-slate-700 mb-2",strokeWidth:1.5}),e.jsx("span",{className:"text-slate-800 font-semibold text-sm",children:"Mobile App"})]}),e.jsxs("button",{onClick:u,className:"bg-orange-50 hover:bg-orange-100 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx("div",{className:"text-4xl mb-2",children:"ðŸ’­"}),e.jsx("span",{className:"text-slate-800 font-semibold text-sm text-center",children:"Share your suggestions"})]})]})]})]})}),r&&e.jsx(t0,{onClose:()=>x(!1),bookingId:s,orderId:a}),o&&e.jsx(ex,{onClose:()=>m(!1),bookingId:s,orderId:a}),f&&e.jsx(tx,{onClose:()=>g(!1)}),p&&e.jsx(sx,{onClose:()=>c(!1)})]})}function rx({onClose:t}){const[s,a]=n.useState(0),r=g=>{a(g.touches[0].clientY)},x=g=>{g.changedTouches[0].clientY-s>100&&t()},o=()=>{window.open("https://www.facebook.com","_blank")},m=()=>{window.open("https://www.instagram.com","_blank")},f=()=>{window.open("https://www.tiktok.com","_blank")};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full shadow-2xl animate-slideUp",onClick:g=>g.stopPropagation(),onTouchStart:r,onTouchEnd:x,children:e.jsxs("div",{className:"px-6 py-6 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mb-6 shadow-lg",children:e.jsx("div",{className:"text-4xl",children:"ðŸ’–"})}),e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#1e293b"},children:"Follow Us"}),e.jsxs("div",{className:"w-full grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("button",{onClick:o,className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[130px]",children:[e.jsx(B0,{className:"w-10 h-10 text-white",strokeWidth:2,fill:"white"}),e.jsx("span",{className:"text-white font-medium text-base",children:"Facebook"})]}),e.jsxs("button",{onClick:m,className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[130px]",children:[e.jsx(xa,{className:"w-10 h-10 text-white",strokeWidth:2}),e.jsx("span",{className:"text-white font-medium text-base",children:"Instagram"})]})]}),e.jsxs("button",{onClick:f,className:"w-full bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[130px]",children:[e.jsx("svg",{className:"w-10 h-10",viewBox:"0 0 24 24",fill:"white",xmlns:"http://www.w3.org/2000/svg",children:e.jsx("path",{d:"M19.59 6.69a4.83 4.83 0 0 1-3.77-4.25V2h-3.45v13.67a2.89 2.89 0 0 1-5.2 1.74 2.89 2.89 0 0 1 2.31-4.64 2.93 2.93 0 0 1 .88.13V9.4a6.84 6.84 0 0 0-1-.05A6.33 6.33 0 0 0 5 20.1a6.34 6.34 0 0 0 10.86-4.43v-7a8.16 8.16 0 0 0 4.77 1.52v-3.4a4.85 4.85 0 0 1-1-.1z"})}),e.jsx("span",{className:"text-white font-medium text-base",children:"TikTok"})]})]})})})}function s0({onBack:t,onNavigateToMap:s}){const[a,r]=n.useState(!1),[x,o]=n.useState(!1),[m,f]=n.useState(!1),[g,p]=n.useState(!1),[c,l]=n.useState(!1),[h,u]=n.useState(!1),b=()=>{u(!0)},E=()=>{};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gray-50 z-10 px-4 sm:px-6 pt-4 pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-slate-700",children:"How can we Help?"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})})]})}),e.jsxs("div",{className:"px-4 sm:px-6 pb-6 pt-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[e.jsxs("button",{onClick:b,className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx(j0,{className:"w-8 h-8 text-white",strokeWidth:1.5}),e.jsx("span",{className:"text-white font-medium text-base",children:"Support chat"})]}),e.jsxs("button",{onClick:()=>p(!0),className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx(Bs,{className:"w-8 h-8 text-white",strokeWidth:1.5}),e.jsx("span",{className:"text-white font-medium text-base",children:"Report a Fault"})]}),e.jsxs("button",{onClick:()=>r(!0),className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx(nt,{className:"w-8 h-8 text-white",strokeWidth:1.5}),e.jsx("span",{className:"text-white font-medium text-base",children:"Price Info"})]}),e.jsxs("button",{onClick:E,className:"bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px]",children:[e.jsx(vs,{className:"w-8 h-8 text-white",strokeWidth:1.5}),e.jsx("span",{className:"text-white font-medium text-base",children:"FAQ"})]})]}),e.jsxs("button",{onClick:()=>l(!0),className:"w-full bg-slate-700 hover:bg-slate-800 rounded-3xl p-6 flex flex-col items-center justify-center gap-3 transition-colors min-h-[140px] mb-6",children:[e.jsx(zt,{className:"w-8 h-8 text-white",strokeWidth:1.5}),e.jsx("span",{className:"text-white font-medium text-base",children:"Follow Us"})]}),e.jsx("button",{onClick:()=>o(!0),className:"w-full bg-orange-100 hover:bg-orange-200 rounded-2xl p-4 transition-colors mb-4",children:e.jsx("span",{className:"font-semibold text-base",style:{color:"#ff5600"},children:"How to find and use deals?"})}),e.jsx("button",{onClick:()=>f(!0),className:"w-full bg-orange-100 hover:bg-orange-200 rounded-2xl p-4 transition-colors",children:e.jsx("span",{className:"font-semibold text-base",style:{color:"#ff5600"},children:"How to unlock and return PB?"})})]})]})})}),a&&e.jsx(Zn,{onClose:()=>r(!1)}),x&&e.jsx(Qn,{onClose:()=>o(!1)}),m&&e.jsx(Kn,{onClose:()=>f(!1)}),g&&e.jsx(ax,{onClose:()=>p(!1)}),c&&e.jsx(rx,{onClose:()=>l(!1)}),h&&e.jsx(Qa,{onClose:()=>u(!1),onCloseToMap:s})]})}function nx({onClose:t,userId:s,onAccountDeleted:a}){const[r,x]=n.useState(!1),o=async()=>{x(!0);try{await J.auth.signOut(),ve.setAuthToken(null),localStorage.removeItem("api_token"),localStorage.removeItem("user_data"),localStorage.removeItem("supabase_token"),localStorage.removeItem("supabase_user"),a&&a(),setTimeout(()=>{window.location.href="/"},500)}catch{alert("Failed to delete account. Please try again or contact support."),x(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/40 backdrop-blur-sm z-[60] flex items-end justify-center",onClick:t,children:e.jsx("div",{className:"bg-white rounded-t-3xl max-w-md w-full animate-slideUp",onClick:m=>m.stopPropagation(),children:e.jsxs("div",{className:"px-8 pt-8 pb-8 flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 rounded-full bg-gradient-to-br from-orange-400 to-orange-500 flex items-center justify-center mb-6",children:e.jsx("div",{className:"text-4xl",children:"ðŸ˜±"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400 mb-6",children:"Attention!"}),e.jsx("p",{className:"text-center text-slate-700 text-base leading-relaxed mb-8 px-2",children:"By deleting your account, you will automatically lose access to this application"}),e.jsxs("button",{onClick:o,disabled:r,className:"w-full bg-gradient-to-r from-red-400 to-red-500 hover:from-red-500 hover:to-red-600 text-white font-semibold py-4 rounded-[1rem] transition-all flex items-center justify-center gap-2 disabled:opacity-50",children:[e.jsx(Rt,{className:"w-5 h-5"}),r?"Deleting Account...":"Delete Account"]})]})})})}const St=[{code:"NL",name:"Netherlands",dialCode:"+31",flag:"ðŸ‡³ðŸ‡±"},{code:"US",name:"United States",dialCode:"+1",flag:"ðŸ‡ºðŸ‡¸"},{code:"IT",name:"Italy",dialCode:"+39",flag:"ðŸ‡®ðŸ‡¹"},{code:"GB",name:"United Kingdom",dialCode:"+44",flag:"ðŸ‡¬ðŸ‡§"},{code:"BE",name:"Belgium",dialCode:"+32",flag:"ðŸ‡§ðŸ‡ª"},{code:"FR",name:"France",dialCode:"+33",flag:"ðŸ‡«ðŸ‡·"},{code:"DE",name:"Germany",dialCode:"+49",flag:"ðŸ‡©ðŸ‡ª"},{code:"ES",name:"Spain",dialCode:"+34",flag:"ðŸ‡ªðŸ‡¸"},{code:"PT",name:"Portugal",dialCode:"+351",flag:"ðŸ‡µðŸ‡¹"},{code:"PL",name:"Poland",dialCode:"+48",flag:"ðŸ‡µðŸ‡±"},{code:"AT",name:"Austria",dialCode:"+43",flag:"ðŸ‡¦ðŸ‡¹"},{code:"CH",name:"Switzerland",dialCode:"+41",flag:"ðŸ‡¨ðŸ‡­"},{code:"SE",name:"Sweden",dialCode:"+46",flag:"ðŸ‡¸ðŸ‡ª"},{code:"NO",name:"Norway",dialCode:"+47",flag:"ðŸ‡³ðŸ‡´"},{code:"DK",name:"Denmark",dialCode:"+45",flag:"ðŸ‡©ðŸ‡°"},{code:"FI",name:"Finland",dialCode:"+358",flag:"ðŸ‡«ðŸ‡®"},{code:"IE",name:"Ireland",dialCode:"+353",flag:"ðŸ‡®ðŸ‡ª"},{code:"GR",name:"Greece",dialCode:"+30",flag:"ðŸ‡¬ðŸ‡·"},{code:"CZ",name:"Czech Republic",dialCode:"+420",flag:"ðŸ‡¨ðŸ‡¿"},{code:"HU",name:"Hungary",dialCode:"+36",flag:"ðŸ‡­ðŸ‡º"},{code:"CA",name:"Canada",dialCode:"+1",flag:"ðŸ‡¨ðŸ‡¦"},{code:"AU",name:"Australia",dialCode:"+61",flag:"ðŸ‡¦ðŸ‡º"},{code:"NZ",name:"New Zealand",dialCode:"+64",flag:"ðŸ‡³ðŸ‡¿"},{code:"LU",name:"Luxembourg",dialCode:"+352",flag:"ðŸ‡±ðŸ‡º"},{code:"IS",name:"Iceland",dialCode:"+354",flag:"ðŸ‡®ðŸ‡¸"},{code:"MT",name:"Malta",dialCode:"+356",flag:"ðŸ‡²ðŸ‡¹"},{code:"CY",name:"Cyprus",dialCode:"+357",flag:"ðŸ‡¨ðŸ‡¾"},{code:"LI",name:"Liechtenstein",dialCode:"+423",flag:"ðŸ‡±ðŸ‡®"},{code:"MC",name:"Monaco",dialCode:"+377",flag:"ðŸ‡²ðŸ‡¨"},{code:"SM",name:"San Marino",dialCode:"+378",flag:"ðŸ‡¸ðŸ‡²"},{code:"VA",name:"Vatican City",dialCode:"+379",flag:"ðŸ‡»ðŸ‡¦"},{code:"AD",name:"Andorra",dialCode:"+376",flag:"ðŸ‡¦ðŸ‡©"}];function a0({isOpen:t,onClose:s,onSubmit:a,initialPhone:r="",initialCountryCode:x="+31"}){const[o,m]=n.useState(St.find(P=>P.dialCode===x)||St[0]),f=()=>{if(!r)return"";let P=r.replace(/\D/g,"");P=P.replace(/^0+/,"");const L=x.substring(1);for(;P.startsWith(L)&&P.length>9;){const $=P.substring(L.length);if($.length>=8&&$.length<=11)P=$;else break}return P.substring(0,9)},[g,p]=n.useState(f()),[c,l]=n.useState(""),[h,u]=n.useState(!1),[b,E]=n.useState(!1),[B,j]=n.useState(0),[v,y]=n.useState(null),d=n.useRef(0),i=n.useRef(0),C=St.filter(P=>P.name.toLowerCase().includes(c.toLowerCase())||P.dialCode.includes(c)),A=P=>{if(P.trim().startsWith("+")){const S=P.replace(/[\s\-()]/g,""),I=St.find(M=>S.startsWith(M.dialCode));if(I){const M=S.substring(I.dialCode.length);m(I),p(M.replace(/\D/g,"").replace(/^0+/,"")),y(null);return}}let L=P.replace(/\D/g,"");L=L.replace(/^0+/,"");const $=o.dialCode.substring(1);if(L.startsWith($)){const S=L.substring($.length);S.length>=8&&S.length<=9&&(L=S,y(null))}const U=o.code==="NL"?9:15;L.length<=U&&(p(L),y(null))},w=()=>{if(!g.trim()){y("Please enter a phone number");return}const P=g.replace(/\D/g,"");if(o.code==="NL"&&P.length>9){y("Phone number is too long. Dutch mobile numbers are 9 digits");return}const L=Aa(o.dialCode,g),$=Fs(L);if(!$.isValid){y($.error||"Invalid phone number");return}g.trim()&&(a($.formatted,o.dialCode),s())},F=P=>{d.current=P.touches[0].clientY,E(!0)},N=P=>{if(!b)return;i.current=P.touches[0].clientY;const L=i.current-d.current;L>0&&j(L)},k=()=>{E(!1),B>100&&s(),j(0)};return t?e.jsx("div",{className:"fixed inset-0 flex items-end justify-center z-50",style:{backgroundColor:"rgba(0, 0, 0, 0.25)"},onClick:s,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md pb-6",style:{transform:`translateY(${B}px)`,transition:b?"none":"transform 0.3s ease-out"},onClick:P=>P.stopPropagation(),children:[e.jsx("div",{className:"flex items-center justify-center pt-3 pb-4 cursor-grab active:cursor-grabbing",onTouchStart:F,onTouchMove:N,onTouchEnd:k,children:e.jsx("div",{className:"w-12 h-1 bg-gray-300 rounded-full"})}),h?e.jsxs("div",{className:"px-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(_t,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:c,onChange:P=>l(P.target.value),placeholder:"Search",className:"w-full pl-10 pr-4 py-3 bg-gray-100 rounded-2xl outline-none text-gray-700"})]}),e.jsx("button",{onClick:()=>u(!1),className:"ml-3 text-gray-600 font-medium",children:"Cancel"})]}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:C.map(P=>e.jsxs("button",{onClick:()=>{m(P),u(!1)},className:"w-full flex items-center justify-between px-4 py-3 hover:bg-gray-50 rounded-2xl transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:"text-2xl",children:P.flag}),e.jsx("span",{className:"text-gray-700 font-medium",children:P.dialCode}),e.jsx("span",{className:"text-gray-600",children:P.name})]}),o.code===P.code&&e.jsx(Qe,{className:"w-5 h-5 text-orange-400"})]},P.code))})]}):e.jsxs("div",{className:"px-5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("span",{className:"text-4xl",children:"ðŸ‘‹"}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400",children:"Hi welcome"})]}),e.jsx("p",{className:"text-slate-700 font-medium mb-2",children:"Enter your phone number"}),e.jsx("p",{className:"text-sm text-gray-500 mb-6",children:o.code==="NL"?"Enter 9 digits without the country code (e.g., 612345678)":`Format: ${o.dialCode} followed by your mobile number`}),e.jsxs("div",{className:"flex gap-3 mb-3",children:[e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center gap-2 px-4 py-3 bg-white border-2 border-orange-300 rounded-2xl hover:border-orange-400 transition-colors",children:[e.jsx("span",{className:"text-2xl",children:o.flag}),e.jsx("span",{className:"text-gray-600 font-medium",children:o.dialCode}),e.jsx("svg",{className:"w-4 h-4 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),e.jsx("input",{type:"tel",value:g,onChange:P=>A(P.target.value),placeholder:"Mobile number",className:`flex-1 px-4 py-3 bg-white border-2 rounded-2xl outline-none text-gray-800 font-medium ${v?"border-red-400 focus:border-red-500":"border-orange-300 focus:border-orange-400"}`,autoFocus:!0,inputMode:"numeric",pattern:"[0-9]*"})]}),v&&e.jsxs("div",{className:"flex items-start gap-2 mb-6 p-3 bg-red-50 border border-red-200 rounded-xl",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-500 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:v})]}),e.jsx("button",{onClick:w,disabled:!g.trim(),className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-[1rem] font-semibold hover:from-orange-500 hover:to-orange-600 transition-all disabled:opacity-50 shadow-lg",children:"Confirm"})]})]})}):null}function xx({profile:t,onClose:s,onSave:a}){const[r,x]=n.useState({full_name:t.full_name||"",username:t.username||"",website:t.website||"",bio:t.bio||"",email:t.email||"",phone_nr:t.phone_nr||"",gender:t.gender||"",age:t.age||""}),[o,m]=n.useState(!1),[f,g]=n.useState(!1),[p,c]=n.useState(!1),[l,h]=n.useState(!1),[u,b]=n.useState(!1),[E,B]=n.useState(t.profile_picture||""),j=n.useRef(null),v=(i,C)=>{x(A=>({...A,[i]:C}))},y=async i=>{var A;const C=(A=i.target.files)==null?void 0:A[0];if(C){b(!0);try{const{data:{user:w}}=await J.auth.getUser();if(!w)throw new Error("Not authenticated");const F=t.profile_picture;F&&Ea(F);const N=await On(C,w.id),{error:k}=await J.from("users").update({profile_picture:N.path}).eq("user_id",w.id);if(k)throw k;B(N.path),F&&F.startsWith("user_profile/")&&await Un(F).catch(console.error),g(!0),setTimeout(()=>g(!1),2e3)}catch(w){alert(w.message||"Failed to upload image. Please try again.")}finally{b(!1),j.current&&(j.current.value="")}}},d=async()=>{var i,C;m(!0);try{if(Ae("USE_EDGE_PROFILE"))await Wt.updateProfile({firstName:(i=r.full_name)==null?void 0:i.split(" ")[0],lastName:(C=r.full_name)==null?void 0:C.split(" ").slice(1).join(" "),phoneNumber:r.phone_nr,gender:r.gender,dateOfBirth:r.age?String(parseInt(r.age)):void 0});else{const{data:{user:A}}=await J.auth.getUser();if(!A)return;const w={full_name:r.full_name,username:r.username,website:r.website,bio:r.bio,phone_nr:r.phone_nr,gender:r.gender,age:r.age?parseInt(r.age):null};if(t.id){const{data:F,error:N}=await J.from("users").update(w).eq("id",t.id).select();if(N)throw N}else{const{data:F,error:N}=await J.from("users").insert({user_id:A.id,email:r.email,...w}).select();if(N)throw N}}g(!0),setTimeout(()=>{g(!1),a()},2e3)}catch{alert("Failed to save profile. Please try again.")}finally{m(!1)}};return e.jsxs("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:[f&&e.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] animate-slide-down px-4 w-full max-w-[340px]",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl px-4 py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-teal-400 to-teal-500 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg font-bold",children:"âœ“"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm leading-tight",children:"Change saved"}),e.jsx("p",{className:"text-gray-600 text-xs leading-tight mt-0.5",children:"changes were successful saved."})]})]})}),e.jsx("div",{className:"h-full overflow-y-auto pb-24",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-gray-50",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-50 z-10 px-4 py-4 flex items-center border-b border-gray-200",children:[e.jsx("button",{onClick:s,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"flex-1 text-center text-xl font-bold text-gray-900 pr-10",children:"Edit Profile"})]}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsxs("div",{className:"relative mb-2",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-orange-400 to-pink-500 flex items-center justify-center shadow-lg overflow-hidden",children:u?e.jsx(Re,{className:"w-8 h-8 text-white animate-spin"}):e.jsx(ks,{imagePath:E,userName:r.full_name||"User",size:"large"})}),e.jsx("button",{type:"button",onClick:()=>{var i;return(i=j.current)==null?void 0:i.click()},disabled:u,className:"absolute bottom-0 right-0 w-8 h-8 bg-orange-500 hover:bg-orange-600 rounded-full flex items-center justify-center shadow-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:e.jsx(Lt,{className:"w-4 h-4 text-white"})}),e.jsx("input",{ref:j,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:y,className:"hidden"})]}),e.jsx("button",{type:"button",onClick:()=>{var i;return(i=j.current)==null?void 0:i.click()},disabled:u,className:"text-sm text-orange-500 hover:text-orange-600 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Uploading...":"Change Profile Photo"})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Profile Information"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(ms,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Name"})]}),e.jsx("input",{type:"text",value:r.full_name,onChange:i=>v("full_name",i.target.value),className:"flex-1 text-sm text-gray-900 outline-none bg-transparent"})]}),e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 text-gray-700",viewBox:"0 0 56 56",children:e.jsx("path",{fill:"currentColor",d:"M8.746 37.703h7.149l-2.133 10.594a4 4 0 0 0-.07.75c0 1.148.796 1.781 1.898 1.781c1.125 0 1.945-.61 2.18-1.758l2.296-11.367h11.086L29.02 48.297c-.07.234-.093.516-.093.75c0 1.148.797 1.781 1.922 1.781s1.945-.61 2.18-1.758L35.3 37.703h8.367c1.289 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875h-7.946L38.63 21.25h8.203c1.29 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875H39.45l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.82-1.805-1.945-1.805c-1.312 0-1.898.726-2.133 1.828l-2.062 10.172H24.215l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.844-1.805-1.945-1.805c-1.336 0-1.946.726-2.157 1.828l-2.062 10.172h-7.687c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805h7.289l-2.485 12.375h-7.57c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805m12.14-4.078l2.509-12.375H34.48l-2.508 12.375Z"})}),e.jsx("label",{className:"text-sm text-gray-600",children:"Nickname"})]}),e.jsx("input",{type:"text",value:r.username,onChange:i=>v("username",i.target.value),className:"flex-1 text-sm text-gray-900 outline-none bg-transparent"})]}),e.jsxs("div",{className:"flex items-start p-4",children:[e.jsxs("div",{className:"flex items-start gap-3 w-32",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 text-gray-700 mt-1",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"1.5",d:"M9.478 3H7.25A2.25 2.25 0 0 0 5 5.25v13.5A2.25 2.25 0 0 0 7.25 21h9a2.25 2.25 0 0 0 2.25-2.25V12M9.478 3c1.243 0 2.272 1.007 2.272 2.25V7.5A2.25 2.25 0 0 0 14 9.75h2.25A2.25 2.25 0 0 1 18.5 12M9.478 3c3.69 0 9.022 5.36 9.022 9M9 16.5h6m-6-3h4"})}),e.jsx("label",{className:"text-sm text-gray-600 pt-1",children:"Bio"})]}),e.jsx("textarea",{value:r.bio,onChange:i=>v("bio",i.target.value),rows:3,className:"flex-1 text-sm text-gray-900 outline-none resize-none bg-transparent",placeholder:"Tell us about yourself"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Online Presence"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(js,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Website"})]}),e.jsx("input",{type:"text",value:r.website,onChange:i=>v("website",i.target.value),placeholder:"Website",className:"flex-1 text-sm text-gray-900 outline-none placeholder-gray-400 bg-transparent"})]}),e.jsxs("div",{className:"flex items-center p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(st,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Social Links"})]}),e.jsxs("button",{className:"flex-1 flex items-center justify-end gap-2 text-sm text-gray-400",children:[e.jsx("span",{children:"Add"}),e.jsx(Ut,{className:"w-4 h-4"})]})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Personal Details (Private)"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(oa,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Email"})]}),e.jsx("input",{type:"email",value:r.email,disabled:!0,className:"flex-1 text-sm text-gray-500 outline-none bg-transparent"})]}),e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(la,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Phone"})]}),e.jsx("button",{type:"button",onClick:()=>h(!0),className:"flex-1 text-sm text-gray-900 outline-none text-left",children:r.phone_nr||"Add phone number"})]}),e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx(ms,{className:"w-5 h-5 text-gray-700"}),e.jsx("label",{className:"text-sm text-gray-600",children:"Gender"})]}),e.jsx("input",{type:"text",value:r.gender,onChange:i=>v("gender",i.target.value),placeholder:"Male/Female/Other",className:"flex-1 text-sm text-gray-900 outline-none bg-transparent placeholder-gray-400"})]}),e.jsxs("div",{className:"flex items-center p-4",children:[e.jsxs("div",{className:"flex items-center gap-3 w-32",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 text-gray-700",viewBox:"0 0 56 56",children:e.jsx("path",{fill:"currentColor",d:"M8.746 37.703h7.149l-2.133 10.594a4 4 0 0 0-.07.75c0 1.148.796 1.781 1.898 1.781c1.125 0 1.945-.61 2.18-1.758l2.296-11.367h11.086L29.02 48.297c-.07.234-.093.516-.093.75c0 1.148.797 1.781 1.922 1.781s1.945-.61 2.18-1.758L35.3 37.703h8.367c1.289 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875h-7.946L38.63 21.25h8.203c1.29 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875H39.45l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.82-1.805-1.945-1.805c-1.312 0-1.898.726-2.133 1.828l-2.062 10.172H24.215l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.844-1.805-1.945-1.805c-1.336 0-1.946.726-2.157 1.828l-2.062 10.172h-7.687c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805h7.289l-2.485 12.375h-7.57c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805m12.14-4.078l2.509-12.375H34.48l-2.508 12.375Z"})}),e.jsx("label",{className:"text-sm text-gray-600",children:"Age"})]}),e.jsx("input",{type:"number",inputMode:"numeric",pattern:"[0-9]*",min:"1",max:"150",value:r.age,onChange:i=>{const C=i.target.value;(C===""||/^\d+$/.test(C))&&v("age",C)},placeholder:"Your age",className:"flex-1 text-sm text-gray-900 outline-none bg-transparent placeholder-gray-400"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-red-500 mb-3 px-2",children:"Dangerous Area"}),e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:e.jsxs("button",{onClick:()=>c(!0),className:"w-full flex items-center justify-center gap-2 p-4 hover:bg-red-50 transition-colors",children:[e.jsx(Rt,{className:"w-5 h-5 text-red-500"}),e.jsx("span",{className:"text-red-500 font-medium",children:"Delete Account"})]})})]})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-50 z-20",style:{paddingBottom:"14px"},children:e.jsx("div",{className:"w-full max-w-md mx-auto px-4 py-4",children:e.jsx("button",{onClick:d,disabled:o,className:"w-full bg-orange-500 hover:bg-orange-600 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md flex items-center justify-center gap-2 disabled:opacity-50",children:o?"Saving...":"Save Changes"})})}),p&&e.jsx(nx,{onClose:()=>c(!1),userId:t.user_id}),e.jsx(a0,{isOpen:l,onClose:()=>h(!1),onSubmit:(i,C)=>{v("phone_nr",i),h(!1)},initialPhone:(()=>{const i=Us(r.phone_nr);return i?i.localNumber:r.phone_nr.replace(/^\+\d+/,"")})(),initialCountryCode:(()=>{const i=Us(r.phone_nr);return i?i.dialCode:"+31"})()})]})}var r0={exports:{}};(function(t,s){(function(r,x){t.exports=x()})(typeof self<"u"?self:c0,function(){return function(a){var r={};function x(o){if(r[o])return r[o].exports;var m=r[o]={i:o,l:!1,exports:{}};return a[o].call(m.exports,m,m.exports,x),m.l=!0,m.exports}return x.m=a,x.c=r,x.d=function(o,m,f){x.o(o,m)||Object.defineProperty(o,m,{configurable:!1,enumerable:!0,get:f})},x.n=function(o){var m=o&&o.__esModule?function(){return o.default}:function(){return o};return x.d(m,"a",m),m},x.o=function(o,m){return Object.prototype.hasOwnProperty.call(o,m)},x.p="",x(x.s=3)}([function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function m(f,g){this.width=g,this.height=f.length/g,this.data=f}return m.createEmpty=function(f,g){return new m(new Uint8ClampedArray(f*g),f)},m.prototype.get=function(f,g){return f<0||f>=this.width||g<0||g>=this.height?!1:!!this.data[g*this.width+f]},m.prototype.set=function(f,g,p){this.data[g*this.width+f]=p?1:0},m.prototype.setRegion=function(f,g,p,c,l){for(var h=g;h<g+c;h++)for(var u=f;u<f+p;u++)this.set(u,h,!!l)},m}();r.BitMatrix=o},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(2);function m(g,p){return g^p}r.addOrSubtractGF=m;var f=function(){function g(p,c,l){this.primitive=p,this.size=c,this.generatorBase=l,this.expTable=new Array(this.size),this.logTable=new Array(this.size);for(var h=1,u=0;u<this.size;u++)this.expTable[u]=h,h=h*2,h>=this.size&&(h=(h^this.primitive)&this.size-1);for(var u=0;u<this.size-1;u++)this.logTable[this.expTable[u]]=u;this.zero=new o.default(this,Uint8ClampedArray.from([0])),this.one=new o.default(this,Uint8ClampedArray.from([1]))}return g.prototype.multiply=function(p,c){return p===0||c===0?0:this.expTable[(this.logTable[p]+this.logTable[c])%(this.size-1)]},g.prototype.inverse=function(p){if(p===0)throw new Error("Can't invert 0");return this.expTable[this.size-this.logTable[p]-1]},g.prototype.buildMonomial=function(p,c){if(p<0)throw new Error("Invalid monomial degree less than 0");if(c===0)return this.zero;var l=new Uint8ClampedArray(p+1);return l[0]=c,new o.default(this,l)},g.prototype.log=function(p){if(p===0)throw new Error("Can't take log(0)");return this.logTable[p]},g.prototype.exp=function(p){return this.expTable[p]},g}();r.default=f},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(1),m=function(){function f(g,p){if(p.length===0)throw new Error("No coefficients.");this.field=g;var c=p.length;if(c>1&&p[0]===0){for(var l=1;l<c&&p[l]===0;)l++;if(l===c)this.coefficients=g.zero.coefficients;else{this.coefficients=new Uint8ClampedArray(c-l);for(var h=0;h<this.coefficients.length;h++)this.coefficients[h]=p[l+h]}}else this.coefficients=p}return f.prototype.degree=function(){return this.coefficients.length-1},f.prototype.isZero=function(){return this.coefficients[0]===0},f.prototype.getCoefficient=function(g){return this.coefficients[this.coefficients.length-1-g]},f.prototype.addOrSubtract=function(g){var p;if(this.isZero())return g;if(g.isZero())return this;var c=this.coefficients,l=g.coefficients;c.length>l.length&&(p=[l,c],c=p[0],l=p[1]);for(var h=new Uint8ClampedArray(l.length),u=l.length-c.length,b=0;b<u;b++)h[b]=l[b];for(var b=u;b<l.length;b++)h[b]=o.addOrSubtractGF(c[b-u],l[b]);return new f(this.field,h)},f.prototype.multiply=function(g){if(g===0)return this.field.zero;if(g===1)return this;for(var p=this.coefficients.length,c=new Uint8ClampedArray(p),l=0;l<p;l++)c[l]=this.field.multiply(this.coefficients[l],g);return new f(this.field,c)},f.prototype.multiplyPoly=function(g){if(this.isZero()||g.isZero())return this.field.zero;for(var p=this.coefficients,c=p.length,l=g.coefficients,h=l.length,u=new Uint8ClampedArray(c+h-1),b=0;b<c;b++)for(var E=p[b],B=0;B<h;B++)u[b+B]=o.addOrSubtractGF(u[b+B],this.field.multiply(E,l[B]));return new f(this.field,u)},f.prototype.multiplyByMonomial=function(g,p){if(g<0)throw new Error("Invalid degree less than 0");if(p===0)return this.field.zero;for(var c=this.coefficients.length,l=new Uint8ClampedArray(c+g),h=0;h<c;h++)l[h]=this.field.multiply(this.coefficients[h],p);return new f(this.field,l)},f.prototype.evaluateAt=function(g){var p=0;if(g===0)return this.getCoefficient(0);var c=this.coefficients.length;if(g===1)return this.coefficients.forEach(function(h){p=o.addOrSubtractGF(p,h)}),p;p=this.coefficients[0];for(var l=1;l<c;l++)p=o.addOrSubtractGF(this.field.multiply(g,p),this.coefficients[l]);return p},f}();r.default=m},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(4),m=x(5),f=x(11),g=x(12);function p(h){var u=g.locate(h);if(!u)return null;for(var b=0,E=u;b<E.length;b++){var B=E[b],j=f.extract(h,B),v=m.decode(j.matrix);if(v)return{binaryData:v.bytes,data:v.text,chunks:v.chunks,version:v.version,location:{topRightCorner:j.mappingFunction(B.dimension,0),topLeftCorner:j.mappingFunction(0,0),bottomRightCorner:j.mappingFunction(B.dimension,B.dimension),bottomLeftCorner:j.mappingFunction(0,B.dimension),topRightFinderPattern:B.topRight,topLeftFinderPattern:B.topLeft,bottomLeftFinderPattern:B.bottomLeft,bottomRightAlignmentPattern:B.alignmentPattern}}}return null}var c={inversionAttempts:"attemptBoth"};function l(h,u,b,E){E===void 0&&(E={});var B=c;Object.keys(B||{}).forEach(function(A){B[A]=E[A]||B[A]});var j=B.inversionAttempts==="attemptBoth"||B.inversionAttempts==="invertFirst",v=B.inversionAttempts==="onlyInvert"||B.inversionAttempts==="invertFirst",y=o.binarize(h,u,b,j),d=y.binarized,i=y.inverted,C=p(v?i:d);return!C&&(B.inversionAttempts==="attemptBoth"||B.inversionAttempts==="invertFirst")&&(C=p(v?d:i)),C}l.default=l,r.default=l},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(0),m=8,f=24;function g(l,h,u){return l<h?h:l>u?u:l}var p=function(){function l(h,u){this.width=h,this.data=new Uint8ClampedArray(h*u)}return l.prototype.get=function(h,u){return this.data[u*this.width+h]},l.prototype.set=function(h,u,b){this.data[u*this.width+h]=b},l}();function c(l,h,u,b){if(l.length!==h*u*4)throw new Error("Malformed data passed to binarizer.");for(var E=new p(h,u),B=0;B<h;B++)for(var j=0;j<u;j++){var v=l[(j*h+B)*4+0],y=l[(j*h+B)*4+1],d=l[(j*h+B)*4+2];E.set(B,j,.2126*v+.7152*y+.0722*d)}for(var i=Math.ceil(h/m),C=Math.ceil(u/m),A=new p(i,C),w=0;w<C;w++)for(var F=0;F<i;F++){for(var N=0,k=1/0,P=0,j=0;j<m;j++)for(var B=0;B<m;B++){var L=E.get(F*m+B,w*m+j);N+=L,k=Math.min(k,L),P=Math.max(P,L)}var $=N/Math.pow(m,2);if(P-k<=f&&($=k/2,w>0&&F>0)){var U=(A.get(F,w-1)+2*A.get(F-1,w)+A.get(F-1,w-1))/4;k<U&&($=U)}A.set(F,w,$)}var S=o.BitMatrix.createEmpty(h,u),I=null;b&&(I=o.BitMatrix.createEmpty(h,u));for(var w=0;w<C;w++)for(var F=0;F<i;F++){for(var M=g(F,2,i-3),H=g(w,2,C-3),N=0,T=-2;T<=2;T++)for(var D=-2;D<=2;D++)N+=A.get(M+T,H+D);for(var R=N/25,T=0;T<m;T++)for(var D=0;D<m;D++){var B=F*m+T,j=w*m+D,Z=E.get(B,j);S.set(B,j,Z<=R),b&&I.set(B,j,!(Z<=R))}}return b?{binarized:S,inverted:I}:{binarized:S}}r.binarize=c},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(0),m=x(6),f=x(9),g=x(10);function p(d,i){for(var C=d^i,A=0;C;)A++,C&=C-1;return A}function c(d,i){return i<<1|d}var l=[{bits:21522,formatInfo:{errorCorrectionLevel:1,dataMask:0}},{bits:20773,formatInfo:{errorCorrectionLevel:1,dataMask:1}},{bits:24188,formatInfo:{errorCorrectionLevel:1,dataMask:2}},{bits:23371,formatInfo:{errorCorrectionLevel:1,dataMask:3}},{bits:17913,formatInfo:{errorCorrectionLevel:1,dataMask:4}},{bits:16590,formatInfo:{errorCorrectionLevel:1,dataMask:5}},{bits:20375,formatInfo:{errorCorrectionLevel:1,dataMask:6}},{bits:19104,formatInfo:{errorCorrectionLevel:1,dataMask:7}},{bits:30660,formatInfo:{errorCorrectionLevel:0,dataMask:0}},{bits:29427,formatInfo:{errorCorrectionLevel:0,dataMask:1}},{bits:32170,formatInfo:{errorCorrectionLevel:0,dataMask:2}},{bits:30877,formatInfo:{errorCorrectionLevel:0,dataMask:3}},{bits:26159,formatInfo:{errorCorrectionLevel:0,dataMask:4}},{bits:25368,formatInfo:{errorCorrectionLevel:0,dataMask:5}},{bits:27713,formatInfo:{errorCorrectionLevel:0,dataMask:6}},{bits:26998,formatInfo:{errorCorrectionLevel:0,dataMask:7}},{bits:5769,formatInfo:{errorCorrectionLevel:3,dataMask:0}},{bits:5054,formatInfo:{errorCorrectionLevel:3,dataMask:1}},{bits:7399,formatInfo:{errorCorrectionLevel:3,dataMask:2}},{bits:6608,formatInfo:{errorCorrectionLevel:3,dataMask:3}},{bits:1890,formatInfo:{errorCorrectionLevel:3,dataMask:4}},{bits:597,formatInfo:{errorCorrectionLevel:3,dataMask:5}},{bits:3340,formatInfo:{errorCorrectionLevel:3,dataMask:6}},{bits:2107,formatInfo:{errorCorrectionLevel:3,dataMask:7}},{bits:13663,formatInfo:{errorCorrectionLevel:2,dataMask:0}},{bits:12392,formatInfo:{errorCorrectionLevel:2,dataMask:1}},{bits:16177,formatInfo:{errorCorrectionLevel:2,dataMask:2}},{bits:14854,formatInfo:{errorCorrectionLevel:2,dataMask:3}},{bits:9396,formatInfo:{errorCorrectionLevel:2,dataMask:4}},{bits:8579,formatInfo:{errorCorrectionLevel:2,dataMask:5}},{bits:11994,formatInfo:{errorCorrectionLevel:2,dataMask:6}},{bits:11245,formatInfo:{errorCorrectionLevel:2,dataMask:7}}],h=[function(d){return(d.y+d.x)%2===0},function(d){return d.y%2===0},function(d){return d.x%3===0},function(d){return(d.y+d.x)%3===0},function(d){return(Math.floor(d.y/2)+Math.floor(d.x/3))%2===0},function(d){return d.x*d.y%2+d.x*d.y%3===0},function(d){return(d.y*d.x%2+d.y*d.x%3)%2===0},function(d){return((d.y+d.x)%2+d.y*d.x%3)%2===0}];function u(d){var i=17+4*d.versionNumber,C=o.BitMatrix.createEmpty(i,i);C.setRegion(0,0,9,9,!0),C.setRegion(i-8,0,8,9,!0),C.setRegion(0,i-8,9,8,!0);for(var A=0,w=d.alignmentPatternCenters;A<w.length;A++)for(var F=w[A],N=0,k=d.alignmentPatternCenters;N<k.length;N++){var P=k[N];F===6&&P===6||F===6&&P===i-7||F===i-7&&P===6||C.setRegion(F-2,P-2,5,5,!0)}return C.setRegion(6,9,1,i-17,!0),C.setRegion(9,6,i-17,1,!0),d.versionNumber>6&&(C.setRegion(i-11,0,3,6,!0),C.setRegion(0,i-11,6,3,!0)),C}function b(d,i,C){for(var A=h[C.dataMask],w=d.height,F=u(i),N=[],k=0,P=0,L=!0,$=w-1;$>0;$-=2){$===6&&$--;for(var U=0;U<w;U++)for(var S=L?w-1-U:U,I=0;I<2;I++){var M=$-I;if(!F.get(M,S)){P++;var H=d.get(M,S);A({y:S,x:M})&&(H=!H),k=c(H,k),P===8&&(N.push(k),P=0,k=0)}}L=!L}return N}function E(d){var i=d.height,C=Math.floor((i-17)/4);if(C<=6)return g.VERSIONS[C-1];for(var A=0,w=5;w>=0;w--)for(var F=i-9;F>=i-11;F--)A=c(d.get(F,w),A);for(var N=0,F=5;F>=0;F--)for(var w=i-9;w>=i-11;w--)N=c(d.get(F,w),N);for(var k=1/0,P,L=0,$=g.VERSIONS;L<$.length;L++){var U=$[L];if(U.infoBits===A||U.infoBits===N)return U;var S=p(A,U.infoBits);S<k&&(P=U,k=S),S=p(N,U.infoBits),S<k&&(P=U,k=S)}if(k<=3)return P}function B(d){for(var i=0,C=0;C<=8;C++)C!==6&&(i=c(d.get(C,8),i));for(var A=7;A>=0;A--)A!==6&&(i=c(d.get(8,A),i));for(var w=d.height,F=0,A=w-1;A>=w-7;A--)F=c(d.get(8,A),F);for(var C=w-8;C<w;C++)F=c(d.get(C,8),F);for(var N=1/0,k=null,P=0,L=l;P<L.length;P++){var $=L[P],U=$.bits,S=$.formatInfo;if(U===i||U===F)return S;var I=p(i,U);I<N&&(k=S,N=I),i!==F&&(I=p(F,U),I<N&&(k=S,N=I))}return N<=3?k:null}function j(d,i,C){var A=i.errorCorrectionLevels[C],w=[],F=0;if(A.ecBlocks.forEach(function(H){for(var T=0;T<H.numBlocks;T++)w.push({numDataCodewords:H.dataCodewordsPerBlock,codewords:[]}),F+=H.dataCodewordsPerBlock+A.ecCodewordsPerBlock}),d.length<F)return null;d=d.slice(0,F);for(var N=A.ecBlocks[0].dataCodewordsPerBlock,k=0;k<N;k++)for(var P=0,L=w;P<L.length;P++){var $=L[P];$.codewords.push(d.shift())}if(A.ecBlocks.length>1)for(var U=A.ecBlocks[0].numBlocks,S=A.ecBlocks[1].numBlocks,k=0;k<S;k++)w[U+k].codewords.push(d.shift());for(;d.length>0;)for(var I=0,M=w;I<M.length;I++){var $=M[I];$.codewords.push(d.shift())}return w}function v(d){var i=E(d);if(!i)return null;var C=B(d);if(!C)return null;var A=b(d,i,C),w=j(A,i,C.errorCorrectionLevel);if(!w)return null;for(var F=w.reduce(function(I,M){return I+M.numDataCodewords},0),N=new Uint8ClampedArray(F),k=0,P=0,L=w;P<L.length;P++){var $=L[P],U=f.decode($.codewords,$.codewords.length-$.numDataCodewords);if(!U)return null;for(var S=0;S<$.numDataCodewords;S++)N[k++]=U[S]}try{return m.decode(N,i.versionNumber)}catch{return null}}function y(d){if(d==null)return null;var i=v(d);if(i)return i;for(var C=0;C<d.width;C++)for(var A=C+1;A<d.height;A++)d.get(C,A)!==d.get(A,C)&&(d.set(C,A,!d.get(C,A)),d.set(A,C,!d.get(A,C)));return v(d)}r.decode=y},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(7),m=x(8),f;(function(E){E.Numeric="numeric",E.Alphanumeric="alphanumeric",E.Byte="byte",E.Kanji="kanji",E.ECI="eci"})(f=r.Mode||(r.Mode={}));var g;(function(E){E[E.Terminator=0]="Terminator",E[E.Numeric=1]="Numeric",E[E.Alphanumeric=2]="Alphanumeric",E[E.Byte=4]="Byte",E[E.Kanji=8]="Kanji",E[E.ECI=7]="ECI"})(g||(g={}));function p(E,B){for(var j=[],v="",y=[10,12,14][B],d=E.readBits(y);d>=3;){var i=E.readBits(10);if(i>=1e3)throw new Error("Invalid numeric value above 999");var C=Math.floor(i/100),A=Math.floor(i/10)%10,w=i%10;j.push(48+C,48+A,48+w),v+=C.toString()+A.toString()+w.toString(),d-=3}if(d===2){var i=E.readBits(7);if(i>=100)throw new Error("Invalid numeric value above 99");var C=Math.floor(i/10),A=i%10;j.push(48+C,48+A),v+=C.toString()+A.toString()}else if(d===1){var i=E.readBits(4);if(i>=10)throw new Error("Invalid numeric value above 9");j.push(48+i),v+=i.toString()}return{bytes:j,text:v}}var c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function l(E,B){for(var j=[],v="",y=[9,11,13][B],d=E.readBits(y);d>=2;){var i=E.readBits(11),C=Math.floor(i/45),A=i%45;j.push(c[C].charCodeAt(0),c[A].charCodeAt(0)),v+=c[C]+c[A],d-=2}if(d===1){var C=E.readBits(6);j.push(c[C].charCodeAt(0)),v+=c[C]}return{bytes:j,text:v}}function h(E,B){for(var j=[],v="",y=[8,16,16][B],d=E.readBits(y),i=0;i<d;i++){var C=E.readBits(8);j.push(C)}try{v+=decodeURIComponent(j.map(function(A){return"%"+("0"+A.toString(16)).substr(-2)}).join(""))}catch{}return{bytes:j,text:v}}function u(E,B){for(var j=[],v="",y=[8,10,12][B],d=E.readBits(y),i=0;i<d;i++){var C=E.readBits(13),A=Math.floor(C/192)<<8|C%192;A<7936?A+=33088:A+=49472,j.push(A>>8,A&255),v+=String.fromCharCode(m.shiftJISTable[A])}return{bytes:j,text:v}}function b(E,B){for(var j,v,y,d,i=new o.BitStream(E),C=B<=9?0:B<=26?1:2,A={text:"",bytes:[],chunks:[],version:B};i.available()>=4;){var w=i.readBits(4);if(w===g.Terminator)return A;if(w===g.ECI)i.readBits(1)===0?A.chunks.push({type:f.ECI,assignmentNumber:i.readBits(7)}):i.readBits(1)===0?A.chunks.push({type:f.ECI,assignmentNumber:i.readBits(14)}):i.readBits(1)===0?A.chunks.push({type:f.ECI,assignmentNumber:i.readBits(21)}):A.chunks.push({type:f.ECI,assignmentNumber:-1});else if(w===g.Numeric){var F=p(i,C);A.text+=F.text,(j=A.bytes).push.apply(j,F.bytes),A.chunks.push({type:f.Numeric,text:F.text})}else if(w===g.Alphanumeric){var N=l(i,C);A.text+=N.text,(v=A.bytes).push.apply(v,N.bytes),A.chunks.push({type:f.Alphanumeric,text:N.text})}else if(w===g.Byte){var k=h(i,C);A.text+=k.text,(y=A.bytes).push.apply(y,k.bytes),A.chunks.push({type:f.Byte,bytes:k.bytes,text:k.text})}else if(w===g.Kanji){var P=u(i,C);A.text+=P.text,(d=A.bytes).push.apply(d,P.bytes),A.chunks.push({type:f.Kanji,bytes:P.bytes,text:P.text})}}if(i.available()===0||i.readBits(i.available())===0)return A}r.decode=b},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=function(){function m(f){this.byteOffset=0,this.bitOffset=0,this.bytes=f}return m.prototype.readBits=function(f){if(f<1||f>32||f>this.available())throw new Error("Cannot read "+f.toString()+" bits");var g=0;if(this.bitOffset>0){var p=8-this.bitOffset,c=f<p?f:p,l=p-c,h=255>>8-c<<l;g=(this.bytes[this.byteOffset]&h)>>l,f-=c,this.bitOffset+=c,this.bitOffset===8&&(this.bitOffset=0,this.byteOffset++)}if(f>0){for(;f>=8;)g=g<<8|this.bytes[this.byteOffset]&255,this.byteOffset++,f-=8;if(f>0){var l=8-f,h=255>>l<<l;g=g<<f|(this.bytes[this.byteOffset]&h)>>l,this.bitOffset+=f}}return g},m.prototype.available=function(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset},m}();r.BitStream=o},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0}),r.shiftJISTable={32:32,33:33,34:34,35:35,36:36,37:37,38:38,39:39,40:40,41:41,42:42,43:43,44:44,45:45,46:46,47:47,48:48,49:49,50:50,51:51,52:52,53:53,54:54,55:55,56:56,57:57,58:58,59:59,60:60,61:61,62:62,63:63,64:64,65:65,66:66,67:67,68:68,69:69,70:70,71:71,72:72,73:73,74:74,75:75,76:76,77:77,78:78,79:79,80:80,81:81,82:82,83:83,84:84,85:85,86:86,87:87,88:88,89:89,90:90,91:91,92:165,93:93,94:94,95:95,96:96,97:97,98:98,99:99,100:100,101:101,102:102,103:103,104:104,105:105,106:106,107:107,108:108,109:109,110:110,111:111,112:112,113:113,114:114,115:115,116:116,117:117,118:118,119:119,120:120,121:121,122:122,123:123,124:124,125:125,126:8254,33088:12288,33089:12289,33090:12290,33091:65292,33092:65294,33093:12539,33094:65306,33095:65307,33096:65311,33097:65281,33098:12443,33099:12444,33100:180,33101:65344,33102:168,33103:65342,33104:65507,33105:65343,33106:12541,33107:12542,33108:12445,33109:12446,33110:12291,33111:20189,33112:12293,33113:12294,33114:12295,33115:12540,33116:8213,33117:8208,33118:65295,33119:92,33120:12316,33121:8214,33122:65372,33123:8230,33124:8229,33125:8216,33126:8217,33127:8220,33128:8221,33129:65288,33130:65289,33131:12308,33132:12309,33133:65339,33134:65341,33135:65371,33136:65373,33137:12296,33138:12297,33139:12298,33140:12299,33141:12300,33142:12301,33143:12302,33144:12303,33145:12304,33146:12305,33147:65291,33148:8722,33149:177,33150:215,33152:247,33153:65309,33154:8800,33155:65308,33156:65310,33157:8806,33158:8807,33159:8734,33160:8756,33161:9794,33162:9792,33163:176,33164:8242,33165:8243,33166:8451,33167:65509,33168:65284,33169:162,33170:163,33171:65285,33172:65283,33173:65286,33174:65290,33175:65312,33176:167,33177:9734,33178:9733,33179:9675,33180:9679,33181:9678,33182:9671,33183:9670,33184:9633,33185:9632,33186:9651,33187:9650,33188:9661,33189:9660,33190:8251,33191:12306,33192:8594,33193:8592,33194:8593,33195:8595,33196:12307,33208:8712,33209:8715,33210:8838,33211:8839,33212:8834,33213:8835,33214:8746,33215:8745,33224:8743,33225:8744,33226:172,33227:8658,33228:8660,33229:8704,33230:8707,33242:8736,33243:8869,33244:8978,33245:8706,33246:8711,33247:8801,33248:8786,33249:8810,33250:8811,33251:8730,33252:8765,33253:8733,33254:8757,33255:8747,33256:8748,33264:8491,33265:8240,33266:9839,33267:9837,33268:9834,33269:8224,33270:8225,33271:182,33276:9711,33359:65296,33360:65297,33361:65298,33362:65299,33363:65300,33364:65301,33365:65302,33366:65303,33367:65304,33368:65305,33376:65313,33377:65314,33378:65315,33379:65316,33380:65317,33381:65318,33382:65319,33383:65320,33384:65321,33385:65322,33386:65323,33387:65324,33388:65325,33389:65326,33390:65327,33391:65328,33392:65329,33393:65330,33394:65331,33395:65332,33396:65333,33397:65334,33398:65335,33399:65336,33400:65337,33401:65338,33409:65345,33410:65346,33411:65347,33412:65348,33413:65349,33414:65350,33415:65351,33416:65352,33417:65353,33418:65354,33419:65355,33420:65356,33421:65357,33422:65358,33423:65359,33424:65360,33425:65361,33426:65362,33427:65363,33428:65364,33429:65365,33430:65366,33431:65367,33432:65368,33433:65369,33434:65370,33439:12353,33440:12354,33441:12355,33442:12356,33443:12357,33444:12358,33445:12359,33446:12360,33447:12361,33448:12362,33449:12363,33450:12364,33451:12365,33452:12366,33453:12367,33454:12368,33455:12369,33456:12370,33457:12371,33458:12372,33459:12373,33460:12374,33461:12375,33462:12376,33463:12377,33464:12378,33465:12379,33466:12380,33467:12381,33468:12382,33469:12383,33470:12384,33471:12385,33472:12386,33473:12387,33474:12388,33475:12389,33476:12390,33477:12391,33478:12392,33479:12393,33480:12394,33481:12395,33482:12396,33483:12397,33484:12398,33485:12399,33486:12400,33487:12401,33488:12402,33489:12403,33490:12404,33491:12405,33492:12406,33493:12407,33494:12408,33495:12409,33496:12410,33497:12411,33498:12412,33499:12413,33500:12414,33501:12415,33502:12416,33503:12417,33504:12418,33505:12419,33506:12420,33507:12421,33508:12422,33509:12423,33510:12424,33511:12425,33512:12426,33513:12427,33514:12428,33515:12429,33516:12430,33517:12431,33518:12432,33519:12433,33520:12434,33521:12435,33600:12449,33601:12450,33602:12451,33603:12452,33604:12453,33605:12454,33606:12455,33607:12456,33608:12457,33609:12458,33610:12459,33611:12460,33612:12461,33613:12462,33614:12463,33615:12464,33616:12465,33617:12466,33618:12467,33619:12468,33620:12469,33621:12470,33622:12471,33623:12472,33624:12473,33625:12474,33626:12475,33627:12476,33628:12477,33629:12478,33630:12479,33631:12480,33632:12481,33633:12482,33634:12483,33635:12484,33636:12485,33637:12486,33638:12487,33639:12488,33640:12489,33641:12490,33642:12491,33643:12492,33644:12493,33645:12494,33646:12495,33647:12496,33648:12497,33649:12498,33650:12499,33651:12500,33652:12501,33653:12502,33654:12503,33655:12504,33656:12505,33657:12506,33658:12507,33659:12508,33660:12509,33661:12510,33662:12511,33664:12512,33665:12513,33666:12514,33667:12515,33668:12516,33669:12517,33670:12518,33671:12519,33672:12520,33673:12521,33674:12522,33675:12523,33676:12524,33677:12525,33678:12526,33679:12527,33680:12528,33681:12529,33682:12530,33683:12531,33684:12532,33685:12533,33686:12534,33695:913,33696:914,33697:915,33698:916,33699:917,33700:918,33701:919,33702:920,33703:921,33704:922,33705:923,33706:924,33707:925,33708:926,33709:927,33710:928,33711:929,33712:931,33713:932,33714:933,33715:934,33716:935,33717:936,33718:937,33727:945,33728:946,33729:947,33730:948,33731:949,33732:950,33733:951,33734:952,33735:953,33736:954,33737:955,33738:956,33739:957,33740:958,33741:959,33742:960,33743:961,33744:963,33745:964,33746:965,33747:966,33748:967,33749:968,33750:969,33856:1040,33857:1041,33858:1042,33859:1043,33860:1044,33861:1045,33862:1025,33863:1046,33864:1047,33865:1048,33866:1049,33867:1050,33868:1051,33869:1052,33870:1053,33871:1054,33872:1055,33873:1056,33874:1057,33875:1058,33876:1059,33877:1060,33878:1061,33879:1062,33880:1063,33881:1064,33882:1065,33883:1066,33884:1067,33885:1068,33886:1069,33887:1070,33888:1071,33904:1072,33905:1073,33906:1074,33907:1075,33908:1076,33909:1077,33910:1105,33911:1078,33912:1079,33913:1080,33914:1081,33915:1082,33916:1083,33917:1084,33918:1085,33920:1086,33921:1087,33922:1088,33923:1089,33924:1090,33925:1091,33926:1092,33927:1093,33928:1094,33929:1095,33930:1096,33931:1097,33932:1098,33933:1099,33934:1100,33935:1101,33936:1102,33937:1103,33951:9472,33952:9474,33953:9484,33954:9488,33955:9496,33956:9492,33957:9500,33958:9516,33959:9508,33960:9524,33961:9532,33962:9473,33963:9475,33964:9487,33965:9491,33966:9499,33967:9495,33968:9507,33969:9523,33970:9515,33971:9531,33972:9547,33973:9504,33974:9519,33975:9512,33976:9527,33977:9535,33978:9501,33979:9520,33980:9509,33981:9528,33982:9538,34975:20124,34976:21782,34977:23043,34978:38463,34979:21696,34980:24859,34981:25384,34982:23030,34983:36898,34984:33909,34985:33564,34986:31312,34987:24746,34988:25569,34989:28197,34990:26093,34991:33894,34992:33446,34993:39925,34994:26771,34995:22311,34996:26017,34997:25201,34998:23451,34999:22992,35e3:34427,35001:39156,35002:32098,35003:32190,35004:39822,35005:25110,35006:31903,35007:34999,35008:23433,35009:24245,35010:25353,35011:26263,35012:26696,35013:38343,35014:38797,35015:26447,35016:20197,35017:20234,35018:20301,35019:20381,35020:20553,35021:22258,35022:22839,35023:22996,35024:23041,35025:23561,35026:24799,35027:24847,35028:24944,35029:26131,35030:26885,35031:28858,35032:30031,35033:30064,35034:31227,35035:32173,35036:32239,35037:32963,35038:33806,35039:34915,35040:35586,35041:36949,35042:36986,35043:21307,35044:20117,35045:20133,35046:22495,35047:32946,35048:37057,35049:30959,35050:19968,35051:22769,35052:28322,35053:36920,35054:31282,35055:33576,35056:33419,35057:39983,35058:20801,35059:21360,35060:21693,35061:21729,35062:22240,35063:23035,35064:24341,35065:39154,35066:28139,35067:32996,35068:34093,35136:38498,35137:38512,35138:38560,35139:38907,35140:21515,35141:21491,35142:23431,35143:28879,35144:32701,35145:36802,35146:38632,35147:21359,35148:40284,35149:31418,35150:19985,35151:30867,35152:33276,35153:28198,35154:22040,35155:21764,35156:27421,35157:34074,35158:39995,35159:23013,35160:21417,35161:28006,35162:29916,35163:38287,35164:22082,35165:20113,35166:36939,35167:38642,35168:33615,35169:39180,35170:21473,35171:21942,35172:23344,35173:24433,35174:26144,35175:26355,35176:26628,35177:27704,35178:27891,35179:27945,35180:29787,35181:30408,35182:31310,35183:38964,35184:33521,35185:34907,35186:35424,35187:37613,35188:28082,35189:30123,35190:30410,35191:39365,35192:24742,35193:35585,35194:36234,35195:38322,35196:27022,35197:21421,35198:20870,35200:22290,35201:22576,35202:22852,35203:23476,35204:24310,35205:24616,35206:25513,35207:25588,35208:27839,35209:28436,35210:28814,35211:28948,35212:29017,35213:29141,35214:29503,35215:32257,35216:33398,35217:33489,35218:34199,35219:36960,35220:37467,35221:40219,35222:22633,35223:26044,35224:27738,35225:29989,35226:20985,35227:22830,35228:22885,35229:24448,35230:24540,35231:25276,35232:26106,35233:27178,35234:27431,35235:27572,35236:29579,35237:32705,35238:35158,35239:40236,35240:40206,35241:40644,35242:23713,35243:27798,35244:33659,35245:20740,35246:23627,35247:25014,35248:33222,35249:26742,35250:29281,35251:20057,35252:20474,35253:21368,35254:24681,35255:28201,35256:31311,35257:38899,35258:19979,35259:21270,35260:20206,35261:20309,35262:20285,35263:20385,35264:20339,35265:21152,35266:21487,35267:22025,35268:22799,35269:23233,35270:23478,35271:23521,35272:31185,35273:26247,35274:26524,35275:26550,35276:27468,35277:27827,35278:28779,35279:29634,35280:31117,35281:31166,35282:31292,35283:31623,35284:33457,35285:33499,35286:33540,35287:33655,35288:33775,35289:33747,35290:34662,35291:35506,35292:22057,35293:36008,35294:36838,35295:36942,35296:38686,35297:34442,35298:20420,35299:23784,35300:25105,35301:29273,35302:30011,35303:33253,35304:33469,35305:34558,35306:36032,35307:38597,35308:39187,35309:39381,35310:20171,35311:20250,35312:35299,35313:22238,35314:22602,35315:22730,35316:24315,35317:24555,35318:24618,35319:24724,35320:24674,35321:25040,35322:25106,35323:25296,35324:25913,35392:39745,35393:26214,35394:26800,35395:28023,35396:28784,35397:30028,35398:30342,35399:32117,35400:33445,35401:34809,35402:38283,35403:38542,35404:35997,35405:20977,35406:21182,35407:22806,35408:21683,35409:23475,35410:23830,35411:24936,35412:27010,35413:28079,35414:30861,35415:33995,35416:34903,35417:35442,35418:37799,35419:39608,35420:28012,35421:39336,35422:34521,35423:22435,35424:26623,35425:34510,35426:37390,35427:21123,35428:22151,35429:21508,35430:24275,35431:25313,35432:25785,35433:26684,35434:26680,35435:27579,35436:29554,35437:30906,35438:31339,35439:35226,35440:35282,35441:36203,35442:36611,35443:37101,35444:38307,35445:38548,35446:38761,35447:23398,35448:23731,35449:27005,35450:38989,35451:38990,35452:25499,35453:31520,35454:27179,35456:27263,35457:26806,35458:39949,35459:28511,35460:21106,35461:21917,35462:24688,35463:25324,35464:27963,35465:28167,35466:28369,35467:33883,35468:35088,35469:36676,35470:19988,35471:39993,35472:21494,35473:26907,35474:27194,35475:38788,35476:26666,35477:20828,35478:31427,35479:33970,35480:37340,35481:37772,35482:22107,35483:40232,35484:26658,35485:33541,35486:33841,35487:31909,35488:21e3,35489:33477,35490:29926,35491:20094,35492:20355,35493:20896,35494:23506,35495:21002,35496:21208,35497:21223,35498:24059,35499:21914,35500:22570,35501:23014,35502:23436,35503:23448,35504:23515,35505:24178,35506:24185,35507:24739,35508:24863,35509:24931,35510:25022,35511:25563,35512:25954,35513:26577,35514:26707,35515:26874,35516:27454,35517:27475,35518:27735,35519:28450,35520:28567,35521:28485,35522:29872,35523:29976,35524:30435,35525:30475,35526:31487,35527:31649,35528:31777,35529:32233,35530:32566,35531:32752,35532:32925,35533:33382,35534:33694,35535:35251,35536:35532,35537:36011,35538:36996,35539:37969,35540:38291,35541:38289,35542:38306,35543:38501,35544:38867,35545:39208,35546:33304,35547:20024,35548:21547,35549:23736,35550:24012,35551:29609,35552:30284,35553:30524,35554:23721,35555:32747,35556:36107,35557:38593,35558:38929,35559:38996,35560:39e3,35561:20225,35562:20238,35563:21361,35564:21916,35565:22120,35566:22522,35567:22855,35568:23305,35569:23492,35570:23696,35571:24076,35572:24190,35573:24524,35574:25582,35575:26426,35576:26071,35577:26082,35578:26399,35579:26827,35580:26820,35648:27231,35649:24112,35650:27589,35651:27671,35652:27773,35653:30079,35654:31048,35655:23395,35656:31232,35657:32e3,35658:24509,35659:35215,35660:35352,35661:36020,35662:36215,35663:36556,35664:36637,35665:39138,35666:39438,35667:39740,35668:20096,35669:20605,35670:20736,35671:22931,35672:23452,35673:25135,35674:25216,35675:25836,35676:27450,35677:29344,35678:30097,35679:31047,35680:32681,35681:34811,35682:35516,35683:35696,35684:25516,35685:33738,35686:38816,35687:21513,35688:21507,35689:21931,35690:26708,35691:27224,35692:35440,35693:30759,35694:26485,35695:40653,35696:21364,35697:23458,35698:33050,35699:34384,35700:36870,35701:19992,35702:20037,35703:20167,35704:20241,35705:21450,35706:21560,35707:23470,35708:24339,35709:24613,35710:25937,35712:26429,35713:27714,35714:27762,35715:27875,35716:28792,35717:29699,35718:31350,35719:31406,35720:31496,35721:32026,35722:31998,35723:32102,35724:26087,35725:29275,35726:21435,35727:23621,35728:24040,35729:25298,35730:25312,35731:25369,35732:28192,35733:34394,35734:35377,35735:36317,35736:37624,35737:28417,35738:31142,35739:39770,35740:20136,35741:20139,35742:20140,35743:20379,35744:20384,35745:20689,35746:20807,35747:31478,35748:20849,35749:20982,35750:21332,35751:21281,35752:21375,35753:21483,35754:21932,35755:22659,35756:23777,35757:24375,35758:24394,35759:24623,35760:24656,35761:24685,35762:25375,35763:25945,35764:27211,35765:27841,35766:29378,35767:29421,35768:30703,35769:33016,35770:33029,35771:33288,35772:34126,35773:37111,35774:37857,35775:38911,35776:39255,35777:39514,35778:20208,35779:20957,35780:23597,35781:26241,35782:26989,35783:23616,35784:26354,35785:26997,35786:29577,35787:26704,35788:31873,35789:20677,35790:21220,35791:22343,35792:24062,35793:37670,35794:26020,35795:27427,35796:27453,35797:29748,35798:31105,35799:31165,35800:31563,35801:32202,35802:33465,35803:33740,35804:34943,35805:35167,35806:35641,35807:36817,35808:37329,35809:21535,35810:37504,35811:20061,35812:20534,35813:21477,35814:21306,35815:29399,35816:29590,35817:30697,35818:33510,35819:36527,35820:39366,35821:39368,35822:39378,35823:20855,35824:24858,35825:34398,35826:21936,35827:31354,35828:20598,35829:23507,35830:36935,35831:38533,35832:20018,35833:27355,35834:37351,35835:23633,35836:23624,35904:25496,35905:31391,35906:27795,35907:38772,35908:36705,35909:31402,35910:29066,35911:38536,35912:31874,35913:26647,35914:32368,35915:26705,35916:37740,35917:21234,35918:21531,35919:34219,35920:35347,35921:32676,35922:36557,35923:37089,35924:21350,35925:34952,35926:31041,35927:20418,35928:20670,35929:21009,35930:20804,35931:21843,35932:22317,35933:29674,35934:22411,35935:22865,35936:24418,35937:24452,35938:24693,35939:24950,35940:24935,35941:25001,35942:25522,35943:25658,35944:25964,35945:26223,35946:26690,35947:28179,35948:30054,35949:31293,35950:31995,35951:32076,35952:32153,35953:32331,35954:32619,35955:33550,35956:33610,35957:34509,35958:35336,35959:35427,35960:35686,35961:36605,35962:38938,35963:40335,35964:33464,35965:36814,35966:39912,35968:21127,35969:25119,35970:25731,35971:28608,35972:38553,35973:26689,35974:20625,35975:27424,35976:27770,35977:28500,35978:31348,35979:32080,35980:34880,35981:35363,35982:26376,35983:20214,35984:20537,35985:20518,35986:20581,35987:20860,35988:21048,35989:21091,35990:21927,35991:22287,35992:22533,35993:23244,35994:24314,35995:25010,35996:25080,35997:25331,35998:25458,35999:26908,36e3:27177,36001:29309,36002:29356,36003:29486,36004:30740,36005:30831,36006:32121,36007:30476,36008:32937,36009:35211,36010:35609,36011:36066,36012:36562,36013:36963,36014:37749,36015:38522,36016:38997,36017:39443,36018:40568,36019:20803,36020:21407,36021:21427,36022:24187,36023:24358,36024:28187,36025:28304,36026:29572,36027:29694,36028:32067,36029:33335,36030:35328,36031:35578,36032:38480,36033:20046,36034:20491,36035:21476,36036:21628,36037:22266,36038:22993,36039:23396,36040:24049,36041:24235,36042:24359,36043:25144,36044:25925,36045:26543,36046:28246,36047:29392,36048:31946,36049:34996,36050:32929,36051:32993,36052:33776,36053:34382,36054:35463,36055:36328,36056:37431,36057:38599,36058:39015,36059:40723,36060:20116,36061:20114,36062:20237,36063:21320,36064:21577,36065:21566,36066:23087,36067:24460,36068:24481,36069:24735,36070:26791,36071:27278,36072:29786,36073:30849,36074:35486,36075:35492,36076:35703,36077:37264,36078:20062,36079:39881,36080:20132,36081:20348,36082:20399,36083:20505,36084:20502,36085:20809,36086:20844,36087:21151,36088:21177,36089:21246,36090:21402,36091:21475,36092:21521,36160:21518,36161:21897,36162:22353,36163:22434,36164:22909,36165:23380,36166:23389,36167:23439,36168:24037,36169:24039,36170:24055,36171:24184,36172:24195,36173:24218,36174:24247,36175:24344,36176:24658,36177:24908,36178:25239,36179:25304,36180:25511,36181:25915,36182:26114,36183:26179,36184:26356,36185:26477,36186:26657,36187:26775,36188:27083,36189:27743,36190:27946,36191:28009,36192:28207,36193:28317,36194:30002,36195:30343,36196:30828,36197:31295,36198:31968,36199:32005,36200:32024,36201:32094,36202:32177,36203:32789,36204:32771,36205:32943,36206:32945,36207:33108,36208:33167,36209:33322,36210:33618,36211:34892,36212:34913,36213:35611,36214:36002,36215:36092,36216:37066,36217:37237,36218:37489,36219:30783,36220:37628,36221:38308,36222:38477,36224:38917,36225:39321,36226:39640,36227:40251,36228:21083,36229:21163,36230:21495,36231:21512,36232:22741,36233:25335,36234:28640,36235:35946,36236:36703,36237:40633,36238:20811,36239:21051,36240:21578,36241:22269,36242:31296,36243:37239,36244:40288,36245:40658,36246:29508,36247:28425,36248:33136,36249:29969,36250:24573,36251:24794,36252:39592,36253:29403,36254:36796,36255:27492,36256:38915,36257:20170,36258:22256,36259:22372,36260:22718,36261:23130,36262:24680,36263:25031,36264:26127,36265:26118,36266:26681,36267:26801,36268:28151,36269:30165,36270:32058,36271:33390,36272:39746,36273:20123,36274:20304,36275:21449,36276:21766,36277:23919,36278:24038,36279:24046,36280:26619,36281:27801,36282:29811,36283:30722,36284:35408,36285:37782,36286:35039,36287:22352,36288:24231,36289:25387,36290:20661,36291:20652,36292:20877,36293:26368,36294:21705,36295:22622,36296:22971,36297:23472,36298:24425,36299:25165,36300:25505,36301:26685,36302:27507,36303:28168,36304:28797,36305:37319,36306:29312,36307:30741,36308:30758,36309:31085,36310:25998,36311:32048,36312:33756,36313:35009,36314:36617,36315:38555,36316:21092,36317:22312,36318:26448,36319:32618,36320:36001,36321:20916,36322:22338,36323:38442,36324:22586,36325:27018,36326:32948,36327:21682,36328:23822,36329:22524,36330:30869,36331:40442,36332:20316,36333:21066,36334:21643,36335:25662,36336:26152,36337:26388,36338:26613,36339:31364,36340:31574,36341:32034,36342:37679,36343:26716,36344:39853,36345:31545,36346:21273,36347:20874,36348:21047,36416:23519,36417:25334,36418:25774,36419:25830,36420:26413,36421:27578,36422:34217,36423:38609,36424:30352,36425:39894,36426:25420,36427:37638,36428:39851,36429:30399,36430:26194,36431:19977,36432:20632,36433:21442,36434:23665,36435:24808,36436:25746,36437:25955,36438:26719,36439:29158,36440:29642,36441:29987,36442:31639,36443:32386,36444:34453,36445:35715,36446:36059,36447:37240,36448:39184,36449:26028,36450:26283,36451:27531,36452:20181,36453:20180,36454:20282,36455:20351,36456:21050,36457:21496,36458:21490,36459:21987,36460:22235,36461:22763,36462:22987,36463:22985,36464:23039,36465:23376,36466:23629,36467:24066,36468:24107,36469:24535,36470:24605,36471:25351,36472:25903,36473:23388,36474:26031,36475:26045,36476:26088,36477:26525,36478:27490,36480:27515,36481:27663,36482:29509,36483:31049,36484:31169,36485:31992,36486:32025,36487:32043,36488:32930,36489:33026,36490:33267,36491:35222,36492:35422,36493:35433,36494:35430,36495:35468,36496:35566,36497:36039,36498:36060,36499:38604,36500:39164,36501:27503,36502:20107,36503:20284,36504:20365,36505:20816,36506:23383,36507:23546,36508:24904,36509:25345,36510:26178,36511:27425,36512:28363,36513:27835,36514:29246,36515:29885,36516:30164,36517:30913,36518:31034,36519:32780,36520:32819,36521:33258,36522:33940,36523:36766,36524:27728,36525:40575,36526:24335,36527:35672,36528:40235,36529:31482,36530:36600,36531:23437,36532:38635,36533:19971,36534:21489,36535:22519,36536:22833,36537:23241,36538:23460,36539:24713,36540:28287,36541:28422,36542:30142,36543:36074,36544:23455,36545:34048,36546:31712,36547:20594,36548:26612,36549:33437,36550:23649,36551:34122,36552:32286,36553:33294,36554:20889,36555:23556,36556:25448,36557:36198,36558:26012,36559:29038,36560:31038,36561:32023,36562:32773,36563:35613,36564:36554,36565:36974,36566:34503,36567:37034,36568:20511,36569:21242,36570:23610,36571:26451,36572:28796,36573:29237,36574:37196,36575:37320,36576:37675,36577:33509,36578:23490,36579:24369,36580:24825,36581:20027,36582:21462,36583:23432,36584:25163,36585:26417,36586:27530,36587:29417,36588:29664,36589:31278,36590:33131,36591:36259,36592:37202,36593:39318,36594:20754,36595:21463,36596:21610,36597:23551,36598:25480,36599:27193,36600:32172,36601:38656,36602:22234,36603:21454,36604:21608,36672:23447,36673:23601,36674:24030,36675:20462,36676:24833,36677:25342,36678:27954,36679:31168,36680:31179,36681:32066,36682:32333,36683:32722,36684:33261,36685:33311,36686:33936,36687:34886,36688:35186,36689:35728,36690:36468,36691:36655,36692:36913,36693:37195,36694:37228,36695:38598,36696:37276,36697:20160,36698:20303,36699:20805,36700:21313,36701:24467,36702:25102,36703:26580,36704:27713,36705:28171,36706:29539,36707:32294,36708:37325,36709:37507,36710:21460,36711:22809,36712:23487,36713:28113,36714:31069,36715:32302,36716:31899,36717:22654,36718:29087,36719:20986,36720:34899,36721:36848,36722:20426,36723:23803,36724:26149,36725:30636,36726:31459,36727:33308,36728:39423,36729:20934,36730:24490,36731:26092,36732:26991,36733:27529,36734:28147,36736:28310,36737:28516,36738:30462,36739:32020,36740:24033,36741:36981,36742:37255,36743:38918,36744:20966,36745:21021,36746:25152,36747:26257,36748:26329,36749:28186,36750:24246,36751:32210,36752:32626,36753:26360,36754:34223,36755:34295,36756:35576,36757:21161,36758:21465,36759:22899,36760:24207,36761:24464,36762:24661,36763:37604,36764:38500,36765:20663,36766:20767,36767:21213,36768:21280,36769:21319,36770:21484,36771:21736,36772:21830,36773:21809,36774:22039,36775:22888,36776:22974,36777:23100,36778:23477,36779:23558,36780:23567,36781:23569,36782:23578,36783:24196,36784:24202,36785:24288,36786:24432,36787:25215,36788:25220,36789:25307,36790:25484,36791:25463,36792:26119,36793:26124,36794:26157,36795:26230,36796:26494,36797:26786,36798:27167,36799:27189,36800:27836,36801:28040,36802:28169,36803:28248,36804:28988,36805:28966,36806:29031,36807:30151,36808:30465,36809:30813,36810:30977,36811:31077,36812:31216,36813:31456,36814:31505,36815:31911,36816:32057,36817:32918,36818:33750,36819:33931,36820:34121,36821:34909,36822:35059,36823:35359,36824:35388,36825:35412,36826:35443,36827:35937,36828:36062,36829:37284,36830:37478,36831:37758,36832:37912,36833:38556,36834:38808,36835:19978,36836:19976,36837:19998,36838:20055,36839:20887,36840:21104,36841:22478,36842:22580,36843:22732,36844:23330,36845:24120,36846:24773,36847:25854,36848:26465,36849:26454,36850:27972,36851:29366,36852:30067,36853:31331,36854:33976,36855:35698,36856:37304,36857:37664,36858:22065,36859:22516,36860:39166,36928:25325,36929:26893,36930:27542,36931:29165,36932:32340,36933:32887,36934:33394,36935:35302,36936:39135,36937:34645,36938:36785,36939:23611,36940:20280,36941:20449,36942:20405,36943:21767,36944:23072,36945:23517,36946:23529,36947:24515,36948:24910,36949:25391,36950:26032,36951:26187,36952:26862,36953:27035,36954:28024,36955:28145,36956:30003,36957:30137,36958:30495,36959:31070,36960:31206,36961:32051,36962:33251,36963:33455,36964:34218,36965:35242,36966:35386,36967:36523,36968:36763,36969:36914,36970:37341,36971:38663,36972:20154,36973:20161,36974:20995,36975:22645,36976:22764,36977:23563,36978:29978,36979:23613,36980:33102,36981:35338,36982:36805,36983:38499,36984:38765,36985:31525,36986:35535,36987:38920,36988:37218,36989:22259,36990:21416,36992:36887,36993:21561,36994:22402,36995:24101,36996:25512,36997:27700,36998:28810,36999:30561,37e3:31883,37001:32736,37002:34928,37003:36930,37004:37204,37005:37648,37006:37656,37007:38543,37008:29790,37009:39620,37010:23815,37011:23913,37012:25968,37013:26530,37014:36264,37015:38619,37016:25454,37017:26441,37018:26905,37019:33733,37020:38935,37021:38592,37022:35070,37023:28548,37024:25722,37025:23544,37026:19990,37027:28716,37028:30045,37029:26159,37030:20932,37031:21046,37032:21218,37033:22995,37034:24449,37035:24615,37036:25104,37037:25919,37038:25972,37039:26143,37040:26228,37041:26866,37042:26646,37043:27491,37044:28165,37045:29298,37046:29983,37047:30427,37048:31934,37049:32854,37050:22768,37051:35069,37052:35199,37053:35488,37054:35475,37055:35531,37056:36893,37057:37266,37058:38738,37059:38745,37060:25993,37061:31246,37062:33030,37063:38587,37064:24109,37065:24796,37066:25114,37067:26021,37068:26132,37069:26512,37070:30707,37071:31309,37072:31821,37073:32318,37074:33034,37075:36012,37076:36196,37077:36321,37078:36447,37079:30889,37080:20999,37081:25305,37082:25509,37083:25666,37084:25240,37085:35373,37086:31363,37087:31680,37088:35500,37089:38634,37090:32118,37091:33292,37092:34633,37093:20185,37094:20808,37095:21315,37096:21344,37097:23459,37098:23554,37099:23574,37100:24029,37101:25126,37102:25159,37103:25776,37104:26643,37105:26676,37106:27849,37107:27973,37108:27927,37109:26579,37110:28508,37111:29006,37112:29053,37113:26059,37114:31359,37115:31661,37116:32218,37184:32330,37185:32680,37186:33146,37187:33307,37188:33337,37189:34214,37190:35438,37191:36046,37192:36341,37193:36984,37194:36983,37195:37549,37196:37521,37197:38275,37198:39854,37199:21069,37200:21892,37201:28472,37202:28982,37203:20840,37204:31109,37205:32341,37206:33203,37207:31950,37208:22092,37209:22609,37210:23720,37211:25514,37212:26366,37213:26365,37214:26970,37215:29401,37216:30095,37217:30094,37218:30990,37219:31062,37220:31199,37221:31895,37222:32032,37223:32068,37224:34311,37225:35380,37226:38459,37227:36961,37228:40736,37229:20711,37230:21109,37231:21452,37232:21474,37233:20489,37234:21930,37235:22766,37236:22863,37237:29245,37238:23435,37239:23652,37240:21277,37241:24803,37242:24819,37243:25436,37244:25475,37245:25407,37246:25531,37248:25805,37249:26089,37250:26361,37251:24035,37252:27085,37253:27133,37254:28437,37255:29157,37256:20105,37257:30185,37258:30456,37259:31379,37260:31967,37261:32207,37262:32156,37263:32865,37264:33609,37265:33624,37266:33900,37267:33980,37268:34299,37269:35013,37270:36208,37271:36865,37272:36973,37273:37783,37274:38684,37275:39442,37276:20687,37277:22679,37278:24974,37279:33235,37280:34101,37281:36104,37282:36896,37283:20419,37284:20596,37285:21063,37286:21363,37287:24687,37288:25417,37289:26463,37290:28204,37291:36275,37292:36895,37293:20439,37294:23646,37295:36042,37296:26063,37297:32154,37298:21330,37299:34966,37300:20854,37301:25539,37302:23384,37303:23403,37304:23562,37305:25613,37306:26449,37307:36956,37308:20182,37309:22810,37310:22826,37311:27760,37312:35409,37313:21822,37314:22549,37315:22949,37316:24816,37317:25171,37318:26561,37319:33333,37320:26965,37321:38464,37322:39364,37323:39464,37324:20307,37325:22534,37326:23550,37327:32784,37328:23729,37329:24111,37330:24453,37331:24608,37332:24907,37333:25140,37334:26367,37335:27888,37336:28382,37337:32974,37338:33151,37339:33492,37340:34955,37341:36024,37342:36864,37343:36910,37344:38538,37345:40667,37346:39899,37347:20195,37348:21488,37349:22823,37350:31532,37351:37261,37352:38988,37353:40441,37354:28381,37355:28711,37356:21331,37357:21828,37358:23429,37359:25176,37360:25246,37361:25299,37362:27810,37363:28655,37364:29730,37365:35351,37366:37944,37367:28609,37368:35582,37369:33592,37370:20967,37371:34552,37372:21482,37440:21481,37441:20294,37442:36948,37443:36784,37444:22890,37445:33073,37446:24061,37447:31466,37448:36799,37449:26842,37450:35895,37451:29432,37452:40008,37453:27197,37454:35504,37455:20025,37456:21336,37457:22022,37458:22374,37459:25285,37460:25506,37461:26086,37462:27470,37463:28129,37464:28251,37465:28845,37466:30701,37467:31471,37468:31658,37469:32187,37470:32829,37471:32966,37472:34507,37473:35477,37474:37723,37475:22243,37476:22727,37477:24382,37478:26029,37479:26262,37480:27264,37481:27573,37482:30007,37483:35527,37484:20516,37485:30693,37486:22320,37487:24347,37488:24677,37489:26234,37490:27744,37491:30196,37492:31258,37493:32622,37494:33268,37495:34584,37496:36933,37497:39347,37498:31689,37499:30044,37500:31481,37501:31569,37502:33988,37504:36880,37505:31209,37506:31378,37507:33590,37508:23265,37509:30528,37510:20013,37511:20210,37512:23449,37513:24544,37514:25277,37515:26172,37516:26609,37517:27880,37518:34411,37519:34935,37520:35387,37521:37198,37522:37619,37523:39376,37524:27159,37525:28710,37526:29482,37527:33511,37528:33879,37529:36015,37530:19969,37531:20806,37532:20939,37533:21899,37534:23541,37535:24086,37536:24115,37537:24193,37538:24340,37539:24373,37540:24427,37541:24500,37542:25074,37543:25361,37544:26274,37545:26397,37546:28526,37547:29266,37548:30010,37549:30522,37550:32884,37551:33081,37552:33144,37553:34678,37554:35519,37555:35548,37556:36229,37557:36339,37558:37530,37559:38263,37560:38914,37561:40165,37562:21189,37563:25431,37564:30452,37565:26389,37566:27784,37567:29645,37568:36035,37569:37806,37570:38515,37571:27941,37572:22684,37573:26894,37574:27084,37575:36861,37576:37786,37577:30171,37578:36890,37579:22618,37580:26626,37581:25524,37582:27131,37583:20291,37584:28460,37585:26584,37586:36795,37587:34086,37588:32180,37589:37716,37590:26943,37591:28528,37592:22378,37593:22775,37594:23340,37595:32044,37596:29226,37597:21514,37598:37347,37599:40372,37600:20141,37601:20302,37602:20572,37603:20597,37604:21059,37605:35998,37606:21576,37607:22564,37608:23450,37609:24093,37610:24213,37611:24237,37612:24311,37613:24351,37614:24716,37615:25269,37616:25402,37617:25552,37618:26799,37619:27712,37620:30855,37621:31118,37622:31243,37623:32224,37624:33351,37625:35330,37626:35558,37627:36420,37628:36883,37696:37048,37697:37165,37698:37336,37699:40718,37700:27877,37701:25688,37702:25826,37703:25973,37704:28404,37705:30340,37706:31515,37707:36969,37708:37841,37709:28346,37710:21746,37711:24505,37712:25764,37713:36685,37714:36845,37715:37444,37716:20856,37717:22635,37718:22825,37719:23637,37720:24215,37721:28155,37722:32399,37723:29980,37724:36028,37725:36578,37726:39003,37727:28857,37728:20253,37729:27583,37730:28593,37731:3e4,37732:38651,37733:20814,37734:21520,37735:22581,37736:22615,37737:22956,37738:23648,37739:24466,37740:26007,37741:26460,37742:28193,37743:30331,37744:33759,37745:36077,37746:36884,37747:37117,37748:37709,37749:30757,37750:30778,37751:21162,37752:24230,37753:22303,37754:22900,37755:24594,37756:20498,37757:20826,37758:20908,37760:20941,37761:20992,37762:21776,37763:22612,37764:22616,37765:22871,37766:23445,37767:23798,37768:23947,37769:24764,37770:25237,37771:25645,37772:26481,37773:26691,37774:26812,37775:26847,37776:30423,37777:28120,37778:28271,37779:28059,37780:28783,37781:29128,37782:24403,37783:30168,37784:31095,37785:31561,37786:31572,37787:31570,37788:31958,37789:32113,37790:21040,37791:33891,37792:34153,37793:34276,37794:35342,37795:35588,37796:35910,37797:36367,37798:36867,37799:36879,37800:37913,37801:38518,37802:38957,37803:39472,37804:38360,37805:20685,37806:21205,37807:21516,37808:22530,37809:23566,37810:24999,37811:25758,37812:27934,37813:30643,37814:31461,37815:33012,37816:33796,37817:36947,37818:37509,37819:23776,37820:40199,37821:21311,37822:24471,37823:24499,37824:28060,37825:29305,37826:30563,37827:31167,37828:31716,37829:27602,37830:29420,37831:35501,37832:26627,37833:27233,37834:20984,37835:31361,37836:26932,37837:23626,37838:40182,37839:33515,37840:23493,37841:37193,37842:28702,37843:22136,37844:23663,37845:24775,37846:25958,37847:27788,37848:35930,37849:36929,37850:38931,37851:21585,37852:26311,37853:37389,37854:22856,37855:37027,37856:20869,37857:20045,37858:20970,37859:34201,37860:35598,37861:28760,37862:25466,37863:37707,37864:26978,37865:39348,37866:32260,37867:30071,37868:21335,37869:26976,37870:36575,37871:38627,37872:27741,37873:20108,37874:23612,37875:24336,37876:36841,37877:21250,37878:36049,37879:32905,37880:34425,37881:24319,37882:26085,37883:20083,37884:20837,37952:22914,37953:23615,37954:38894,37955:20219,37956:22922,37957:24525,37958:35469,37959:28641,37960:31152,37961:31074,37962:23527,37963:33905,37964:29483,37965:29105,37966:24180,37967:24565,37968:25467,37969:25754,37970:29123,37971:31896,37972:20035,37973:24316,37974:20043,37975:22492,37976:22178,37977:24745,37978:28611,37979:32013,37980:33021,37981:33075,37982:33215,37983:36786,37984:35223,37985:34468,37986:24052,37987:25226,37988:25773,37989:35207,37990:26487,37991:27874,37992:27966,37993:29750,37994:30772,37995:23110,37996:32629,37997:33453,37998:39340,37999:20467,38e3:24259,38001:25309,38002:25490,38003:25943,38004:26479,38005:30403,38006:29260,38007:32972,38008:32954,38009:36649,38010:37197,38011:20493,38012:22521,38013:23186,38014:26757,38016:26995,38017:29028,38018:29437,38019:36023,38020:22770,38021:36064,38022:38506,38023:36889,38024:34687,38025:31204,38026:30695,38027:33833,38028:20271,38029:21093,38030:21338,38031:25293,38032:26575,38033:27850,38034:30333,38035:31636,38036:31893,38037:33334,38038:34180,38039:36843,38040:26333,38041:28448,38042:29190,38043:32283,38044:33707,38045:39361,38046:40614,38047:20989,38048:31665,38049:30834,38050:31672,38051:32903,38052:31560,38053:27368,38054:24161,38055:32908,38056:30033,38057:30048,38058:20843,38059:37474,38060:28300,38061:30330,38062:37271,38063:39658,38064:20240,38065:32624,38066:25244,38067:31567,38068:38309,38069:40169,38070:22138,38071:22617,38072:34532,38073:38588,38074:20276,38075:21028,38076:21322,38077:21453,38078:21467,38079:24070,38080:25644,38081:26001,38082:26495,38083:27710,38084:27726,38085:29256,38086:29359,38087:29677,38088:30036,38089:32321,38090:33324,38091:34281,38092:36009,38093:31684,38094:37318,38095:29033,38096:38930,38097:39151,38098:25405,38099:26217,38100:30058,38101:30436,38102:30928,38103:34115,38104:34542,38105:21290,38106:21329,38107:21542,38108:22915,38109:24199,38110:24444,38111:24754,38112:25161,38113:25209,38114:25259,38115:26e3,38116:27604,38117:27852,38118:30130,38119:30382,38120:30865,38121:31192,38122:32203,38123:32631,38124:32933,38125:34987,38126:35513,38127:36027,38128:36991,38129:38750,38130:39131,38131:27147,38132:31800,38133:20633,38134:23614,38135:24494,38136:26503,38137:27608,38138:29749,38139:30473,38140:32654,38208:40763,38209:26570,38210:31255,38211:21305,38212:30091,38213:39661,38214:24422,38215:33181,38216:33777,38217:32920,38218:24380,38219:24517,38220:30050,38221:31558,38222:36924,38223:26727,38224:23019,38225:23195,38226:32016,38227:30334,38228:35628,38229:20469,38230:24426,38231:27161,38232:27703,38233:28418,38234:29922,38235:31080,38236:34920,38237:35413,38238:35961,38239:24287,38240:25551,38241:30149,38242:31186,38243:33495,38244:37672,38245:37618,38246:33948,38247:34541,38248:39981,38249:21697,38250:24428,38251:25996,38252:27996,38253:28693,38254:36007,38255:36051,38256:38971,38257:25935,38258:29942,38259:19981,38260:20184,38261:22496,38262:22827,38263:23142,38264:23500,38265:20904,38266:24067,38267:24220,38268:24598,38269:25206,38270:25975,38272:26023,38273:26222,38274:28014,38275:29238,38276:31526,38277:33104,38278:33178,38279:33433,38280:35676,38281:36e3,38282:36070,38283:36212,38284:38428,38285:38468,38286:20398,38287:25771,38288:27494,38289:33310,38290:33889,38291:34154,38292:37096,38293:23553,38294:26963,38295:39080,38296:33914,38297:34135,38298:20239,38299:21103,38300:24489,38301:24133,38302:26381,38303:31119,38304:33145,38305:35079,38306:35206,38307:28149,38308:24343,38309:25173,38310:27832,38311:20175,38312:29289,38313:39826,38314:20998,38315:21563,38316:22132,38317:22707,38318:24996,38319:25198,38320:28954,38321:22894,38322:31881,38323:31966,38324:32027,38325:38640,38326:25991,38327:32862,38328:19993,38329:20341,38330:20853,38331:22592,38332:24163,38333:24179,38334:24330,38335:26564,38336:20006,38337:34109,38338:38281,38339:38491,38340:31859,38341:38913,38342:20731,38343:22721,38344:30294,38345:30887,38346:21029,38347:30629,38348:34065,38349:31622,38350:20559,38351:22793,38352:29255,38353:31687,38354:32232,38355:36794,38356:36820,38357:36941,38358:20415,38359:21193,38360:23081,38361:24321,38362:38829,38363:20445,38364:33303,38365:37610,38366:22275,38367:25429,38368:27497,38369:29995,38370:35036,38371:36628,38372:31298,38373:21215,38374:22675,38375:24917,38376:25098,38377:26286,38378:27597,38379:31807,38380:33769,38381:20515,38382:20472,38383:21253,38384:21574,38385:22577,38386:22857,38387:23453,38388:23792,38389:23791,38390:23849,38391:24214,38392:25265,38393:25447,38394:25918,38395:26041,38396:26379,38464:27861,38465:27873,38466:28921,38467:30770,38468:32299,38469:32990,38470:33459,38471:33804,38472:34028,38473:34562,38474:35090,38475:35370,38476:35914,38477:37030,38478:37586,38479:39165,38480:40179,38481:40300,38482:20047,38483:20129,38484:20621,38485:21078,38486:22346,38487:22952,38488:24125,38489:24536,38490:24537,38491:25151,38492:26292,38493:26395,38494:26576,38495:26834,38496:20882,38497:32033,38498:32938,38499:33192,38500:35584,38501:35980,38502:36031,38503:37502,38504:38450,38505:21536,38506:38956,38507:21271,38508:20693,38509:21340,38510:22696,38511:25778,38512:26420,38513:29287,38514:30566,38515:31302,38516:37350,38517:21187,38518:27809,38519:27526,38520:22528,38521:24140,38522:22868,38523:26412,38524:32763,38525:20961,38526:30406,38528:25705,38529:30952,38530:39764,38531:40635,38532:22475,38533:22969,38534:26151,38535:26522,38536:27598,38537:21737,38538:27097,38539:24149,38540:33180,38541:26517,38542:39850,38543:26622,38544:40018,38545:26717,38546:20134,38547:20451,38548:21448,38549:25273,38550:26411,38551:27819,38552:36804,38553:20397,38554:32365,38555:40639,38556:19975,38557:24930,38558:28288,38559:28459,38560:34067,38561:21619,38562:26410,38563:39749,38564:24051,38565:31637,38566:23724,38567:23494,38568:34588,38569:28234,38570:34001,38571:31252,38572:33032,38573:22937,38574:31885,38575:27665,38576:30496,38577:21209,38578:22818,38579:28961,38580:29279,38581:30683,38582:38695,38583:40289,38584:26891,38585:23167,38586:23064,38587:20901,38588:21517,38589:21629,38590:26126,38591:30431,38592:36855,38593:37528,38594:40180,38595:23018,38596:29277,38597:28357,38598:20813,38599:26825,38600:32191,38601:32236,38602:38754,38603:40634,38604:25720,38605:27169,38606:33538,38607:22916,38608:23391,38609:27611,38610:29467,38611:30450,38612:32178,38613:32791,38614:33945,38615:20786,38616:26408,38617:40665,38618:30446,38619:26466,38620:21247,38621:39173,38622:23588,38623:25147,38624:31870,38625:36016,38626:21839,38627:24758,38628:32011,38629:38272,38630:21249,38631:20063,38632:20918,38633:22812,38634:29242,38635:32822,38636:37326,38637:24357,38638:30690,38639:21380,38640:24441,38641:32004,38642:34220,38643:35379,38644:36493,38645:38742,38646:26611,38647:34222,38648:37971,38649:24841,38650:24840,38651:27833,38652:30290,38720:35565,38721:36664,38722:21807,38723:20305,38724:20778,38725:21191,38726:21451,38727:23461,38728:24189,38729:24736,38730:24962,38731:25558,38732:26377,38733:26586,38734:28263,38735:28044,38736:29494,38737:29495,38738:30001,38739:31056,38740:35029,38741:35480,38742:36938,38743:37009,38744:37109,38745:38596,38746:34701,38747:22805,38748:20104,38749:20313,38750:19982,38751:35465,38752:36671,38753:38928,38754:20653,38755:24188,38756:22934,38757:23481,38758:24248,38759:25562,38760:25594,38761:25793,38762:26332,38763:26954,38764:27096,38765:27915,38766:28342,38767:29076,38768:29992,38769:31407,38770:32650,38771:32768,38772:33865,38773:33993,38774:35201,38775:35617,38776:36362,38777:36965,38778:38525,38779:39178,38780:24958,38781:25233,38782:27442,38784:27779,38785:28020,38786:32716,38787:32764,38788:28096,38789:32645,38790:34746,38791:35064,38792:26469,38793:33713,38794:38972,38795:38647,38796:27931,38797:32097,38798:33853,38799:37226,38800:20081,38801:21365,38802:23888,38803:27396,38804:28651,38805:34253,38806:34349,38807:35239,38808:21033,38809:21519,38810:23653,38811:26446,38812:26792,38813:29702,38814:29827,38815:30178,38816:35023,38817:35041,38818:37324,38819:38626,38820:38520,38821:24459,38822:29575,38823:31435,38824:33870,38825:25504,38826:30053,38827:21129,38828:27969,38829:28316,38830:29705,38831:30041,38832:30827,38833:31890,38834:38534,38835:31452,38836:40845,38837:20406,38838:24942,38839:26053,38840:34396,38841:20102,38842:20142,38843:20698,38844:20001,38845:20940,38846:23534,38847:26009,38848:26753,38849:28092,38850:29471,38851:30274,38852:30637,38853:31260,38854:31975,38855:33391,38856:35538,38857:36988,38858:37327,38859:38517,38860:38936,38861:21147,38862:32209,38863:20523,38864:21400,38865:26519,38866:28107,38867:29136,38868:29747,38869:33256,38870:36650,38871:38563,38872:40023,38873:40607,38874:29792,38875:22593,38876:28057,38877:32047,38878:39006,38879:20196,38880:20278,38881:20363,38882:20919,38883:21169,38884:23994,38885:24604,38886:29618,38887:31036,38888:33491,38889:37428,38890:38583,38891:38646,38892:38666,38893:40599,38894:40802,38895:26278,38896:27508,38897:21015,38898:21155,38899:28872,38900:35010,38901:24265,38902:24651,38903:24976,38904:28451,38905:29001,38906:31806,38907:32244,38908:32879,38976:34030,38977:36899,38978:37676,38979:21570,38980:39791,38981:27347,38982:28809,38983:36034,38984:36335,38985:38706,38986:21172,38987:23105,38988:24266,38989:24324,38990:26391,38991:27004,38992:27028,38993:28010,38994:28431,38995:29282,38996:29436,38997:31725,38998:32769,38999:32894,39e3:34635,39001:37070,39002:20845,39003:40595,39004:31108,39005:32907,39006:37682,39007:35542,39008:20525,39009:21644,39010:35441,39011:27498,39012:36036,39013:33031,39014:24785,39015:26528,39016:40434,39017:20121,39018:20120,39019:39952,39020:35435,39021:34241,39022:34152,39023:26880,39024:28286,39025:30871,39026:33109,39071:24332,39072:19984,39073:19989,39074:20010,39075:20017,39076:20022,39077:20028,39078:20031,39079:20034,39080:20054,39081:20056,39082:20098,39083:20101,39084:35947,39085:20106,39086:33298,39087:24333,39088:20110,39089:20126,39090:20127,39091:20128,39092:20130,39093:20144,39094:20147,39095:20150,39096:20174,39097:20173,39098:20164,39099:20166,39100:20162,39101:20183,39102:20190,39103:20205,39104:20191,39105:20215,39106:20233,39107:20314,39108:20272,39109:20315,39110:20317,39111:20311,39112:20295,39113:20342,39114:20360,39115:20367,39116:20376,39117:20347,39118:20329,39119:20336,39120:20369,39121:20335,39122:20358,39123:20374,39124:20760,39125:20436,39126:20447,39127:20430,39128:20440,39129:20443,39130:20433,39131:20442,39132:20432,39133:20452,39134:20453,39135:20506,39136:20520,39137:20500,39138:20522,39139:20517,39140:20485,39141:20252,39142:20470,39143:20513,39144:20521,39145:20524,39146:20478,39147:20463,39148:20497,39149:20486,39150:20547,39151:20551,39152:26371,39153:20565,39154:20560,39155:20552,39156:20570,39157:20566,39158:20588,39159:20600,39160:20608,39161:20634,39162:20613,39163:20660,39164:20658,39232:20681,39233:20682,39234:20659,39235:20674,39236:20694,39237:20702,39238:20709,39239:20717,39240:20707,39241:20718,39242:20729,39243:20725,39244:20745,39245:20737,39246:20738,39247:20758,39248:20757,39249:20756,39250:20762,39251:20769,39252:20794,39253:20791,39254:20796,39255:20795,39256:20799,39257:20800,39258:20818,39259:20812,39260:20820,39261:20834,39262:31480,39263:20841,39264:20842,39265:20846,39266:20864,39267:20866,39268:22232,39269:20876,39270:20873,39271:20879,39272:20881,39273:20883,39274:20885,39275:20886,39276:20900,39277:20902,39278:20898,39279:20905,39280:20906,39281:20907,39282:20915,39283:20913,39284:20914,39285:20912,39286:20917,39287:20925,39288:20933,39289:20937,39290:20955,39291:20960,39292:34389,39293:20969,39294:20973,39296:20976,39297:20981,39298:20990,39299:20996,39300:21003,39301:21012,39302:21006,39303:21031,39304:21034,39305:21038,39306:21043,39307:21049,39308:21071,39309:21060,39310:21067,39311:21068,39312:21086,39313:21076,39314:21098,39315:21108,39316:21097,39317:21107,39318:21119,39319:21117,39320:21133,39321:21140,39322:21138,39323:21105,39324:21128,39325:21137,39326:36776,39327:36775,39328:21164,39329:21165,39330:21180,39331:21173,39332:21185,39333:21197,39334:21207,39335:21214,39336:21219,39337:21222,39338:39149,39339:21216,39340:21235,39341:21237,39342:21240,39343:21241,39344:21254,39345:21256,39346:30008,39347:21261,39348:21264,39349:21263,39350:21269,39351:21274,39352:21283,39353:21295,39354:21297,39355:21299,39356:21304,39357:21312,39358:21318,39359:21317,39360:19991,39361:21321,39362:21325,39363:20950,39364:21342,39365:21353,39366:21358,39367:22808,39368:21371,39369:21367,39370:21378,39371:21398,39372:21408,39373:21414,39374:21413,39375:21422,39376:21424,39377:21430,39378:21443,39379:31762,39380:38617,39381:21471,39382:26364,39383:29166,39384:21486,39385:21480,39386:21485,39387:21498,39388:21505,39389:21565,39390:21568,39391:21548,39392:21549,39393:21564,39394:21550,39395:21558,39396:21545,39397:21533,39398:21582,39399:21647,39400:21621,39401:21646,39402:21599,39403:21617,39404:21623,39405:21616,39406:21650,39407:21627,39408:21632,39409:21622,39410:21636,39411:21648,39412:21638,39413:21703,39414:21666,39415:21688,39416:21669,39417:21676,39418:21700,39419:21704,39420:21672,39488:21675,39489:21698,39490:21668,39491:21694,39492:21692,39493:21720,39494:21733,39495:21734,39496:21775,39497:21780,39498:21757,39499:21742,39500:21741,39501:21754,39502:21730,39503:21817,39504:21824,39505:21859,39506:21836,39507:21806,39508:21852,39509:21829,39510:21846,39511:21847,39512:21816,39513:21811,39514:21853,39515:21913,39516:21888,39517:21679,39518:21898,39519:21919,39520:21883,39521:21886,39522:21912,39523:21918,39524:21934,39525:21884,39526:21891,39527:21929,39528:21895,39529:21928,39530:21978,39531:21957,39532:21983,39533:21956,39534:21980,39535:21988,39536:21972,39537:22036,39538:22007,39539:22038,39540:22014,39541:22013,39542:22043,39543:22009,39544:22094,39545:22096,39546:29151,39547:22068,39548:22070,39549:22066,39550:22072,39552:22123,39553:22116,39554:22063,39555:22124,39556:22122,39557:22150,39558:22144,39559:22154,39560:22176,39561:22164,39562:22159,39563:22181,39564:22190,39565:22198,39566:22196,39567:22210,39568:22204,39569:22209,39570:22211,39571:22208,39572:22216,39573:22222,39574:22225,39575:22227,39576:22231,39577:22254,39578:22265,39579:22272,39580:22271,39581:22276,39582:22281,39583:22280,39584:22283,39585:22285,39586:22291,39587:22296,39588:22294,39589:21959,39590:22300,39591:22310,39592:22327,39593:22328,39594:22350,39595:22331,39596:22336,39597:22351,39598:22377,39599:22464,39600:22408,39601:22369,39602:22399,39603:22409,39604:22419,39605:22432,39606:22451,39607:22436,39608:22442,39609:22448,39610:22467,39611:22470,39612:22484,39613:22482,39614:22483,39615:22538,39616:22486,39617:22499,39618:22539,39619:22553,39620:22557,39621:22642,39622:22561,39623:22626,39624:22603,39625:22640,39626:27584,39627:22610,39628:22589,39629:22649,39630:22661,39631:22713,39632:22687,39633:22699,39634:22714,39635:22750,39636:22715,39637:22712,39638:22702,39639:22725,39640:22739,39641:22737,39642:22743,39643:22745,39644:22744,39645:22757,39646:22748,39647:22756,39648:22751,39649:22767,39650:22778,39651:22777,39652:22779,39653:22780,39654:22781,39655:22786,39656:22794,39657:22800,39658:22811,39659:26790,39660:22821,39661:22828,39662:22829,39663:22834,39664:22840,39665:22846,39666:31442,39667:22869,39668:22864,39669:22862,39670:22874,39671:22872,39672:22882,39673:22880,39674:22887,39675:22892,39676:22889,39744:22904,39745:22913,39746:22941,39747:20318,39748:20395,39749:22947,39750:22962,39751:22982,39752:23016,39753:23004,39754:22925,39755:23001,39756:23002,39757:23077,39758:23071,39759:23057,39760:23068,39761:23049,39762:23066,39763:23104,39764:23148,39765:23113,39766:23093,39767:23094,39768:23138,39769:23146,39770:23194,39771:23228,39772:23230,39773:23243,39774:23234,39775:23229,39776:23267,39777:23255,39778:23270,39779:23273,39780:23254,39781:23290,39782:23291,39783:23308,39784:23307,39785:23318,39786:23346,39787:23248,39788:23338,39789:23350,39790:23358,39791:23363,39792:23365,39793:23360,39794:23377,39795:23381,39796:23386,39797:23387,39798:23397,39799:23401,39800:23408,39801:23411,39802:23413,39803:23416,39804:25992,39805:23418,39806:23424,39808:23427,39809:23462,39810:23480,39811:23491,39812:23495,39813:23497,39814:23508,39815:23504,39816:23524,39817:23526,39818:23522,39819:23518,39820:23525,39821:23531,39822:23536,39823:23542,39824:23539,39825:23557,39826:23559,39827:23560,39828:23565,39829:23571,39830:23584,39831:23586,39832:23592,39833:23608,39834:23609,39835:23617,39836:23622,39837:23630,39838:23635,39839:23632,39840:23631,39841:23409,39842:23660,39843:23662,39844:20066,39845:23670,39846:23673,39847:23692,39848:23697,39849:23700,39850:22939,39851:23723,39852:23739,39853:23734,39854:23740,39855:23735,39856:23749,39857:23742,39858:23751,39859:23769,39860:23785,39861:23805,39862:23802,39863:23789,39864:23948,39865:23786,39866:23819,39867:23829,39868:23831,39869:23900,39870:23839,39871:23835,39872:23825,39873:23828,39874:23842,39875:23834,39876:23833,39877:23832,39878:23884,39879:23890,39880:23886,39881:23883,39882:23916,39883:23923,39884:23926,39885:23943,39886:23940,39887:23938,39888:23970,39889:23965,39890:23980,39891:23982,39892:23997,39893:23952,39894:23991,39895:23996,39896:24009,39897:24013,39898:24019,39899:24018,39900:24022,39901:24027,39902:24043,39903:24050,39904:24053,39905:24075,39906:24090,39907:24089,39908:24081,39909:24091,39910:24118,39911:24119,39912:24132,39913:24131,39914:24128,39915:24142,39916:24151,39917:24148,39918:24159,39919:24162,39920:24164,39921:24135,39922:24181,39923:24182,39924:24186,39925:40636,39926:24191,39927:24224,39928:24257,39929:24258,39930:24264,39931:24272,39932:24271,4e4:24278,40001:24291,40002:24285,40003:24282,40004:24283,40005:24290,40006:24289,40007:24296,40008:24297,40009:24300,40010:24305,40011:24307,40012:24304,40013:24308,40014:24312,40015:24318,40016:24323,40017:24329,40018:24413,40019:24412,40020:24331,40021:24337,40022:24342,40023:24361,40024:24365,40025:24376,40026:24385,40027:24392,40028:24396,40029:24398,40030:24367,40031:24401,40032:24406,40033:24407,40034:24409,40035:24417,40036:24429,40037:24435,40038:24439,40039:24451,40040:24450,40041:24447,40042:24458,40043:24456,40044:24465,40045:24455,40046:24478,40047:24473,40048:24472,40049:24480,40050:24488,40051:24493,40052:24508,40053:24534,40054:24571,40055:24548,40056:24568,40057:24561,40058:24541,40059:24755,40060:24575,40061:24609,40062:24672,40064:24601,40065:24592,40066:24617,40067:24590,40068:24625,40069:24603,40070:24597,40071:24619,40072:24614,40073:24591,40074:24634,40075:24666,40076:24641,40077:24682,40078:24695,40079:24671,40080:24650,40081:24646,40082:24653,40083:24675,40084:24643,40085:24676,40086:24642,40087:24684,40088:24683,40089:24665,40090:24705,40091:24717,40092:24807,40093:24707,40094:24730,40095:24708,40096:24731,40097:24726,40098:24727,40099:24722,40100:24743,40101:24715,40102:24801,40103:24760,40104:24800,40105:24787,40106:24756,40107:24560,40108:24765,40109:24774,40110:24757,40111:24792,40112:24909,40113:24853,40114:24838,40115:24822,40116:24823,40117:24832,40118:24820,40119:24826,40120:24835,40121:24865,40122:24827,40123:24817,40124:24845,40125:24846,40126:24903,40127:24894,40128:24872,40129:24871,40130:24906,40131:24895,40132:24892,40133:24876,40134:24884,40135:24893,40136:24898,40137:24900,40138:24947,40139:24951,40140:24920,40141:24921,40142:24922,40143:24939,40144:24948,40145:24943,40146:24933,40147:24945,40148:24927,40149:24925,40150:24915,40151:24949,40152:24985,40153:24982,40154:24967,40155:25004,40156:24980,40157:24986,40158:24970,40159:24977,40160:25003,40161:25006,40162:25036,40163:25034,40164:25033,40165:25079,40166:25032,40167:25027,40168:25030,40169:25018,40170:25035,40171:32633,40172:25037,40173:25062,40174:25059,40175:25078,40176:25082,40177:25076,40178:25087,40179:25085,40180:25084,40181:25086,40182:25088,40183:25096,40184:25097,40185:25101,40186:25100,40187:25108,40188:25115,40256:25118,40257:25121,40258:25130,40259:25134,40260:25136,40261:25138,40262:25139,40263:25153,40264:25166,40265:25182,40266:25187,40267:25179,40268:25184,40269:25192,40270:25212,40271:25218,40272:25225,40273:25214,40274:25234,40275:25235,40276:25238,40277:25300,40278:25219,40279:25236,40280:25303,40281:25297,40282:25275,40283:25295,40284:25343,40285:25286,40286:25812,40287:25288,40288:25308,40289:25292,40290:25290,40291:25282,40292:25287,40293:25243,40294:25289,40295:25356,40296:25326,40297:25329,40298:25383,40299:25346,40300:25352,40301:25327,40302:25333,40303:25424,40304:25406,40305:25421,40306:25628,40307:25423,40308:25494,40309:25486,40310:25472,40311:25515,40312:25462,40313:25507,40314:25487,40315:25481,40316:25503,40317:25525,40318:25451,40320:25449,40321:25534,40322:25577,40323:25536,40324:25542,40325:25571,40326:25545,40327:25554,40328:25590,40329:25540,40330:25622,40331:25652,40332:25606,40333:25619,40334:25638,40335:25654,40336:25885,40337:25623,40338:25640,40339:25615,40340:25703,40341:25711,40342:25718,40343:25678,40344:25898,40345:25749,40346:25747,40347:25765,40348:25769,40349:25736,40350:25788,40351:25818,40352:25810,40353:25797,40354:25799,40355:25787,40356:25816,40357:25794,40358:25841,40359:25831,40360:33289,40361:25824,40362:25825,40363:25260,40364:25827,40365:25839,40366:25900,40367:25846,40368:25844,40369:25842,40370:25850,40371:25856,40372:25853,40373:25880,40374:25884,40375:25861,40376:25892,40377:25891,40378:25899,40379:25908,40380:25909,40381:25911,40382:25910,40383:25912,40384:30027,40385:25928,40386:25942,40387:25941,40388:25933,40389:25944,40390:25950,40391:25949,40392:25970,40393:25976,40394:25986,40395:25987,40396:35722,40397:26011,40398:26015,40399:26027,40400:26039,40401:26051,40402:26054,40403:26049,40404:26052,40405:26060,40406:26066,40407:26075,40408:26073,40409:26080,40410:26081,40411:26097,40412:26482,40413:26122,40414:26115,40415:26107,40416:26483,40417:26165,40418:26166,40419:26164,40420:26140,40421:26191,40422:26180,40423:26185,40424:26177,40425:26206,40426:26205,40427:26212,40428:26215,40429:26216,40430:26207,40431:26210,40432:26224,40433:26243,40434:26248,40435:26254,40436:26249,40437:26244,40438:26264,40439:26269,40440:26305,40441:26297,40442:26313,40443:26302,40444:26300,40512:26308,40513:26296,40514:26326,40515:26330,40516:26336,40517:26175,40518:26342,40519:26345,40520:26352,40521:26357,40522:26359,40523:26383,40524:26390,40525:26398,40526:26406,40527:26407,40528:38712,40529:26414,40530:26431,40531:26422,40532:26433,40533:26424,40534:26423,40535:26438,40536:26462,40537:26464,40538:26457,40539:26467,40540:26468,40541:26505,40542:26480,40543:26537,40544:26492,40545:26474,40546:26508,40547:26507,40548:26534,40549:26529,40550:26501,40551:26551,40552:26607,40553:26548,40554:26604,40555:26547,40556:26601,40557:26552,40558:26596,40559:26590,40560:26589,40561:26594,40562:26606,40563:26553,40564:26574,40565:26566,40566:26599,40567:27292,40568:26654,40569:26694,40570:26665,40571:26688,40572:26701,40573:26674,40574:26702,40576:26803,40577:26667,40578:26713,40579:26723,40580:26743,40581:26751,40582:26783,40583:26767,40584:26797,40585:26772,40586:26781,40587:26779,40588:26755,40589:27310,40590:26809,40591:26740,40592:26805,40593:26784,40594:26810,40595:26895,40596:26765,40597:26750,40598:26881,40599:26826,40600:26888,40601:26840,40602:26914,40603:26918,40604:26849,40605:26892,40606:26829,40607:26836,40608:26855,40609:26837,40610:26934,40611:26898,40612:26884,40613:26839,40614:26851,40615:26917,40616:26873,40617:26848,40618:26863,40619:26920,40620:26922,40621:26906,40622:26915,40623:26913,40624:26822,40625:27001,40626:26999,40627:26972,40628:27e3,40629:26987,40630:26964,40631:27006,40632:26990,40633:26937,40634:26996,40635:26941,40636:26969,40637:26928,40638:26977,40639:26974,40640:26973,40641:27009,40642:26986,40643:27058,40644:27054,40645:27088,40646:27071,40647:27073,40648:27091,40649:27070,40650:27086,40651:23528,40652:27082,40653:27101,40654:27067,40655:27075,40656:27047,40657:27182,40658:27025,40659:27040,40660:27036,40661:27029,40662:27060,40663:27102,40664:27112,40665:27138,40666:27163,40667:27135,40668:27402,40669:27129,40670:27122,40671:27111,40672:27141,40673:27057,40674:27166,40675:27117,40676:27156,40677:27115,40678:27146,40679:27154,40680:27329,40681:27171,40682:27155,40683:27204,40684:27148,40685:27250,40686:27190,40687:27256,40688:27207,40689:27234,40690:27225,40691:27238,40692:27208,40693:27192,40694:27170,40695:27280,40696:27277,40697:27296,40698:27268,40699:27298,40700:27299,40768:27287,40769:34327,40770:27323,40771:27331,40772:27330,40773:27320,40774:27315,40775:27308,40776:27358,40777:27345,40778:27359,40779:27306,40780:27354,40781:27370,40782:27387,40783:27397,40784:34326,40785:27386,40786:27410,40787:27414,40788:39729,40789:27423,40790:27448,40791:27447,40792:30428,40793:27449,40794:39150,40795:27463,40796:27459,40797:27465,40798:27472,40799:27481,40800:27476,40801:27483,40802:27487,40803:27489,40804:27512,40805:27513,40806:27519,40807:27520,40808:27524,40809:27523,40810:27533,40811:27544,40812:27541,40813:27550,40814:27556,40815:27562,40816:27563,40817:27567,40818:27570,40819:27569,40820:27571,40821:27575,40822:27580,40823:27590,40824:27595,40825:27603,40826:27615,40827:27628,40828:27627,40829:27635,40830:27631,40832:40638,40833:27656,40834:27667,40835:27668,40836:27675,40837:27684,40838:27683,40839:27742,40840:27733,40841:27746,40842:27754,40843:27778,40844:27789,40845:27802,40846:27777,40847:27803,40848:27774,40849:27752,40850:27763,40851:27794,40852:27792,40853:27844,40854:27889,40855:27859,40856:27837,40857:27863,40858:27845,40859:27869,40860:27822,40861:27825,40862:27838,40863:27834,40864:27867,40865:27887,40866:27865,40867:27882,40868:27935,40869:34893,40870:27958,40871:27947,40872:27965,40873:27960,40874:27929,40875:27957,40876:27955,40877:27922,40878:27916,40879:28003,40880:28051,40881:28004,40882:27994,40883:28025,40884:27993,40885:28046,40886:28053,40887:28644,40888:28037,40889:28153,40890:28181,40891:28170,40892:28085,40893:28103,40894:28134,40895:28088,40896:28102,40897:28140,40898:28126,40899:28108,40900:28136,40901:28114,40902:28101,40903:28154,40904:28121,40905:28132,40906:28117,40907:28138,40908:28142,40909:28205,40910:28270,40911:28206,40912:28185,40913:28274,40914:28255,40915:28222,40916:28195,40917:28267,40918:28203,40919:28278,40920:28237,40921:28191,40922:28227,40923:28218,40924:28238,40925:28196,40926:28415,40927:28189,40928:28216,40929:28290,40930:28330,40931:28312,40932:28361,40933:28343,40934:28371,40935:28349,40936:28335,40937:28356,40938:28338,40939:28372,40940:28373,40941:28303,40942:28325,40943:28354,40944:28319,40945:28481,40946:28433,40947:28748,40948:28396,40949:28408,40950:28414,40951:28479,40952:28402,40953:28465,40954:28399,40955:28466,40956:28364,161:65377,162:65378,163:65379,164:65380,165:65381,166:65382,167:65383,168:65384,169:65385,170:65386,171:65387,172:65388,173:65389,174:65390,175:65391,176:65392,177:65393,178:65394,179:65395,180:65396,181:65397,182:65398,183:65399,184:65400,185:65401,186:65402,187:65403,188:65404,189:65405,190:65406,191:65407,192:65408,193:65409,194:65410,195:65411,196:65412,197:65413,198:65414,199:65415,200:65416,201:65417,202:65418,203:65419,204:65420,205:65421,206:65422,207:65423,208:65424,209:65425,210:65426,211:65427,212:65428,213:65429,214:65430,215:65431,216:65432,217:65433,218:65434,219:65435,220:65436,221:65437,222:65438,223:65439,57408:28478,57409:28435,57410:28407,57411:28550,57412:28538,57413:28536,57414:28545,57415:28544,57416:28527,57417:28507,57418:28659,57419:28525,57420:28546,57421:28540,57422:28504,57423:28558,57424:28561,57425:28610,57426:28518,57427:28595,57428:28579,57429:28577,57430:28580,57431:28601,57432:28614,57433:28586,57434:28639,57435:28629,57436:28652,57437:28628,57438:28632,57439:28657,57440:28654,57441:28635,57442:28681,57443:28683,57444:28666,57445:28689,57446:28673,57447:28687,57448:28670,57449:28699,57450:28698,57451:28532,57452:28701,57453:28696,57454:28703,57455:28720,57456:28734,57457:28722,57458:28753,57459:28771,57460:28825,57461:28818,57462:28847,57463:28913,57464:28844,57465:28856,57466:28851,57467:28846,57468:28895,57469:28875,57470:28893,57472:28889,57473:28937,57474:28925,57475:28956,57476:28953,57477:29029,57478:29013,57479:29064,57480:29030,57481:29026,57482:29004,57483:29014,57484:29036,57485:29071,57486:29179,57487:29060,57488:29077,57489:29096,57490:29100,57491:29143,57492:29113,57493:29118,57494:29138,57495:29129,57496:29140,57497:29134,57498:29152,57499:29164,57500:29159,57501:29173,57502:29180,57503:29177,57504:29183,57505:29197,57506:29200,57507:29211,57508:29224,57509:29229,57510:29228,57511:29232,57512:29234,57513:29243,57514:29244,57515:29247,57516:29248,57517:29254,57518:29259,57519:29272,57520:29300,57521:29310,57522:29314,57523:29313,57524:29319,57525:29330,57526:29334,57527:29346,57528:29351,57529:29369,57530:29362,57531:29379,57532:29382,57533:29380,57534:29390,57535:29394,57536:29410,57537:29408,57538:29409,57539:29433,57540:29431,57541:20495,57542:29463,57543:29450,57544:29468,57545:29462,57546:29469,57547:29492,57548:29487,57549:29481,57550:29477,57551:29502,57552:29518,57553:29519,57554:40664,57555:29527,57556:29546,57557:29544,57558:29552,57559:29560,57560:29557,57561:29563,57562:29562,57563:29640,57564:29619,57565:29646,57566:29627,57567:29632,57568:29669,57569:29678,57570:29662,57571:29858,57572:29701,57573:29807,57574:29733,57575:29688,57576:29746,57577:29754,57578:29781,57579:29759,57580:29791,57581:29785,57582:29761,57583:29788,57584:29801,57585:29808,57586:29795,57587:29802,57588:29814,57589:29822,57590:29835,57591:29854,57592:29863,57593:29898,57594:29903,57595:29908,57596:29681,57664:29920,57665:29923,57666:29927,57667:29929,57668:29934,57669:29938,57670:29936,57671:29937,57672:29944,57673:29943,57674:29956,57675:29955,57676:29957,57677:29964,57678:29966,57679:29965,57680:29973,57681:29971,57682:29982,57683:29990,57684:29996,57685:30012,57686:30020,57687:30029,57688:30026,57689:30025,57690:30043,57691:30022,57692:30042,57693:30057,57694:30052,57695:30055,57696:30059,57697:30061,57698:30072,57699:30070,57700:30086,57701:30087,57702:30068,57703:30090,57704:30089,57705:30082,57706:30100,57707:30106,57708:30109,57709:30117,57710:30115,57711:30146,57712:30131,57713:30147,57714:30133,57715:30141,57716:30136,57717:30140,57718:30129,57719:30157,57720:30154,57721:30162,57722:30169,57723:30179,57724:30174,57725:30206,57726:30207,57728:30204,57729:30209,57730:30192,57731:30202,57732:30194,57733:30195,57734:30219,57735:30221,57736:30217,57737:30239,57738:30247,57739:30240,57740:30241,57741:30242,57742:30244,57743:30260,57744:30256,57745:30267,57746:30279,57747:30280,57748:30278,57749:30300,57750:30296,57751:30305,57752:30306,57753:30312,57754:30313,57755:30314,57756:30311,57757:30316,57758:30320,57759:30322,57760:30326,57761:30328,57762:30332,57763:30336,57764:30339,57765:30344,57766:30347,57767:30350,57768:30358,57769:30355,57770:30361,57771:30362,57772:30384,57773:30388,57774:30392,57775:30393,57776:30394,57777:30402,57778:30413,57779:30422,57780:30418,57781:30430,57782:30433,57783:30437,57784:30439,57785:30442,57786:34351,57787:30459,57788:30472,57789:30471,57790:30468,57791:30505,57792:30500,57793:30494,57794:30501,57795:30502,57796:30491,57797:30519,57798:30520,57799:30535,57800:30554,57801:30568,57802:30571,57803:30555,57804:30565,57805:30591,57806:30590,57807:30585,57808:30606,57809:30603,57810:30609,57811:30624,57812:30622,57813:30640,57814:30646,57815:30649,57816:30655,57817:30652,57818:30653,57819:30651,57820:30663,57821:30669,57822:30679,57823:30682,57824:30684,57825:30691,57826:30702,57827:30716,57828:30732,57829:30738,57830:31014,57831:30752,57832:31018,57833:30789,57834:30862,57835:30836,57836:30854,57837:30844,57838:30874,57839:30860,57840:30883,57841:30901,57842:30890,57843:30895,57844:30929,57845:30918,57846:30923,57847:30932,57848:30910,57849:30908,57850:30917,57851:30922,57852:30956,57920:30951,57921:30938,57922:30973,57923:30964,57924:30983,57925:30994,57926:30993,57927:31001,57928:31020,57929:31019,57930:31040,57931:31072,57932:31063,57933:31071,57934:31066,57935:31061,57936:31059,57937:31098,57938:31103,57939:31114,57940:31133,57941:31143,57942:40779,57943:31146,57944:31150,57945:31155,57946:31161,57947:31162,57948:31177,57949:31189,57950:31207,57951:31212,57952:31201,57953:31203,57954:31240,57955:31245,57956:31256,57957:31257,57958:31264,57959:31263,57960:31104,57961:31281,57962:31291,57963:31294,57964:31287,57965:31299,57966:31319,57967:31305,57968:31329,57969:31330,57970:31337,57971:40861,57972:31344,57973:31353,57974:31357,57975:31368,57976:31383,57977:31381,57978:31384,57979:31382,57980:31401,57981:31432,57982:31408,57984:31414,57985:31429,57986:31428,57987:31423,57988:36995,57989:31431,57990:31434,57991:31437,57992:31439,57993:31445,57994:31443,57995:31449,57996:31450,57997:31453,57998:31457,57999:31458,58e3:31462,58001:31469,58002:31472,58003:31490,58004:31503,58005:31498,58006:31494,58007:31539,58008:31512,58009:31513,58010:31518,58011:31541,58012:31528,58013:31542,58014:31568,58015:31610,58016:31492,58017:31565,58018:31499,58019:31564,58020:31557,58021:31605,58022:31589,58023:31604,58024:31591,58025:31600,58026:31601,58027:31596,58028:31598,58029:31645,58030:31640,58031:31647,58032:31629,58033:31644,58034:31642,58035:31627,58036:31634,58037:31631,58038:31581,58039:31641,58040:31691,58041:31681,58042:31692,58043:31695,58044:31668,58045:31686,58046:31709,58047:31721,58048:31761,58049:31764,58050:31718,58051:31717,58052:31840,58053:31744,58054:31751,58055:31763,58056:31731,58057:31735,58058:31767,58059:31757,58060:31734,58061:31779,58062:31783,58063:31786,58064:31775,58065:31799,58066:31787,58067:31805,58068:31820,58069:31811,58070:31828,58071:31823,58072:31808,58073:31824,58074:31832,58075:31839,58076:31844,58077:31830,58078:31845,58079:31852,58080:31861,58081:31875,58082:31888,58083:31908,58084:31917,58085:31906,58086:31915,58087:31905,58088:31912,58089:31923,58090:31922,58091:31921,58092:31918,58093:31929,58094:31933,58095:31936,58096:31941,58097:31938,58098:31960,58099:31954,58100:31964,58101:31970,58102:39739,58103:31983,58104:31986,58105:31988,58106:31990,58107:31994,58108:32006,58176:32002,58177:32028,58178:32021,58179:32010,58180:32069,58181:32075,58182:32046,58183:32050,58184:32063,58185:32053,58186:32070,58187:32115,58188:32086,58189:32078,58190:32114,58191:32104,58192:32110,58193:32079,58194:32099,58195:32147,58196:32137,58197:32091,58198:32143,58199:32125,58200:32155,58201:32186,58202:32174,58203:32163,58204:32181,58205:32199,58206:32189,58207:32171,58208:32317,58209:32162,58210:32175,58211:32220,58212:32184,58213:32159,58214:32176,58215:32216,58216:32221,58217:32228,58218:32222,58219:32251,58220:32242,58221:32225,58222:32261,58223:32266,58224:32291,58225:32289,58226:32274,58227:32305,58228:32287,58229:32265,58230:32267,58231:32290,58232:32326,58233:32358,58234:32315,58235:32309,58236:32313,58237:32323,58238:32311,58240:32306,58241:32314,58242:32359,58243:32349,58244:32342,58245:32350,58246:32345,58247:32346,58248:32377,58249:32362,58250:32361,58251:32380,58252:32379,58253:32387,58254:32213,58255:32381,58256:36782,58257:32383,58258:32392,58259:32393,58260:32396,58261:32402,58262:32400,58263:32403,58264:32404,58265:32406,58266:32398,58267:32411,58268:32412,58269:32568,58270:32570,58271:32581,58272:32588,58273:32589,58274:32590,58275:32592,58276:32593,58277:32597,58278:32596,58279:32600,58280:32607,58281:32608,58282:32616,58283:32617,58284:32615,58285:32632,58286:32642,58287:32646,58288:32643,58289:32648,58290:32647,58291:32652,58292:32660,58293:32670,58294:32669,58295:32666,58296:32675,58297:32687,58298:32690,58299:32697,58300:32686,58301:32694,58302:32696,58303:35697,58304:32709,58305:32710,58306:32714,58307:32725,58308:32724,58309:32737,58310:32742,58311:32745,58312:32755,58313:32761,58314:39132,58315:32774,58316:32772,58317:32779,58318:32786,58319:32792,58320:32793,58321:32796,58322:32801,58323:32808,58324:32831,58325:32827,58326:32842,58327:32838,58328:32850,58329:32856,58330:32858,58331:32863,58332:32866,58333:32872,58334:32883,58335:32882,58336:32880,58337:32886,58338:32889,58339:32893,58340:32895,58341:32900,58342:32902,58343:32901,58344:32923,58345:32915,58346:32922,58347:32941,58348:20880,58349:32940,58350:32987,58351:32997,58352:32985,58353:32989,58354:32964,58355:32986,58356:32982,58357:33033,58358:33007,58359:33009,58360:33051,58361:33065,58362:33059,58363:33071,58364:33099,58432:38539,58433:33094,58434:33086,58435:33107,58436:33105,58437:33020,58438:33137,58439:33134,58440:33125,58441:33126,58442:33140,58443:33155,58444:33160,58445:33162,58446:33152,58447:33154,58448:33184,58449:33173,58450:33188,58451:33187,58452:33119,58453:33171,58454:33193,58455:33200,58456:33205,58457:33214,58458:33208,58459:33213,58460:33216,58461:33218,58462:33210,58463:33225,58464:33229,58465:33233,58466:33241,58467:33240,58468:33224,58469:33242,58470:33247,58471:33248,58472:33255,58473:33274,58474:33275,58475:33278,58476:33281,58477:33282,58478:33285,58479:33287,58480:33290,58481:33293,58482:33296,58483:33302,58484:33321,58485:33323,58486:33336,58487:33331,58488:33344,58489:33369,58490:33368,58491:33373,58492:33370,58493:33375,58494:33380,58496:33378,58497:33384,58498:33386,58499:33387,58500:33326,58501:33393,58502:33399,58503:33400,58504:33406,58505:33421,58506:33426,58507:33451,58508:33439,58509:33467,58510:33452,58511:33505,58512:33507,58513:33503,58514:33490,58515:33524,58516:33523,58517:33530,58518:33683,58519:33539,58520:33531,58521:33529,58522:33502,58523:33542,58524:33500,58525:33545,58526:33497,58527:33589,58528:33588,58529:33558,58530:33586,58531:33585,58532:33600,58533:33593,58534:33616,58535:33605,58536:33583,58537:33579,58538:33559,58539:33560,58540:33669,58541:33690,58542:33706,58543:33695,58544:33698,58545:33686,58546:33571,58547:33678,58548:33671,58549:33674,58550:33660,58551:33717,58552:33651,58553:33653,58554:33696,58555:33673,58556:33704,58557:33780,58558:33811,58559:33771,58560:33742,58561:33789,58562:33795,58563:33752,58564:33803,58565:33729,58566:33783,58567:33799,58568:33760,58569:33778,58570:33805,58571:33826,58572:33824,58573:33725,58574:33848,58575:34054,58576:33787,58577:33901,58578:33834,58579:33852,58580:34138,58581:33924,58582:33911,58583:33899,58584:33965,58585:33902,58586:33922,58587:33897,58588:33862,58589:33836,58590:33903,58591:33913,58592:33845,58593:33994,58594:33890,58595:33977,58596:33983,58597:33951,58598:34009,58599:33997,58600:33979,58601:34010,58602:34e3,58603:33985,58604:33990,58605:34006,58606:33953,58607:34081,58608:34047,58609:34036,58610:34071,58611:34072,58612:34092,58613:34079,58614:34069,58615:34068,58616:34044,58617:34112,58618:34147,58619:34136,58620:34120,58688:34113,58689:34306,58690:34123,58691:34133,58692:34176,58693:34212,58694:34184,58695:34193,58696:34186,58697:34216,58698:34157,58699:34196,58700:34203,58701:34282,58702:34183,58703:34204,58704:34167,58705:34174,58706:34192,58707:34249,58708:34234,58709:34255,58710:34233,58711:34256,58712:34261,58713:34269,58714:34277,58715:34268,58716:34297,58717:34314,58718:34323,58719:34315,58720:34302,58721:34298,58722:34310,58723:34338,58724:34330,58725:34352,58726:34367,58727:34381,58728:20053,58729:34388,58730:34399,58731:34407,58732:34417,58733:34451,58734:34467,58735:34473,58736:34474,58737:34443,58738:34444,58739:34486,58740:34479,58741:34500,58742:34502,58743:34480,58744:34505,58745:34851,58746:34475,58747:34516,58748:34526,58749:34537,58750:34540,58752:34527,58753:34523,58754:34543,58755:34578,58756:34566,58757:34568,58758:34560,58759:34563,58760:34555,58761:34577,58762:34569,58763:34573,58764:34553,58765:34570,58766:34612,58767:34623,58768:34615,58769:34619,58770:34597,58771:34601,58772:34586,58773:34656,58774:34655,58775:34680,58776:34636,58777:34638,58778:34676,58779:34647,58780:34664,58781:34670,58782:34649,58783:34643,58784:34659,58785:34666,58786:34821,58787:34722,58788:34719,58789:34690,58790:34735,58791:34763,58792:34749,58793:34752,58794:34768,58795:38614,58796:34731,58797:34756,58798:34739,58799:34759,58800:34758,58801:34747,58802:34799,58803:34802,58804:34784,58805:34831,58806:34829,58807:34814,58808:34806,58809:34807,58810:34830,58811:34770,58812:34833,58813:34838,58814:34837,58815:34850,58816:34849,58817:34865,58818:34870,58819:34873,58820:34855,58821:34875,58822:34884,58823:34882,58824:34898,58825:34905,58826:34910,58827:34914,58828:34923,58829:34945,58830:34942,58831:34974,58832:34933,58833:34941,58834:34997,58835:34930,58836:34946,58837:34967,58838:34962,58839:34990,58840:34969,58841:34978,58842:34957,58843:34980,58844:34992,58845:35007,58846:34993,58847:35011,58848:35012,58849:35028,58850:35032,58851:35033,58852:35037,58853:35065,58854:35074,58855:35068,58856:35060,58857:35048,58858:35058,58859:35076,58860:35084,58861:35082,58862:35091,58863:35139,58864:35102,58865:35109,58866:35114,58867:35115,58868:35137,58869:35140,58870:35131,58871:35126,58872:35128,58873:35148,58874:35101,58875:35168,58876:35166,58944:35174,58945:35172,58946:35181,58947:35178,58948:35183,58949:35188,58950:35191,58951:35198,58952:35203,58953:35208,58954:35210,58955:35219,58956:35224,58957:35233,58958:35241,58959:35238,58960:35244,58961:35247,58962:35250,58963:35258,58964:35261,58965:35263,58966:35264,58967:35290,58968:35292,58969:35293,58970:35303,58971:35316,58972:35320,58973:35331,58974:35350,58975:35344,58976:35340,58977:35355,58978:35357,58979:35365,58980:35382,58981:35393,58982:35419,58983:35410,58984:35398,58985:35400,58986:35452,58987:35437,58988:35436,58989:35426,58990:35461,58991:35458,58992:35460,58993:35496,58994:35489,58995:35473,58996:35493,58997:35494,58998:35482,58999:35491,59e3:35524,59001:35533,59002:35522,59003:35546,59004:35563,59005:35571,59006:35559,59008:35556,59009:35569,59010:35604,59011:35552,59012:35554,59013:35575,59014:35550,59015:35547,59016:35596,59017:35591,59018:35610,59019:35553,59020:35606,59021:35600,59022:35607,59023:35616,59024:35635,59025:38827,59026:35622,59027:35627,59028:35646,59029:35624,59030:35649,59031:35660,59032:35663,59033:35662,59034:35657,59035:35670,59036:35675,59037:35674,59038:35691,59039:35679,59040:35692,59041:35695,59042:35700,59043:35709,59044:35712,59045:35724,59046:35726,59047:35730,59048:35731,59049:35734,59050:35737,59051:35738,59052:35898,59053:35905,59054:35903,59055:35912,59056:35916,59057:35918,59058:35920,59059:35925,59060:35938,59061:35948,59062:35960,59063:35962,59064:35970,59065:35977,59066:35973,59067:35978,59068:35981,59069:35982,59070:35988,59071:35964,59072:35992,59073:25117,59074:36013,59075:36010,59076:36029,59077:36018,59078:36019,59079:36014,59080:36022,59081:36040,59082:36033,59083:36068,59084:36067,59085:36058,59086:36093,59087:36090,59088:36091,59089:36100,59090:36101,59091:36106,59092:36103,59093:36111,59094:36109,59095:36112,59096:40782,59097:36115,59098:36045,59099:36116,59100:36118,59101:36199,59102:36205,59103:36209,59104:36211,59105:36225,59106:36249,59107:36290,59108:36286,59109:36282,59110:36303,59111:36314,59112:36310,59113:36300,59114:36315,59115:36299,59116:36330,59117:36331,59118:36319,59119:36323,59120:36348,59121:36360,59122:36361,59123:36351,59124:36381,59125:36382,59126:36368,59127:36383,59128:36418,59129:36405,59130:36400,59131:36404,59132:36426,59200:36423,59201:36425,59202:36428,59203:36432,59204:36424,59205:36441,59206:36452,59207:36448,59208:36394,59209:36451,59210:36437,59211:36470,59212:36466,59213:36476,59214:36481,59215:36487,59216:36485,59217:36484,59218:36491,59219:36490,59220:36499,59221:36497,59222:36500,59223:36505,59224:36522,59225:36513,59226:36524,59227:36528,59228:36550,59229:36529,59230:36542,59231:36549,59232:36552,59233:36555,59234:36571,59235:36579,59236:36604,59237:36603,59238:36587,59239:36606,59240:36618,59241:36613,59242:36629,59243:36626,59244:36633,59245:36627,59246:36636,59247:36639,59248:36635,59249:36620,59250:36646,59251:36659,59252:36667,59253:36665,59254:36677,59255:36674,59256:36670,59257:36684,59258:36681,59259:36678,59260:36686,59261:36695,59262:36700,59264:36706,59265:36707,59266:36708,59267:36764,59268:36767,59269:36771,59270:36781,59271:36783,59272:36791,59273:36826,59274:36837,59275:36834,59276:36842,59277:36847,59278:36999,59279:36852,59280:36869,59281:36857,59282:36858,59283:36881,59284:36885,59285:36897,59286:36877,59287:36894,59288:36886,59289:36875,59290:36903,59291:36918,59292:36917,59293:36921,59294:36856,59295:36943,59296:36944,59297:36945,59298:36946,59299:36878,59300:36937,59301:36926,59302:36950,59303:36952,59304:36958,59305:36968,59306:36975,59307:36982,59308:38568,59309:36978,59310:36994,59311:36989,59312:36993,59313:36992,59314:37002,59315:37001,59316:37007,59317:37032,59318:37039,59319:37041,59320:37045,59321:37090,59322:37092,59323:25160,59324:37083,59325:37122,59326:37138,59327:37145,59328:37170,59329:37168,59330:37194,59331:37206,59332:37208,59333:37219,59334:37221,59335:37225,59336:37235,59337:37234,59338:37259,59339:37257,59340:37250,59341:37282,59342:37291,59343:37295,59344:37290,59345:37301,59346:37300,59347:37306,59348:37312,59349:37313,59350:37321,59351:37323,59352:37328,59353:37334,59354:37343,59355:37345,59356:37339,59357:37372,59358:37365,59359:37366,59360:37406,59361:37375,59362:37396,59363:37420,59364:37397,59365:37393,59366:37470,59367:37463,59368:37445,59369:37449,59370:37476,59371:37448,59372:37525,59373:37439,59374:37451,59375:37456,59376:37532,59377:37526,59378:37523,59379:37531,59380:37466,59381:37583,59382:37561,59383:37559,59384:37609,59385:37647,59386:37626,59387:37700,59388:37678,59456:37657,59457:37666,59458:37658,59459:37667,59460:37690,59461:37685,59462:37691,59463:37724,59464:37728,59465:37756,59466:37742,59467:37718,59468:37808,59469:37804,59470:37805,59471:37780,59472:37817,59473:37846,59474:37847,59475:37864,59476:37861,59477:37848,59478:37827,59479:37853,59480:37840,59481:37832,59482:37860,59483:37914,59484:37908,59485:37907,59486:37891,59487:37895,59488:37904,59489:37942,59490:37931,59491:37941,59492:37921,59493:37946,59494:37953,59495:37970,59496:37956,59497:37979,59498:37984,59499:37986,59500:37982,59501:37994,59502:37417,59503:38e3,59504:38005,59505:38007,59506:38013,59507:37978,59508:38012,59509:38014,59510:38017,59511:38015,59512:38274,59513:38279,59514:38282,59515:38292,59516:38294,59517:38296,59518:38297,59520:38304,59521:38312,59522:38311,59523:38317,59524:38332,59525:38331,59526:38329,59527:38334,59528:38346,59529:28662,59530:38339,59531:38349,59532:38348,59533:38357,59534:38356,59535:38358,59536:38364,59537:38369,59538:38373,59539:38370,59540:38433,59541:38440,59542:38446,59543:38447,59544:38466,59545:38476,59546:38479,59547:38475,59548:38519,59549:38492,59550:38494,59551:38493,59552:38495,59553:38502,59554:38514,59555:38508,59556:38541,59557:38552,59558:38549,59559:38551,59560:38570,59561:38567,59562:38577,59563:38578,59564:38576,59565:38580,59566:38582,59567:38584,59568:38585,59569:38606,59570:38603,59571:38601,59572:38605,59573:35149,59574:38620,59575:38669,59576:38613,59577:38649,59578:38660,59579:38662,59580:38664,59581:38675,59582:38670,59583:38673,59584:38671,59585:38678,59586:38681,59587:38692,59588:38698,59589:38704,59590:38713,59591:38717,59592:38718,59593:38724,59594:38726,59595:38728,59596:38722,59597:38729,59598:38748,59599:38752,59600:38756,59601:38758,59602:38760,59603:21202,59604:38763,59605:38769,59606:38777,59607:38789,59608:38780,59609:38785,59610:38778,59611:38790,59612:38795,59613:38799,59614:38800,59615:38812,59616:38824,59617:38822,59618:38819,59619:38835,59620:38836,59621:38851,59622:38854,59623:38856,59624:38859,59625:38876,59626:38893,59627:40783,59628:38898,59629:31455,59630:38902,59631:38901,59632:38927,59633:38924,59634:38968,59635:38948,59636:38945,59637:38967,59638:38973,59639:38982,59640:38991,59641:38987,59642:39019,59643:39023,59644:39024,59712:39025,59713:39028,59714:39027,59715:39082,59716:39087,59717:39089,59718:39094,59719:39108,59720:39107,59721:39110,59722:39145,59723:39147,59724:39171,59725:39177,59726:39186,59727:39188,59728:39192,59729:39201,59730:39197,59731:39198,59732:39204,59733:39200,59734:39212,59735:39214,59736:39229,59737:39230,59738:39234,59739:39241,59740:39237,59741:39248,59742:39243,59743:39249,59744:39250,59745:39244,59746:39253,59747:39319,59748:39320,59749:39333,59750:39341,59751:39342,59752:39356,59753:39391,59754:39387,59755:39389,59756:39384,59757:39377,59758:39405,59759:39406,59760:39409,59761:39410,59762:39419,59763:39416,59764:39425,59765:39439,59766:39429,59767:39394,59768:39449,59769:39467,59770:39479,59771:39493,59772:39490,59773:39488,59774:39491,59776:39486,59777:39509,59778:39501,59779:39515,59780:39511,59781:39519,59782:39522,59783:39525,59784:39524,59785:39529,59786:39531,59787:39530,59788:39597,59789:39600,59790:39612,59791:39616,59792:39631,59793:39633,59794:39635,59795:39636,59796:39646,59797:39647,59798:39650,59799:39651,59800:39654,59801:39663,59802:39659,59803:39662,59804:39668,59805:39665,59806:39671,59807:39675,59808:39686,59809:39704,59810:39706,59811:39711,59812:39714,59813:39715,59814:39717,59815:39719,59816:39720,59817:39721,59818:39722,59819:39726,59820:39727,59821:39730,59822:39748,59823:39747,59824:39759,59825:39757,59826:39758,59827:39761,59828:39768,59829:39796,59830:39827,59831:39811,59832:39825,59833:39830,59834:39831,59835:39839,59836:39840,59837:39848,59838:39860,59839:39872,59840:39882,59841:39865,59842:39878,59843:39887,59844:39889,59845:39890,59846:39907,59847:39906,59848:39908,59849:39892,59850:39905,59851:39994,59852:39922,59853:39921,59854:39920,59855:39957,59856:39956,59857:39945,59858:39955,59859:39948,59860:39942,59861:39944,59862:39954,59863:39946,59864:39940,59865:39982,59866:39963,59867:39973,59868:39972,59869:39969,59870:39984,59871:40007,59872:39986,59873:40006,59874:39998,59875:40026,59876:40032,59877:40039,59878:40054,59879:40056,59880:40167,59881:40172,59882:40176,59883:40201,59884:40200,59885:40171,59886:40195,59887:40198,59888:40234,59889:40230,59890:40367,59891:40227,59892:40223,59893:40260,59894:40213,59895:40210,59896:40257,59897:40255,59898:40254,59899:40262,59900:40264,59968:40285,59969:40286,59970:40292,59971:40273,59972:40272,59973:40281,59974:40306,59975:40329,59976:40327,59977:40363,59978:40303,59979:40314,59980:40346,59981:40356,59982:40361,59983:40370,59984:40388,59985:40385,59986:40379,59987:40376,59988:40378,59989:40390,59990:40399,59991:40386,59992:40409,59993:40403,59994:40440,59995:40422,59996:40429,59997:40431,59998:40445,59999:40474,6e4:40475,60001:40478,60002:40565,60003:40569,60004:40573,60005:40577,60006:40584,60007:40587,60008:40588,60009:40594,60010:40597,60011:40593,60012:40605,60013:40613,60014:40617,60015:40632,60016:40618,60017:40621,60018:38753,60019:40652,60020:40654,60021:40655,60022:40656,60023:40660,60024:40668,60025:40670,60026:40669,60027:40672,60028:40677,60029:40680,60030:40687,60032:40692,60033:40694,60034:40695,60035:40697,60036:40699,60037:40700,60038:40701,60039:40711,60040:40712,60041:30391,60042:40725,60043:40737,60044:40748,60045:40766,60046:40778,60047:40786,60048:40788,60049:40803,60050:40799,60051:40800,60052:40801,60053:40806,60054:40807,60055:40812,60056:40810,60057:40823,60058:40818,60059:40822,60060:40853,60061:40860,60062:40864,60063:22575,60064:27079,60065:36953,60066:29796,60067:20956,60068:29081}},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(1),m=x(2);function f(l,h,u,b){var E;h.degree()<u.degree()&&(E=[u,h],h=E[0],u=E[1]);for(var B=h,j=u,v=l.zero,y=l.one;j.degree()>=b/2;){var d=B,i=v;if(B=j,v=y,B.isZero())return null;j=d;for(var C=l.zero,A=B.getCoefficient(B.degree()),w=l.inverse(A);j.degree()>=B.degree()&&!j.isZero();){var F=j.degree()-B.degree(),N=l.multiply(j.getCoefficient(j.degree()),w);C=C.addOrSubtract(l.buildMonomial(F,N)),j=j.addOrSubtract(B.multiplyByMonomial(F,N))}if(y=C.multiplyPoly(v).addOrSubtract(i),j.degree()>=B.degree())return null}var k=y.getCoefficient(0);if(k===0)return null;var P=l.inverse(k);return[y.multiply(P),j.multiply(P)]}function g(l,h){var u=h.degree();if(u===1)return[h.getCoefficient(1)];for(var b=new Array(u),E=0,B=1;B<l.size&&E<u;B++)h.evaluateAt(B)===0&&(b[E]=l.inverse(B),E++);return E!==u?null:b}function p(l,h,u){for(var b=u.length,E=new Array(b),B=0;B<b;B++){for(var j=l.inverse(u[B]),v=1,y=0;y<b;y++)B!==y&&(v=l.multiply(v,o.addOrSubtractGF(1,l.multiply(u[y],j))));E[B]=l.multiply(h.evaluateAt(j),l.inverse(v)),l.generatorBase!==0&&(E[B]=l.multiply(E[B],j))}return E}function c(l,h){var u=new Uint8ClampedArray(l.length);u.set(l);for(var b=new o.default(285,256,0),E=new m.default(b,u),B=new Uint8ClampedArray(h),j=!1,v=0;v<h;v++){var y=E.evaluateAt(b.exp(v+b.generatorBase));B[B.length-1-v]=y,y!==0&&(j=!0)}if(!j)return u;var d=new m.default(b,B),i=f(b,b.buildMonomial(h,1),d,h);if(i===null)return null;var C=g(b,i[0]);if(C==null)return null;for(var A=p(b,i[1],C),w=0;w<C.length;w++){var F=u.length-1-b.log(C[w]);if(F<0)return null;u[F]=o.addOrSubtractGF(u[F],A[w])}return u}r.decode=c},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0}),r.VERSIONS=[{infoBits:null,versionNumber:1,alignmentPatternCenters:[],errorCorrectionLevels:[{ecCodewordsPerBlock:7,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:13,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:13}]},{ecCodewordsPerBlock:17,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:2,alignmentPatternCenters:[6,18],errorCorrectionLevels:[{ecCodewordsPerBlock:10,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:34}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:28}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:16}]}]},{infoBits:null,versionNumber:3,alignmentPatternCenters:[6,22],errorCorrectionLevels:[{ecCodewordsPerBlock:15,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:55}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:13}]}]},{infoBits:null,versionNumber:4,alignmentPatternCenters:[6,26],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:80}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:32}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:9}]}]},{infoBits:null,versionNumber:5,alignmentPatternCenters:[6,30],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:43}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:11},{numBlocks:2,dataCodewordsPerBlock:12}]}]},{infoBits:null,versionNumber:6,alignmentPatternCenters:[6,34],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68}]},{ecCodewordsPerBlock:16,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:27}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:31892,versionNumber:7,alignmentPatternCenters:[6,22,38],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:78}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:31}]},{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:13},{numBlocks:1,dataCodewordsPerBlock:14}]}]},{infoBits:34236,versionNumber:8,alignmentPatternCenters:[6,24,42],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:97}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:38},{numBlocks:2,dataCodewordsPerBlock:39}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:18},{numBlocks:2,dataCodewordsPerBlock:19}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:14},{numBlocks:2,dataCodewordsPerBlock:15}]}]},{infoBits:39577,versionNumber:9,alignmentPatternCenters:[6,26,46],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:12},{numBlocks:4,dataCodewordsPerBlock:13}]}]},{infoBits:42195,versionNumber:10,alignmentPatternCenters:[6,28,50],errorCorrectionLevels:[{ecCodewordsPerBlock:18,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:68},{numBlocks:2,dataCodewordsPerBlock:69}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:43},{numBlocks:1,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:15},{numBlocks:2,dataCodewordsPerBlock:16}]}]},{infoBits:48118,versionNumber:11,alignmentPatternCenters:[6,30,54],errorCorrectionLevels:[{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:81}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:50},{numBlocks:4,dataCodewordsPerBlock:51}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:22},{numBlocks:4,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:12},{numBlocks:8,dataCodewordsPerBlock:13}]}]},{infoBits:51042,versionNumber:12,alignmentPatternCenters:[6,32,58],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:92},{numBlocks:2,dataCodewordsPerBlock:93}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:36},{numBlocks:2,dataCodewordsPerBlock:37}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:20},{numBlocks:6,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:14},{numBlocks:4,dataCodewordsPerBlock:15}]}]},{infoBits:55367,versionNumber:13,alignmentPatternCenters:[6,34,62],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:37},{numBlocks:1,dataCodewordsPerBlock:38}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:20},{numBlocks:4,dataCodewordsPerBlock:21}]},{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:11},{numBlocks:4,dataCodewordsPerBlock:12}]}]},{infoBits:58893,versionNumber:14,alignmentPatternCenters:[6,26,46,66],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:40},{numBlocks:5,dataCodewordsPerBlock:41}]},{ecCodewordsPerBlock:20,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:16},{numBlocks:5,dataCodewordsPerBlock:17}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:5,dataCodewordsPerBlock:13}]}]},{infoBits:63784,versionNumber:15,alignmentPatternCenters:[6,26,48,70],errorCorrectionLevels:[{ecCodewordsPerBlock:22,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:87},{numBlocks:1,dataCodewordsPerBlock:88}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:41},{numBlocks:5,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:12},{numBlocks:7,dataCodewordsPerBlock:13}]}]},{infoBits:68472,versionNumber:16,alignmentPatternCenters:[6,26,50,74],errorCorrectionLevels:[{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:98},{numBlocks:1,dataCodewordsPerBlock:99}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:19},{numBlocks:2,dataCodewordsPerBlock:20}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:70749,versionNumber:17,alignmentPatternCenters:[6,30,54,78],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:1,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:22},{numBlocks:15,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:17,dataCodewordsPerBlock:15}]}]},{infoBits:76311,versionNumber:18,alignmentPatternCenters:[6,30,56,82],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:120},{numBlocks:1,dataCodewordsPerBlock:121}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:43},{numBlocks:4,dataCodewordsPerBlock:44}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:1,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:14},{numBlocks:19,dataCodewordsPerBlock:15}]}]},{infoBits:79154,versionNumber:19,alignmentPatternCenters:[6,30,58,86],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:113},{numBlocks:4,dataCodewordsPerBlock:114}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:44},{numBlocks:11,dataCodewordsPerBlock:45}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:21},{numBlocks:4,dataCodewordsPerBlock:22}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:9,dataCodewordsPerBlock:13},{numBlocks:16,dataCodewordsPerBlock:14}]}]},{infoBits:84390,versionNumber:20,alignmentPatternCenters:[6,34,62,90],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:107},{numBlocks:5,dataCodewordsPerBlock:108}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:41},{numBlocks:13,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:5,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:15},{numBlocks:10,dataCodewordsPerBlock:16}]}]},{infoBits:87683,versionNumber:21,alignmentPatternCenters:[6,28,50,72,94],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:116},{numBlocks:4,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:42}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:16},{numBlocks:6,dataCodewordsPerBlock:17}]}]},{infoBits:92361,versionNumber:22,alignmentPatternCenters:[6,26,50,74,98],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:111},{numBlocks:7,dataCodewordsPerBlock:112}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:24,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:13}]}]},{infoBits:96236,versionNumber:23,alignmentPatternCenters:[6,30,54,74,102],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:121},{numBlocks:5,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:47},{numBlocks:14,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:16,dataCodewordsPerBlock:15},{numBlocks:14,dataCodewordsPerBlock:16}]}]},{infoBits:102084,versionNumber:24,alignmentPatternCenters:[6,28,54,80,106],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:45},{numBlocks:14,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:24},{numBlocks:16,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:30,dataCodewordsPerBlock:16},{numBlocks:2,dataCodewordsPerBlock:17}]}]},{infoBits:102881,versionNumber:25,alignmentPatternCenters:[6,32,58,84,110],errorCorrectionLevels:[{ecCodewordsPerBlock:26,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:106},{numBlocks:4,dataCodewordsPerBlock:107}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:47},{numBlocks:13,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:13,dataCodewordsPerBlock:16}]}]},{infoBits:110507,versionNumber:26,alignmentPatternCenters:[6,30,58,86,114],errorCorrectionLevels:[{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:114},{numBlocks:2,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:46},{numBlocks:4,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:28,dataCodewordsPerBlock:22},{numBlocks:6,dataCodewordsPerBlock:23}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:33,dataCodewordsPerBlock:16},{numBlocks:4,dataCodewordsPerBlock:17}]}]},{infoBits:110734,versionNumber:27,alignmentPatternCenters:[6,34,62,90,118],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:45},{numBlocks:3,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:8,dataCodewordsPerBlock:23},{numBlocks:26,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:117786,versionNumber:28,alignmentPatternCenters:[6,26,50,74,98,122],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:117},{numBlocks:10,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:3,dataCodewordsPerBlock:45},{numBlocks:23,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:24},{numBlocks:31,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:31,dataCodewordsPerBlock:16}]}]},{infoBits:119615,versionNumber:29,alignmentPatternCenters:[6,30,54,78,102,126],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:7,dataCodewordsPerBlock:116},{numBlocks:7,dataCodewordsPerBlock:117}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:21,dataCodewordsPerBlock:45},{numBlocks:7,dataCodewordsPerBlock:46}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:1,dataCodewordsPerBlock:23},{numBlocks:37,dataCodewordsPerBlock:24}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:26,dataCodewordsPerBlock:16}]}]},{infoBits:126325,versionNumber:30,alignmentPatternCenters:[6,26,52,78,104,130],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:5,dataCodewordsPerBlock:115},{numBlocks:10,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:47},{numBlocks:10,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:15,dataCodewordsPerBlock:24},{numBlocks:25,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:25,dataCodewordsPerBlock:16}]}]},{infoBits:127568,versionNumber:31,alignmentPatternCenters:[6,30,56,82,108,134],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:3,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:46},{numBlocks:29,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:24},{numBlocks:1,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:23,dataCodewordsPerBlock:15},{numBlocks:28,dataCodewordsPerBlock:16}]}]},{infoBits:133589,versionNumber:32,alignmentPatternCenters:[6,34,60,86,112,138],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:24},{numBlocks:35,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:15},{numBlocks:35,dataCodewordsPerBlock:16}]}]},{infoBits:136944,versionNumber:33,alignmentPatternCenters:[6,30,58,86,114,142],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:115},{numBlocks:1,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:21,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:24},{numBlocks:19,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:11,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:141498,versionNumber:34,alignmentPatternCenters:[6,34,62,90,118,146],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:115},{numBlocks:6,dataCodewordsPerBlock:116}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:14,dataCodewordsPerBlock:46},{numBlocks:23,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:44,dataCodewordsPerBlock:24},{numBlocks:7,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:59,dataCodewordsPerBlock:16},{numBlocks:1,dataCodewordsPerBlock:17}]}]},{infoBits:145311,versionNumber:35,alignmentPatternCenters:[6,30,54,78,102,126,150],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:121},{numBlocks:7,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:12,dataCodewordsPerBlock:47},{numBlocks:26,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:39,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:22,dataCodewordsPerBlock:15},{numBlocks:41,dataCodewordsPerBlock:16}]}]},{infoBits:150283,versionNumber:36,alignmentPatternCenters:[6,24,50,76,102,128,154],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:121},{numBlocks:14,dataCodewordsPerBlock:122}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:6,dataCodewordsPerBlock:47},{numBlocks:34,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:46,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:2,dataCodewordsPerBlock:15},{numBlocks:64,dataCodewordsPerBlock:16}]}]},{infoBits:152622,versionNumber:37,alignmentPatternCenters:[6,28,54,80,106,132,158],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:17,dataCodewordsPerBlock:122},{numBlocks:4,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:29,dataCodewordsPerBlock:46},{numBlocks:14,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:49,dataCodewordsPerBlock:24},{numBlocks:10,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:24,dataCodewordsPerBlock:15},{numBlocks:46,dataCodewordsPerBlock:16}]}]},{infoBits:158308,versionNumber:38,alignmentPatternCenters:[6,32,58,84,110,136,162],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:4,dataCodewordsPerBlock:122},{numBlocks:18,dataCodewordsPerBlock:123}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:13,dataCodewordsPerBlock:46},{numBlocks:32,dataCodewordsPerBlock:47}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:48,dataCodewordsPerBlock:24},{numBlocks:14,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:42,dataCodewordsPerBlock:15},{numBlocks:32,dataCodewordsPerBlock:16}]}]},{infoBits:161089,versionNumber:39,alignmentPatternCenters:[6,26,54,82,110,138,166],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:117},{numBlocks:4,dataCodewordsPerBlock:118}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:40,dataCodewordsPerBlock:47},{numBlocks:7,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:43,dataCodewordsPerBlock:24},{numBlocks:22,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:10,dataCodewordsPerBlock:15},{numBlocks:67,dataCodewordsPerBlock:16}]}]},{infoBits:167017,versionNumber:40,alignmentPatternCenters:[6,30,58,86,114,142,170],errorCorrectionLevels:[{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:19,dataCodewordsPerBlock:118},{numBlocks:6,dataCodewordsPerBlock:119}]},{ecCodewordsPerBlock:28,ecBlocks:[{numBlocks:18,dataCodewordsPerBlock:47},{numBlocks:31,dataCodewordsPerBlock:48}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:34,dataCodewordsPerBlock:24},{numBlocks:34,dataCodewordsPerBlock:25}]},{ecCodewordsPerBlock:30,ecBlocks:[{numBlocks:20,dataCodewordsPerBlock:15},{numBlocks:61,dataCodewordsPerBlock:16}]}]}]},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=x(0);function m(c,l,h,u){var b=c.x-l.x+h.x-u.x,E=c.y-l.y+h.y-u.y;if(b===0&&E===0)return{a11:l.x-c.x,a12:l.y-c.y,a13:0,a21:h.x-l.x,a22:h.y-l.y,a23:0,a31:c.x,a32:c.y,a33:1};var B=l.x-h.x,j=u.x-h.x,v=l.y-h.y,y=u.y-h.y,d=B*y-j*v,i=(b*y-j*E)/d,C=(B*E-b*v)/d;return{a11:l.x-c.x+i*l.x,a12:l.y-c.y+i*l.y,a13:i,a21:u.x-c.x+C*u.x,a22:u.y-c.y+C*u.y,a23:C,a31:c.x,a32:c.y,a33:1}}function f(c,l,h,u){var b=m(c,l,h,u);return{a11:b.a22*b.a33-b.a23*b.a32,a12:b.a13*b.a32-b.a12*b.a33,a13:b.a12*b.a23-b.a13*b.a22,a21:b.a23*b.a31-b.a21*b.a33,a22:b.a11*b.a33-b.a13*b.a31,a23:b.a13*b.a21-b.a11*b.a23,a31:b.a21*b.a32-b.a22*b.a31,a32:b.a12*b.a31-b.a11*b.a32,a33:b.a11*b.a22-b.a12*b.a21}}function g(c,l){return{a11:c.a11*l.a11+c.a21*l.a12+c.a31*l.a13,a12:c.a12*l.a11+c.a22*l.a12+c.a32*l.a13,a13:c.a13*l.a11+c.a23*l.a12+c.a33*l.a13,a21:c.a11*l.a21+c.a21*l.a22+c.a31*l.a23,a22:c.a12*l.a21+c.a22*l.a22+c.a32*l.a23,a23:c.a13*l.a21+c.a23*l.a22+c.a33*l.a23,a31:c.a11*l.a31+c.a21*l.a32+c.a31*l.a33,a32:c.a12*l.a31+c.a22*l.a32+c.a32*l.a33,a33:c.a13*l.a31+c.a23*l.a32+c.a33*l.a33}}function p(c,l){for(var h=f({x:3.5,y:3.5},{x:l.dimension-3.5,y:3.5},{x:l.dimension-6.5,y:l.dimension-6.5},{x:3.5,y:l.dimension-3.5}),u=m(l.topLeft,l.topRight,l.alignmentPattern,l.bottomLeft),b=g(u,h),E=o.BitMatrix.createEmpty(l.dimension,l.dimension),B=function(C,A){var w=b.a13*C+b.a23*A+b.a33;return{x:(b.a11*C+b.a21*A+b.a31)/w,y:(b.a12*C+b.a22*A+b.a32)/w}},j=0;j<l.dimension;j++)for(var v=0;v<l.dimension;v++){var y=v+.5,d=j+.5,i=B(y,d);E.set(v,j,c.get(Math.floor(i.x),Math.floor(i.y)))}return{matrix:E,mappingFunction:B}}r.extract=p},function(a,r,x){Object.defineProperty(r,"__esModule",{value:!0});var o=4,m=.5,f=1.5,g=function(y,d){return Math.sqrt(Math.pow(d.x-y.x,2)+Math.pow(d.y-y.y,2))};function p(y){return y.reduce(function(d,i){return d+i})}function c(y,d,i){var C,A,w,F,N=g(y,d),k=g(d,i),P=g(y,i),L,$,U;return k>=N&&k>=P?(C=[d,y,i],L=C[0],$=C[1],U=C[2]):P>=k&&P>=N?(A=[y,d,i],L=A[0],$=A[1],U=A[2]):(w=[y,i,d],L=w[0],$=w[1],U=w[2]),(U.x-$.x)*(L.y-$.y)-(U.y-$.y)*(L.x-$.x)<0&&(F=[U,L],L=F[0],U=F[1]),{bottomLeft:L,topLeft:$,topRight:U}}function l(y,d,i,C){var A=(p(u(y,i,C,5))/7+p(u(y,d,C,5))/7+p(u(i,y,C,5))/7+p(u(d,y,C,5))/7)/4;if(A<1)throw new Error("Invalid module size");var w=Math.round(g(y,d)/A),F=Math.round(g(y,i)/A),N=Math.floor((w+F)/2)+7;switch(N%4){case 0:N++;break;case 2:N--;break}return{dimension:N,moduleSize:A}}function h(y,d,i,C){var A=[{x:Math.floor(y.x),y:Math.floor(y.y)}],w=Math.abs(d.y-y.y)>Math.abs(d.x-y.x),F,N,k,P;w?(F=Math.floor(y.y),N=Math.floor(y.x),k=Math.floor(d.y),P=Math.floor(d.x)):(F=Math.floor(y.x),N=Math.floor(y.y),k=Math.floor(d.x),P=Math.floor(d.y));for(var L=Math.abs(k-F),$=Math.abs(P-N),U=Math.floor(-L/2),S=F<k?1:-1,I=N<P?1:-1,M=!0,H=F,T=N;H!==k+S;H+=S){var D=w?T:H,R=w?H:T;if(i.get(D,R)!==M&&(M=!M,A.push({x:D,y:R}),A.length===C+1))break;if(U+=$,U>0){if(T===P)break;T+=I,U-=L}}for(var Z=[],O=0;O<C;O++)A[O]&&A[O+1]?Z.push(g(A[O],A[O+1])):Z.push(0);return Z}function u(y,d,i,C){var A,w=d.y-y.y,F=d.x-y.x,N=h(y,d,i,Math.ceil(C/2)),k=h(y,{x:y.x-F,y:y.y-w},i,Math.ceil(C/2)),P=N.shift()+k.shift()-1;return(A=k.concat(P)).concat.apply(A,N)}function b(y,d){var i=p(y)/p(d),C=0;return d.forEach(function(A,w){C+=Math.pow(y[w]-A*i,2)}),{averageSize:i,error:C}}function E(y,d,i){try{var C=u(y,{x:-1,y:y.y},i,d.length),A=u(y,{x:y.x,y:-1},i,d.length),w={x:Math.max(0,y.x-y.y)-1,y:Math.max(0,y.y-y.x)-1},F=u(y,w,i,d.length),N={x:Math.min(i.width,y.x+y.y)+1,y:Math.min(i.height,y.y+y.x)+1},k=u(y,N,i,d.length),P=b(C,d),L=b(A,d),$=b(F,d),U=b(k,d),S=Math.sqrt(P.error*P.error+L.error*L.error+$.error*$.error+U.error*U.error),I=(P.averageSize+L.averageSize+$.averageSize+U.averageSize)/4,M=(Math.pow(P.averageSize-I,2)+Math.pow(L.averageSize-I,2)+Math.pow($.averageSize-I,2)+Math.pow(U.averageSize-I,2))/I;return S+M}catch{return 1/0}}function B(y,d){for(var i=Math.round(d.x);y.get(i,Math.round(d.y));)i--;for(var C=Math.round(d.x);y.get(C,Math.round(d.y));)C++;for(var A=(i+C)/2,w=Math.round(d.y);y.get(Math.round(A),w);)w--;for(var F=Math.round(d.y);y.get(Math.round(A),F);)F++;var N=(w+F)/2;return{x:A,y:N}}function j(y){for(var d=[],i=[],C=[],A=[],w=function(D){for(var R=0,Z=!1,O=[0,0,0,0,0],V=function(z){var _=y.get(z,D);if(_===Z)R++;else{O=[O[1],O[2],O[3],O[4],R],R=1,Z=_;var W=p(O)/7,ne=Math.abs(O[0]-W)<W&&Math.abs(O[1]-W)<W&&Math.abs(O[2]-3*W)<3*W&&Math.abs(O[3]-W)<W&&Math.abs(O[4]-W)<W&&!_,X=p(O.slice(-3))/3,re=Math.abs(O[2]-X)<X&&Math.abs(O[3]-X)<X&&Math.abs(O[4]-X)<X&&_;if(ne){var te=z-O[3]-O[4],oe=te-O[2],Y={startX:oe,endX:te,y:D},ee=i.filter(function(ce){return oe>=ce.bottom.startX&&oe<=ce.bottom.endX||te>=ce.bottom.startX&&oe<=ce.bottom.endX||oe<=ce.bottom.startX&&te>=ce.bottom.endX&&O[2]/(ce.bottom.endX-ce.bottom.startX)<f&&O[2]/(ce.bottom.endX-ce.bottom.startX)>m});ee.length>0?ee[0].bottom=Y:i.push({top:Y,bottom:Y})}if(re){var xe=z-O[4],me=xe-O[3],Y={startX:me,y:D,endX:xe},ee=A.filter(function(pe){return me>=pe.bottom.startX&&me<=pe.bottom.endX||xe>=pe.bottom.startX&&me<=pe.bottom.endX||me<=pe.bottom.startX&&xe>=pe.bottom.endX&&O[2]/(pe.bottom.endX-pe.bottom.startX)<f&&O[2]/(pe.bottom.endX-pe.bottom.startX)>m});ee.length>0?ee[0].bottom=Y:A.push({top:Y,bottom:Y})}}},q=-1;q<=y.width;q++)V(q);d.push.apply(d,i.filter(function(z){return z.bottom.y!==D&&z.bottom.y-z.top.y>=2})),i=i.filter(function(z){return z.bottom.y===D}),C.push.apply(C,A.filter(function(z){return z.bottom.y!==D})),A=A.filter(function(z){return z.bottom.y===D})},F=0;F<=y.height;F++)w(F);d.push.apply(d,i.filter(function(D){return D.bottom.y-D.top.y>=2})),C.push.apply(C,A);var N=d.filter(function(D){return D.bottom.y-D.top.y>=2}).map(function(D){var R=(D.top.startX+D.top.endX+D.bottom.startX+D.bottom.endX)/4,Z=(D.top.y+D.bottom.y+1)/2;if(y.get(Math.round(R),Math.round(Z))){var O=[D.top.endX-D.top.startX,D.bottom.endX-D.bottom.startX,D.bottom.y-D.top.y+1],V=p(O)/O.length,q=E({x:Math.round(R),y:Math.round(Z)},[1,1,3,1,1],y);return{score:q,x:R,y:Z,size:V}}}).filter(function(D){return!!D}).sort(function(D,R){return D.score-R.score}).map(function(D,R,Z){if(R>o)return null;var O=Z.filter(function(q,z){return R!==z}).map(function(q){return{x:q.x,y:q.y,score:q.score+Math.pow(q.size-D.size,2)/D.size,size:q.size}}).sort(function(q,z){return q.score-z.score});if(O.length<2)return null;var V=D.score+O[0].score+O[1].score;return{points:[D].concat(O.slice(0,2)),score:V}}).filter(function(D){return!!D}).sort(function(D,R){return D.score-R.score});if(N.length===0)return null;var k=c(N[0].points[0],N[0].points[1],N[0].points[2]),P=k.topRight,L=k.topLeft,$=k.bottomLeft,U=v(y,C,P,L,$),S=[];U&&S.push({alignmentPattern:{x:U.alignmentPattern.x,y:U.alignmentPattern.y},bottomLeft:{x:$.x,y:$.y},dimension:U.dimension,topLeft:{x:L.x,y:L.y},topRight:{x:P.x,y:P.y}});var I=B(y,P),M=B(y,L),H=B(y,$),T=v(y,C,I,M,H);return T&&S.push({alignmentPattern:{x:T.alignmentPattern.x,y:T.alignmentPattern.y},bottomLeft:{x:H.x,y:H.y},topLeft:{x:M.x,y:M.y},topRight:{x:I.x,y:I.y},dimension:T.dimension}),S.length===0?null:S}r.locate=j;function v(y,d,i,C,A){var w,F,N;try{w=l(C,i,A,y),F=w.dimension,N=w.moduleSize}catch{return null}var k={x:i.x-C.x+A.x,y:i.y-C.y+A.y},P=(g(C,A)+g(C,i))/2/N,L=1-3/P,$={x:C.x+L*(k.x-C.x),y:C.y+L*(k.y-C.y)},U=d.map(function(I){var M=(I.top.startX+I.top.endX+I.bottom.startX+I.bottom.endX)/4,H=(I.top.y+I.bottom.y+1)/2;if(y.get(Math.floor(M),Math.floor(H))){var T=[I.top.endX-I.top.startX,I.bottom.endX-I.bottom.startX,I.bottom.y-I.top.y+1];p(T)/T.length;var D=E({x:Math.floor(M),y:Math.floor(H)},[1,1,1],y),R=D+g({x:M,y:H},$);return{x:M,y:H,score:R}}}).filter(function(I){return!!I}).sort(function(I,M){return I.score-M.score}),S=P>=15&&U.length?U[0]:$;return{alignmentPattern:S,dimension:F}}}]).default})})(r0);var ox=r0.exports;const lx=sa(ox);function n0({onClose:t,userLinkId:s}){const[a,r]=n.useState("details"),[x,o]=n.useState(""),[m,f]=n.useState(!1),[g,p]=n.useState(!1),[c,l]=n.useState(""),[h,u]=n.useState(!1),{showToast:b}=qe(),E=n.useRef(null),B=n.useRef(null),j=n.useRef(null),[v,y]=n.useState(!1),[d,i]=n.useState(!1),[C,A]=n.useState(""),w=n.useRef(null),F=async()=>{if(s)try{await navigator.clipboard.writeText(s),f(!0),b("Link ID copied to clipboard!","success"),setTimeout(()=>f(!1),2e3)}catch{b("Failed to copy Link ID","error")}},N=async I=>{const M=I||x.trim();if(!M){l("Please enter a Link ID");return}if(M.length!==6){l("Link ID must be exactly 6 characters");return}p(!0),l(""),u(!1);try{const H=await Je.sendInvite(M);if(H.success)u(!0),b("Connection invite sent successfully!","success"),o(""),setTimeout(()=>{t()},1500);else{const T=H.error||"Failed to send invite";l(T),b(T,"error")}}catch(H){const T=(H==null?void 0:H.message)||"Failed to send invite. Please try again.";l(T),b(T,"error")}finally{p(!1)}},k=I=>{const M=I.target.value.toUpperCase().replace(/[^A-Z0-9]/g,"");M.length<=6&&(o(M),l(""),u(!1))},P=async()=>{if(!E.current||!j.current)return;const I=E.current,M=j.current,H=M.getContext("2d");if(!H||I.readyState!==I.HAVE_ENOUGH_DATA)return;M.width=I.videoWidth,M.height=I.videoHeight,H.drawImage(I,0,0,M.width,M.height);const T=H.getImageData(0,0,M.width,M.height);try{const D=lx(T.data,T.width,T.height,{inversionAttempts:"dontInvert"});if(D&&D.data){const R=D.data.trim().toUpperCase();A(`Found: ${R}`);const Z=R.match(/[A-Z0-9]{6}/);if(Z){const O=Z[0];A(`Processing: ${O}`),i(!1),$(),S(),await N(O)}else A(`Invalid format: ${R.substring(0,20)}`),setTimeout(()=>A(""),2e3)}else A("")}catch{A("Scan error")}},L=()=>{i(!0),w.current=window.setInterval(()=>{P()},200)},$=()=>{w.current&&(clearInterval(w.current),w.current=null),i(!1)};n.useEffect(()=>(a==="scanner"?(A(""),U()):(S(),$(),A("")),()=>{S(),$()}),[a]);const U=async()=>{try{const I=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1920},height:{ideal:1080},focusMode:"continuous",advanced:[{focusMode:"continuous"}]}});B.current=I,E.current&&(E.current.srcObject=I,E.current.onloadedmetadata=()=>{var M;(M=E.current)==null||M.play(),y(!0),L()})}catch{b("Could not access camera. Please check permissions.","error")}},S=()=>{B.current&&(B.current.getTracks().forEach(I=>I.stop()),B.current=null),E.current&&(E.current.srcObject=null),y(!1)};return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center animate-fade-in",onClick:t,children:[e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md max-h-[90vh] overflow-hidden animate-slide-up",onClick:I=>I.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white px-6 py-4 flex items-center justify-center rounded-t-3xl border-b border-gray-100",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Link to connect"})}),e.jsxs("div",{className:"flex border-b border-gray-200",children:[e.jsxs("button",{onClick:()=>r("details"),className:`flex-1 py-3 px-4 font-semibold transition-colors flex items-center justify-center gap-2 ${a==="details"?"text-black border-b-2 border-black":"text-gray-400"}`,children:[e.jsx(gt,{className:"w-5 h-5"}),"Details"]}),e.jsxs("button",{onClick:()=>r("scanner"),className:`flex-1 py-3 px-4 font-semibold transition-colors flex items-center justify-center gap-2 ${a==="scanner"?"text-black border-b-2 border-black":"text-gray-400"}`,children:[e.jsx(Lt,{className:"w-5 h-5"}),"QR Scanner"]})]}),e.jsx("div",{className:"overflow-y-auto",style:{maxHeight:"calc(90vh - 140px)"},children:a==="details"?e.jsxs("div",{className:"px-6 py-6 space-y-6",children:[s&&e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-gray-700 mb-2",children:"Your Link ID"}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 rounded-xl px-4 py-3 border border-gray-200",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900 tracking-wider flex-1",children:s}),e.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-200 rounded-lg transition-colors flex-shrink-0",children:m?e.jsx(Qe,{className:"w-5 h-5 text-green-600"}):e.jsx(A0,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Share this code/scan QR to invite and connect with friends."})]}),e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-white p-3 rounded-xl border-2 border-gray-200 shadow-sm",children:e.jsx("img",{src:`https://api.qrserver.com/v1/create-qr-code/?size=400x400&data=${s}&bgcolor=FFFFFF&color=000000`,alt:`QR Code for ${s}`,className:"w-36 h-36",onError:I=>{I.currentTarget.src=`https://quickchart.io/qr?text=${s}&size=400`}})})})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold text-gray-700 mb-2 block",children:"Connect with a friend"}),e.jsx("input",{type:"text",value:x,onChange:k,placeholder:"ABC3454",maxLength:6,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-gray-400 focus:border-gray-400 text-center text-lg font-semibold tracking-wider uppercase placeholder:text-gray-300"}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Enter 6 characters (letters and numbers)"})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:c})}),h&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-xl p-3",children:e.jsx("p",{className:"text-sm text-green-700 font-medium",children:"Connection invite sent successfully!"})}),e.jsx("button",{onClick:()=>N(),disabled:g||x.length!==6||h,className:"w-full bg-black text-white py-4 rounded-xl font-semibold hover:bg-gray-800 transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed",children:g?"Sending invite...":h?"Invite sent!":"Add friend"})]})]}):e.jsxs("div",{className:"relative bg-black",style:{height:"500px"},children:[e.jsx("video",{ref:E,autoPlay:!0,playsInline:!0,muted:!0,className:"absolute top-0 left-0 w-full h-full object-cover"}),e.jsx("canvas",{ref:j,style:{display:"none"}}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center justify-center h-full px-8 text-white",children:[e.jsxs("div",{className:"w-64 h-64 bg-transparent relative rounded-3xl",style:{boxShadow:"0 0 0 4000px rgba(0,0,0,0.6)"},children:[e.jsx("div",{className:"absolute top-0 left-0 w-12 h-12 border-t-4 border-l-4 border-white rounded-tl-3xl"}),e.jsx("div",{className:"absolute top-0 right-0 w-12 h-12 border-t-4 border-r-4 border-white rounded-tr-3xl"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-12 h-12 border-b-4 border-l-4 border-white rounded-bl-3xl"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-12 h-12 border-b-4 border-r-4 border-white rounded-br-3xl"})]}),e.jsx("p",{className:"text-lg font-semibold mt-8 text-center",style:{textShadow:"0 2px 8px rgba(0,0,0,0.7)"},children:"Point the camera at the QR code"}),e.jsx("p",{className:"text-sm text-gray-300 mt-2 text-center",style:{textShadow:"0 2px 8px rgba(0,0,0,0.7)"},children:C||(d?"Scanning...":"Connection invite will be sent automatically")})]}),!v&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(Lt,{className:"w-12 h-12 mx-auto mb-3 opacity-50"}),e.jsx("p",{className:"text-sm",children:"Starting camera..."})]})})]})})]}),e.jsx("style",{children:`
        @keyframes scan {
          0%, 100% { transform: translateY(-100%); }
          50% { transform: translateY(100%); }
        }
      `})]})}function x0({onClose:t}){const[s,a]=n.useState(!1),[r,x]=n.useState(!1),[o,m]=n.useState(null),[f,g]=n.useState(!0);n.useEffect(()=>{p()},[]);const p=async()=>{var l;try{const{data:{user:h}}=await J.auth.getUser();if(!h)return;const{data:u,error:b}=await J.from("users").select("*").eq("user_id",h.id).maybeSingle();if(b)throw b;m(u||{id:"",user_id:h.id,full_name:"User",username:((l=h.email)==null?void 0:l.split("@")[0])||"user",email:h.email||"",phone_nr:"",gender:"",age:"",bio:"",website:"",profile_picture:"",instagram:"",tiktok:"",points_count:0,saved_qty:"",current_level:1,link_id:""})}catch{}finally{g(!1)}},c=()=>{p(),a(!1)};return s&&o?e.jsx(xx,{profile:o,onClose:()=>a(!1),onSave:c}):r?e.jsx(n0,{onClose:()=>x(!1),userLinkId:o==null?void 0:o.link_id}):f?e.jsx("div",{className:"fixed inset-0 bg-white z-50 flex items-center justify-center",children:e.jsx("div",{className:"text-gray-500",children:"Loading..."})}):o?e.jsx("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-white",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-4 py-4 flex items-center justify-between border-b border-gray-200",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"My profile"}),e.jsx("button",{onClick:()=>a(!0),className:"p-2 -mr-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(N0,{className:"w-5 h-5 text-gray-800"})})]}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-orange-400 to-pink-500 flex items-center justify-center shadow-lg overflow-hidden flex-shrink-0",children:o.profile_picture?e.jsx("img",{src:pa(o.profile_picture),alt:o.full_name,className:"w-full h-full object-cover",onError:l=>{l.currentTarget.style.display="none",l.currentTarget.parentElement.innerHTML=`<span class="text-white text-3xl font-bold">${o.full_name?o.full_name.charAt(0).toUpperCase():"U"}</span>`}}):e.jsx("span",{className:"text-white text-3xl font-bold",children:o.full_name?o.full_name.charAt(0).toUpperCase():"U"})}),e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o.full_name})})]}),o.link_id&&e.jsx("button",{onClick:()=>x(!0),className:"w-full bg-white rounded-2xl p-4 border border-gray-200 hover:border-gray-300 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx(F0,{className:"w-5 h-5 text-gray-700"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("p",{className:"text-xs text-gray-600 font-medium",children:"Your Link ID"}),e.jsx("p",{className:"text-lg font-bold text-gray-900 tracking-wider",children:o.link_id})]})]}),e.jsx(ye,{className:"w-5 h-5 text-gray-400 transform rotate-180"})]})}),(o.username||o.bio)&&e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-200",children:[o.username&&e.jsxs("div",{className:"flex items-center p-4 border-b border-gray-100",children:[e.jsx(D0,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Nickname"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.username})]}),o.bio&&e.jsxs("div",{className:`flex items-center p-4 ${o.username?"":"border-b-0"}`,children:[e.jsx(ia,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Bio"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.bio})]})]}),(o.website||o.instagram||o.tiktok)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Online Presence"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-200",children:[o.website&&e.jsxs("div",{className:`flex items-center p-4 ${o.instagram||o.tiktok?"border-b border-gray-100":""}`,children:[e.jsx(js,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Website"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.website})]}),(o.instagram||o.tiktok)&&e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx(st,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Social Links"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-3",children:[o.instagram&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(xa,{className:"w-4 h-4 text-pink-500"}),e.jsx("span",{className:"text-xs",children:o.instagram})]}),o.tiktok&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(k0,{className:"w-4 h-4 text-gray-800"}),e.jsx("span",{className:"text-xs",children:o.tiktok})]})]})})]})]})]}),(o.email||o.phone_nr||o.gender||o.age)&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Personal Details (Private)"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm border border-gray-200",children:[o.email&&e.jsxs("div",{className:`flex items-center p-4 ${o.phone_nr||o.gender||o.age?"border-b border-gray-100":""}`,children:[e.jsx(oa,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Email"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.email})]}),o.phone_nr&&e.jsxs("div",{className:`flex items-center p-4 ${o.gender||o.age?"border-b border-gray-100":""}`,children:[e.jsx(la,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Phone"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.phone_nr})]}),o.gender&&e.jsxs("div",{className:`flex items-center p-4 ${o.age?"border-b border-gray-100":""}`,children:[e.jsx(S0,{className:"w-5 h-5 text-gray-700 mr-3"}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Gender"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.gender})]}),o.age&&e.jsxs("div",{className:"flex items-center p-4",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-5 h-5 text-gray-700 mr-3",viewBox:"0 0 56 56",children:e.jsx("path",{fill:"currentColor",d:"M8.746 37.703h7.149l-2.133 10.594a4 4 0 0 0-.07.75c0 1.148.796 1.781 1.898 1.781c1.125 0 1.945-.61 2.18-1.758l2.296-11.367h11.086L29.02 48.297c-.07.234-.093.516-.093.75c0 1.148.797 1.781 1.922 1.781s1.945-.61 2.18-1.758L35.3 37.703h8.367c1.289 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875h-7.946L38.63 21.25h8.203c1.29 0 2.18-.937 2.18-2.203c0-1.031-.703-1.875-1.758-1.875H39.45l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.82-1.805-1.945-1.805c-1.312 0-1.898.726-2.133 1.828l-2.062 10.172H24.215l1.922-9.445c.023-.141.07-.446.07-.75c0-1.149-.844-1.805-1.945-1.805c-1.336 0-1.946.726-2.157 1.828l-2.062 10.172h-7.687c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805h7.289l-2.485 12.375h-7.57c-1.29 0-2.18.984-2.18 2.273c0 1.055.703 1.805 1.758 1.805m12.14-4.078l2.509-12.375H34.48l-2.508 12.375Z"})}),e.jsx("span",{className:"text-sm text-gray-600 w-28",children:"Age"}),e.jsx("span",{className:"flex-1 text-sm text-gray-900 text-right",children:o.age})]})]})]})]})]})})}):null}function ix({onClose:t,onNavigateToMap:s}){return e.jsx("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-white",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-4 py-4 flex items-center justify-between border-b border-gray-200",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Privacy Policy"}),e.jsx("button",{onClick:s||t,className:"p-2 -mr-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})})]}),e.jsx("div",{className:"px-5 py-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-2",children:"PRIVACY POLICY"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Last Updated: May 10, 2022"}),e.jsxs("div",{className:"space-y-6 text-sm text-gray-700 leading-relaxed",children:[e.jsxs("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded",children:[e.jsx("p",{className:"font-semibold text-gray-900 mb-2",children:"Data Collection Notice"}),e.jsx("p",{children:"This Application collects Personal Data from its Users. The policy can be printed through the print command in the browser settings."})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Owner and Data Controller"}),e.jsx("p",{className:"mb-1",children:"Wilhelmina van Pruisenweg 35, 2595 AN The Hague"}),e.jsxs("p",{children:["Contact: ",e.jsx("a",{href:"mailto:hello@pawatasty.com",className:"text-blue-600 hover:underline",children:"hello@pawatasty.com"})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"TYPES OF DATA COLLECTED"}),e.jsx("p",{className:"mb-3",children:"This Application collects various types of Personal Data, either directly or through third parties. These include:"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("ul",{className:"list-disc pl-5 space-y-1 text-xs",children:[e.jsx("li",{children:"Tracker and unique device identifiers for advertising (e.g. Google Advertiser ID or IDFA)"}),e.jsx("li",{children:"Device information, geography/region"}),e.jsx("li",{children:"Number of Users and sessions, session duration"}),e.jsx("li",{children:"Application opens/launches, operating systems"}),e.jsx("li",{children:"Email address, usage data, universally unique identifier (UUID)"}),e.jsx("li",{children:"Payment info, first and last name, billing address"}),e.jsx("li",{children:"Phone number, password, social media accounts"}),e.jsx("li",{children:"Geographic position, location permissions (continuous/non-continuous and approximate/precise)"}),e.jsx("li",{children:"Camera permission (without saving or recording)"}),e.jsx("li",{children:"Shipping address"})]})}),e.jsx("p",{className:"mt-3 text-xs text-gray-600",children:"The details of each type of data collected are provided in the dedicated sections of this privacy policy or in specific explanation texts displayed before the data is collected."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"DATA COLLECTION"}),e.jsx("p",{className:"mb-3",children:"Personal Data can either be provided by the User or collected automatically when using the Application (e.g. Usage Data). Unless specified otherwise, all Data requested by the Application is mandatory and failure to provide it may result in the inability to use its services."}),e.jsx("p",{className:"mb-3",children:"If some Data is not mandatory, the User can choose not to provide it without affecting the availability or functionality of the service. If unsure about mandatory data, the User can contact the Owner."}),e.jsx("p",{children:"The use of Cookies or other tracking tools by the Application or third-party services used by the Application serves the purpose of providing the required Service and any other purposes outlined in this privacy policy and the Cookie Policy (if available). The User is responsible for obtaining consent from third parties for any Personal Data obtained, published, or shared through the Application."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"DATA PROCESSING"}),e.jsx("p",{className:"mb-3",children:"The Owner implements appropriate security measures to prevent unauthorized access, modification, disclosure, or destruction of the Data. The processing of Data is carried out using computers and/or IT tools and following organizational procedures strictly related to the intended purposes."}),e.jsx("p",{className:"mb-3",children:"The Data may be accessible to certain personnel involved in the operation of the Application (e.g. administration, sales, marketing, legal, system administration) or external parties (e.g. technical service providers, mail carriers, hosting providers, IT companies, communications agencies) appointed as Data Processors by the Owner if necessary."}),e.jsx("p",{className:"text-gray-600",children:"The updated list of these parties can be requested from the Owner at any time."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"LEGAL BASIS OF PROCESSING"}),e.jsx("p",{className:"mb-3",children:"The Owner can process Personal Data if one of the following applies:"}),e.jsxs("ol",{className:"list-decimal pl-5 space-y-2",children:[e.jsx("li",{children:"User consent for specific purposes"}),e.jsx("li",{children:"Provision of Data is necessary for performance of an agreement with the User"}),e.jsx("li",{children:"Necessary for compliance with a legal obligation"}),e.jsx("li",{children:"Related to a task carried out in the public interest or exercise of official authority"}),e.jsx("li",{children:"Necessary for the Owner's or a third party's legitimate interests"})]}),e.jsx("p",{className:"mt-3",children:"The Owner will clarify the specific legal basis for processing upon request."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"PLACE OF PROCESSING"}),e.jsx("p",{className:"mb-3",children:"The Data is processed at the Owner's operating offices and any other places where the parties involved in the processing are located. Data transfers to a country other than the User's may occur, and details on the place of processing can be found in the relevant section of this privacy policy."}),e.jsx("p",{children:"The User has the right to know about the legal basis of data transfers and the security measures taken by the Owner to safeguard their Data. If such a transfer occurs, more information can be obtained by checking the relevant sections of this document or contacting the Owner."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"RETENTION TIME"}),e.jsx("p",{className:"mb-3",children:"Personal Data will be processed and stored for as long as required by the purpose they have been collected for."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Personal Data collected for contract performance"})," will be kept until the contract is fulfilled."]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"Personal Data collected for legitimate interests"})," will be kept as long as needed to achieve those interests. Information on the legitimate interests can be found in this document or by contacting the owner."]}),e.jsx("p",{children:"If the user gives consent, the owner may keep Personal Data for a longer period, but only as long as the consent is not withdrawn. Additionally, if required by law or by an authority, the owner may be obliged to keep Personal Data longer."}),e.jsx("p",{className:"text-gray-600",children:"After the retention period, Personal Data will be deleted and the rights of access, erasure, rectification, and data portability cannot be exercised."})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"PROCESSING PURPOSES"}),e.jsx("p",{className:"mb-3",children:"The owner collects User Data to provide its service, meet legal obligations, respond to enforcement requests, protect rights and interests, detect malicious or fraudulent activity, and for:"}),e.jsx("div",{className:"bg-gray-50 p-4 rounded-lg",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsx("div",{children:"â€¢ Analytics"}),e.jsx("div",{children:"â€¢ User database management"}),e.jsx("div",{children:"â€¢ Handling payments"}),e.jsx("div",{children:"â€¢ Registration and authentication"}),e.jsx("div",{children:"â€¢ A/B testing"}),e.jsx("div",{children:"â€¢ Social features"}),e.jsx("div",{children:"â€¢ Managing contacts"}),e.jsx("div",{children:"â€¢ Infrastructure monitoring"}),e.jsx("div",{children:"â€¢ Location-based interactions"}),e.jsx("div",{children:"â€¢ Device permissions"}),e.jsx("div",{children:"â€¢ Hosting and backend"}),e.jsx("div",{children:"â€¢ Platform services"}),e.jsx("div",{children:"â€¢ Managing support requests"}),e.jsx("div",{children:"â€¢ Location processing"})]})}),e.jsx("p",{className:"mt-3 text-xs text-gray-600",children:'For information on the Personal Data used for each purpose, see "Detailed information on the processing of Personal Data".'})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"DEVICE PERMISSIONS FOR PERSONAL DATA ACCESS"}),e.jsx("p",{className:"mb-3",children:"Depending on the device, this application may ask for certain permissions to access device data. The user must grant these permissions, but can revoke them at any time through device settings or by contacting the owner."}),e.jsx("p",{className:"mb-3 text-orange-700 font-medium",children:"Revoking these permissions may impact the application's functioning."}),e.jsxs("div",{className:"space-y-4 mt-4",children:[e.jsxs("div",{className:"border-l-4 border-green-400 pl-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Location Permissions"}),e.jsxs("ul",{className:"space-y-2 text-xs",children:[e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Approximate location (continuous):"})," Used to access the user's approximate device location and provide location-based services."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Approximate location (non-continuous):"})," Used to access the user's approximate device location and provide location-based services, but the location is not determined continuously."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Precise location (continuous):"})," Used to access the user's precise device location and provide location-based services."]}),e.jsxs("li",{children:[e.jsx("span",{className:"font-medium",children:"Precise location (non-continuous):"})," Used to access the user's precise device location and provide location-based services, but the location is not determined continuously."]})]})]}),e.jsxs("div",{className:"border-l-4 border-purple-400 pl-3",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Camera Permission"}),e.jsxs("p",{className:"text-xs",children:[e.jsx("span",{className:"font-medium",children:"Camera permission (without saving or recording):"})," Used to access the camera or capture images and video from the device, but does not save or record the output."]})]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"DETAILED INFORMATION ON PERSONAL DATA PROCESSING"}),e.jsx("p",{className:"mb-4 text-gray-600",children:"Personal Data is collected for the following purposes and using the following services:"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Analytics"}),e.jsx("p",{className:"text-xs mb-2",children:"Services that allow the owner to monitor and analyze web traffic and track user behavior."}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-800 mt-2",children:"Google Analytics for Firebase (Google LLC)"}),e.jsx("p",{className:"mt-1",children:"Personal data: application opens, device information, geography/region, launches, number of sessions, number of users, operating systems, session duration, tracker, and unique device identifiers."}),e.jsx("p",{className:"mt-1",children:"Place of processing: United States"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Handling Payments"}),e.jsx("p",{className:"text-xs mb-2",children:"Payment processing through external service providers."}),e.jsxs("div",{className:"space-y-3 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Stripe (Stripe Technology Europe Ltd)"}),e.jsx("p",{children:"Personal data: billing address, email, first and last name, payment information"}),e.jsx("p",{children:"Place of processing: Ireland"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"PayPal (PayPal Inc.)"}),e.jsx("p",{children:"Personal data: billing address, email, first and last name, phone number"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Apple Pay (Apple Inc.)"}),e.jsx("p",{children:"Personal data: billing address, email, first and last name, payment information, shipping address"}),e.jsx("p",{children:"Place of processing: United States"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Google Pay (Google Ireland Limited)"}),e.jsx("p",{children:"Personal data: billing address, email, first and last name, payment information, shipping address"}),e.jsx("p",{children:"Place of processing: Ireland"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Location Processing"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Radar (Radar Labs, Inc.)"}),e.jsx("p",{className:"mt-1",children:"A geolocation service that collects location data (latitude, longitude), device IDs, IP addresses, and device info."}),e.jsx("p",{className:"mt-1",children:"Place of processing: United States"}),e.jsx("a",{href:"https://radar.com/privacy",className:"text-blue-600 hover:underline",children:"Privacy Policy"})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Registration and Authentication"}),e.jsxs("div",{className:"space-y-3 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Firebase Authentication (Google LLC)"}),e.jsx("p",{children:"Personal data: email, name, password, phone number, social media accounts"}),e.jsx("p",{children:"Place of processing: United States"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Facebook Authentication (Meta Platforms Ireland Limited)"}),e.jsx("p",{children:"Place of processing: Ireland"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Infrastructure Monitoring"}),e.jsxs("div",{className:"space-y-3 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Firebase Performance Monitoring (Google LLC)"}),e.jsx("p",{children:"Place of processing: United States"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Sentry (Functional Software, Inc.)"}),e.jsx("p",{children:"Place of processing: United States"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Platform Services and Hosting"}),e.jsxs("div",{className:"space-y-3 text-xs text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Apple App Store (Apple Inc.)"}),e.jsx("p",{children:"Place of processing: United States"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:"Google Play Store (Google Ireland Limited)"}),e.jsx("p",{children:"Place of processing: Ireland"})]})]})]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"USERS' RIGHTS"}),e.jsx("p",{className:"mb-3",children:"Users have the right to:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:"Withdraw consent at any time"}),e.jsx("li",{children:"Object to processing of their data"}),e.jsx("li",{children:"Access their data"}),e.jsx("li",{children:"Verify and rectify their data"}),e.jsx("li",{children:"Restrict processing"}),e.jsx("li",{children:"Delete their data"}),e.jsx("li",{children:"Receive their data and transfer it to another controller"}),e.jsx("li",{children:"File a complaint with authorities"})]}),e.jsx("p",{className:"mt-4 font-semibold",children:"Exercising User Rights"}),e.jsx("p",{className:"mt-2",children:"User rights can be exercised by contacting the Owner using the contact information provided in this document. These requests are free and will be addressed by the Owner within one month or as soon as possible."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"ADDITIONAL INFORMATION"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Legal Action"}),e.jsx("p",{children:"The Owner may use the User's Personal Data for legal purposes in court or in preparation for potential legal action resulting from improper use of the Application or Services. The User acknowledges that the Owner may be required to disclose personal data to public authorities upon request."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"System Logs and Maintenance"}),e.jsx("p",{children:"For operation and maintenance, this Application and third-party services may collect interaction records (System logs) and use other Personal Data (such as IP Address)."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:'Handling "Do Not Track" Requests'}),e.jsx("p",{children:'This Application does not support "Do Not Track" requests. To determine if third-party services used by this Application honor these requests, consult their privacy policies.'})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Changes to Privacy Policy"}),e.jsx("p",{children:"The Owner reserves the right to change this privacy policy at any time by posting updates on this page and potentially within the Application. It is recommended to check this page frequently, with the last modification date listed at the bottom."}),e.jsx("p",{className:"mt-2 text-orange-700",children:"If changes impact processing activities based on the User's consent, the Owner will obtain new consent as needed."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Push Notifications"}),e.jsx("p",{children:"This app may send push notifications to the user. Users may opt-out by changing the notification settings for this app on their device, but this may negatively affect the app's functionality. Push notifications may also be sent based on the user's location."})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"DEFINITIONS AND LEGAL REFERENCES"}),e.jsxs("div",{className:"space-y-3 text-xs",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Personal Data"}),e.jsx("p",{className:"text-gray-600",children:"Data that directly, indirectly, or in connection with other information allows for the identification of a natural person."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Usage Data"}),e.jsx("p",{className:"text-gray-600",children:"Information automatically collected through the Application or third-party services used by it."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"User"}),e.jsx("p",{className:"text-gray-600",children:"The person using the Application, who is the Data Subject unless otherwise specified."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Data Subject"}),e.jsx("p",{className:"text-gray-600",children:"The natural person to whom Personal Data refers."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Data Processor"}),e.jsx("p",{className:"text-gray-600",children:"The natural or legal person, public authority, agency, or other body that processes Personal Data on behalf of the Controller."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Data Controller (Owner)"}),e.jsx("p",{className:"text-gray-600",children:"The natural or legal person, public authority, agency, or other body that determines the purposes and means of processing Personal Data."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Application"}),e.jsx("p",{className:"text-gray-600",children:"The means by which Personal Data of the User is collected and processed."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Service"}),e.jsx("p",{className:"text-gray-600",children:"The service provided by the Application as described in its terms and on the site/application."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Cookie"}),e.jsx("p",{className:"text-gray-600",children:"Small data files stored in the User's browser, used as trackers."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"Tracker"}),e.jsx("p",{className:"text-gray-600",children:"Any technology (such as cookies, unique identifiers, web beacons, embedded scripts, e-tags, or fingerprinting) used to track Users."})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:"European Union (EU)"}),e.jsx("p",{className:"text-gray-600",children:"References to the European Union in this document include all current member states of the European Union and the European Economic Area unless otherwise specified."})]})]})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mt-6",children:[e.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[e.jsx("span",{className:"font-semibold",children:"Legal Information:"})," This privacy statement is based on provisions from various legislations, including Art. 13/14 of the General Data Protection Regulation (EU) 2016/679."]}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"This privacy policy applies solely to this Application unless stated otherwise within this document."}),e.jsx("p",{className:"text-xs text-gray-600 text-center font-semibold",children:"Last Updated: May 10, 2022"}),e.jsx("p",{className:"text-xs text-gray-600 text-center mt-2",children:"For questions or concerns, please contact us at hello@pawatasty.com"})]})]})]})})]})})})}function cx({onClose:t,onNavigateToMap:s}){return e.jsx("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:e.jsx("div",{className:"h-full overflow-y-auto",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-white",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-4 py-4 flex items-center justify-between border-b border-gray-200",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Terms & Conditions"}),e.jsx("button",{onClick:s||t,className:"p-2 -mr-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-800"})})]}),e.jsx("div",{className:"px-5 py-6 space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900 mb-2",children:"TERMS AND CONDITIONS"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Effective Date: October 21, 2022"}),e.jsxs("div",{className:"space-y-6 text-sm text-gray-700 leading-relaxed",children:[e.jsxs("div",{className:"bg-orange-50 border-l-4 border-orange-400 p-4 rounded",children:[e.jsx("p",{className:"font-bold text-gray-900 mb-2",children:"PLEASE READ THIS AGREEMENT CAREFULLY"}),e.jsx("p",{className:"text-sm",children:"PawaTasty is a lifestyle platform that seamlessly blends dining, charging, and social discovery through a mobile-first experience designed to keep users powered, connected, and rewarded."})]}),e.jsx("p",{children:'This agreement sets forth the legally binding terms for your use of the services provided by Pawa Technology and its affiliated entities, doing business as Mobile Charging Solutions / Dinning Deals/discounts, Pawa Technology, or any other name used from time to time (referred to as "Pawa Tasty", "Pawa sharing", "Pawa", "We", "Us", or "Our").'}),e.jsx("p",{className:"font-semibold text-gray-900",children:"By accessing or using the PawaTasty app or website, you agree to be bound by these terms and conditions. Please read them carefully."}),e.jsx("p",{children:'By using our services, you (referred to as "Consumer", "User", "You", or "Your", including your family, heirs, agents, affiliates, representatives, successors, and assigns) agree to all terms and conditions outlined in this agreement. If you do not agree to the conditions stated herein, do not use the services.'}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"THE SERVICES PROVIDED BY PAWA INCLUDE:"}),e.jsxs("ol",{className:"list-decimal pl-5 space-y-2",children:[e.jsx("li",{children:"Pawa mobile application and related website"}),e.jsx("li",{children:'Pawa portable power bank (referred to as "Battery" or "Batteries")'}),e.jsx("li",{children:"Pawa Deals/discounts (e.g., two main courses for the price of one)"}),e.jsx("li",{children:"All related equipment, maintenance, personnel, services, applications, websites, and information provided by Pawa."})]})]}),e.jsxs("div",{className:"border-l-4 border-blue-400 pl-4",children:[e.jsx("h3",{className:"font-bold text-gray-900 mb-3",children:"Access Based on Plan Type"}),e.jsx("p",{className:"mb-3",children:"PawaTasty offers two service tiers, each providing different levels of access and functionality:"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Pay-Per-Use Plan:"}),e.jsx("p",{children:"Users with this plan can rent portable power banks at participating locations through the PawaTasty mobile app or platform. This plan does not include access to exclusive deals or promotions."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Subscription Plan:"}),e.jsx("p",{children:"Users with an active subscription can access both charging stations and exclusive partner deals, promotions, and dining discounts featured on the PawaTasty platform."})]})]}),e.jsx("p",{className:"mt-3 text-blue-700 font-medium",children:"Users may upgrade their account at any time via the mobile app to unlock access to additional features and offers available only to subscribers."})]}),e.jsx("p",{children:"This agreement, including all updates, supplements, additional terms, and Pawa's rules and policies, constitutes the sole agreement for the use of services between you and Pawa. It supersedes all other provisions."}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"1. GENERAL BATTERY RENTAL AND USE TERMS"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"1.1 Consumer Responsibility"}),e.jsx("p",{children:"Pawa and the Consumer are the only parties involved in this Agreement. The Consumer is the sole renter and must comply with all terms and conditions outlined in this Agreement. The Consumer must use the Battery rented from Pawa solely for their own use. If the Consumer allows someone else to use the Battery, the Consumer is solely responsible for ensuring that the terms and conditions of this Agreement are followed."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"1.2 Battery Ownership"}),e.jsx("p",{children:"The Battery and all Pawa equipment attached to it remain the exclusive property of Pawa at all times. The Consumer must not dismantle, modify, repair, or damage the Battery or Pawa equipment in any way. Any stickers on the Battery must not be written on, peeled off, or otherwise altered. The Consumer may not use the Battery or Pawa equipment for commercial purposes without Pawa's written permission. The Services offered must only be used for their intended purpose. Tampering with the Services, Battery, or application, or attempting unauthorized access is strictly prohibited."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"1.3 Battery Operating Hours and Availability"}),e.jsx("p",{className:"mb-3",children:"The Consumer agrees to rent the Battery within the specified maximum rental time. The number of Batteries available for rent is limited and availability cannot be guaranteed. The Battery is an electric power battery that requires regular charging and must be used safely and responsibly. The Consumer understands the following:"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:"The remaining charge in the Battery decreases with use and its operational capabilities may decrease or stop completely as the charge decreases."}),e.jsx("li",{children:"The level of charge in the Battery when the rental starts is not guaranteed and may vary with each rental."}),e.jsx("li",{children:"The rate at which the charge decreases during use is not guaranteed and depends on the Battery, operational conditions, weather, and other factors."}),e.jsx("li",{children:"The Consumer is responsible for checking the Battery's charge level before use and ensuring it is adequate."}),e.jsx("li",{children:"The amount of time the Battery will function before losing its charge is not guaranteed."}),e.jsx("li",{children:"The Battery may lose charge and stop functioning at any time during the rental, including before the Consumer intends to recharge it."})]}),e.jsx("p",{className:"mt-3",children:"If the Battery stops functioning during a rental due to a lack of charge, the Consumer must return it in accordance with this Agreement. Pawa is not liable for any accidents that occur as a result of the Battery running out of charge."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"1.4 Reporting Accidents or Damage"}),e.jsx("p",{children:"The Consumer must report any accidents, damage, personal injury, or lost or stolen Battery to Pawa as soon as possible by emailing hello@pawatasty.com. If there is a personal injury, property damage, or stolen Battery, the Consumer must report the incident to Pawa within 24 hours."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"1.5 Liability"}),e.jsx("p",{children:"The Consumer is solely responsible for the Battery during the rental period and is liable for any misuse, claims, losses, damages, injuries, costs, penalties, or expenses that occur while the Battery is in their custody. The Consumer must return the Battery in the same condition as when rented and will not be held responsible for normal wear and tear. The Consumer must pay any fines, fees, penalties, court costs, or other charges incurred by Pawa due to improper use of the Battery or violation of laws, regulations, or ordinances while using the Services. The Consumer is solely responsible for any harmful consequences, financial or otherwise, from attempting to recharge the Battery using any means other than Pawa's charging station, and Pawa will not be held liable."})]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"2. PAYMENT AND FEES"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"2.1 Utilization Fees"}),e.jsx("p",{children:'The user may use the Battery on a pay-per-use basis, where "use" refers to unlocking the Battery through the Pawa mobile application and utilizing it until it is returned to a Pawa battery storage pack. Alternatively, fees and charges may be determined according to the pricing described on the Pawa app or website for the station being used. Pawa may charge and collect taxes and local government fees in addition to the fees. Pawa will charge the user through credit/debit card or other payment methods offered during subscription for the fees as described.'})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"2.2 Promo Codes"}),e.jsx("p",{children:"Promo codes (discounts) can only be redeemed through the Pawa application. Pawa reserves the right to modify or cancel discounts at any time and they are non-transferable and cannot be resold."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"2.3 Rental Time and Charges"}),e.jsx("p",{children:"Information about rental time and charges can be found on the Pawa website (https://pawatasty.com/pricing) or in the Pawa iOS and Android apps before rental. The user is solely responsible for ensuring that the Battery is locked within the rental time. If the Battery is not returned within the rental period, it will be considered sold to the user for â‚¬50.00, but this sale will be cancelled if the Battery is returned to any Pawa charging bank."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"2.4 Valid Payment Method"}),e.jsx("p",{children:"To register for the services, the user must provide Pawa with a valid payment method accepted by the company. The user represents that they are authorized to use the payment method and authorizes Pawa to charge the fees, including taxes and local government fees, to the method. If the user disputes a charge, they must inform Pawa within 10 business days of the end of the month and provide information about the dispute, such as the utilization date and times. The user must immediately inform Pawa of any changes to the payment method."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"2.5 Payment Scheme"}),e.jsx("p",{children:"Details of the payment scheme for the services can be found on the Pawa website (https://pawatasty.com/pricing) and in the Pawa apps. Pawa reserves the right to change prices at any time. At the start of the rental period, a deposit will be authorized on the user's payment method for an amount determined by Pawa. The rental fee will be taken from the deposit and the difference returned to the user at the end of the rental period."})]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"3. ADDITIONAL TERMS OF USE"}),e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.1 Safety Check"}),e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:"If a user discovers any defect or potential safety issue with a battery, they must stop using it immediately and report it to Pawa."}),e.jsx("li",{children:"The user must report any defects or safety issues to Pawa promptly."}),e.jsx("li",{children:"If the user fails to comply with these requirements, they will be fully liable for any consequences, including all claims, losses, damages, and expenses, and must indemnify Pawa."})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.2 Lost or Stolen Battery"}),e.jsx("p",{children:"A battery may be considered lost or stolen if, in Pawa's reasonable determination, the circumstances suggest so. The last user of the battery will be responsible unless the circumstances suggest otherwise. Pawa has the right to take any necessary action, including seeking restitution and compensation, and filing a police report. The user must report the disappearance or theft of the battery to Pawa immediately. Pawa's computer data will be considered conclusive evidence of the battery's usage."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.3 Limitations on Services Availability"}),e.jsx("p",{children:"Pawa strives to provide the services 365 days a year, but cannot guarantee availability at all times due to unforeseen events. Access to services is dependent on battery availability, which may not be guaranteed even if it is marked as available on the mobile app."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.4 Access License"}),e.jsx("p",{children:"Subject to the user's compliance with this agreement, Pawa grants the user a limited, revocable license to access and use the services and its content. The license does not include any commercial or resale use, collection of product listings or prices, or unauthorized use of data mining tools. Any unauthorized use will automatically terminate the license granted."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.5 Copyright and Ownership"}),e.jsx("p",{children:"The content on the services, including text, graphics, photographs, images, sound, and illustrations, is owned by Pawa, its licensors, agents, and content providers. The design and content of the services are protected by intellectual property laws. The services may only be used for their intended purpose and may not be modified, copied, sold, or exploited without Pawa's written consent. The user is responsible for obtaining permission for any reused copyrighted material. The services, its content, and related rights remain the exclusive property of Pawa unless otherwise agreed. No proprietary notices may be removed from the materials on the services."})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"3.6 Trademarks/No Endorsement"}),e.jsx("p",{children:"All trademarks, service marks, and trade names used by Pawa, including its name, logo, and the services name, are trademarks of Mobile Charging Solutions or its affiliates, partners, vendors, or licensors. The user may not use Pawa's trademarks without prior written consent and should not use any language or symbols that suggest endorsement by Pawa. The use of Pawa's marks does not grant the user any rights or license to use Pawa's proprietary materials."})]})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"4. TERMINATION"}),e.jsx("p",{className:"mb-3",children:"You have the right to end this Agreement at any time by giving notice to Pawa. To do so, send an email to hello@pawatasty.com. If you terminate the Agreement, (i) all rights granted to you will end immediately; (ii) you must stop using the Services and/or Batteries; and (iii) you must pay Pawa all outstanding amounts. Upon termination, you will lose access to all Services."}),e.jsx("p",{children:"Pawa also has the right to terminate this Agreement and/or suspend your access to its Services with written notice (including email) if: (a) you fail to pay Pawa any amount owed under this Agreement or (b) you violate any terms or conditions of this Agreement. Upon termination of this Agreement for any reason, your access to and use of the Services will end."})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"5. CONFIDENTIALITY"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"5.1 Confidentiality and Privacy Policies"}),e.jsx("p",{children:"You understand and agree that Pawa will keep all personal information it holds about users, including names, addresses, phone numbers, email addresses, passwords, payment information, and other information, in accordance with its privacy policy (found on https://pawatasty.com). However, (i) if you are unable to provide personal information to authorities, Pawa may, at its sole discretion, provide your name, address, phone number, and other information to such authorities; (ii) if Pawa receives a subpoena, it will provide the requested information as required by law; (iii) Pawa may disclose aggregate and other data about you as permitted by law, including general latitude and longitude data for your addresses (as long as this does not allow an individual's address to be identified)."}),e.jsx("p",{className:"mt-3",children:"Pawa may also disclose individual data to a third party with your express permission and consent (e.g. for participation in a study)."})]})]}),e.jsxs("div",{className:"pt-4",children:[e.jsx("h3",{className:"text-base font-bold text-gray-900 mb-4",children:"6. COMMUNICATIONS AND AGREEMENT TO BE CONTACTED"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"6.1."})," You confirm that any contact information provided to Pawa, such as your name, email address, and mobile phone number, is accurate. You also confirm that you are the current subscriber or owner of any phone number provided to Pawa. If your contact information changes, including your phone number, you agree to update it using the Pawa app or website. If you have issues, contact hello@pawatasty.com. You agree to compensate, defend, and hold Pawa harmless from and against any claims, losses, liabilities, costs, and expenses (including reasonable attorneys' fees) arising from your failure to update your contact information, providing a phone number that is not yours, or violating any federal, state, or local law, regulation, or ordinance."]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"6.2."})," By voluntarily providing your phone number(s) to Pawa, you agree to receive text messages related to your registration. Consent to receive automated marketing calls/texts is not a requirement for rental or purchase. You acknowledge that your phone carrier may charge for calls or text messages and that Pawa is not responsible for these charges."]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-semibold",children:"6.3."}),' You agree that Pawa may contact you at the email addresses you provide or obtain from other sources. You agree to receive emails even if you cancel your account or end your relationship with Pawa, unless you opt out. To opt out, email hello@pawatasty.com with the subject "Opt out." It may take up to 30 days to process your opt-out request. You may also use other opt-out methods offered by Pawa on its app or website (if any). It is your responsibility to notify Pawa if you do not want to receive emails by following the opt-out procedures.']})]})]}),e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mt-6",children:[e.jsx("p",{className:"text-xs text-gray-600 text-center",children:"Last Updated: October 21, 2022"}),e.jsx("p",{className:"text-xs text-gray-600 text-center mt-2",children:"For questions or concerns, please contact us at hello@pawatasty.com"})]})]})]})})]})})})}function dx({isOpen:t,onClose:s,onConfirm:a}){const[r,x]=n.useState(!1);n.useEffect(()=>{t&&x(!0)},[t]);const o=()=>{x(!1),setTimeout(()=>{s()},300)},m=()=>{x(!1),setTimeout(()=>{a()},300)};return t?e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:r?"rgba(0, 0, 0, 0.4)":"rgba(0, 0, 0, 0)",backdropFilter:r?"blur(4px)":"blur(0px)",transition:"background-color 300ms ease-out, backdrop-filter 300ms ease-out"},onClick:o,children:e.jsxs("div",{className:"w-full bg-white rounded-t-[2rem] p-6 shadow-2xl",style:{transform:r?"translateY(0)":"translateY(100%)",transition:"transform 300ms ease-out"},onClick:f=>f.stopPropagation(),children:[e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(ca,{className:"w-8 h-8 text-orange-500"})}),e.jsx("p",{className:"text-xl font-bold text-gray-900 text-center",children:"Are you sure you want to log out?"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:o,className:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-800 font-semibold py-3.5 rounded-2xl transition-all",children:"Stay In"}),e.jsx("button",{onClick:m,className:"flex-1 bg-slate-700 hover:bg-slate-800 text-white font-semibold py-3.5 rounded-2xl transition-all shadow-md",children:"Log Out"})]})]})}):null}function mx({onSuccess:t,onError:s,customerName:a,customerEmail:r}){const x=pt(),o=Jt(),[m,f]=n.useState(!1),[g,p]=n.useState(null),[c,l]=n.useState(a||""),[h,u]=n.useState(!1),[b,E]=n.useState(!1),[B,j]=n.useState(null),[v,y]=n.useState(!1),d=n.useRef(!0),i=n.useRef(!1);n.useEffect(()=>(d.current=!0,()=>{d.current=!1}),[]);const C=N=>N.trim()?N.trim().length<2?"Name must be at least 2 characters":/^[a-zA-Z\s'-]+$/.test(N.trim())?null:"Name can only contain letters, spaces, hyphens, and apostrophes":"Cardholder name is required",A=async N=>{var k;if(N.preventDefault(),!i.current)try{if(!x||!o){const I="Payment system not ready. Please try again.";p(I),s(I);return}const P=C(c);if(P){j(P),p(P),s(P);return}if(!h){const I="Please complete your card details";p(I),s(I);return}i.current=!0,d.current&&(f(!0),p(null),j(null));const{data:{session:L},error:$}=await J.auth.getSession();if($)throw new Error(`Authentication error: ${$.message}`);if(!(L!=null&&L.access_token))throw new Error("Not authenticated. Please log in again.");const U=new AbortController,S=setTimeout(()=>U.abort(),3e4);try{const I=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/payment-methods/card-setup",{method:"POST",headers:{Authorization:`Bearer ${L.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({customerName:(c==null?void 0:c.trim())||"",customerEmail:(r==null?void 0:r.trim())||"",amount:50}),signal:U.signal});if(clearTimeout(S),!I.ok){let D;try{D=await I.json()}catch{throw new Error(`Payment setup failed (${I.status})`)}throw new Error((D==null?void 0:D.error)||(D==null?void 0:D.message)||"Failed to create payment")}let M;try{M=await I.json()}catch{throw new Error("Invalid response from payment server")}if(!(M!=null&&M.clientSecret)||!(M!=null&&M.paymentMethodId))throw new Error("Invalid response from server. Please try again.");const H=o.getElement(Ot);if(!H)throw new Error("Card element not found. Please refresh and try again.");const T=await x.confirmCardPayment(M.clientSecret,{payment_method:{card:H,billing_details:{name:(c==null?void 0:c.trim())||"",email:(r==null?void 0:r.trim())||""}}});if(T.error)throw new Error(T.error.message||"Payment failed");if(((k=T.paymentIntent)==null?void 0:k.status)!=="succeeded")throw new Error("Payment was not successful. Please try again.");if(d.current)try{t(M.paymentMethodId)}catch{throw new Error("Payment succeeded but failed to save. Please contact support.")}}catch(I){throw I.name==="AbortError"?new Error("Request timeout. Please check your connection and try again."):I}}catch(P){const L=(P==null?void 0:P.message)||"Failed to set up card payment. Please try again.";d.current&&p(L);try{s(L)}catch{}}finally{i.current=!1,d.current&&f(!1)}},w={style:{base:{fontSize:"16px",color:"#1f2937",fontFamily:'-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',lineHeight:"24px","::placeholder":{color:"#9ca3af"}},invalid:{color:"#ef4444",iconColor:"#ef4444"}},hidePostalCode:!1},F=c.trim().length>=2&&!C(c)&&h&&x&&o;return e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"First Payment: â‚¬0.50"}),e.jsx("br",{}),"This initial charge verifies your card and enables automatic subscription payments."]})}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cardholder Name",a&&e.jsx("span",{className:"text-xs text-gray-500 ml-2",children:"(from your profile)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:c,onChange:N=>{l(N.target.value),y(!0);const k=C(N.target.value);j(k),k||p(null)},onBlur:()=>y(!0),placeholder:"John Doe",className:`w-full px-4 py-3 pr-10 border rounded-xl focus:ring-2 focus:border-transparent transition-all ${v&&B?"border-red-300 focus:ring-red-500":v&&c.trim()&&!B?"border-green-300 focus:ring-green-500":"border-gray-300 focus:ring-slate-500"}`,disabled:m,required:!0}),v&&c.trim()&&!B&&e.jsx(ys,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-500"}),v&&B&&e.jsx(Ie,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-red-500"})]}),v&&B&&e.jsx("p",{className:"mt-1 text-xs text-red-600",children:B}),a&&!v&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"You can edit this if needed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Card Details"}),x?e.jsx("div",{className:`w-full px-4 py-3 bg-white border rounded-xl focus-within:ring-2 focus-within:border-transparent min-h-[44px] transition-all ${h?"border-green-300 focus-within:ring-green-500":"border-gray-300 focus-within:ring-slate-500"}`,children:e.jsx(Ot,{options:w,onReady:()=>{try{E(!0)}catch{}},onChange:N=>{try{u(N.complete),N.error?p(N.error.message):B||p(null)}catch{}}})}):e.jsx("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-300 rounded-xl",children:e.jsx("p",{className:"text-sm text-gray-500",children:"Loading payment form..."})}),e.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"For testing, use card: 4242 4242 4242 4242"})]}),g&&!B&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:g})]}),e.jsx("button",{type:"submit",disabled:m||!F,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-2xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx(Re,{className:"w-5 h-5 animate-spin"}),"Processing Payment..."]}):"Pay â‚¬0.50 & Set Up Card"})]})}function ux({onSuccess:t,onError:s,customerName:a,customerEmail:r}){const x=pt(),o=Jt(),[m,f]=n.useState(null),[g,p]=n.useState(!1),[c,l]=n.useState(!1),[h,u]=n.useState(null),[b,E]=n.useState(null),[B,j]=n.useState([]);return n.useEffect(()=>{const v=window.location.protocol==="https:",y=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";if(!x||!o)return;if(!v&&!y){E("Digital wallets require a secure HTTPS connection. Apple Pay will not be available.");return}y&&E("Apple Pay requires HTTPS and domain verification. Only Google Pay may be available in development.");const d=x.paymentRequest({country:"NL",currency:"eur",total:{label:"Payment Method Setup",amount:50},requestPayerName:!0,requestPayerEmail:!0});return d.canMakePayment().then(i=>{if(i){const C=[];i.applePay&&C.push("Apple Pay"),i.googlePay&&C.push("Google Pay"),j(C),f(d),p(!0),y&&!i.applePay&&i.googlePay?E("Google Pay is available. Apple Pay requires HTTPS domain verification and will only work in production."):y&&i.applePay&&E(null)}else E("No digital wallets (Apple Pay / Google Pay) are available on this device or browser.")}).catch(i=>{E("Unable to check digital wallet availability. Please use card payment.")}),d.on("paymentmethod",async i=>{var C;l(!0),u(null);try{const{data:{session:A}}=await J.auth.getSession();if(!A)throw new Error("Not authenticated");const w=await fetch("https://dopjawhuylqipltnuydp.supabase.co/functions/v1/payment-methods/payment-request-setup",{method:"POST",headers:{Authorization:`Bearer ${A.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({customerName:a,customerEmail:r,amount:50})});if(!w.ok){const k=await w.json();throw new Error(k.error||"Failed to create payment")}const F=await w.json();if(!F.clientSecret||!F.paymentMethodId)throw new Error("Invalid response from server");const N=await x.confirmCardPayment(F.clientSecret,{payment_method:i.paymentMethod.id},{handleActions:!1});if(N.error)throw new Error(N.error.message||"Payment failed");if(((C=N.paymentIntent)==null?void 0:C.status)==="succeeded")i.complete("success"),t(F.paymentMethodId);else throw new Error("Payment was not successful")}catch(A){const w=A.message||"Failed to set up payment method";u(w),s(w),i.complete("fail"),l(!1)}}),()=>{d.abort()}},[x,o,t,s,a,r]),!g||!m?b?e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-xl flex items-start gap-2",children:[e.jsx(nt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-blue-900 font-medium",children:"Digital Wallet Information"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:b})]})]}):null:e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"First Payment: â‚¬0.50"}),e.jsx("br",{}),"This initial charge verifies your payment method and enables automatic subscription payments."]})}),h&&e.jsxs("div",{className:"p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:h})]}),b&&!h&&e.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-xl flex items-start gap-2",children:[e.jsx(nt,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-blue-700",children:b}),B.length>0&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:["Available: ",B.join(", ")]})]})]}),c?e.jsxs("div",{className:"flex items-center justify-center gap-2 p-4 bg-gray-50 rounded-xl",children:[e.jsx(Re,{className:"w-5 h-5 animate-spin text-orange-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Processing payment..."})]}):e.jsx("div",{className:"payment-request-button",children:e.jsx(Ra,{options:{paymentRequest:m,style:{paymentRequestButton:{type:"default",theme:"dark",height:"48px"}}}})})]})}function hx({onClose:t,onSuccess:s,userProfile:a}){const[r,x]=n.useState("card"),[o]=n.useState(()=>{try{return qa()}catch{return Promise.resolve(null)}}),[m,f]=n.useState(!0),[g,p]=n.useState(!1),[c,l]=n.useState(null),[h,u]=n.useState(null),[b,E]=n.useState(!1),[B,j]=n.useState(!1),[v,y]=n.useState(""),[d,i]=n.useState(""),[C,A]=n.useState(""),[w,F]=n.useState(""),[N,k]=n.useState(null),[P,L]=n.useState(null),[$,U]=n.useState(null),[S,I]=n.useState(null),{showSuccess:M,showError:H}=qe(),T=n.useRef(!0);n.useEffect(()=>(T.current=!0,()=>{T.current=!1}),[]),n.useEffect(()=>{if(a){if(a.full_name&&(y(a.full_name),A(a.full_name)),a.email&&(i(a.email),F(a.email)),a.phone_nr){const _=At(a.phone_nr);_&&u(_.code)}E(!0),j(!0)}else fa.getProfile().then(_=>{if(_!=null&&_.full_name&&(y(_.full_name),A(_.full_name)),_!=null&&_.email&&(i(_.email),F(_.email)),_!=null&&_.phone){const W=At(_.phone);W&&(u(W.code),E(!0),j(!0))}}).catch(_=>{})},[a]);const D=async _=>{if(T.current){!g&&T.current&&p(!0);try{if(!_)throw new Error("Invalid payment method ID");const W=await De.savePaymentMethod({type:"card",stripePaymentMethodId:_,isPrimary:m});if(!T.current)return;try{M("Payment method added successfully")}catch{}if(await new Promise(ne=>setTimeout(ne,300)),!T.current)return;try{typeof s=="function"&&s()}catch{}try{typeof t=="function"&&t()}catch{}}catch(W){if(!T.current)return;const ne=(W==null?void 0:W.message)||"Failed to save payment method. Please try again.";try{l(ne),H(ne),U(null),p(!1)}catch{}}}},R=_=>{l(_),H(_),U(null)},Z=async _=>{if(_.preventDefault(),!g){l(null),p(!0);try{if(r==="card"){if(!(C!=null&&C.trim()))throw new Error("Please enter the cardholder name.");U({paymentMethodId:"temp"})}else if(r==="bancontact"){if(!(v!=null&&v.trim()))throw new Error("Your profile name is required for Bancontact. Please complete your profile first.");if(!(d!=null&&d.trim()))throw new Error("Your profile email is required for Bancontact. Please complete your profile first.");const W=await De.savePaymentMethod({type:r,cardholderName:v.trim(),isPrimary:m});if(!W)throw new Error("No response from server");if(W.requiresAction&&W.clientSecret&&W.setupIntentId&&W.paymentMethodId)L({clientSecret:W.clientSecret,setupIntentId:W.setupIntentId,paymentMethodId:W.paymentMethodId});else throw new Error("Failed to initialize Bancontact setup")}else if(r==="ideal"){if(!(v!=null&&v.trim()))throw new Error("Your profile name is required for iDEAL. Please complete your profile first.");if(!(d!=null&&d.trim()))throw new Error("Your profile email is required for iDEAL. Please complete your profile first.");const W=await De.savePaymentMethod({type:r,cardholderName:v.trim(),isPrimary:m});if(!W)throw new Error("No response from server");if(W.requiresAction&&W.clientSecret&&W.setupIntentId&&W.paymentMethodId)k({clientSecret:W.clientSecret,setupIntentId:W.setupIntentId,paymentMethodId:W.paymentMethodId});else try{s(),t()}catch{}}}catch(W){const ne=(W==null?void 0:W.message)||"Failed to add payment method. Please try again.";l(ne),H(ne)}finally{p(!1)}}},O=()=>{try{M("Payment method added successfully"),s(),t()}catch{H("Failed to complete iDEAL setup")}},V=_=>{try{l(_),H(_),k(null)}catch{}},q=async _=>{try{if(!(C!=null&&C.trim())){const W="Please enter your name to continue.";l(W),H(W);return}I({paymentMethodId:"temp"})}catch{H("Failed to process payment request")}},z=_=>{try{l(_),H(_)}catch{}};return S?e.jsx("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm z-[60] flex items-end",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-col items-center mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Apple Pay / Google Pay"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Complete your first payment and we'll set up automatic payments"})]})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:o,children:e.jsx(ux,{customerName:C,customerEmail:w,onSuccess:_=>{try{I(null),M("Payment method added successfully"),s(),t()}catch{H("Failed to complete payment setup")}},onError:_=>{try{l(_),H(_),I(null)}catch{}}})})})]})}):$?e.jsx("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm z-[60] flex items-end",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsxs("div",{className:"flex flex-col items-center mb-2",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Card"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:"Complete your first payment and we'll set up automatic payments"})]})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:o,children:e.jsx(mx,{customerName:C,customerEmail:w,onSuccess:_=>{try{U(null),M("Payment method added successfully"),s(),t()}catch{H("Failed to complete card setup")}},onError:_=>{try{l(_),H(_),U(null)}catch{}}})})})]})}):P?e.jsx("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm z-[60] flex items-end",onClick:()=>L(null),children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Complete via Bancontact"})})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:o,children:e.jsx(Ya,{clientSecret:P.clientSecret,setupIntentId:P.setupIntentId,paymentMethodId:P.paymentMethodId,customerName:v,customerEmail:d,onSuccess:()=>{try{L(null),M("Payment method added successfully"),s(),t()}catch{H("Failed to complete Bancontact setup")}},onError:_=>{try{l(_),H(_),L(null)}catch{}}})})})]})}):N?e.jsx("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm z-[60] flex items-end",onClick:()=>k(null),children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Complete via iDEAL"})})}),e.jsx("div",{className:"px-5 py-5",children:e.jsx(Ye,{stripe:o,children:e.jsx(Ga,{clientSecret:N.clientSecret,setupIntentId:N.setupIntentId,paymentMethodId:N.paymentMethodId,customerName:v,customerEmail:d,onSuccess:O,onError:V})})})]})}):e.jsx("div",{className:"fixed inset-0 bg-black/10 backdrop-blur-sm z-[60] flex items-end",onClick:t,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md mx-auto shadow-2xl relative animate-slide-up max-h-[92vh] overflow-y-auto",onClick:_=>_.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white rounded-t-3xl z-10 px-5 pt-5 pb-3 border-b border-gray-100",children:e.jsx("div",{className:"flex items-center justify-center mb-2",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Payment Method"})})}),e.jsxs("form",{onSubmit:Z,className:"px-5 py-5",children:[e.jsx(Ye,{stripe:o,children:e.jsx(Wa,{onSuccess:q,onError:z,loading:g,setLoading:p})}),e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("div",{className:"flex-1 h-px bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-500",children:"or add"}),e.jsx("div",{className:"flex-1 h-px bg-gray-300"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-6",children:[e.jsx("button",{type:"button",onClick:()=>x("card"),className:`py-3 rounded-xl font-medium transition-all ${r==="card"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsx("span",{className:"text-xs",children:"Card"})]})}),e.jsx("button",{type:"button",onClick:()=>x("ideal"),className:`py-3 rounded-xl font-medium transition-all ${r==="ideal"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-5 h-5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 576 512",children:e.jsx("path",{fill:"currentColor",d:"M125.61 165.48a49.07 49.07 0 1 0 49.06 49.06a49.08 49.08 0 0 0-49.06-49.06M86.15 425.84h78.94V285.32H86.15Zm151.46-211.6c0-20-10-22.53-18.74-22.53h-14.05v45.79h14.05c9.75 0 18.74-2.81 18.74-23.26m201.69 46v-91.31h22.75v68.57h33.69C486.5 113.08 388.61 86.19 299.67 86.19h-94.83V169h14c25.6 0 41.5 17.35 41.5 45.26c0 28.81-15.52 46-41.5 46h-14v165.62h94.83c144.61 0 194.94-67.16 196.72-165.64Zm-109.75 0H273.3V169h54.43v22.73H296v10.58h30V225h-30v12.5h33.51Zm74.66 0l-5.16-17.67h-29.74l-5.18 17.67h-23.66L368 168.92h32.35l27.53 91.34ZM299.65 32H32v448h267.65c161.85 0 251-79.73 251-224.52C550.62 172 518 32 299.65 32m0 426.92H53.07V53.07h246.58c142.1 0 229.9 64.61 229.9 202.41c0 134.09-81 203.44-229.9 203.44m83.86-264.85L376 219.88h16.4l-7.52-25.81Z"})})}),e.jsx("span",{className:"text-xs",children:"iDEAL"})]})}),e.jsx("button",{type:"button",onClick:()=>x("bancontact"),className:`py-3 rounded-xl font-medium transition-all ${r==="bancontact"?"bg-slate-700 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-1",children:[e.jsx("div",{className:"w-5 h-5",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"currentColor",d:"M28.516 13.027h-9.433l-5.723 6.692H2.079l3.041-3.583H1.495c-.823 0-1.495.687-1.495 1.531v3.24c0 .843.672 1.531 1.495 1.531H18.74c.823 0 1.948-.511 2.5-1.14l2.609-2.964l4.624-5.26zm-1.5 1.702l-1 1.14zm3.489-5.166H13.306c-.823 0-1.947.511-2.5 1.135l-7.317 8.281h9.396l5.823-6.692h11.229l-3.016 3.583h3.584c.823 0 1.495-.692 1.495-1.536v-3.235c0-.844-.672-1.536-1.495-1.536m-2.494 4.03l-.5.568l-.131.156z"})})}),e.jsx("span",{className:"text-xs",children:"Bancontact"})]})})]}),r==="card"&&e.jsx("div",{className:"mb-6",children:e.jsx(Ye,{stripe:o,children:e.jsx(Ha,{onSuccess:D,onError:R,loading:g,setLoading:p,initialCardholderName:C})})}),r==="ideal"&&e.jsx("div",{className:"space-y-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Holder Name"}),e.jsx("input",{type:"text",value:v,onChange:_=>y(_.target.value),placeholder:"Enter account holder name...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-slate-500"})]})}),r==="bancontact"&&e.jsx("div",{className:"space-y-4 mb-6",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Holder Name"}),e.jsx("input",{type:"text",value:v,onChange:_=>y(_.target.value),placeholder:"Enter account holder name...",className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-slate-500 focus:border-slate-500"})]})}),r!=="card"&&e.jsxs(e.Fragment,{children:[c&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-xl flex items-start gap-2",children:[e.jsx(Ie,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),e.jsx("p",{className:"text-sm text-red-600",children:c})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx("input",{type:"checkbox",id:"saveCard",checked:m,onChange:_=>f(_.target.checked),className:"w-4 h-4 text-slate-700 border-gray-300 rounded focus:ring-slate-500"}),e.jsx("label",{htmlFor:"saveCard",className:"text-sm text-gray-700",children:"Set as primary payment method"})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white font-bold py-4 rounded-2xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:g?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Adding..."]}):"Add Payment Method"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4 text-xs text-gray-500",children:[e.jsx(ws,{className:"w-3 h-3"}),e.jsx("span",{children:"Your payment information is secure and encrypted"})]})]})]})]})})}function fx({isOpen:t,onClose:s,onConfirm:a,paymentMethod:r,isDeleting:x}){if(!t||!r)return null;const o=()=>{if(r.type==="ideal")return`iDEAL â€¢â€¢â€¢â€¢ ${r.lastFour}`;if(r.type==="paypal")return`PayPal - ${r.email}`;let f=`${r.cardBrand?r.cardBrand.charAt(0).toUpperCase()+r.cardBrand.slice(1):"Card"} â€¢â€¢â€¢â€¢ ${r.lastFour}`;return r.expiryMonth&&r.expiryYear&&(f+=` - Expires ${String(r.expiryMonth).padStart(2,"0")}/${String(r.expiryYear).slice(-2)}`),f};return e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[60] flex items-end justify-center animate-fadeIn",children:e.jsx("div",{className:"bg-white rounded-t-3xl w-full max-w-md overflow-hidden shadow-xl animate-slideUp",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx(Bs,{className:"w-6 h-6 text-red-600"})}),e.jsx("button",{onClick:s,disabled:x,className:"p-2 hover:bg-gray-100 rounded-full transition-colors disabled:opacity-50",children:e.jsx(we,{className:"w-6 h-6 text-gray-500"})})]}),e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Delete Payment Method?"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to delete this payment method?"}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 mb-6",children:[e.jsx("p",{className:"text-gray-900 font-medium",children:o()}),r.cardholderName&&e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:r.cardholderName})]}),e.jsx("p",{className:"text-red-600 text-sm font-medium mb-6",children:"This action cannot be undone."}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:s,disabled:x,className:"flex-1 bg-gray-100 text-gray-900 font-semibold py-3 rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:a,disabled:x,className:"flex-1 bg-red-600 text-white font-semibold py-3 rounded-xl hover:bg-red-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:x?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Deleting..."]}):"Delete"})]})]})})})}function gx({onClose:t,userProfile:s}){var Z,O;const[a,r]=n.useState([]),[x,o]=n.useState(!0),[m,f]=n.useState(null),[g,p]=n.useState(!1),[c,l]=n.useState(null),[h,u]=n.useState(null),[b,E]=n.useState(!1),[B,j]=n.useState(null),[v,y]=n.useState(null),[d,i]=n.useState(null),[C,A]=n.useState(!1),[w,F]=n.useState(null),{showSuccess:N,showError:k}=qe(),P=async()=>{try{o(!0),f(null);const q=(await De.getPaymentMethods()).paymentMethods||[];r(q);const z=q.find(_=>_.isPrimary);z?y(z.id):q.length>0&&y(q[0].id)}catch(V){const q=V instanceof Error?V.message:"Failed to load payment methods";q.includes("Not authenticated")?f("Please log in to view your payment methods"):q.includes("Failed to fetch")?f("Unable to connect to server. Please check your internet connection and try again."):f("Unable to load payment methods. Please try again.")}finally{o(!1)}};n.useEffect(()=>{P()},[]);const L=V=>{F(V),A(!0),i(null)},$=async()=>{if(w)try{u(w.id),await De.setDefaultPaymentMethod(w.id),A(!1),F(null),await P(),N("Payment method updated successfully")}catch{k("Failed to set as primary. Please try again.")}finally{u(null)}},U=V=>{j(V),E(!0),i(null)},S=async()=>{if(!B)return;const V=B.isPrimary;try{if(l(B.id),await De.deletePaymentMethod(B.id),E(!1),j(null),await P(),V){const q=a.filter(z=>z.id!==B.id);if(q.length>0)try{await De.setDefaultPaymentMethod(q[0].id),await P()}catch{}}N("Payment method deleted")}catch{k("Failed to delete payment method. Please try again.")}finally{l(null)}},I=async()=>{p(!1),await P()},M=V=>{if(V.email){const q=V.email.split("@");if(q.length===2){const[z,_]=q;if(z&&z.length<=3)return V.email;if(z&&_)return`${z.slice(0,3)}...@${_}`}}return V.cardholderName?V.cardholderName.length<=15?V.cardholderName:V.cardholderName.slice(0,15)+"...":`****${V.lastFour}`},H=V=>{var _;const q=(_=V.cardBrand)==null?void 0:_.toLowerCase(),z=V.type;return q==="visa"?{card:"bg-gradient-to-br from-blue-600 via-blue-700 to-blue-900",circle1:"bg-blue-500/30",circle2:"bg-blue-400/20"}:q==="mastercard"?{card:"bg-gradient-to-br from-red-600 via-orange-600 to-red-800",circle1:"bg-orange-500/30",circle2:"bg-red-400/20"}:z==="googlepay"?{card:"bg-gradient-to-br from-blue-600 via-green-600 to-blue-700",circle1:"bg-green-500/30",circle2:"bg-blue-400/20"}:z==="applepay"?{card:"bg-gradient-to-br from-gray-900 via-black to-gray-900",circle1:"bg-gray-700/30",circle2:"bg-gray-600/20"}:z==="bancontact"?{card:"bg-gradient-to-br from-blue-700 via-blue-800 to-blue-900",circle1:"bg-blue-600/30",circle2:"bg-blue-500/20"}:z==="sepa_debit"?{card:"bg-gradient-to-br from-blue-900 via-blue-950 to-indigo-950",circle1:"bg-blue-800/30",circle2:"bg-blue-700/20"}:{card:"bg-gradient-to-br from-slate-700 via-slate-600 to-slate-800",circle1:"bg-slate-600/30",circle2:"bg-slate-500/20"}},T=(V,q="normal")=>{var W;const z=q==="large"?"w-16 h-16":"w-10 h-10";if(V.type==="googlepay")return e.jsx("div",{className:`${z} bg-white rounded-lg flex items-center justify-center shadow-sm border border-gray-200`,children:e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:q==="large"?"38":"24",height:q==="large"?"16":"10",viewBox:"0 0 512 204",children:[e.jsx("path",{fill:"#5f6368",d:"M362.927 55.057c14.075 0 24.952 3.839 33.27 11.517c8.317 7.677 12.155 17.914 12.155 30.71v61.42h-17.914V144.63h-.64c-7.677 11.517-18.554 17.275-31.35 17.275c-10.877 0-20.474-3.2-28.151-9.597c-7.038-6.398-11.517-15.355-11.517-24.952q0-15.356 11.517-24.953c7.677-6.398 18.554-8.957 31.35-8.957c11.516 0 20.474 1.92 27.511 6.398v-4.478c0-5.972-2.229-11.943-6.688-15.834l-.99-.801c-5.118-4.479-11.516-7.038-18.553-7.038q-16.315 0-24.953 13.436L321.34 74.89c10.236-13.436 23.672-19.834 41.587-19.834M272.715 11.55c11.48 0 22.39 3.995 31.113 11.445l1.517 1.35c8.957 7.678 13.435 19.195 13.435 31.351s-4.478 23.033-13.435 31.35s-19.834 12.796-32.63 12.796l-30.71-.64v59.502H222.81V11.55zm92.77 97.25q-11.516 0-19.193 5.758q-7.678 4.798-7.678 13.435c0 5.119 2.56 9.597 6.398 12.157c4.479 3.199 9.597 5.118 14.716 5.118c7.165 0 14.331-2.787 19.936-7.84l1.177-1.117c6.398-5.758 9.597-12.796 9.597-20.474c-5.758-4.478-14.076-7.038-24.952-7.038m-91.49-79.336h-31.99V80.65h31.99c7.037 0 14.075-2.559 18.554-7.677c10.236-9.597 10.236-25.592.64-35.19l-.64-.64c-5.119-5.118-11.517-8.317-18.555-7.677M512 58.256l-63.34 145.235h-19.194l23.672-50.544l-41.587-94.051h20.474l30.07 72.297h.64l29.431-72.297H512z"}),e.jsx("path",{fill:"#4285f4",d:"M165.868 86.407c0-5.758-.64-11.516-1.28-17.274H84.615v32.63h45.425c-1.919 10.236-7.677 19.833-16.634 25.592v21.113h27.511c15.995-14.715 24.952-36.469 24.952-62.06"}),e.jsx("path",{fill:"#34a853",d:"M84.614 168.942c23.032 0 42.226-7.678 56.302-20.474l-27.511-21.113c-7.678 5.118-17.275 8.317-28.791 8.317c-21.754 0-40.948-14.715-47.346-35.189H9.118v21.753c14.715 28.791 43.506 46.706 75.496 46.706"}),e.jsx("path",{fill:"#fbbc04",d:"M37.268 100.483c-3.838-10.237-3.838-21.753 0-32.63V46.1H9.118c-12.157 23.673-12.157 51.824 0 76.136z"}),e.jsx("path",{fill:"#ea4335",d:"M84.614 33.304c12.156 0 23.672 4.479 32.63 12.796l24.312-24.312C126.2 7.712 105.727-.605 85.253.034c-31.99 0-61.42 17.915-75.496 46.706l28.151 21.753c5.758-20.474 24.952-35.189 46.706-35.189"})]})});if(V.type==="applepay")return e.jsx("div",{className:`${z} bg-black rounded-lg flex items-center justify-center`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:q==="large"?"32":"20",height:q==="large"?"32":"20",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"white",d:"M5.849 11.047c-.376.448-.975.803-1.573.751c-.079-.604.219-1.251.563-1.652c.375-.457 1.031-.785 1.563-.812c.063.631-.183 1.251-.552 1.713zm.547.87c-.869-.053-1.615.499-2.027.499c-.421 0-1.052-.473-1.739-.457c-.891.011-1.724.52-2.177 1.339c-.943 1.629-.245 4.041.661 5.369c.443.656.973 1.375 1.672 1.355c.661-.027.927-.437 1.724-.437c.807 0 1.036.437 1.74.421c.723-.011 1.181-.656 1.624-1.312c.505-.745.713-1.475.724-1.511c-.011-.016-1.401-.552-1.411-2.167c-.011-1.355 1.093-2 1.14-2.037c-.62-.937-1.599-1.036-1.932-1.061zm5.016-1.834v9.855h1.515v-3.369h2.095c1.911 0 3.255-1.328 3.255-3.245c0-1.921-1.317-3.24-3.203-3.24zm1.515 1.292h1.745c1.312 0 2.063.708 2.063 1.953s-.751 1.959-2.073 1.959h-1.735zm8.109 8.636c.953 0 1.833-.484 2.235-1.256h.032v1.183h1.4v-4.907c0-1.416-1.124-2.337-2.859-2.337c-1.604 0-2.792.932-2.833 2.208h1.359c.115-.609.667-1.005 1.433-1.005c.927 0 1.443.437 1.443 1.24v.541l-1.885.115c-1.761.109-2.709.833-2.709 2.099c0 1.276.98 2.12 2.385 2.12zm.412-1.167c-.808 0-1.323-.391-1.323-.989c0-.62.495-.985 1.437-1.043l1.683-.104v.557c0 .923-.776 1.579-1.803 1.579zm5.125 3.776c1.473 0 2.167-.573 2.771-2.297L32 12.792h-1.536l-1.781 5.817h-.032l-1.781-5.817h-1.583l2.563 7.172l-.136.437c-.235.735-.609 1.02-1.276 1.02c-.12 0-.349-.015-.443-.025v1.183c.088.025.464.036.573.036z"})})});if(V.type==="bancontact")return e.jsx("div",{className:`${z} bg-blue-600 rounded-lg flex items-center justify-center`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:q==="large"?"32":"20",height:q==="large"?"32":"20",viewBox:"0 0 32 32",children:e.jsx("path",{fill:"white",d:"M28.516 13.027h-9.433l-5.723 6.692H2.079l3.041-3.583H1.495c-.823 0-1.495.687-1.495 1.531v3.24c0 .843.672 1.531 1.495 1.531H18.74c.823 0 1.948-.511 2.5-1.14l2.609-2.964l4.624-5.26zm-1.5 1.702l-1 1.14zm3.489-5.166H13.306c-.823 0-1.947.511-2.5 1.135l-7.317 8.281h9.396l5.823-6.692h11.229l-3.016 3.583h3.584c.823 0 1.495-.692 1.495-1.536v-3.235c0-.844-.672-1.536-1.495-1.536m-2.494 4.03l-.5.568l-.131.156z"})})});if(V.type==="sepa_debit")return e.jsx("div",{className:`${z} bg-blue-900 rounded-lg flex items-center justify-center`,children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:q==="large"?"32":"20",height:q==="large"?"32":"20",viewBox:"0 0 24 24",children:e.jsx("path",{fill:"white",d:"M12.553 8.72v6.56h1.766v-1.694h1.052l.293-.01q.868-.013.984-.033q.985-.13 1.3-.994q.16-.436.16-1.434q0-.83-.145-1.243q-.277-.786-1.09-1.04q-.354-.111-1.031-.111zm6.79 0l-1.971 6.56h1.826l.317-1.134h2.36l.337 1.133H24l-1.995-6.558zm-9.339.031a3.36 3.36 0 0 0-1.888.574a3.27 3.27 0 0 0-1.199 1.455h-.742l-.464.996h.969a3 3 0 0 0 .004.526h-.467l-.465.995H6.94a3.33 3.33 0 0 0 3.064 1.973a3.37 3.37 0 0 0 1.876-.564l.013-.009v-1.241l-.05.056a2.293 2.293 0 0 1-3.618-.215h2.396l.465-.995H7.838a2.4 2.4 0 0 1-.012-.526h3.505l.008-.017l.438-.939l.019-.04H8.154a2.31 2.31 0 0 1 1.963-1.108c.694 0 1.344.31 1.783.85l.028.035l.409-.875l-.015-.014a3.36 3.36 0 0 0-2.318-.917m-7.2.004q-.658 0-1.196.048q-.646.051-1.062.348a1.1 1.1 0 0 0-.41.565q-.128.372-.128.99q0 .81.236 1.21q.269.47 1.074.621q.308.052 1.094.109q.981.066 1.098.103q.316.095.316.528a1.1 1.1 0 0 1-.037.315a.48.48 0 0 1-.298.287q-.127.048-.589.048h-.604a1 1 0 0 1-.41-.09q-.246-.121-.246-.549v-.136H0q0 .8.118 1.143q.213.618.879.82q.543.165 1.922.164q.826 0 1.228-.075q.96-.18 1.233-.853q.151-.368.151-1.16q0-.344-.033-.617a1.2 1.2 0 0 0-.355-.74q-.379-.363-1.22-.448q-.265-.028-1.33-.1l-.331-.023a.8.8 0 0 1-.35-.094q-.185-.113-.185-.471q0-.396.208-.514t.852-.118q.661 0 .808.205q.095.138.095.542h1.642q.016-.217.016-.326q0-1.325-1.072-1.613q-.44-.119-1.473-.119zm17.894 1.27l.827 2.843h-1.63zm-6.38.13h1.116q.27 0 .342.01q.36.063.456.345q.067.201.067.617a3 3 0 0 1-.033.512q-.053.258-.21.344q-.114.063-.637.082h-1.1Z"})})});const _=(W=V.cardBrand)==null?void 0:W.toLowerCase();return _==="visa"?e.jsx("div",{className:`bg-white rounded-lg ${q==="large"?"px-4 py-3":"px-3 py-2"} shadow-sm border border-gray-200`,children:e.jsx("span",{className:`text-blue-600 font-bold ${q==="large"?"text-2xl":"text-lg"}`,children:"VISA"})}):_==="mastercard"?e.jsx("div",{className:`${z} rounded-lg flex items-center justify-center`,children:e.jsxs("div",{className:"flex gap-[-4px]",children:[e.jsx("div",{className:`${q==="large"?"w-8 h-8":"w-6 h-6"} bg-red-500 rounded-full`}),e.jsx("div",{className:`${q==="large"?"w-8 h-8 -ml-3":"w-6 h-6 -ml-2"} bg-yellow-500 rounded-full`})]})}):e.jsx("div",{className:`${z} bg-gray-200 rounded-lg flex items-center justify-center`,children:e.jsx(Ve,{className:`${q==="large"?"w-8 h-8":"w-5 h-5"} text-gray-600`})})},D=a.find(V=>V.isPrimary)||a[0],R=a.filter(V=>V.id!==(D==null?void 0:D.id));return g?e.jsx(hx,{onClose:()=>p(!1),onSuccess:I,userProfile:s}):e.jsxs("div",{className:"fixed inset-0 bg-white z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto pb-32",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-white",children:[e.jsxs("div",{className:"sticky top-0 bg-white z-10 px-6 py-4 flex items-center justify-between",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-900"})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Payment"}),e.jsx("button",{onClick:t,className:"p-2 -mr-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-6 h-6 text-gray-900"})})]}),e.jsx("div",{className:"px-6 pt-6 space-y-6",children:x?e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"h-48 bg-gray-200 rounded-3xl animate-pulse"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-20 bg-gray-200 rounded-2xl animate-pulse"}),e.jsx("div",{className:"h-20 bg-gray-200 rounded-2xl animate-pulse"})]})]}):m?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ie,{className:"w-16 h-16 text-red-500 mx-auto mb-6"}),e.jsx("h3",{className:"text-gray-900 font-bold text-xl mb-3",children:m.includes("log in")?"Authentication Required":"Something went wrong"}),e.jsx("p",{className:"text-gray-600 text-sm mb-8",children:m}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("button",{onClick:P,className:"w-full bg-slate-700 text-white px-6 py-3.5 rounded-xl hover:bg-slate-800 transition-colors font-medium shadow-md",children:"Retry"}),e.jsxs("button",{onClick:()=>p(!0),className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white px-8 py-3.5 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all font-medium shadow-lg flex items-center justify-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"Add Payment Method"]})]})]}):a.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(Ve,{className:"w-10 h-10 text-gray-400"})}),e.jsx("h3",{className:"text-gray-900 font-bold text-xl mb-3",children:"No payment methods"}),e.jsx("p",{className:"text-gray-600 text-sm mb-8",children:"Add a payment method to continue"}),e.jsx("button",{onClick:()=>p(!0),className:"bg-gradient-to-r from-orange-400 to-orange-500 text-white px-10 py-3.5 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all font-medium shadow-lg",children:"Add Payment Method"})]}):e.jsxs(e.Fragment,{children:[D&&e.jsxs("div",{className:`relative h-48 ${H(D).card} rounded-3xl p-6 overflow-hidden shadow-xl`,children:[e.jsx("div",{className:`absolute top-0 right-0 w-64 h-64 ${H(D).circle1} rounded-full -mr-32 -mt-32`}),e.jsx("div",{className:`absolute bottom-0 right-0 w-48 h-48 ${H(D).circle2} rounded-full -mr-16 -mb-16`}),e.jsxs("div",{className:"absolute top-4 right-4 z-20",children:[e.jsx("button",{onClick:()=>i(d===D.id?null:D.id),className:"p-2 hover:bg-white/10 rounded-xl transition-colors",children:e.jsx(Ps,{className:"w-5 h-5 text-white"})}),d===D.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(null)}),e.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden z-50",children:e.jsxs("button",{onClick:()=>U(D),className:"w-full px-4 py-3 text-left text-red-600 hover:bg-red-50 transition-colors flex items-center gap-3",children:[e.jsx(Rt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Delete Card"})]})})]})]}),e.jsxs("div",{className:"relative z-10 h-full flex flex-col justify-between",children:[e.jsx("div",{children:e.jsx("p",{className:"text-white/90 text-sm font-medium mb-1",children:D.type==="card"?"Credit Card":D.type==="applepay"?"Apple Pay":D.type==="googlepay"?"Google Pay":D.type==="bancontact"?"Bancontact":D.type==="sepa_debit"?"SEPA Direct Debit":"Payment Method"})}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-white text-2xl font-semibold tracking-wider mb-3",children:["**** **** **** ",D.lastFour]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-white font-medium",children:M(D)}),((Z=D.cardBrand)==null?void 0:Z.toLowerCase())==="mastercard"&&e.jsxs("div",{className:"flex gap-[-8px]",children:[e.jsx("div",{className:"w-8 h-8 bg-red-500 rounded-full"}),e.jsx("div",{className:"w-8 h-8 bg-yellow-500 rounded-full -ml-3"})]}),((O=D.cardBrand)==null?void 0:O.toLowerCase())==="visa"&&e.jsx("div",{className:"bg-white rounded px-2 py-1",children:e.jsx("span",{className:"text-blue-600 font-bold text-sm",children:"VISA"})})]})]})]})]}),R.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-gray-900 font-bold text-lg",children:"Alternative"}),R.map(V=>e.jsxs("div",{className:"flex items-center gap-4 p-4 rounded-2xl bg-gradient-to-br from-gray-50 to-gray-100 relative",children:[e.jsxs("div",{className:"flex-1 flex items-center gap-4",children:[T(V),e.jsxs("div",{className:"flex-1 text-left",children:[e.jsxs("p",{className:"text-gray-900 font-semibold",children:["**** ",V.lastFour]}),e.jsx("p",{className:"text-gray-600 text-sm",children:M(V)})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>i(d===V.id?null:V.id),className:"p-3 hover:bg-gray-200 rounded-xl transition-colors",children:e.jsx(Ps,{className:"w-5 h-5 text-gray-600"})}),d===V.id&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-40",onClick:()=>i(null)}),e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-200 overflow-hidden z-50",children:[e.jsxs("button",{onClick:()=>L(V),className:"w-full px-4 py-3 text-left text-gray-900 hover:bg-gray-50 transition-colors flex items-center gap-3",children:[e.jsx(Ve,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"font-medium",children:"Set Primary"})]}),e.jsxs("button",{onClick:()=>U(V),className:"w-full px-4 py-3 text-left text-red-600 hover:bg-red-50 transition-colors flex items-center gap-3 border-t border-gray-100",children:[e.jsx(Rt,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:"Delete Card"})]})]})]})]})]},V.id))]}),e.jsxs("button",{onClick:()=>p(!0),className:"w-full border-2 border-dashed border-gray-300 text-gray-700 font-semibold py-5 rounded-2xl hover:border-slate-700 hover:text-slate-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(cs,{className:"w-5 h-5"}),"Add new card"]})]})})]})}),e.jsx(fx,{isOpen:b,onClose:()=>{E(!1),j(null)},onConfirm:S,paymentMethod:B,isDeleting:c!==null}),C&&w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-[70] flex items-end justify-center animate-fadeIn",children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md p-6 shadow-2xl animate-slideUp",children:[e.jsxs("div",{className:"flex flex-col items-center text-center mb-6",children:[e.jsx("div",{className:"mb-4",children:T(w,"large")}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Set as Primary?"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["Make **** **** ",w.lastFour," your primary payment method?"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>{A(!1),F(null)},disabled:h!==null,className:"flex-1 bg-gray-100 text-gray-900 font-semibold py-3.5 rounded-xl hover:bg-gray-200 transition-colors disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:$,disabled:h!==null,className:"flex-1 bg-gradient-to-r from-orange-400 to-orange-500 text-white font-semibold py-3.5 rounded-xl hover:from-orange-500 hover:to-orange-600 transition-all shadow-lg disabled:opacity-50 disabled:cursor-not-allowed",children:h?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Setting..."})]}):"Confirm"})]})]})})]})}function px({onClose:t,onNavigateToMap:s,userProfile:a}){const[r,x]=n.useState(!1),[o,m]=n.useState(!1),[f,g]=n.useState(!1),[p,c]=n.useState(!1),[l,h]=n.useState(!1),[u,b]=n.useState(!1),E=async()=>{try{await J.auth.signOut(),ve.setAuthToken(null),localStorage.removeItem("api_token"),localStorage.removeItem("user_data"),localStorage.removeItem("supabase_token"),localStorage.removeItem("supabase_user"),sessionStorage.clear(),window.location.href="/"}catch{ve.setAuthToken(null),localStorage.clear(),sessionStorage.clear(),window.location.href="/"}};return r?e.jsx(x0,{onClose:()=>x(!1)}):o?e.jsx(ix,{onClose:()=>m(!1),onNavigateToMap:s}):f?e.jsx(cx,{onClose:()=>g(!1),onNavigateToMap:s}):p?e.jsx(s0,{onBack:()=>c(!1)}):l?e.jsx(gx,{onClose:()=>h(!1),userProfile:a}):e.jsxs("div",{className:"fixed inset-0 bg-gray-50 z-50 overflow-hidden",children:[e.jsx("div",{className:"h-full overflow-y-auto pb-24",children:e.jsxs("div",{className:"min-h-full w-full max-w-md mx-auto bg-gray-50",children:[e.jsxs("div",{className:"sticky top-0 bg-gray-50 z-10 px-4 py-4 flex items-center border-b border-gray-200",children:[e.jsx("button",{onClick:t,className:"p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsx("h1",{className:"flex-1 text-center text-xl font-bold text-gray-900 pr-10",children:"Settings"})]}),e.jsxs("div",{className:"px-4 py-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Account Settings"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("button",{onClick:()=>x(!0),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ms,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Personal Information"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("button",{className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(P0,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Notifications"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("button",{className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(js,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Language"})]}),e.jsx("span",{className:"text-gray-500 text-sm",children:"English"})]})]})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Payments"}),e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:e.jsxs("button",{onClick:()=>h(!0),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ve,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Payment methods"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-sm font-bold text-gray-900 mb-3 px-2",children:"Help & Support"}),e.jsxs("div",{className:"bg-white rounded-2xl overflow-hidden shadow-sm",children:[e.jsxs("button",{onClick:()=>c(!0),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(vs,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Help Center"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ws,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Privacy"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]}),e.jsxs("button",{onClick:()=>g(!0),className:"w-full flex items-center justify-between p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ia,{className:"w-5 h-5 text-gray-700"}),e.jsx("span",{className:"text-gray-900 font-medium",children:"Terms & Conditions"})]}),e.jsx(Pe,{className:"w-5 h-5 text-gray-400"})]})]})]}),e.jsx("p",{className:"text-center text-gray-400 text-sm mt-8 pb-4",children:"Version 1.0.4"})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-gray-50 z-20",style:{paddingBottom:"14px"},children:e.jsx("div",{className:"w-full max-w-md mx-auto px-4 py-4",children:e.jsxs("button",{onClick:()=>b(!0),className:"w-full bg-slate-700 hover:bg-slate-800 text-white font-semibold py-4 rounded-[1rem] transition-all shadow-md flex items-center justify-center gap-2",children:[e.jsx(ca,{className:"w-5 h-5"}),"Log Out"]})})}),e.jsx(dx,{isOpen:u,onClose:()=>b(!1),onConfirm:E})]})}function Ex({isVisible:t,onHide:s,message:a="Changes were successfully saved."}){return n.useEffect(()=>{if(t){const r=setTimeout(()=>{s()},3e3);return()=>clearTimeout(r)}},[t,s]),t?e.jsx("div",{className:"fixed top-4 left-1/2 -translate-x-1/2 z-[60] animate-slide-down",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl px-6 py-3 flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-teal-400 to-teal-500 flex items-center justify-center flex-shrink-0",children:e.jsx(Qe,{className:"w-6 h-6 text-white stroke-[3]"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-sm leading-tight",children:"Change saved"}),e.jsx("p",{className:"text-gray-600 text-xs leading-tight",children:a})]})]})}):null}function bx({user:t,onComplete:s,prefilledPhone:a,onBack:r}){const[x,o]=n.useState(""),[m,f]=n.useState(""),[g,p]=n.useState(""),[c,l]=n.useState("+31"),[h,u]=n.useState(!1),[b,E]=n.useState(!1),[B,j]=n.useState(null),[v,y]=n.useState(!1),[d,i]=n.useState("phone"),C=n.useRef(!1);n.useEffect(()=>{var k,P,L,$;const F=(k=t==null?void 0:t.app_metadata)==null?void 0:k.provider,N=F==="google"?"google":F==="facebook"?"facebook":"phone";if(i(N),N==="google"||N==="facebook"){const U=((P=t.user_metadata)==null?void 0:P.full_name)||((L=t.user_metadata)==null?void 0:L.name)||"",S=t.email||(($=t.user_metadata)==null?void 0:$.email)||"";o(U),f(S)}else if(N==="phone"){const U=t.phone||a||"";let S=U;if(S){S=S.replace(/\D/g,""),S=S.replace(/^0+/,"");const I=At(U);if(I){l(I.dialCode);const M=I.dialCode.substring(1);for(;S.startsWith(M)&&S.length>9;){const H=S.substring(M.length);if(H.length>=8)S=H;else break}S=S.substring(0,9)}}p(S)}},[t,a]),n.useEffect(()=>{if(B){const F=setTimeout(()=>{j(null)},5e3);return()=>clearTimeout(F)}},[B]);const A=async F=>{var N;F.preventDefault();try{const{data:{session:k},error:P}=await J.auth.refreshSession()}catch{}if(d==="phone"){if(!x.trim()){j("Please enter your full name");return}if(x.trim().split(" ").length<2){j("Please enter both first and last name");return}if(!m.trim()){j("Please enter your email address");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(m.trim())){j("Please enter a valid email address");return}}else if((d==="google"||d==="facebook")&&!g.trim()){j("Please enter your phone number");return}E(!0),j(null);try{let k=g.trim();if(k){if(k=k.replace(/\s+/g,""),!k.startsWith("+")){k=k.replace(/^0+/,"");const H=c.substring(1);if(k.startsWith(H)){const T=k.substring(H.length);T.length>=8&&T.length<=9&&(k=T)}k=`${c}${k}`}const M=Fs(k);if(!M.isValid){j(M.error||"Invalid phone number format");return}k=M.formatted}const P=At(k),{data:{user:L},error:$}=await J.auth.getUser();if($||!L){j("Session expired. Please log in again."),await J.auth.signOut(),setTimeout(()=>{window.location.reload()},2e3);return}const{data:U}=await J.from("users").select("user_id, email").eq("user_id",L.id).maybeSingle(),S={profile_completed:!0,updated_at:new Date().toISOString()};if(x.trim()){S.full_name=x.trim();const M=x.trim().split(" ");S.first_name=M[0]||"",S.last_name=M.slice(1).join(" ")||""}if(m.trim()){const M=m.trim().toLowerCase(),H=(N=U==null?void 0:U.email)==null?void 0:N.toLowerCase();if(M!==H){const{data:T}=await J.from("users").select("user_id").ilike("email",M).neq("user_id",L.id).maybeSingle();if(T)throw new Error("That email is already registered. Please use a different one.");S.email=m.trim()}}if(k&&(S.phone_nr=k,S.country=(P==null?void 0:P.name)||null),U){const{error:M}=await J.from("users").update(S).eq("user_id",L.id);if(M)throw M.code==="23505"||M.message.includes("duplicate key")||M.message.includes("idx_users_email_unique_lower")?new Error("That email is already registered. Please use a different one."):new Error(`Database update failed: ${M.message}`)}else{const{error:M}=await J.from("users").insert({user_id:L.id,email:L.email,created_at:new Date().toISOString(),...S});if(M)throw M.code==="23505"||M.message.includes("duplicate key")||M.message.includes("idx_users_email_unique_lower")?new Error("That email is already registered. Please use a different one."):new Error(`Database insert failed: ${M.message}`)}const{data:I}=await J.from("users").select("user_id, full_name, first_name, last_name, email, phone_nr, country, profile_completed, created_at, updated_at").eq("user_id",L.id).maybeSingle();try{const M={};x.trim()&&(M.firstName=x.trim().split(" ")[0],M.lastName=x.trim().split(" ").slice(1).join(" ")),k&&(M.phoneNumber=k,M.country=(P==null?void 0:P.name)||void 0),m.trim()&&(M.email=m.trim()),await Wt.updateProfile(M)}catch{}y(!0),C.current||(C.current=!0,setTimeout(()=>{s()},1500))}catch(k){j(k instanceof Error?k.message:"Failed to save profile")}finally{E(!1)}},w=x.toUpperCase()||"YOUR NAME";return e.jsxs("div",{className:"fixed inset-0 bg-white flex items-start justify-center overflow-hidden pt-12",children:[r&&e.jsx("button",{onClick:r,className:"fixed top-6 left-5 z-10 p-2 -ml-2 hover:bg-gray-100 rounded-full transition-colors","aria-label":"Go back",children:e.jsx(ye,{className:"w-6 h-6 text-gray-800"})}),e.jsxs("div",{className:"w-full max-w-md px-5 pb-[30px] relative",style:{minHeight:"calc(100vh - 3rem)"},children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-800 text-center mb-4",children:"Complete your profile"}),d==="phone"&&e.jsx("p",{className:"text-sm text-gray-600 text-center mb-8 hidden",children:"Please provide your name and email address to complete your profile."}),(d==="google"||d==="facebook")&&e.jsx("p",{className:"text-sm text-gray-600 text-center mb-8 hidden",children:"We've captured your name and email. Please add your phone number to complete your profile."}),d==="email"&&e.jsx("p",{className:"text-sm text-gray-600 text-center mb-8 hidden",children:"Please provide your name and phone number to complete your profile."}),e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-orange-300 to-orange-400 flex items-center justify-center mb-4 shadow-lg",children:e.jsx("div",{className:"text-4xl",children:"ðŸ˜Ž"})}),e.jsx("h2",{className:"text-2xl font-bold text-orange-400 tracking-wide",children:w})]}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[(d==="phone"||d==="email")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Your Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:x,onChange:F=>o(F.target.value),className:"w-full px-4 py-3 bg-white border-2 border-orange-300 rounded-xl outline-none focus:border-orange-400 text-gray-800 font-medium",placeholder:"Enter your name",required:!0}),x&&e.jsx("button",{type:"button",onClick:()=>o(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(we,{className:"w-5 h-5"})})]})]}),d==="phone"&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"email",value:m,onChange:F=>f(F.target.value),className:"w-full px-4 py-3 bg-white border-2 border-orange-300 rounded-xl outline-none focus:border-orange-400 text-gray-800 font-medium",placeholder:"Enter your email address",required:!0}),m&&e.jsx("button",{type:"button",onClick:()=>f(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",children:e.jsx(we,{className:"w-5 h-5"})})]})]}),(d==="email"||d==="google"||d==="facebook")&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("button",{type:"button",onClick:()=>u(!0),className:`w-full px-4 py-3 rounded-xl text-left font-medium transition-colors ${g?"bg-orange-50 text-gray-800 hover:bg-orange-100":"bg-white border-2 border-orange-300 text-gray-400 hover:border-orange-400"}`,children:g||"Add your phone number"})]}),d==="phone"&&g&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:g,disabled:!0,className:"w-full px-4 py-3 bg-gray-100 rounded-xl text-gray-500 font-medium cursor-not-allowed"})]}),(d==="google"||d==="facebook")&&m&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:m,disabled:!0,className:"w-full px-4 py-3 bg-gray-100 rounded-xl text-gray-500 font-medium cursor-not-allowed"})]}),(d==="google"||d==="facebook")&&x&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Your Name"}),e.jsx("input",{type:"text",value:x,disabled:!0,className:"w-full px-4 py-3 bg-gray-100 rounded-xl text-gray-500 font-medium cursor-not-allowed"})]}),e.jsx(a0,{isOpen:h,onClose:()=>u(!1),onSubmit:(F,N)=>{p(F),l(N)},initialPhone:g.replace(c,"").trim(),initialCountryCode:c}),B&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-3 text-red-600 text-sm",children:B}),e.jsx("div",{className:"fixed bottom-[30px] left-0 right-0 px-5 max-w-md mx-auto",children:e.jsx("button",{type:"submit",disabled:b,className:"w-full bg-gradient-to-r from-orange-400 to-orange-500 text-white py-4 rounded-[1rem] font-semibold hover:from-orange-500 hover:to-orange-600 transition-all disabled:opacity-50 shadow-lg",children:b?"Saving...":"Finish"})})]})]}),e.jsx(Ex,{isVisible:v,onHide:()=>y(!1)})]})}const Es="connection_invites_cache",ea=2*60*1e3;let Tt=null,bs=0;const ta=()=>{if(Tt&&Date.now()-bs<ea)return Tt;try{const t=localStorage.getItem(Es);if(t){const{data:s,timestamp:a}=JSON.parse(t);if(Date.now()-a<ea)return Tt=s,bs=a,s;localStorage.removeItem(Es)}}catch{}return null},is=t=>{const s=Date.now();Tt=t,bs=s;try{localStorage.setItem(Es,JSON.stringify({data:t,timestamp:s}))}catch{}};function yx({isOpen:t,onClose:s,onInviteCountChange:a,onConnectionsCountChange:r}){const x=t?ta():null,[o,m]=n.useState(x||[]),[f,g]=n.useState(!x),[p,c]=n.useState(null),{showToast:l}=qe(),h=n.useRef(!1);n.useEffect(()=>{if(t){const E=ta();if(E){m(E),g(!1),a==null||a(E.length),h.current=!0;return}h.current||(u(),h.current=!0)}},[t]),n.useEffect(()=>{let E;return(async()=>{const{data:{user:j}}=await J.auth.getUser();j&&(E=J.channel("connection_invites_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"connection_invites",filter:`recipient_user_id=eq.${j.id}`},v=>{const y=v.new;m(d=>{const i=[y,...d];return is(i),a==null||a(i.length),i}),l(`New connection request from ${y.sender_name}`,"success")}).subscribe())})(),()=>{E&&J.removeChannel(E)}},[a,l]);const u=async()=>{g(!0);try{const E=await Je.getPendingInvites();E.success?(m(E.invites),is(E.invites),a==null||a(E.invites.length)):l(E.error||"Failed to load invites","error")}catch{l("Failed to load invites","error")}finally{g(!1)}},b=async(E,B)=>{c(E);try{const j=await Je.respondToInvite(E,B);if(j.success){l(B==="accept"?"Connection established!":"Invite ignored","success");const v=o.filter(y=>y.id!==E);if(m(v),is(v),a==null||a(v.length),B==="accept"){const y=await Je.getConnections();y.success&&(r==null||r(y.connections.length))}}else l(j.error||`Failed to ${B} invite`,"error")}catch{l(`Failed to ${B} invite`,"error")}finally{c(null)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-30 backdrop-blur-sm z-50 flex items-end justify-center animate-fade-in",onClick:s,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up",onClick:E=>E.stopPropagation(),children:[e.jsx("div",{className:"sticky top-0 bg-white px-6 py-4 flex items-center justify-center rounded-t-3xl border-b border-gray-100",children:e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Connection Invites"})}),e.jsx("div",{className:"px-6 py-4",children:f?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):o.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(na,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No pending invites"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Share your Link ID to connect with friends"})]}):e.jsx("div",{className:"space-y-3",children:o.map(E=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-400 to-blue-600 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-white text-lg font-bold",children:E.sender_name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm text-gray-900",children:[e.jsx("span",{className:"font-bold",children:E.sender_name})," sent you a connection request"]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[e.jsx("span",{className:"font-semibold",children:"Link ID:"})," ",E.sender_link_id]}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:new Date(E.created_at).toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(E.id,"accept"),disabled:p===E.id,className:"flex-1 bg-[#1e3a5f] text-white py-2.5 rounded-xl font-semibold hover:bg-[#152a45] transition-colors disabled:bg-gray-300 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p===E.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}):e.jsxs(e.Fragment,{children:[e.jsx(Qe,{className:"w-4 h-4"}),"Accept"]})}),e.jsx("button",{onClick:()=>b(E.id,"ignore"),disabled:p===E.id,className:"flex-1 bg-gray-100 text-gray-700 py-2.5 rounded-xl font-semibold hover:bg-gray-200 transition-colors disabled:bg-gray-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:p===E.id?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}):e.jsxs(e.Fragment,{children:[e.jsx(Cs,{className:"w-4 h-4"}),"Ignore"]})})]})]},E.id))})})]})}):null}function Cx({isOpen:t,onClose:s,onConnectionsCountChange:a}){const[r,x]=n.useState([]),[o,m]=n.useState(!1),[f,g]=n.useState(null),{showToast:p}=qe();n.useEffect(()=>{t&&c()},[t]),n.useEffect(()=>{let h;return t&&(async()=>{const{data:{user:b}}=await J.auth.getUser();b&&(h=J.channel("user_connections_realtime").on("postgres_changes",{event:"INSERT",schema:"public",table:"user_connections"},E=>{c()}).on("postgres_changes",{event:"DELETE",schema:"public",table:"user_connections"},E=>{c()}).subscribe())})(),()=>{h&&J.removeChannel(h)}},[t]);const c=async()=>{m(!0);try{const h=await Je.getConnections();h.success?(x(h.connections),a==null||a(h.connections.length)):p(h.error||"Failed to load connections","error")}catch{p("Failed to load connections","error")}finally{m(!1)}},l=async h=>{if(confirm("Are you sure you want to remove this connection?")){g(h);try{const u=await Je.removeConnection(h);if(u.success){p("Connection removed","success");const b=r.filter(E=>E.user_id!==h);x(b),a==null||a(b.length)}else p(u.error||"Failed to remove connection","error")}catch{p("Failed to remove connection","error")}finally{g(null)}}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end justify-center animate-fade-in",onClick:s,children:e.jsxs("div",{className:"bg-white rounded-t-3xl w-full max-w-md max-h-[80vh] overflow-y-auto animate-slide-up",onClick:h=>h.stopPropagation(),children:[e.jsxs("div",{className:"sticky top-0 bg-white px-6 py-4 flex items-center justify-between rounded-t-3xl border-b border-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Friends List"}),e.jsx("button",{onClick:s,className:"p-1.5 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(we,{className:"w-5 h-5 text-gray-600"})})]}),e.jsx("div",{className:"px-6 py-4",children:o?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx(Re,{className:"w-8 h-8 text-orange-500 animate-spin"})}):r.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(st,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500 font-medium",children:"No friends yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Send connection invites to add friends"})]}):e.jsx("div",{className:"space-y-3",children:r.map(h=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 hover:border-orange-300 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-orange-400 to-pink-500 flex items-center justify-center flex-shrink-0",children:h.profile_picture?e.jsx("img",{src:h.profile_picture,alt:h.full_name,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-white text-lg font-bold",children:h.full_name.charAt(0).toUpperCase()})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-base font-bold text-gray-900 truncate",children:h.full_name}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[e.jsx("span",{className:"font-semibold",children:"Link ID:"})," ",h.link_id]})]}),e.jsx("button",{onClick:()=>l(h.user_id),disabled:f===h.user_id,className:"p-2 hover:bg-red-50 rounded-xl transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Remove connection",children:f===h.user_id?e.jsx(Re,{className:"w-5 h-5 text-red-500 animate-spin"}):e.jsx(I0,{className:"w-5 h-5 text-red-500"})})]})},h.user_id))})})]})}):null}function wx(){const[t,s]=n.useState("splash"),[a,r]=n.useState("map"),[x,o]=n.useState(null),[m,f]=n.useState(null),[g,p]=n.useState([]),[c,l]=n.useState([]),[h,u]=n.useState(null),[b,E]=n.useState(null),[B,j]=n.useState(!1),[v,y]=n.useState(!1),[d,i]=n.useState(!1),[C,A]=n.useState(!1),[w,F]=n.useState(0),[N,k]=n.useState(0),[P,L]=n.useState(!1),[$,U]=n.useState("week"),[S,I]=n.useState(null),[M,H]=n.useState(0),T=n.useRef(!1),D=n.useRef(!1),R=n.useCallback(async()=>{if(!D.current)try{const le=(Ae("USE_EDGE_MERCHANTS")?await mt.getAllMerchants():await dt.getAllMerchants()).map(Q=>{const K=Q.specialty||Q.companySpecialty||[],Fe=et(Q.openTime,Q.openDays);return{id:Q.id,name:Q.name,address:Q.address,city:xt(Q.address||"",Q.city),category:Q.category,merchantCategory:Q.merchantCategory,businessType:Q.businessType,subcategoryName:Q.subcategoryName,specialty:K,status:Fe?"Open":"Closed",image_url:Q.imageUrl,logoId:Q.logoId,coverImageIds:Q.coverImageIds,latitude:Q.latitude,longitude:Q.longitude,rating:Q.rating||0,reviewCount:Q.reviewCount||0,phone:Q.phone,website:Q.website,opening_hours:Q.openingHours||"",open_days:Q.openDays,open_time:Q.openTime,deals:Q.deals||[],availableSlots:Q.availableSlots||0,occupiedSlots:Q.occupiedSlots||0,totalSlots:Q.totalSlots||0,returnSlots:Q.returnSlots||0,hasStation:Q.hasStation||!1,unitPrice:Q.unitPrice,unitMin:Q.unitMin,parentMerchantId:Q.parentMerchantId}});l(le),D.current=!0;const de=le.slice(0,10).map(Q=>({coverImageIds:Q.coverImageIds||void 0,logoId:Q.logoId||void 0}));jt(de,10),As().then(()=>{}).catch(Q=>{})}catch{l([])}},[]),Z=n.useCallback(async(se,le=!1)=>{try{const Q=(await Ke.getUserBookings()).bookings.filter(K=>K.status!=="completed"&&K.status!=="cancelled"&&K.status!=="expired").map(K=>{var Fe,Se;return{id:K.id,user_id:K.userId,restaurant_id:K.merchantId,booking_date:K.bookingDate||K.booking_date||"",booking_time:K.booking_time||"",party_size:K.guests||1,booking_type:K.booking_type||"single",status:K.status,created_at:K.createdAt||new Date().toISOString(),dealImage:K.dealImage||((Fe=K.deal)==null?void 0:Fe.image)||"",deal_description:((Se=K.deal)==null?void 0:Se.title)||"",restaurant:K.restaurant?{id:K.restaurant.id,name:K.restaurant.name,address:K.restaurant.address,category:"Restaurant"}:void 0}});p(Q)}catch{p([])}le&&s("map")},[]),O=n.useCallback(async()=>{try{const[se,le]=await Promise.all([Je.getPendingInvites(),Je.getConnections()]);se.success&&F(se.invites.length),le.success&&k(le.connections.length)}catch{}},[]),V=n.useCallback(async()=>{if(x)try{const{data:se}=await J.from("users").select("full_name, current_level, email, phone_nr, profile_completed, total_savings, available_points, total_points, pending_points, profile_picture, link_id").eq("user_id",x.id).maybeSingle();se&&(f(se),await O())}catch{}},[x,O]),q=n.useCallback(async se=>{try{const{data:le,error:de}=await J.from("users").select("full_name, current_level, email, phone_nr, profile_completed, total_savings, available_points, total_points, pending_points, profile_picture, link_id").eq("user_id",se.id).maybeSingle();if(de){s("profile-completion");return}if(le)if(f(le),await O(),le.profile_completed===!0){await Z(se.id,!1),s("map");return}else{s("profile-completion");return}else s("profile-completion")}catch{s("profile-completion")}},[Z,O]),z=n.useCallback(async()=>{var se;if(!T.current){T.current=!0;try{const le=new URLSearchParams(window.location.search),de=le.get("code");if(de)try{const{data:Ee,error:ut}=await J.auth.exchangeCodeForSession(de);if(ut){s("login");return}if((se=Ee==null?void 0:Ee.session)!=null&&se.user){o(Ee.session.user),localStorage.setItem("supabase_token",Ee.session.access_token),localStorage.setItem("supabase_user",JSON.stringify(Ee.session.user)),window.history.replaceState({},document.title,window.location.pathname),await q(Ee.session.user);return}}catch{s("login");return}const Q=le.get("payment_setup_complete"),K=le.get("setup_intent"),Fe=le.get("setup_intent_client_secret");if(Q&&(K||Fe))try{const{data:{session:Ee}}=await J.auth.getSession();if(Ee!=null&&Ee.user){const{paymentMethodsAPI:ut}=await $0(async()=>{const{paymentMethodsAPI:Ft}=await Promise.resolve().then(()=>nr);return{paymentMethodsAPI:Ft}},void 0);await ut.completePaymentMethodSetup(Q,K||Fe||""),window.history.replaceState({},document.title,window.location.pathname)}}catch{}const Se=new URLSearchParams(window.location.hash.substring(1));(Se.has("access_token")||Se.has("error"))&&await new Promise(Ee=>setTimeout(Ee,1e3));const{data:{session:Ne},error:Ge}=await J.auth.getSession();if(Ne!=null&&Ne.user){o(Ne.user),await q(Ne.user);return}const ge=localStorage.getItem("phone_auth_session"),rt=localStorage.getItem("phone_auth_user");if(ge&&rt){const Ee=JSON.parse(rt);o(Ee),await q(Ee);return}const Et=localStorage.getItem("api_token"),Nt=localStorage.getItem("user_data");if(Et&&Nt)try{ve.setAuthToken(Et);const Ee=await ha.verify();Ee.valid&&Ee.user?(o(Ee.user),await q(Ee.user)):s("login")}catch{localStorage.removeItem("api_token"),localStorage.removeItem("user_data"),s("login")}else s("login")}finally{T.current=!1}}},[q]);n.useEffect(()=>{P&&(R(),z())},[P]),n.useEffect(()=>{const{data:se}=J.auth.onAuthStateChange((de,Q)=>{t!=="profile-completion"&&(de==="SIGNED_OUT"?(o(null),f(null),p([]),l([]),D.current=!1,u(null),E(null),j(!1),localStorage.removeItem("api_token"),localStorage.removeItem("user_data"),localStorage.removeItem("supabase_token"),localStorage.removeItem("supabase_user"),s("login")):de==="SIGNED_IN"&&(Q!=null&&Q.user)?(o(Q.user),localStorage.setItem("supabase_token",Q.access_token),localStorage.setItem("supabase_user",JSON.stringify(Q.user)),D.current||R().catch(K=>{}),(async()=>{try{await q(Q.user)}catch{}})()):de==="TOKEN_REFRESHED"&&Q&&localStorage.setItem("supabase_token",Q.access_token))}),le=()=>{s("membership"),j(!1)};return window.addEventListener("navigate-to-membership",le),()=>{se.subscription.unsubscribe(),window.removeEventListener("navigate-to-membership",le)}},[q,R,t]),n.useEffect(()=>{if(!x)return;const se=J.channel("profile-changes").on("postgres_changes",{event:"UPDATE",schema:"public",table:"users",filter:`user_id=eq.${x.id}`},()=>{V()}).on("postgres_changes",{event:"*",schema:"public",table:"points_transactions",filter:`user_id=eq.${x.id}`},()=>{V()}).subscribe();return()=>{se.unsubscribe()}},[x,V]),n.useEffect(()=>{if(!x)return;const se=J.channel("connection-invites-global").on("postgres_changes",{event:"INSERT",schema:"public",table:"connection_invites",filter:`recipient_user_id=eq.${x.id}`},le=>{F(de=>de+1)}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"connection_invites",filter:`recipient_user_id=eq.${x.id}`},le=>{le.new.status!=="pending"&&F(Q=>Math.max(0,Q-1))}).subscribe();return()=>{se.unsubscribe()}},[x]);const _=se=>{E(se),r(t),s("merchant-details")},W=async se=>{try{const de=(await Ke.getUserBookings()).bookings.filter(Q=>Q.status!=="completed"&&Q.status!=="cancelled"&&Q.status!=="expired").map(Q=>{var K,Fe,Se,at,Ne,Ge;return{id:Q.id,user_id:Q.userId,restaurant_id:Q.merchantId,booking_date:Q.bookingDate||Q.booking_date||"",booking_time:Q.booking_time||"",party_size:Q.guests||1,booking_type:"single",status:Q.status,created_at:Q.createdAt||new Date().toISOString(),dealImage:Q.dealImage||((K=Q.deal)==null?void 0:K.image)||"",deal_description:((Fe=Q.deal)==null?void 0:Fe.title)||"",restaurant:Q.restaurant||Q.merchant?{id:Q.merchantId,name:((Se=Q.restaurant)==null?void 0:Se.name)||((at=Q.merchant)==null?void 0:at.name)||"Restaurant",address:((Ne=Q.restaurant)==null?void 0:Ne.address)||((Ge=Q.merchant)==null?void 0:Ge.address)||"",category:"Restaurant"}:void 0}});p(de),s("bookings")}catch{}},ne=()=>{z()},X=se=>{I(se),s("otp-verification")},re=async()=>{const{data:{user:se}}=await J.auth.getUser();se&&(o(se),s("profile-completion"))},te=()=>{I(null),s("login")},oe=async se=>{r(t==="map"||t==="discover"?t:"map"),U(se||"week"),s("bookings");try{const Q=(await Ke.getUserBookings()).bookings.filter(K=>K.status!=="completed"&&K.status!=="cancelled"&&K.status!=="expired").map(K=>{var Fe,Se,at,Ne,Ge,ge,rt;return{id:K.id,user_id:K.userId,restaurant_id:K.merchantId,booking_date:K.bookingDate||K.booking_date||"",booking_time:K.booking_time||"",party_size:K.guests||1,booking_type:K.booking_type||"single",status:K.status,created_at:K.createdAt||new Date().toISOString(),restaurant:K.restaurant||K.merchant?{id:K.merchantId,name:((Fe=K.restaurant)==null?void 0:Fe.name)||((Se=K.merchant)==null?void 0:Se.name)||"Restaurant",address:((at=K.restaurant)==null?void 0:at.address)||((Ne=K.merchant)==null?void 0:Ne.address)||""}:void 0,deal_description:((Ge=K.deal)==null?void 0:Ge.title)||((ge=K.deal)==null?void 0:ge.description)||"",dealImage:((rt=K.deal)==null?void 0:rt.image)||K.dealImage||""}});p(Q)}catch{}},Y=()=>{s("map")},ee=se=>{const le=g.find(de=>de.id===se);le&&(u(le),r(t),s("booking-detail"))},xe=()=>{r(t),s("chat")},me=()=>{r(t),j(!1),s("promotions")},ce=()=>{r(t),j(!1),s("membership")},Le=()=>{r(t),s("discover")},pe=()=>{r(t),j(!1),s("history")},Me=()=>{r(t),j(!1),s("help-center")},Xe=()=>{r(t),j(!1),s("settings")},es=()=>{r(t),j(!1),s("profile")},G=()=>{y(!0)},ae=()=>{i(!0)},fe=()=>{A(!0)},ie=()=>{s(a),a==="map"&&j(!0)},Be=()=>{L(!0),s("login")};if(t==="splash")return e.jsx(pr,{onComplete:Be});if(t==="login")return e.jsx(Cr,{onLogin:ne,onOTPRequired:X});if(t==="otp-verification"&&S)return e.jsx(vr,{phoneNumber:S,onVerified:re,onBack:te});if(t==="profile-completion"&&x)return e.jsx(bx,{user:x,prefilledPhone:S||void 0,onBack:()=>{I(null),s("login")},onComplete:async()=>{I(null);try{const se=await Wt.getProfile(),le={...x,...se};o(le);const{data:de}=await J.from("users").select("full_name, current_level, email, phone_nr, total_savings, available_points, total_points, pending_points, profile_picture, link_id").eq("user_id",x.id).maybeSingle();de&&f(de),localStorage.getItem("api_token")&&localStorage.setItem("user_data",JSON.stringify(le))}catch{}await Z(x.id,!0),s("map")}});if(t==="map")return e.jsxs(e.Fragment,{children:[e.jsx(dn,{restaurants:c,onRestaurantSelect:_,onNavigateToBookings:()=>oe("week"),onOpenMenu:()=>j(!0),onOpenDiscover:Le,onOpenPromotions:me,unreadInvitesCount:M,userProfile:m}),e.jsx(jn,{isOpen:B,onClose:()=>j(!1),onOpenPromotions:me,onOpenMembership:ce,onOpenHistory:pe,onOpenHelpCenter:Me,onOpenSettings:Xe,onOpenProfile:es,onOpenLinkId:G,onOpenConnectionInvites:ae,onOpenFriendsList:fe,connectionInvitesCount:w,connectionsCount:N,userProfile:m}),v&&e.jsx(n0,{onClose:()=>y(!1),userLinkId:m==null?void 0:m.link_id}),d&&e.jsx(yx,{isOpen:d,onClose:()=>i(!1),onInviteCountChange:F,onConnectionsCountChange:k}),C&&e.jsx(Cx,{isOpen:C,onClose:()=>A(!1),onConnectionsCountChange:k})]});if(t==="discover")return e.jsx(Vn,{restaurants:c,onRestaurantSelect:_,onBack:()=>s("map"),onNavigateToBookings:()=>oe("week"),unreadInvitesCount:M});if(t==="merchant-details"&&b){const se={id:b.id,name:b.name,specialty:b.specialty&&b.specialty.length>0?b.specialty:[],subcategoryName:b.subcategoryName,city:xt(b.address||"",b.city),status:"open",image:b.image_url||"",address:b.address||"",rating:b.rating||0,reviewCount:b.reviewCount||0,deals:b.deals,latitude:b.latitude,longitude:b.longitude,coverImageIds:b.coverImageIds||void 0,logoId:b.logoId||void 0,open_days:b.open_days,open_time:b.open_time,businessType:b.businessType,availableSlots:b.availableSlots,occupiedSlots:b.occupiedSlots,totalSlots:b.totalSlots,returnSlots:b.returnSlots,unitPrice:b.unitPrice,unitMin:b.unitMin,parentMerchantId:b.parentMerchantId};return e.jsx(e0,{restaurant:se,onBack:()=>s(a),onBookingComplete:async le=>{if(x)try{const Q=(await Ke.getUserBookings()).bookings.filter(K=>K.status!=="completed"&&K.status!=="cancelled"&&K.status!=="expired").map(K=>{var Fe,Se;return{id:K.id,user_id:K.userId,restaurant_id:K.merchantId,booking_date:K.bookingDate||K.booking_date||"",booking_time:K.booking_time||"",party_size:K.guests||1,booking_type:K.booking_type||"single",status:K.status,created_at:K.createdAt||new Date().toISOString(),dealImage:K.dealImage||((Fe=K.deal)==null?void 0:Fe.image)||"",deal_description:((Se=K.deal)==null?void 0:Se.title)||"",restaurant:K.restaurant?{id:K.restaurant.id,name:K.restaurant.name,address:K.restaurant.address,category:"Restaurant"}:void 0}});p(Q)}catch{}s("bookings")}})}if(t==="booking-form"&&b&&x)return e.jsx(mn,{restaurant:b,userId:x.id,onBack:()=>s("map"),onBookingComplete:W});if(t==="confirmation"&&h&&h.restaurant)return e.jsx(Xa,{booking:h,restaurant:h.restaurant,onGoToBookings:oe,onExploreMore:Y});if(t==="booking-detail"&&h){const se=c.find(Ne=>Ne.id===h.restaurant_id),le=()=>{const Ne=g.find(Ge=>Ge.id===h.id);return Ne&&Ne.dealImage?qt(Ne.dealImage):se!=null&&se.coverImageIds&&se.coverImageIds.length>0?_e(se.coverImageIds[0]):se!=null&&se.logoId?_e(se.logoId):se!=null&&se.image_url?_e(se.image_url):"https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=800&h=600&fit=crop"},de=g.find(Ne=>Ne.id===h.id),Q=(de==null?void 0:de.deal_description)||h.deal_description||"",K=h.restaurant||(de==null?void 0:de.restaurant),Fe=(K==null?void 0:K.name)||(se==null?void 0:se.name)||"Restaurant",Se=(K==null?void 0:K.address)||(se==null?void 0:se.address)||"",at=async()=>{if(await V(),x!=null&&x.id)try{const Ge=(await Ke.getUserBookings()).bookings.filter(ge=>ge.status!=="completed"&&ge.status!=="cancelled"&&ge.status!=="expired").map(ge=>{var rt,Et,Nt,Ee,ut,Ft;return{id:ge.id,user_id:ge.userId,restaurant_id:ge.merchantId,booking_date:ge.bookingDate||ge.booking_date||"",booking_time:ge.booking_time||"",party_size:ge.guests||1,booking_type:"single",status:ge.status,created_at:ge.createdAt||new Date().toISOString(),dealImage:ge.dealImage||((rt=ge.deal)==null?void 0:rt.image)||"",deal_description:((Et=ge.deal)==null?void 0:Et.title)||"",restaurant:ge.restaurant||ge.merchant?{id:ge.merchantId,name:((Nt=ge.restaurant)==null?void 0:Nt.name)||((Ee=ge.merchant)==null?void 0:Ee.name)||"Restaurant",address:((ut=ge.restaurant)==null?void 0:ut.address)||((Ft=ge.merchant)==null?void 0:Ft.address)||"",category:"Restaurant"}:void 0}});p(Ge)}catch{}};return e.jsx(gn,{booking:{id:h.id,type:"dining",name:Fe,address:Se,date:h.booking_date,time:h.booking_time,status:h.status==="confirmed"?"active":h.status==="cancelled"?"cancelled":"complete",amount:0,deal:Q,dealTitle:Q,image:le(),merchantId:h.restaurant_id},onBack:()=>{u(null),s(a)},onNavigateToMap:()=>{u(null),s(a)},onBookingChanged:at})}return t==="bookings"?e.jsx(wn,{bookings:g,initialView:$,onBack:()=>{s(a==="map"||a==="discover"?a:"map")},onBookingClick:ee,onOpenChat:xe,onOpenHistory:pe,onRestaurantSelect:_,onNavigateToDiscover:()=>{s("discover")},onNavigateToMap:()=>{s("map")},onInviteCountChange:async se=>{F(se),await O()}}):t==="chat"&&x?e.jsx(Qa,{onClose:()=>s(a),onCloseToMap:()=>s("map")}):t==="promotions"?e.jsx(Sn,{onBack:ie}):t==="membership"?e.jsx(In,{onBack:ie,userProfile:m}):t==="history"?e.jsx(Xn,{onBack:()=>{s(a),a==="map"&&j(!0)},onOpenHelpCenter:Me,onNavigateToMerchant:se=>{const le=c.find(de=>de.id===se);le&&_(le)},onNavigateToMap:()=>{s("map")}}):t==="help-center"?e.jsx(s0,{onBack:ie,onNavigateToMap:()=>s("map")}):t==="settings"?e.jsx(px,{onClose:ie,onNavigateToMap:()=>s("map"),userProfile:m}):t==="profile"?e.jsx(x0,{onClose:ie}):null}function vx(){return e.jsx(dr,{children:e.jsx(wx,{})})}class Bx extends n.Component{constructor(s){super(s),this.state={hasError:!1}}static getDerivedStateFromError(s){return{hasError:!0,error:s}}componentDidCatch(s,a){}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 max-w-md w-full text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"bg-red-100 rounded-full p-3",children:e.jsx(Bs,{className:"w-8 h-8 text-red-600"})})}),e.jsx("h1",{className:"text-xl font-bold text-gray-900 mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),e.jsx("button",{onClick:()=>window.location.reload(),className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Refresh Page"}),!1]})}):this.props.children}}ua(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Bx,{children:e.jsx(Br,{children:e.jsx(vx,{})})})}));
